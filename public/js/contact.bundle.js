(()=>{"use strict";var e,t,r,o,n,i={6528:(e,t,r)=>{var o=r(9251),n=r(9660);async function i(e){e.preventDefault();const t=e.target.querySelector('button[type="submit"]'),r=t.textContent;t.disabled=!0,t.textContent="Envoi en cours...";try{const t=new FormData(e.target),r={name:t.get("name"),email:t.get("email"),subject:t.get("subject"),message:t.get("message")};if(!(r.name&&r.email&&r.subject&&r.message))throw new Error("Tous les champs sont requis");const o={name:String(r.name).trim(),email:String(r.email).trim(),subject:String(r.subject).trim(),message:String(r.message).trim()};console.log("Submitting contact data:",o);const{data:i,error:s}=await n.N.from("support_messages").insert(o).select().single();if(s)throw console.error("Supabase error:",s),"42501"===s.code?new Error("Erreur de permission. Veuillez réessayer ou nous contacter directement."):"PGRST301"===s.code?new Error("Erreur de validation des données. Vérifiez vos informations."):new Error(`Erreur lors de l'enregistrement: ${s.message}`);console.log("Successfully inserted to database:",i);try{await async function(e){try{const t=await fetch("https://ofeyssipibktmbfebibo.supabase.co/functions/v1/discord-contact-notification",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mZXlzc2lwaWJrdG1iZmViaWJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM5MjUwOTQsImV4cCI6MjA1OTUwMTA5NH0.w71CAKfolktzRl-TmLVhHYaEbhCfVk4A7YraEUCglrU"},body:JSON.stringify({record:e})});if(!t.ok){const e=await t.json();throw new Error(`Discord API error: ${t.status} - ${e.error||"Unknown error"}`)}const r=await t.json();return console.log("Discord notification sent successfully:",r),r}catch(e){throw console.error("Failed to send Discord notification:",e),e}}({...i,created_at:i.created_at||(new Date).toISOString()})}catch(e){console.warn("Discord notification failed:",e)}a("Message envoyé avec succès ! Nous vous répondrons bientôt.","success"),e.target.reset()}catch(e){console.error("Error sending contact message:",e),a(e.message||"Erreur lors de l'envoi du message. Veuillez réessayer.","error")}finally{t.disabled=!1,t.textContent=r}}function a(e,t="info"){document.querySelectorAll(".notification").forEach((e=>e.remove()));const r=document.createElement("div");return r.className=`notification notification-${t}`,r.textContent=e,Object.assign(r.style,{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"5px",color:"white",fontWeight:"bold",zIndex:"10000",maxWidth:"400px",backgroundColor:"success"===t?"#10b981":"error"===t?"#ef4444":"#3b82f6"}),document.body.appendChild(r),setTimeout((()=>{r.parentNode&&r.remove()}),5e3),r}document.addEventListener("DOMContentLoaded",(()=>{try{(0,o.Mt)(),!function(){const e=document.querySelector(".contact-form");return!!e&&(e.addEventListener("submit",i),console.log("Contact form initialized"),!0)}()?console.warn("Contact form not found on this page"):console.log("Contact page initialized successfully")}catch(e){console.error("Error initializing contact page:",e)}}))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return i[e].call(r.exports,r,r.exports,s),r.exports}s.m=i,e=[],s.O=(t,r,o,n)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,o,n]=e[u],a=!0,c=0;c<r.length;c++)(!1&n||i>=n)&&Object.keys(s.O).every((e=>s.O[e](r[c])))?r.splice(c--,1):(a=!1,n<i&&(i=n));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[r,o,n]},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var n=Object.create(null);s.r(n);var i={};t=t||[null,r({}),r([]),r(r)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=r(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(n,i),n},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>"js/"+e+".chunk.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},n="urbandocs_webapp:",s.l=(e,t,r,i)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+r){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",n+r),a.src=e),o[e]=[t];var f=(t,r)=>{a.onerror=a.onload=null,clearTimeout(m);var n=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((e=>e(r))),t)return t(r)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=353,s.p="/",(()=>{var e={353:0};s.f.j=(t,r)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var n=new Promise(((r,n)=>o=e[t]=[r,n]));r.push(o[2]=n);var i=s.p+s.u(t),a=new Error;s.l(i,(r=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var n=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",a.name="ChunkLoadError",a.type=n,a.request=i,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,r)=>{var o,n,[i,a,c]=r,l=0;if(i.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var u=c(s)}for(t&&t(r);l<i.length;l++)n=i[l],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(u)},r=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var c=s.O(void 0,[76],(()=>s(6528)));c=s.O(c)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R3VDLFNBQVdzRyxFQUFTQSxFQUUvRCxHQVlIN0MsRUFBb0JTLEVBQUVTLEVBQUsyQixHQUEwQyxJQUE3QndDLEVBQWdCeEMsR0FHeEQsSUFBSWdELEVBQXVCLENBQUNDLEVBQTRCeEosS0FDdkQsSUFHSTJELEVBQVU0QyxHQUhUbkMsRUFBVXFGLEVBQWFDLEdBQVcxSixFQUdoQnlFLEVBQUksRUFDM0IsR0FBR0wsRUFBU3VGLE1BQU1DLEdBQWdDLElBQXhCYixFQUFnQmEsS0FBYSxDQUN0RCxJQUFJakcsS0FBWThGLEVBQ1ovRixFQUFvQndDLEVBQUV1RCxFQUFhOUYsS0FDckNELEVBQW9CUSxFQUFFUCxHQUFZOEYsRUFBWTlGLElBR2hELEdBQUcrRixFQUFTLElBQUl0SSxFQUFTc0ksRUFBUWhHLEVBQ2xDLENBRUEsSUFERzhGLEdBQTRCQSxFQUEyQnhKLEdBQ3JEeUUsRUFBSUwsRUFBU00sT0FBUUQsSUFDekI4QixFQUFVbkMsRUFBU0ssR0FDaEJmLEVBQW9Cd0MsRUFBRTZDLEVBQWlCeEMsSUFBWXdDLEVBQWdCeEMsSUFDckV3QyxFQUFnQnhDLEdBQVMsS0FFMUJ3QyxFQUFnQnhDLEdBQVcsRUFFNUIsT0FBTzdDLEVBQW9CUyxFQUFFL0MsSUFHMUJ5SSxFQUFxQkMsS0FBbUMsNkJBQUlBLEtBQW1DLDhCQUFLLEdBQ3hHRCxFQUFtQjdILFFBQVF1SCxFQUFxQmIsS0FBSyxLQUFNLElBQzNEbUIsRUFBbUJ0QyxLQUFPZ0MsRUFBcUJiLEtBQUssS0FBTW1CLEVBQW1CdEMsS0FBS21CLEtBQUttQixHLEtDbEZ2RixJQUFJRSxFQUFzQnJHLEVBQW9CUyxPQUFFTixFQUFXLENBQUMsS0FBSyxJQUFPSCxFQUFvQixRQUM1RnFHLEVBQXNCckcsRUFBb0JTLEVBQUU0RixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NyZWF0ZSBmYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9tb2R1bGVzL2NvbnRhY3QtZm9ybS5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2VudHJpZXMvY29udGFjdC5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9ydW50aW1lSWQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWZlcnJlZCA9IFtdO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5PID0gKHJlc3VsdCwgY2h1bmtJZHMsIGZuLCBwcmlvcml0eSkgPT4ge1xuXHRpZihjaHVua0lkcykge1xuXHRcdHByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcblx0XHRmb3IodmFyIGkgPSBkZWZlcnJlZC5sZW5ndGg7IGkgPiAwICYmIGRlZmVycmVkW2kgLSAxXVsyXSA+IHByaW9yaXR5OyBpLS0pIGRlZmVycmVkW2ldID0gZGVmZXJyZWRbaSAtIDFdO1xuXHRcdGRlZmVycmVkW2ldID0gW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldO1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgbm90RnVsZmlsbGVkID0gSW5maW5pdHk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWQubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldID0gZGVmZXJyZWRbaV07XG5cdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBjaHVua0lkcy5sZW5ndGg7IGorKykge1xuXHRcdFx0aWYgKChwcmlvcml0eSAmIDEgPT09IDAgfHwgbm90RnVsZmlsbGVkID49IHByaW9yaXR5KSAmJiBPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLk8pLmV2ZXJ5KChrZXkpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fLk9ba2V5XShjaHVua0lkc1tqXSkpKSkge1xuXHRcdFx0XHRjaHVua0lkcy5zcGxpY2Uoai0tLCAxKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZ1bGZpbGxlZCA9IGZhbHNlO1xuXHRcdFx0XHRpZihwcmlvcml0eSA8IG5vdEZ1bGZpbGxlZCkgbm90RnVsZmlsbGVkID0gcHJpb3JpdHk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWQuc3BsaWNlKGktLSwgMSlcblx0XHRcdHZhciByID0gZm4oKTtcblx0XHRcdGlmIChyICE9PSB1bmRlZmluZWQpIHJlc3VsdCA9IHI7XG5cdFx0fVxuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59OyIsInZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiA/IChvYmopID0+IChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkgOiAob2JqKSA9PiAob2JqLl9fcHJvdG9fXyk7XG52YXIgbGVhZlByb3RvdHlwZXM7XG4vLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3Rcbi8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuLy8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3Rcbi8vIG1vZGUgJiAxNjogcmV0dXJuIHZhbHVlIHdoZW4gaXQncyBQcm9taXNlLWxpa2Vcbi8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbl9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG5cdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IHRoaXModmFsdWUpO1xuXHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuXHRpZih0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlKSB7XG5cdFx0aWYoKG1vZGUgJiA0KSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG5cdFx0aWYoKG1vZGUgJiAxNikgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicpIHJldHVybiB2YWx1ZTtcblx0fVxuXHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuXHR2YXIgZGVmID0ge307XG5cdGxlYWZQcm90b3R5cGVzID0gbGVhZlByb3RvdHlwZXMgfHwgW251bGwsIGdldFByb3RvKHt9KSwgZ2V0UHJvdG8oW10pLCBnZXRQcm90byhnZXRQcm90byldO1xuXHRmb3IodmFyIGN1cnJlbnQgPSBtb2RlICYgMiAmJiB2YWx1ZTsgdHlwZW9mIGN1cnJlbnQgPT0gJ29iamVjdCcgJiYgIX5sZWFmUHJvdG90eXBlcy5pbmRleE9mKGN1cnJlbnQpOyBjdXJyZW50ID0gZ2V0UHJvdG8oY3VycmVudCkpIHtcblx0XHRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IChkZWZba2V5XSA9ICgpID0+ICh2YWx1ZVtrZXldKSkpO1xuXHR9XG5cdGRlZlsnZGVmYXVsdCddID0gKCkgPT4gKHZhbHVlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBkZWYpO1xuXHRyZXR1cm4gbnM7XG59OyIsInZhciBpblByb2dyZXNzID0ge307XG52YXIgZGF0YVdlYnBhY2tQcmVmaXggPSBcInVyYmFuZG9jc193ZWJhcHA6XCI7XG4vLyBsb2FkU2NyaXB0IGZ1bmN0aW9uIHRvIGxvYWQgYSBzY3JpcHQgdmlhIHNjcmlwdCB0YWdcbl9fd2VicGFja19yZXF1aXJlX18ubCA9ICh1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkgPT4ge1xuXHRpZihpblByb2dyZXNzW3VybF0pIHsgaW5Qcm9ncmVzc1t1cmxdLnB1c2goZG9uZSk7IHJldHVybjsgfVxuXHR2YXIgc2NyaXB0LCBuZWVkQXR0YWNoO1xuXHRpZihrZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBzID0gc2NyaXB0c1tpXTtcblx0XHRcdGlmKHMuZ2V0QXR0cmlidXRlKFwic3JjXCIpID09IHVybCB8fCBzLmdldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiKSA9PSBkYXRhV2VicGFja1ByZWZpeCArIGtleSkgeyBzY3JpcHQgPSBzOyBicmVhazsgfVxuXHRcdH1cblx0fVxuXHRpZighc2NyaXB0KSB7XG5cdFx0bmVlZEF0dGFjaCA9IHRydWU7XG5cdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cblx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG5cdFx0c2NyaXB0LnRpbWVvdXQgPSAxMjA7XG5cdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubmMpIHtcblx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcblx0XHR9XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiLCBkYXRhV2VicGFja1ByZWZpeCArIGtleSk7XG5cblx0XHRzY3JpcHQuc3JjID0gdXJsO1xuXHR9XG5cdGluUHJvZ3Jlc3NbdXJsXSA9IFtkb25lXTtcblx0dmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpID0+IHtcblx0XHQvLyBhdm9pZCBtZW0gbGVha3MgaW4gSUUuXG5cdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcblx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0dmFyIGRvbmVGbnMgPSBpblByb2dyZXNzW3VybF07XG5cdFx0ZGVsZXRlIGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRzY3JpcHQucGFyZW50Tm9kZSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdGRvbmVGbnMgJiYgZG9uZUZucy5mb3JFYWNoKChmbikgPT4gKGZuKGV2ZW50KSkpO1xuXHRcdGlmKHByZXYpIHJldHVybiBwcmV2KGV2ZW50KTtcblx0fVxuXHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQob25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHVuZGVmaW5lZCwgeyB0eXBlOiAndGltZW91dCcsIHRhcmdldDogc2NyaXB0IH0pLCAxMjAwMDApO1xuXHRzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG5cdHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG5cdG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xufTsiLCIvLyBzcmMvanMvbW9kdWxlcy9jb250YWN0LWZvcm0uanMgLSBDb250YWN0IGZvcm0gbW9kdWxlXHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4uL3N1cGFiYXNlLWNsaWVudC5qc1wiO1xyXG5cclxuLy8gQ29udGFjdCBmb3JtIGhhbmRsZXJcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNvbnRhY3RTdWJtaXQoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKTtcclxuICBjb25zdCBvcmlnaW5hbFRleHQgPSBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gIC8vIERpc2FibGUgYnV0dG9uIGFuZCBzaG93IGxvYWRpbmcgc3RhdGVcclxuICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRW52b2kgZW4gY291cnMuLi5cIjtcclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBmb3JtIGRhdGFcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCk7XHJcbiAgICBjb25zdCBjb250YWN0RGF0YSA9IHtcclxuICAgICAgbmFtZTogZm9ybURhdGEuZ2V0KFwibmFtZVwiKSxcclxuICAgICAgZW1haWw6IGZvcm1EYXRhLmdldChcImVtYWlsXCIpLFxyXG4gICAgICBzdWJqZWN0OiBmb3JtRGF0YS5nZXQoXCJzdWJqZWN0XCIpLFxyXG4gICAgICBtZXNzYWdlOiBmb3JtRGF0YS5nZXQoXCJtZXNzYWdlXCIpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB0aGF0IGFsbCBmaWVsZHMgaGF2ZSB2YWx1ZXNcclxuICAgIGlmIChcclxuICAgICAgIWNvbnRhY3REYXRhLm5hbWUgfHxcclxuICAgICAgIWNvbnRhY3REYXRhLmVtYWlsIHx8XHJcbiAgICAgICFjb250YWN0RGF0YS5zdWJqZWN0IHx8XHJcbiAgICAgICFjb250YWN0RGF0YS5tZXNzYWdlXHJcbiAgICApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG91cyBsZXMgY2hhbXBzIHNvbnQgcmVxdWlzXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENsZWFuIGFuZCB2YWxpZGF0ZSB0aGUgZGF0YVxyXG4gICAgY29uc3QgY2xlYW5Db250YWN0RGF0YSA9IHtcclxuICAgICAgbmFtZTogU3RyaW5nKGNvbnRhY3REYXRhLm5hbWUpLnRyaW0oKSxcclxuICAgICAgZW1haWw6IFN0cmluZyhjb250YWN0RGF0YS5lbWFpbCkudHJpbSgpLFxyXG4gICAgICBzdWJqZWN0OiBTdHJpbmcoY29udGFjdERhdGEuc3ViamVjdCkudHJpbSgpLFxyXG4gICAgICBtZXNzYWdlOiBTdHJpbmcoY29udGFjdERhdGEubWVzc2FnZSkudHJpbSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIlN1Ym1pdHRpbmcgY29udGFjdCBkYXRhOlwiLCBjbGVhbkNvbnRhY3REYXRhKTtcclxuXHJcbiAgICAvLyBJbnNlcnQgaW50byBTdXBhYmFzZSBkYXRhYmFzZVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJzdXBwb3J0X21lc3NhZ2VzXCIpXHJcbiAgICAgIC5pbnNlcnQoY2xlYW5Db250YWN0RGF0YSlcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIlN1cGFiYXNlIGVycm9yOlwiLCBlcnJvcik7XHJcblxyXG4gICAgICAvLyBQcm92aWRlIHVzZXItZnJpZW5kbHkgZXJyb3IgbWVzc2FnZSBiYXNlZCBvbiBlcnJvciBjb2RlXHJcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyNTAxXCIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICBcIkVycmV1ciBkZSBwZXJtaXNzaW9uLiBWZXVpbGxleiByw6llc3NheWVyIG91IG5vdXMgY29udGFjdGVyIGRpcmVjdGVtZW50LlwiXHJcbiAgICAgICAgKTtcclxuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSBcIlBHUlNUMzAxXCIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICBcIkVycmV1ciBkZSB2YWxpZGF0aW9uIGRlcyBkb25uw6llcy4gVsOpcmlmaWV6IHZvcyBpbmZvcm1hdGlvbnMuXCJcclxuICAgICAgICApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyZXVyIGxvcnMgZGUgbCdlbnJlZ2lzdHJlbWVudDogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgaW5zZXJ0ZWQgdG8gZGF0YWJhc2U6XCIsIGRhdGEpO1xyXG5cclxuICAgIC8vIFNlbmQgRGlzY29yZCBub3RpZmljYXRpb24gZGlyZWN0bHkgZnJvbSBjbGllbnRcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHNlbmREaXNjb3JkTm90aWZpY2F0aW9uKHtcclxuICAgICAgICAuLi5kYXRhLFxyXG4gICAgICAgIGNyZWF0ZWRfYXQ6IGRhdGEuY3JlYXRlZF9hdCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZGlzY29yZEVycm9yKSB7XHJcbiAgICAgIC8vIERvbid0IGZhaWwgdGhlIGVudGlyZSBzdWJtaXNzaW9uIGlmIERpc2NvcmQgZmFpbHNcclxuICAgICAgY29uc29sZS53YXJuKFwiRGlzY29yZCBub3RpZmljYXRpb24gZmFpbGVkOlwiLCBkaXNjb3JkRXJyb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN1Y2Nlc3MgZmVlZGJhY2tcclxuICAgIHNob3dOb3RpZmljYXRpb24oXHJcbiAgICAgIFwiTWVzc2FnZSBlbnZvecOpIGF2ZWMgc3VjY8OocyAhIE5vdXMgdm91cyByw6lwb25kcm9ucyBiaWVudMO0dC5cIixcclxuICAgICAgXCJzdWNjZXNzXCJcclxuICAgICk7XHJcbiAgICBldmVudC50YXJnZXQucmVzZXQoKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNlbmRpbmcgY29udGFjdCBtZXNzYWdlOlwiLCBlcnJvcik7XHJcblxyXG4gICAgLy8gU2hvdyBzcGVjaWZpYyBlcnJvciBtZXNzYWdlIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGdlbmVyaWMgbWVzc2FnZVxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID1cclxuICAgICAgZXJyb3IubWVzc2FnZSB8fCBcIkVycmV1ciBsb3JzIGRlIGwnZW52b2kgZHUgbWVzc2FnZS4gVmV1aWxsZXogcsOpZXNzYXllci5cIjtcclxuICAgIHNob3dOb3RpZmljYXRpb24oZXJyb3JNZXNzYWdlLCBcImVycm9yXCIpO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICAvLyBSZS1lbmFibGUgYnV0dG9uXHJcbiAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcclxuICB9XHJcbn1cclxuXHJcbi8vIFNlbmQgRGlzY29yZCBub3RpZmljYXRpb25cclxuYXN5bmMgZnVuY3Rpb24gc2VuZERpc2NvcmROb3RpZmljYXRpb24oY29udGFjdERhdGEpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgXCJodHRwczovL29mZXlzc2lwaWJrdG1iZmViaWJvLnN1cGFiYXNlLmNvL2Z1bmN0aW9ucy92MS9kaXNjb3JkLWNvbnRhY3Qtbm90aWZpY2F0aW9uXCIsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciBleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKcGMzTWlPaUp6ZFhCaFltRnpaU0lzSW5KbFppSTZJbTltWlhsemMybHdhV0pyZEcxaVptVmlhV0p2SWl3aWNtOXNaU0k2SW1GdWIyNGlMQ0pwWVhRaU9qRTNORE01TWpVd09UUXNJbVY0Y0NJNk1qQTFPVFV3TVRBNU5IMC53NzFDQUtmb2xrdHpSbC1UbUxWaEhZYUViaENmVms0QTdZcmFFVUNnbHJVYCwgLy8gYW5vbiBrZXlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIHJlY29yZDogY29udGFjdERhdGEsXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgRGlzY29yZCBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7XHJcbiAgICAgICAgICBlcnJvckRhdGEuZXJyb3IgfHwgXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICB9YFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIGNvbnNvbGUubG9nKFwiRGlzY29yZCBub3RpZmljYXRpb24gc2VudCBzdWNjZXNzZnVsbHk6XCIsIHJlc3VsdCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHNlbmQgRGlzY29yZCBub3RpZmljYXRpb246XCIsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLy8gU2ltcGxlIG5vdGlmaWNhdGlvbiBzeXN0ZW1cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dOb3RpZmljYXRpb24obWVzc2FnZSwgdHlwZSA9IFwiaW5mb1wiKSB7XHJcbiAgLy8gUmVtb3ZlIGV4aXN0aW5nIG5vdGlmaWNhdGlvbnNcclxuICBjb25zdCBleGlzdGluZ05vdGlmaWNhdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm5vdGlmaWNhdGlvblwiKTtcclxuICBleGlzdGluZ05vdGlmaWNhdGlvbnMuZm9yRWFjaCgobm90aWYpID0+IG5vdGlmLnJlbW92ZSgpKTtcclxuXHJcbiAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbiBlbGVtZW50XHJcbiAgY29uc3Qgbm90aWZpY2F0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICBub3RpZmljYXRpb24uY2xhc3NOYW1lID0gYG5vdGlmaWNhdGlvbiBub3RpZmljYXRpb24tJHt0eXBlfWA7XHJcbiAgbm90aWZpY2F0aW9uLnRleHRDb250ZW50ID0gbWVzc2FnZTtcclxuXHJcbiAgLy8gQWRkIHN0eWxlc1xyXG4gIE9iamVjdC5hc3NpZ24obm90aWZpY2F0aW9uLnN0eWxlLCB7XHJcbiAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxyXG4gICAgdG9wOiBcIjIwcHhcIixcclxuICAgIHJpZ2h0OiBcIjIwcHhcIixcclxuICAgIHBhZGRpbmc6IFwiMTVweCAyMHB4XCIsXHJcbiAgICBib3JkZXJSYWRpdXM6IFwiNXB4XCIsXHJcbiAgICBjb2xvcjogXCJ3aGl0ZVwiLFxyXG4gICAgZm9udFdlaWdodDogXCJib2xkXCIsXHJcbiAgICB6SW5kZXg6IFwiMTAwMDBcIixcclxuICAgIG1heFdpZHRoOiBcIjQwMHB4XCIsXHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I6XHJcbiAgICAgIHR5cGUgPT09IFwic3VjY2Vzc1wiID8gXCIjMTBiOTgxXCIgOiB0eXBlID09PSBcImVycm9yXCIgPyBcIiNlZjQ0NDRcIiA6IFwiIzNiODJmNlwiLFxyXG4gIH0pO1xyXG5cclxuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5vdGlmaWNhdGlvbik7XHJcblxyXG4gIC8vIEF1dG8gcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xyXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgaWYgKG5vdGlmaWNhdGlvbi5wYXJlbnROb2RlKSB7XHJcbiAgICAgIG5vdGlmaWNhdGlvbi5yZW1vdmUoKTtcclxuICAgIH1cclxuICB9LCA1MDAwKTtcclxuXHJcbiAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSBjb250YWN0IGZvcm1cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRDb250YWN0Rm9ybSgpIHtcclxuICBjb25zdCBjb250YWN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFjdC1mb3JtXCIpO1xyXG4gIGlmIChjb250YWN0Rm9ybSkge1xyXG4gICAgY29udGFjdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVDb250YWN0U3VibWl0KTtcclxuICAgIGNvbnNvbGUubG9nKFwiQ29udGFjdCBmb3JtIGluaXRpYWxpemVkXCIpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxzZTtcclxufVxyXG4iLCIvLyBzcmMvanMvZW50cmllcy9jb250YWN0LmpzIC0gQ29udGFjdCBwYWdlIGVudHJ5IHBvaW50XHJcbmltcG9ydCB7IGluaXRIZWFkZXJBdXRoIH0gZnJvbSBcIi4uL2F1dGgvaGVhZGVyLWF1dGguanNcIjtcclxuaW1wb3J0IHsgaW5pdENvbnRhY3RGb3JtIH0gZnJvbSBcIi4uL21vZHVsZXMvY29udGFjdC1mb3JtLmpzXCI7XHJcblxyXG4vLyBJbml0aWFsaXplIGhlYWRlciBhdXRoZW50aWNhdGlvbiBhbmQgY29udGFjdCBmb3JtIHdoZW4gRE9NIGlzIGxvYWRlZFxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEluaXRpYWxpemUgaGVhZGVyIGF1dGhlbnRpY2F0aW9uXHJcbiAgICBpbml0SGVhZGVyQXV0aCgpO1xyXG5cclxuICAgIC8vIEluaXRpYWxpemUgY29udGFjdCBmb3JtXHJcbiAgICBjb25zdCBjb250YWN0Rm9ybUluaXRpYWxpemVkID0gaW5pdENvbnRhY3RGb3JtKCk7XHJcblxyXG4gICAgaWYgKGNvbnRhY3RGb3JtSW5pdGlhbGl6ZWQpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJDb250YWN0IHBhZ2UgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiQ29udGFjdCBmb3JtIG5vdCBmb3VuZCBvbiB0aGlzIHBhZ2VcIik7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbml0aWFsaXppbmcgY29udGFjdCBwYWdlOlwiLCBlcnJvcik7XHJcbiAgfVxyXG59KTtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwianMvXCIgKyBjaHVua0lkICsgXCIuY2h1bmsuanNcIjtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5qID0gMzUzOyIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQzNTM6IDBcbn07XG5cbl9fd2VicGFja19yZXF1aXJlX18uZi5qID0gKGNodW5rSWQsIHByb21pc2VzKSA9PiB7XG5cdFx0Ly8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxuXHRcdHZhciBpbnN0YWxsZWRDaHVua0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSA/IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA6IHVuZGVmaW5lZDtcblx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIHsgLy8gMCBtZWFucyBcImFscmVhZHkgaW5zdGFsbGVkXCIuXG5cblx0XHRcdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYodHJ1ZSkgeyAvLyBhbGwgY2h1bmtzIGhhdmUgSlNcblx0XHRcdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiAoaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF0pKTtcblx0XHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSA9IHByb21pc2UpO1xuXG5cdFx0XHRcdFx0Ly8gc3RhcnQgY2h1bmsgbG9hZGluZ1xuXHRcdFx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuXHRcdFx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID0gJ0xvYWRpbmcgY2h1bmsgJyArIGNodW5rSWQgKyAnIGZhaWxlZC5cXG4oJyArIGVycm9yVHlwZSArICc6ICcgKyByZWFsU3JjICsgJyknO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm5hbWUgPSAnQ2h1bmtMb2FkRXJyb3InO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhWzFdKGVycm9yKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG59O1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZihjaHVua0lkcy5zb21lKChpZCkgPT4gKGluc3RhbGxlZENodW5rc1tpZF0gIT09IDApKSkge1xuXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdH1cblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLk8ocmVzdWx0KTtcbn1cblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3Nl0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDY1MjgpKSlcbl9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4iXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJsZWFmUHJvdG90eXBlcyIsImdldFByb3RvIiwiaW5Qcm9ncmVzcyIsImRhdGFXZWJwYWNrUHJlZml4IiwiYXN5bmMiLCJoYW5kbGVDb250YWN0U3VibWl0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ1dHRvbiIsInRhcmdldCIsInF1ZXJ5U2VsZWN0b3IiLCJvcmlnaW5hbFRleHQiLCJ0ZXh0Q29udGVudCIsImRpc2FibGVkIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImNvbnRhY3REYXRhIiwibmFtZSIsImdldCIsImVtYWlsIiwic3ViamVjdCIsIm1lc3NhZ2UiLCJFcnJvciIsImNsZWFuQ29udGFjdERhdGEiLCJTdHJpbmciLCJ0cmltIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJjb2RlIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZWNvcmQiLCJvayIsImVycm9yRGF0YSIsImpzb24iLCJzdGF0dXMiLCJyZXN1bHQiLCJzZW5kRGlzY29yZE5vdGlmaWNhdGlvbiIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJkaXNjb3JkRXJyb3IiLCJ3YXJuIiwic2hvd05vdGlmaWNhdGlvbiIsInJlc2V0IiwidHlwZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJub3RpZiIsInJlbW92ZSIsIm5vdGlmaWNhdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJPYmplY3QiLCJhc3NpZ24iLCJzdHlsZSIsInBvc2l0aW9uIiwidG9wIiwicmlnaHQiLCJwYWRkaW5nIiwiYm9yZGVyUmFkaXVzIiwiY29sb3IiLCJmb250V2VpZ2h0IiwiekluZGV4IiwibWF4V2lkdGgiLCJiYWNrZ3JvdW5kQ29sb3IiLCJhcHBlbmRDaGlsZCIsInNldFRpbWVvdXQiLCJwYXJlbnROb2RlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnRhY3RGb3JtIiwiaW5pdENvbnRhY3RGb3JtIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwibSIsIk8iLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImkiLCJsZW5ndGgiLCJmdWxmaWxsZWQiLCJqIiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiciIsImdldFByb3RvdHlwZU9mIiwib2JqIiwidCIsInZhbHVlIiwibW9kZSIsInRoaXMiLCJfX2VzTW9kdWxlIiwidGhlbiIsIm5zIiwiY3JlYXRlIiwiZGVmIiwiY3VycmVudCIsImluZGV4T2YiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZCIsImRlZmluaXRpb24iLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZiIsImUiLCJjaHVua0lkIiwiUHJvbWlzZSIsImFsbCIsInJlZHVjZSIsInByb21pc2VzIiwidSIsImciLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJ3aW5kb3ciLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJsIiwidXJsIiwiZG9uZSIsInB1c2giLCJzY3JpcHQiLCJuZWVkQXR0YWNoIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicyIsImdldEF0dHJpYnV0ZSIsImNoYXJzZXQiLCJ0aW1lb3V0IiwibmMiLCJzZXRBdHRyaWJ1dGUiLCJzcmMiLCJvblNjcmlwdENvbXBsZXRlIiwicHJldiIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicmVtb3ZlQ2hpbGQiLCJiaW5kIiwiaGVhZCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwicCIsImluc3RhbGxlZENodW5rcyIsImluc3RhbGxlZENodW5rRGF0YSIsInByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZXJyb3JUeXBlIiwicmVhbFNyYyIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImlkIiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwic2VsZiIsIl9fd2VicGFja19leHBvcnRzX18iXSwic291cmNlUm9vdCI6IiJ9