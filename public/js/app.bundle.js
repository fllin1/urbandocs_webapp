(()=>{"use strict";var e,t,n,r,o,i={1900:(e,t,n)=>{var r=n(9660),o=n(1235),i=n(141),s=n(6354);async function c(){const e=s.Aw.get("citySelect"),t=s.Aw.get("citySpinner");if(e){(0,s.Oh)(t,!0),o.n.setLoading(!0);try{const t=await i.K.loadCities();if((0,s.fM)(e,t,"Sélectionnez une ville","Aucune ville disponible","city"))(0,s.wc)("Nouvelles villes disponibles ! Retrouvez les synthèses de Lille et Bordeaux","success"),o.n.setCities(t);else{const e=null===o.n.getState("user")?"Veuillez vous connecter pour accéder aux données.":"Aucune ville trouvée.";(0,s.wc)(e,"warning")}}catch(t){console.error("Erreur lors du chargement des villes:",t),(0,s.wc)("Erreur de chargement des villes","error"),(0,s.kD)(e,"Erreur chargement")}finally{(0,s.Oh)(t,!1),o.n.setLoading(!1)}}}function a(){return o.n.getState("selectedDocument")}n(3715);var l=n(9251),u=n(2387);let d=null;r.N.auth.onAuthStateChange(((e,t)=>{!function(e){if(d=e,o.n.setUser(e),e){const e=a();e&&e.id?(s.X2&&(s.X2.disabled=!1),(0,s.wc)(`Document trouvé (Source: ${(0,s.rf)(e.source_plu_date)||"Non spécifiée"}). Prêt à consulter.`,"success")):s.X2&&(s.X2.disabled=!0)}else s.X2&&(s.X2.disabled=!0)}(t?.user||null),"SIGNED_OUT"===e?(console.log("App: User signed out"),o.n.resetSelections()):"SIGNED_IN"===e?(console.log("App: User signed in"),s.ss&&s.wZ&&s.zA&&c()):"INITIAL_SESSION"===e?console.log("App: Initial session loaded"):"TOKEN_REFRESHED"===e&&console.log("App: Token refreshed")})),s.ss.addEventListener("change",(e=>{!async function(e){const t=s.Aw.get("zoningSelect"),n=s.Aw.get("zoneSelect"),r=s.Aw.get("zoningSpinner"),c=s.Aw.get("synthesisBtn");if((0,s.kD)(t,"Sélectionnez d'abord une ville"),(0,s.kD)(n,"Sélectionnez d'abord un zonage"),c&&(c.disabled=!0),o.n.clearSelectedDocument(),e){(0,s.Oh)(r,!0),o.n.setLoading(!0);try{const n=await i.K.loadZonings(e);(0,s.fM)(t,n,"Sélectionnez un zonage","Aucun zonage disponible","zoning")?((0,s.wc)(`${n.length} zonages chargés`,"success"),o.n.setZonings(n)):(0,s.wc)("Aucun zonage trouvé pour cette ville.","warning")}catch(e){console.error("Erreur lors du chargement des zonages:",e),(0,s.wc)("Erreur de chargement des zonages","error"),(0,s.kD)(t,"Erreur chargement")}finally{(0,s.Oh)(r,!1),o.n.setLoading(!1)}}else(0,s.wc)("Veuillez sélectionner une ville.","info")}(e.target.value)})),s.wZ.addEventListener("change",(e=>{!async function(e){const t=s.Aw.get("zoneSelect"),n=s.Aw.get("zoneSpinner"),r=s.Aw.get("synthesisBtn");if((0,s.kD)(t,"Sélectionnez d'abord un zonage"),r&&(r.disabled=!0),o.n.clearSelectedDocument(),e){(0,s.Oh)(n,!0),o.n.setLoading(!0);try{const n=await i.K.loadZones(e);(0,s.fM)(t,n,"Sélectionnez une zone","Aucune zone disponible","zone")?((0,s.wc)(`${n.length} zones chargées`,"success"),o.n.setZones(n)):(0,s.wc)("Aucune zone trouvée pour ce zonage.","warning")}catch(e){console.error("Erreur lors du chargement des zones:",e),(0,s.wc)("Erreur de chargement des zones","error"),(0,s.kD)(t,"Erreur chargement")}finally{(0,s.Oh)(n,!1),o.n.setLoading(!1)}}else(0,s.wc)("Veuillez sélectionner un zonage.","info")}(e.target.value)})),s.zA.addEventListener("change",(e=>{const t=e.target.value,n=s.wZ.value;t&&n?async function(e,t,n=null){const r=s.Aw.get("synthesisBtn"),c=s.Aw.get("documentSpinner");if(r&&(r.disabled=!0),o.n.clearSelectedDocument(),!o.n.getState("user"))return(0,s.wc)("Veuillez vous connecter pour accéder aux documents.","warning"),null;if(!e||!t)return(0,s.wc)("Sélection incomplète pour rechercher le document.","info"),null;(0,s.Oh)(c,!0),o.n.setLoading(!0);try{const c=await i.K.findDocument(e,t,n);return c?(o.n.setSelectedDocument(c),r&&(r.disabled=!1),(0,s.wc)("Document trouvé !","success"),c):((0,s.wc)("Aucun document trouvé pour cette sélection.","warning"),null)}catch(e){return console.error("Erreur lors de la recherche du document:",e),(0,s.wc)("Erreur lors de la recherche du document","error"),null}finally{(0,s.Oh)(c,!1),o.n.setLoading(!1)}}(n,t,"7c0f2830-f3fc-4c69-911c-470286f91982"):(0,s.wc)("Veuillez d'abord sélectionner un zoning.","warning")})),s.X2.addEventListener("click",(function(){if(!(0,l.HW)())return(0,s.wc)("Authentification requise pour télécharger.","warning"),void(s.X2.disabled=!0);const e=a();e&&e.id?((0,s.wc)("Ouverture du document...","info"),window.open(`/plu-summary?id=${e.id}`,"_blank"),setTimeout((()=>{s.X2.disabled||(0,s.wc)(`Document trouvé (Source: ${(0,s.rf)(e.source_plu_date)||"Non spécifiée"}). Prêt à consulter.`,"success")}),1500)):((0,s.wc)("Lien du document non disponible.","warning"),s.X2.disabled=!0)})),document.addEventListener("DOMContentLoaded",(async()=>{try{if(!await(0,u.Kv)(!1))return;(0,l.Mt)(),(0,s.kD)(s.ss,"Chargement..."),(0,s.kD)(s.wZ,"Sélectionnez d'abord une ville"),(0,s.kD)(s.zA,"Sélectionnez d'abord un zonage"),s.X2&&(s.X2.disabled=!0),s.ss&&s.wZ&&s.zA&&((0,s.wc)("Initialisation...","info"),await c())}catch(e){console.error("Error initializing app:",e)}}))},6354:(e,t,n)=>{n.d(t,{Aw:()=>s,Oh:()=>a,X2:()=>f,fM:()=>d,kD:()=>l,rf:()=>u,ss:()=>g,wZ:()=>p,wc:()=>c,zA:()=>h});var r=n(4587);const o={showToast:(e,t)=>console.log(`Toast: ${e} (${t})`)},i={setUIState:()=>{},setLoading:()=>{}},s=new class{constructor(){this.elements=new Map,this.initializeElements()}initializeElements(){this.register("citySelect","citySelect"),this.register("zoningSelect","zoningSelect"),this.register("zoneSelect","zoneSelect"),this.register("typologieSelect","typologieSelect"),this.register("synthesisBtn","synthesisBtn"),this.register("statusMessage","statusMessage"),this.register("citySpinner","citySpinner"),this.register("zoningSpinner","zoningSpinner"),this.register("zoneSpinner","zoneSpinner"),this.register("typologieSpinner","typologieSpinner"),this.register("documentSpinner","documentSpinner"),this.register("userStatus","userStatus"),this.register("logoutBtn","logoutBtn"),this.register("loginLink","loginLink"),this.register("signupLink","signupLink")}register(e,t){const n=document.getElementById(t);n&&this.elements.set(e,n)}get(e){return this.elements.get(e)||null}exists(e){return this.elements.has(e)&&null!==this.elements.get(e)}};function c(e,t="info"){const n=s.get("statusMessage");if(n&&(n.textContent=e,n.className=`status-message alert alert-${t}`,n.classList.remove("d-none")),"error"===t||"warning"===t)try{o.showToast(e,t,8e3)}catch(e){console.warn("Toast not available:",e)}try{i.setUIState(t,e)}catch(e){console.warn("State manager not available:",e)}}function a(e,t){const n="string"==typeof e?s.get(e):e;n&&(n.classList.toggle("d-none",!t),n.classList.toggle("hidden",!t));try{i.setLoading(t)}catch(e){console.warn("State manager not available:",e)}}function l(e,t){const n="string"==typeof e?s.get(e):e;n&&(n.innerHTML=`<option value="">${t||"Sélectionnez une option"}</option>`,n.disabled=!0,n.classList.remove("error"))}function u(e){return e?e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())).trim():""}function d(e,t,n,o,i){const c="string"==typeof e?s.get(e):e;if(!c)return console.warn(`Select element not found: ${e}`),!1;if(l(c,n),!t||0===t.length)return c.innerHTML=`<option value="">${o}</option>`,c.disabled=!0,!1;const a=document.createDocumentFragment(),d=document.createElement("option");return d.value="",d.textContent=n,d.disabled=!0,d.selected=!0,a.appendChild(d),t.forEach((e=>{const t=document.createElement("option");t.value=e.id;let n="";n="zone"===i&&r.P.hasOwnProperty(e.name)?r.P[e.name]:u(e.name),t.textContent=n,t.setAttribute("data-raw-name",e.name),a.appendChild(t)})),c.innerHTML="",c.appendChild(a),c.disabled=!1,c.classList.add("fade-in"),!0}const g=s.get("citySelect"),p=s.get("zoningSelect"),h=s.get("zoneSelect"),f=(s.get("typologieSelect"),s.get("synthesisBtn"));s.get("statusMessage"),s.get("citySpinner"),s.get("zoningSpinner"),s.get("zoneSpinner"),s.get("typologieSpinner"),s.get("documentSpinner"),s.get("userStatus"),s.get("logoutBtn"),s.get("loginLink"),s.get("signupLink")}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return i[e].call(n.exports,n,n.exports,c),n.exports}c.m=i,e=[],c.O=(t,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,r,o]=e[u],s=!0,a=0;a<n.length;a++)(!1&o||i>=o)&&Object.keys(c.O).every((e=>c.O[e](n[a])))?n.splice(a--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);c.r(o);var i={};t=t||[null,n({}),n([]),n(n)];for(var s=2&r&&e;"object"==typeof s&&!~t.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,c.d(o,i),o},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,n)=>(c.f[n](e,t),t)),[])),c.u=e=>"js/"+e+".chunk.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="urbandocs_webapp:",c.l=(e,t,n,i)=>{if(r[e])r[e].push(t);else{var s,a;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==o+n){s=d;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.setAttribute("data-webpack",o+n),s.src=e),r[e]=[t];var g=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var o=r[e];if(delete r[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(n))),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=g.bind(null,s.onerror),s.onload=g.bind(null,s.onload),a&&document.head.appendChild(s)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.j=524,c.p="/",(()=>{var e={209:0,524:0};c.f.j=(t,n)=>{var r=c.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=c.p+c.u(t),s=new Error;c.l(i,(n=>{if(c.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,r[1](s)}}),"chunk-"+t,t)}},c.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,s,a]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in s)c.o(s,r)&&(c.m[r]=s[r]);if(a)var u=a(c)}for(t&&t(n);l<i.length;l++)o=i[l],c.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return c.O(u)},n=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=c.O(void 0,[76,671],(()=>c(1900)));a=c.O(a)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianMvYXBwLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoidUJBQUlBLEVDQ0FDLEVBREFDLEVDQUFDLEVBQ0FDLEUsNkRDNEJKQyxlQUFlQyxJQUNiLE1BQU1DLEVBQWEsS0FBWUMsSUFBSSxjQUM3QkMsRUFBYyxLQUFZRCxJQUFJLGVBRXBDLEdBQUtELEVBQUwsRUFFQSxRQUFjRSxHQUFhLEdBQzNCLElBQWFDLFlBQVcsR0FFeEIsSUFDRSxNQUFNQyxRQUFlLElBQVdMLGFBVWhDLElBUmdCLFFBQ2RDLEVBQ0FJLEVBQ0EseUJBQ0EsMEJBQ0EsU0FJQSxRQUNFLDhFQUNBLFdBRUYsSUFBYUMsVUFBVUQsT0FDbEIsQ0FDTCxNQUNNRSxFQUNZLE9BRkUsSUFBYUMsU0FBUyxRQUdwQyxvREFDQSx5QkFDTixRQUFXRCxFQUFTLFVBQ3RCLENBQ0YsQ0FBRSxNQUFPRSxHQUNQQyxRQUFRRCxNQUFNLHdDQUF5Q0EsSUFDdkQsUUFBVyxrQ0FBbUMsVUFDOUMsUUFBWVIsRUFBWSxvQkFDMUIsQ0FBRSxTQUNBLFFBQWNFLEdBQWEsR0FDM0IsSUFBYUMsWUFBVyxFQUMxQixDQXJDdUIsQ0FzQ3pCLENBNkpBLFNBQVNPLElBQ1AsT0FBTyxJQUFhSCxTQUFTLG1CQUMvQixDLGdDQzlLQSxJQUFJSSxFQUFjLEtBNEJsQixJQUFTQyxLQUFLQyxtQkFBa0IsQ0FBQ0MsRUFBT0MsTUF6QnhDLFNBQThCQyxHQUk1QixHQUhBTCxFQUFjSyxFQUNkLElBQWFDLFFBQVFELEdBRWpCQSxFQUFNLENBRVIsTUFBTUUsRUFBbUJSLElBQ3JCUSxHQUFvQkEsRUFBaUJDLElBQ25DLE9BQWMsS0FBYUMsVUFBVyxJQUMxQyxRQUNFLDZCQUNFLFFBQWNGLEVBQWlCRyxrQkFBb0Isc0NBRXJELFlBR0UsT0FBYyxLQUFhRCxVQUFXLEVBRTlDLE1BRU0sT0FBYyxLQUFhQSxVQUFXLEVBRTlDLENBT0VFLENBSGFQLEdBQVNDLE1BQVEsTUFLaEIsZUFBVkYsR0FDRkwsUUFBUWMsSUFBSSx3QkFDWixJQUFhQyxtQkFDTSxjQUFWVixHQUNUTCxRQUFRYyxJQUFJLHVCQUVSLE1BQWMsTUFBZ0IsTUFDaEN4QixLQUVpQixvQkFBVmUsRUFDVEwsUUFBUWMsSUFBSSwrQkFDTyxvQkFBVlQsR0FDVEwsUUFBUWMsSUFBSSwyQkFvQ2hCLEtBQVdFLGlCQUFpQixVQUFXWCxLRDlEdkNoQixlQUEyQjRCLEdBQ3pCLE1BQU1DLEVBQWUsS0FBWTFCLElBQUksZ0JBQy9CMkIsRUFBYSxLQUFZM0IsSUFBSSxjQUM3QjRCLEVBQWdCLEtBQVk1QixJQUFJLGlCQUNoQzZCLEVBQWUsS0FBWTdCLElBQUksZ0JBU3JDLElBTkEsUUFBWTBCLEVBQWMsbUNBQzFCLFFBQVlDLEVBQVksa0NBQ3BCRSxJQUFjQSxFQUFhVixVQUFXLEdBRTFDLElBQWFXLHdCQUVSTCxFQUFMLEVBS0EsUUFBY0csR0FBZSxHQUM3QixJQUFhMUIsWUFBVyxHQUV4QixJQUNFLE1BQU02QixRQUFnQixJQUFXQyxZQUFZUCxJQUU3QixRQUNkQyxFQUNBSyxFQUNBLHlCQUNBLDBCQUNBLFlBSUEsUUFBVyxHQUFHQSxFQUFRRSx5QkFBMEIsV0FDaEQsSUFBYUMsV0FBV0gsS0FFeEIsUUFBVyx3Q0FBeUMsVUFFeEQsQ0FBRSxNQUFPeEIsR0FDUEMsUUFBUUQsTUFBTSx5Q0FBMENBLElBQ3hELFFBQVcsbUNBQW9DLFVBQy9DLFFBQVltQixFQUFjLG9CQUM1QixDQUFFLFNBQ0EsUUFBY0UsR0FBZSxHQUM3QixJQUFhMUIsWUFBVyxFQUMxQixDQTdCQSxNQUZFLFFBQVcsbUNBQW9DLE9BZ0NuRCxDQ2tCRThCLENBRGVuQixFQUFNc0IsT0FBT0MsVUFJOUIsS0FBYVosaUJBQWlCLFVBQVdYLEtEaEJ6Q2hCLGVBQXlCd0MsR0FDdkIsTUFBTVYsRUFBYSxLQUFZM0IsSUFBSSxjQUM3QnNDLEVBQWMsS0FBWXRDLElBQUksZUFDOUI2QixFQUFlLEtBQVk3QixJQUFJLGdCQU9yQyxJQUxBLFFBQVkyQixFQUFZLGtDQUNwQkUsSUFBY0EsRUFBYVYsVUFBVyxHQUUxQyxJQUFhVyx3QkFFUk8sRUFBTCxFQUtBLFFBQWNDLEdBQWEsR0FDM0IsSUFBYXBDLFlBQVcsR0FFeEIsSUFDRSxNQUFNcUMsUUFBYyxJQUFXQyxVQUFVSCxJQUV6QixRQUNkVixFQUNBWSxFQUNBLHdCQUNBLHlCQUNBLFVBSUEsUUFBVyxHQUFHQSxFQUFNTix3QkFBeUIsV0FDN0MsSUFBYVEsU0FBU0YsS0FFdEIsUUFBVyxzQ0FBdUMsVUFFdEQsQ0FBRSxNQUFPaEMsR0FDUEMsUUFBUUQsTUFBTSx1Q0FBd0NBLElBQ3RELFFBQVcsaUNBQWtDLFVBQzdDLFFBQVlvQixFQUFZLG9CQUMxQixDQUFFLFNBQ0EsUUFBY1csR0FBYSxHQUMzQixJQUFhcEMsWUFBVyxFQUMxQixDQTdCQSxNQUZFLFFBQVcsbUNBQW9DLE9BZ0NuRCxDQ3pCRXNDLENBRGlCM0IsRUFBTXNCLE9BQU9DLFVBSWhDLEtBQVdaLGlCQUFpQixVQUFXWCxJQUNyQyxNQUFNNkIsRUFBUzdCLEVBQU1zQixPQUFPQyxNQUN0QkMsRUFBVyxLQUFhRCxNQUUxQk0sR0FBVUwsRUR1QmhCeEMsZUFBNEJ3QyxFQUFVSyxFQUFRQyxFQUFjLE1BQzFELE1BQU1kLEVBQWUsS0FBWTdCLElBQUksZ0JBQy9CNEMsRUFBa0IsS0FBWTVDLElBQUksbUJBTXhDLEdBSkk2QixJQUFjQSxFQUFhVixVQUFXLEdBQzFDLElBQWFXLHlCQUVPLElBQWF4QixTQUFTLFFBTXhDLE9BSkEsUUFDRSxzREFDQSxXQUVLLEtBR1QsSUFBSytCLElBQWFLLEVBRWhCLE9BREEsUUFBVyxvREFBcUQsUUFDekQsTUFHVCxRQUFjRSxHQUFpQixHQUMvQixJQUFhMUMsWUFBVyxHQUV4QixJQUNFLE1BQU0yQyxRQUFpQixJQUFXQyxhQUNoQ1QsRUFDQUssRUFDQUMsR0FHRixPQUFJRSxHQUNGLElBQWFFLG9CQUFvQkYsR0FDN0JoQixJQUFjQSxFQUFhVixVQUFXLElBQzFDLFFBQVcsb0JBQXFCLFdBQ3pCMEIsS0FFUCxRQUFXLDhDQUErQyxXQUNuRCxLQUVYLENBQUUsTUFBT3RDLEdBR1AsT0FGQUMsUUFBUUQsTUFBTSwyQ0FBNENBLElBQzFELFFBQVcsMENBQTJDLFNBQy9DLElBQ1QsQ0FBRSxTQUNBLFFBQWNxQyxHQUFpQixHQUMvQixJQUFhMUMsWUFBVyxFQUMxQixDQUNGLENDdEVJNEMsQ0FBYVQsRUFBVUssRUFBUSx5Q0FFL0IsUUFBVywyQ0FBNEMsY0F1QjNELEtBQWFsQixpQkFBaUIsU0F2RTlCLFdBRUUsS0FEYSxVQUlYLE9BRkEsUUFBVyw2Q0FBOEMsZ0JBQ3pELEtBQWFMLFVBQVcsR0FJMUIsTUFBTUYsRUFBbUJSLElBQ3JCUSxHQUFvQkEsRUFBaUJDLEtBQ3ZDLFFBQVcsMkJBQTRCLFFBQ3ZDOEIsT0FBT0MsS0FBSyxtQkFBbUJoQyxFQUFpQkMsS0FBTSxVQUV0RGdDLFlBQVcsS0FFSixLQUFhL0IsV0FDaEIsUUFDRSw2QkFDRSxRQUFjRixFQUFpQkcsa0JBQW9CLHNDQUVyRCxhQUdILFNBRUgsUUFBVyxtQ0FBb0MsV0FDL0MsS0FBYUQsVUFBVyxFQUU1QixJQThDQTBCLFNBQVNyQixpQkFBaUIsb0JBQW9CM0IsVUFDNUMsSUFHRSxVQUR3QixTQUFrQixHQUV4QyxRQUlGLFdBR0EsUUFBWSxLQUFZLGtCQUN4QixRQUFZLEtBQWMsbUNBQzFCLFFBQVksS0FBWSxrQ0FFcEIsT0FBYyxLQUFhc0IsVUFBVyxHQUd0QyxNQUFjLE1BQWdCLFFBQ2hDLFFBQVcsb0JBQXFCLGNBQzFCckIsSUFFVixDQUFFLE1BQU9TLEdBQ1BDLFFBQVFELE1BQU0sMEJBQTJCQSxFQUMzQyxJLGtJQzlMRixNQUFNNEMsRUFBZSxDQUNuQkMsVUFBVyxDQUFDL0MsRUFBU2dELElBQVM3QyxRQUFRYyxJQUFJLFVBQVVqQixNQUFZZ0QsT0FHNURDLEVBQWUsQ0FDbkJDLFdBQVksT0FDWnJELFdBQVksUUFrRFJzRCxFQUFjLElBOUNwQixNQUNFLFdBQUFDLEdBQ0VDLEtBQUtDLFNBQVcsSUFBSUMsSUFDcEJGLEtBQUtHLG9CQUNQLENBRUEsa0JBQUFBLEdBRUVILEtBQUtJLFNBQVMsYUFBYyxjQUM1QkosS0FBS0ksU0FBUyxlQUFnQixnQkFDOUJKLEtBQUtJLFNBQVMsYUFBYyxjQUM1QkosS0FBS0ksU0FBUyxrQkFBbUIsbUJBQ2pDSixLQUFLSSxTQUFTLGVBQWdCLGdCQUM5QkosS0FBS0ksU0FBUyxnQkFBaUIsaUJBRy9CSixLQUFLSSxTQUFTLGNBQWUsZUFDN0JKLEtBQUtJLFNBQVMsZ0JBQWlCLGlCQUMvQkosS0FBS0ksU0FBUyxjQUFlLGVBQzdCSixLQUFLSSxTQUFTLG1CQUFvQixvQkFDbENKLEtBQUtJLFNBQVMsa0JBQW1CLG1CQUdqQ0osS0FBS0ksU0FBUyxhQUFjLGNBQzVCSixLQUFLSSxTQUFTLFlBQWEsYUFDM0JKLEtBQUtJLFNBQVMsWUFBYSxhQUMzQkosS0FBS0ksU0FBUyxhQUFjLGFBQzlCLENBRUEsUUFBQUEsQ0FBU0MsRUFBTTdDLEdBQ2IsTUFBTThDLEVBQVVuQixTQUFTb0IsZUFBZS9DLEdBQ3BDOEMsR0FDRk4sS0FBS0MsU0FBU08sSUFBSUgsRUFBTUMsRUFFNUIsQ0FFQSxHQUFBaEUsQ0FBSStELEdBQ0YsT0FBT0wsS0FBS0MsU0FBUzNELElBQUkrRCxJQUFTLElBQ3BDLENBRUEsTUFBQUksQ0FBT0osR0FDTCxPQUFPTCxLQUFLQyxTQUFTUyxJQUFJTCxJQUFxQyxPQUE1QkwsS0FBS0MsU0FBUzNELElBQUkrRCxFQUN0RCxHQVdGLFNBQVNNLEVBQVdoRSxFQUFTZ0QsRUFBTyxRQUNsQyxNQUFNaUIsRUFBZ0JkLEVBQVl4RCxJQUFJLGlCQVV0QyxHQVJJc0UsSUFFRkEsRUFBY0MsWUFBY2xFLEVBQzVCaUUsRUFBY0UsVUFBWSw4QkFBOEJuQixJQUN4RGlCLEVBQWNHLFVBQVVDLE9BQU8sV0FJcEIsVUFBVHJCLEdBQTZCLFlBQVRBLEVBQ3RCLElBQ0VGLEVBQWFDLFVBQVUvQyxFQUFTZ0QsRUFBTSxJQUN4QyxDQUFFLE1BQU85QyxHQUNQQyxRQUFRbUUsS0FBSyx1QkFBd0JwRSxFQUN2QyxDQUlGLElBQ0UrQyxFQUFhQyxXQUFXRixFQUFNaEQsRUFDaEMsQ0FBRSxNQUFPRSxHQUNQQyxRQUFRbUUsS0FBSywrQkFBZ0NwRSxFQUMvQyxDQUNGLENBS0EsU0FBU3FFLEVBQWNDLEVBQWFDLEdBQ2xDLE1BQU1DLEVBQ21CLGlCQUFoQkYsRUFDSHJCLEVBQVl4RCxJQUFJNkUsR0FDaEJBLEVBRUZFLElBQ0ZBLEVBQWVOLFVBQVVPLE9BQU8sVUFBV0YsR0FDM0NDLEVBQWVOLFVBQVVPLE9BQU8sVUFBV0YsSUFJN0MsSUFDRXhCLEVBQWFwRCxXQUFXNEUsRUFDMUIsQ0FBRSxNQUFPdkUsR0FDUEMsUUFBUW1FLEtBQUssK0JBQWdDcEUsRUFDL0MsQ0FDRixDQUtBLFNBQVMwRSxFQUFZQyxFQUFlQyxHQUNsQyxNQUFNbkIsRUFDcUIsaUJBQWxCa0IsRUFDSDFCLEVBQVl4RCxJQUFJa0YsR0FDaEJBLEVBRUZsQixJQUNGQSxFQUFRb0IsVUFBWSxvQkFDbEJELEdBQWUscUNBRWpCbkIsRUFBUTdDLFVBQVcsRUFDbkI2QyxFQUFRUyxVQUFVQyxPQUFPLFNBRTdCLENBS0EsU0FBU1csRUFBY3RCLEdBQ3JCLE9BQUtBLEVBRUVBLEVBQ0p1QixRQUFRLEtBQU0sS0FDZEEsUUFBUSxTQUFVQyxHQUFTQSxFQUFLQyxnQkFDaENDLE9BTGUsRUFNcEIsQ0FLQSxTQUFTQyxFQUNQUixFQUNBUyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBLE1BQU05QixFQUNxQixpQkFBbEJrQixFQUNIMUIsRUFBWXhELElBQUlrRixHQUNoQkEsRUFFTixJQUFLbEIsRUFFSCxPQURBeEQsUUFBUW1FLEtBQUssNkJBQTZCTyxNQUNuQyxFQU1ULEdBRkFELEVBQVlqQixFQUFTNEIsSUFFaEJELEdBQXdCLElBQWhCQSxFQUFLMUQsT0FHaEIsT0FGQStCLEVBQVFvQixVQUFZLG9CQUFvQlMsYUFDeEM3QixFQUFRN0MsVUFBVyxHQUNaLEVBSVQsTUFBTTRFLEVBQVdsRCxTQUFTbUQseUJBR3BCQyxFQUFnQnBELFNBQVNxRCxjQUFjLFVBaUM3QyxPQWhDQUQsRUFBYzdELE1BQVEsR0FDdEI2RCxFQUFjMUIsWUFBY3FCLEVBQzVCSyxFQUFjOUUsVUFBVyxFQUN6QjhFLEVBQWNFLFVBQVcsRUFDekJKLEVBQVNLLFlBQVlILEdBR3JCTixFQUFLVSxTQUFTQyxJQUNaLE1BQU1DLEVBQVMxRCxTQUFTcUQsY0FBYyxVQUN0Q0ssRUFBT25FLE1BQVFrRSxFQUFLcEYsR0FHcEIsSUFBSXNGLEVBQWMsR0FFaEJBLEVBRGUsU0FBYlYsR0FBdUIsSUFBaUJXLGVBQWVILEVBQUt2QyxNQUNoRCxJQUFpQnVDLEVBQUt2QyxNQUV0QnNCLEVBQWNpQixFQUFLdkMsTUFHbkN3QyxFQUFPaEMsWUFBY2lDLEVBQ3JCRCxFQUFPRyxhQUFhLGdCQUFpQkosRUFBS3ZDLE1BQzFDZ0MsRUFBU0ssWUFBWUcsTUFJdkJ2QyxFQUFRb0IsVUFBWSxHQUNwQnBCLEVBQVFvQyxZQUFZTCxHQUNwQi9CLEVBQVE3QyxVQUFXLEVBR25CNkMsRUFBUVMsVUFBVWtDLElBQUksWUFFZixDQUNULENBZ0VBLE1BQU01RyxFQUFheUQsRUFBWXhELElBQUksY0FDN0IwQixFQUFlOEIsRUFBWXhELElBQUksZ0JBQy9CMkIsRUFBYTZCLEVBQVl4RCxJQUFJLGNBRTdCNkIsR0FEa0IyQixFQUFZeEQsSUFBSSxtQkFDbkJ3RCxFQUFZeEQsSUFBSSxpQkFDZndELEVBQVl4RCxJQUFJLGlCQUVsQndELEVBQVl4RCxJQUFJLGVBQ2R3RCxFQUFZeEQsSUFBSSxpQkFDbEJ3RCxFQUFZeEQsSUFBSSxlQUNYd0QsRUFBWXhELElBQUksb0JBQ2pCd0QsRUFBWXhELElBQUksbUJBRXJCd0QsRUFBWXhELElBQUksY0FDakJ3RCxFQUFZeEQsSUFBSSxhQUNoQndELEVBQVl4RCxJQUFJLGFBQ2Z3RCxFQUFZeEQsSUFBSSxhLEdDaFQvQjRHLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQkUsSUFBakJELEVBQ0gsT0FBT0EsRUFBYUUsUUFHckIsSUFBSUMsRUFBU04sRUFBeUJFLEdBQVksQ0FHakRHLFFBQVMsQ0FBQyxHQU9YLE9BSEFFLEVBQW9CTCxHQUFVTSxLQUFLRixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTSixHQUdwRUssRUFBT0QsT0FDZixDQUdBSixFQUFvQlEsRUFBSUYsRU56QnBCM0gsRUFBVyxHQUNmcUgsRUFBb0JTLEVBQUksQ0FBQ0MsRUFBUUMsRUFBVUMsRUFBSUMsS0FDOUMsSUFBR0YsRUFBSCxDQU1BLElBQUlHLEVBQWVDLElBQ25CLElBQVNDLEVBQUksRUFBR0EsRUFBSXJJLEVBQVN5QyxPQUFRNEYsSUFBSyxDQUd6QyxJQUZBLElBQUtMLEVBQVVDLEVBQUlDLEdBQVlsSSxFQUFTcUksR0FDcENDLEdBQVksRUFDUEMsRUFBSSxFQUFHQSxFQUFJUCxFQUFTdkYsT0FBUThGLE1BQ3BCLEVBQVhMLEdBQXNCQyxHQUFnQkQsSUFBYU0sT0FBT0MsS0FBS3BCLEVBQW9CUyxHQUFHWSxPQUFPQyxHQUFTdEIsRUFBb0JTLEVBQUVhLEdBQUtYLEVBQVNPLE1BQzlJUCxFQUFTWSxPQUFPTCxJQUFLLElBRXJCRCxHQUFZLEVBQ1RKLEVBQVdDLElBQWNBLEVBQWVELElBRzdDLEdBQUdJLEVBQVcsQ0FDYnRJLEVBQVM0SSxPQUFPUCxJQUFLLEdBQ3JCLElBQUlRLEVBQUlaLFNBQ0VULElBQU5xQixJQUFpQmQsRUFBU2MsRUFDL0IsQ0FDRCxDQUNBLE9BQU9kLENBbkJQLENBSkNHLEVBQVdBLEdBQVksRUFDdkIsSUFBSSxJQUFJRyxFQUFJckksRUFBU3lDLE9BQVE0RixFQUFJLEdBQUtySSxFQUFTcUksRUFBSSxHQUFHLEdBQUtILEVBQVVHLElBQUtySSxFQUFTcUksR0FBS3JJLEVBQVNxSSxFQUFJLEdBQ3JHckksRUFBU3FJLEdBQUssQ0FBQ0wsRUFBVUMsRUFBSUMsSUNMM0JoSSxFQUFXc0ksT0FBT00sZUFBa0JDLEdBQVNQLE9BQU9NLGVBQWVDLEdBQVNBLEdBQVNBLEVBQWEsVUFRdEcxQixFQUFvQjJCLEVBQUksU0FBU3BHLEVBQU9xRyxHQUV2QyxHQURVLEVBQVBBLElBQVVyRyxFQUFRc0IsS0FBS3RCLElBQ2hCLEVBQVBxRyxFQUFVLE9BQU9yRyxFQUNwQixHQUFvQixpQkFBVkEsR0FBc0JBLEVBQU8sQ0FDdEMsR0FBVyxFQUFQcUcsR0FBYXJHLEVBQU1zRyxXQUFZLE9BQU90RyxFQUMxQyxHQUFXLEdBQVBxRyxHQUFvQyxtQkFBZnJHLEVBQU11RyxLQUFxQixPQUFPdkcsQ0FDNUQsQ0FDQSxJQUFJd0csRUFBS1osT0FBT2EsT0FBTyxNQUN2QmhDLEVBQW9Cd0IsRUFBRU8sR0FDdEIsSUFBSUUsRUFBTSxDQUFDLEVBQ1hySixFQUFpQkEsR0FBa0IsQ0FBQyxLQUFNQyxFQUFTLENBQUMsR0FBSUEsRUFBUyxJQUFLQSxFQUFTQSxJQUMvRSxJQUFJLElBQUlxSixFQUFpQixFQUFQTixHQUFZckcsRUFBeUIsaUJBQVgyRyxLQUF5QnRKLEVBQWV1SixRQUFRRCxHQUFVQSxFQUFVckosRUFBU3FKLEdBQ3hIZixPQUFPaUIsb0JBQW9CRixHQUFTMUMsU0FBUzhCLEdBQVNXLEVBQUlYLEdBQU8sSUFBTy9GLEVBQU0rRixLQUkvRSxPQUZBVyxFQUFhLFFBQUksSUFBTSxFQUN2QmpDLEVBQW9CcUMsRUFBRU4sRUFBSUUsR0FDbkJGLENBQ1IsRU14QkEvQixFQUFvQnFDLEVBQUksQ0FBQ2pDLEVBQVNrQyxLQUNqQyxJQUFJLElBQUloQixLQUFPZ0IsRUFDWHRDLEVBQW9CdUMsRUFBRUQsRUFBWWhCLEtBQVN0QixFQUFvQnVDLEVBQUVuQyxFQUFTa0IsSUFDNUVILE9BQU9xQixlQUFlcEMsRUFBU2tCLEVBQUssQ0FBRW1CLFlBQVksRUFBTXRKLElBQUttSixFQUFXaEIsTUNKM0V0QixFQUFvQjBDLEVBQUksQ0FBQyxFQUd6QjFDLEVBQW9CMkMsRUFBS0MsR0FDakJDLFFBQVFDLElBQUkzQixPQUFPQyxLQUFLcEIsRUFBb0IwQyxHQUFHSyxRQUFPLENBQUNDLEVBQVUxQixLQUN2RXRCLEVBQW9CMEMsRUFBRXBCLEdBQUtzQixFQUFTSSxHQUM3QkEsSUFDTCxLQ05KaEQsRUFBb0JpRCxFQUFLTCxHQUVqQixNQUFRQSxFQUFVLFlDSDFCNUMsRUFBb0JrRCxFQUFJLFdBQ3ZCLEdBQTBCLGlCQUFmQyxXQUF5QixPQUFPQSxXQUMzQyxJQUNDLE9BQU90RyxNQUFRLElBQUl1RyxTQUFTLGNBQWIsRUFDaEIsQ0FBRSxNQUFPVCxHQUNSLEdBQXNCLGlCQUFYeEcsT0FBcUIsT0FBT0EsTUFDeEMsQ0FDQSxDQVB1QixHQ0F4QjZELEVBQW9CdUMsRUFBSSxDQUFDYixFQUFLMkIsSUFBVWxDLE9BQU9tQyxVQUFVMUQsZUFBZVcsS0FBS21CLEVBQUsyQixHVEE5RXZLLEVBQWEsQ0FBQyxFQUNkQyxFQUFvQixvQkFFeEJpSCxFQUFvQnVELEVBQUksQ0FBQ0MsRUFBS0MsRUFBTW5DLEVBQUtzQixLQUN4QyxHQUFHOUosRUFBVzBLLEdBQVExSyxFQUFXMEssR0FBS0UsS0FBS0QsT0FBM0MsQ0FDQSxJQUFJRSxFQUFRQyxFQUNaLFFBQVd6RCxJQUFSbUIsRUFFRixJQURBLElBQUl1QyxFQUFVN0gsU0FBUzhILHFCQUFxQixVQUNwQzlDLEVBQUksRUFBR0EsRUFBSTZDLEVBQVF6SSxPQUFRNEYsSUFBSyxDQUN2QyxJQUFJK0MsRUFBSUYsRUFBUTdDLEdBQ2hCLEdBQUcrQyxFQUFFQyxhQUFhLFFBQVVSLEdBQU9PLEVBQUVDLGFBQWEsaUJBQW1CakwsRUFBb0J1SSxFQUFLLENBQUVxQyxFQUFTSSxFQUFHLEtBQU8sQ0FDcEgsQ0FFR0osSUFDSEMsR0FBYSxHQUNiRCxFQUFTM0gsU0FBU3FELGNBQWMsV0FFekI0RSxRQUFVLFFBQ2pCTixFQUFPTyxRQUFVLElBQ2JsRSxFQUFvQm1FLElBQ3ZCUixFQUFPOUQsYUFBYSxRQUFTRyxFQUFvQm1FLElBRWxEUixFQUFPOUQsYUFBYSxlQUFnQjlHLEVBQW9CdUksR0FFeERxQyxFQUFPUyxJQUFNWixHQUVkMUssRUFBVzBLLEdBQU8sQ0FBQ0MsR0FDbkIsSUFBSVksRUFBbUIsQ0FBQ0MsRUFBTXRLLEtBRTdCMkosRUFBT1ksUUFBVVosRUFBT2EsT0FBUyxLQUNqQ0MsYUFBYVAsR0FDYixJQUFJUSxFQUFVNUwsRUFBVzBLLEdBSXpCLFVBSE8xSyxFQUFXMEssR0FDbEJHLEVBQU9nQixZQUFjaEIsRUFBT2dCLFdBQVdDLFlBQVlqQixHQUNuRGUsR0FBV0EsRUFBUWxGLFNBQVNvQixHQUFRQSxFQUFHNUcsS0FDcENzSyxFQUFNLE9BQU9BLEVBQUt0SyxJQUVsQmtLLEVBQVU3SCxXQUFXZ0ksRUFBaUJRLEtBQUssVUFBTTFFLEVBQVcsQ0FBRTNELEtBQU0sVUFBV2xCLE9BQVFxSSxJQUFXLE1BQ3RHQSxFQUFPWSxRQUFVRixFQUFpQlEsS0FBSyxLQUFNbEIsRUFBT1ksU0FDcERaLEVBQU9hLE9BQVNILEVBQWlCUSxLQUFLLEtBQU1sQixFQUFPYSxRQUNuRFosR0FBYzVILFNBQVM4SSxLQUFLdkYsWUFBWW9FLEVBcENrQixHVUgzRDNELEVBQW9Cd0IsRUFBS3BCLElBQ0gsb0JBQVgyRSxRQUEwQkEsT0FBT0MsYUFDMUM3RCxPQUFPcUIsZUFBZXBDLEVBQVMyRSxPQUFPQyxZQUFhLENBQUV6SixNQUFPLFdBRTdENEYsT0FBT3FCLGVBQWVwQyxFQUFTLGFBQWMsQ0FBRTdFLE9BQU8sS0NMdkR5RSxFQUFvQmtCLEVBQUksSUNBeEJsQixFQUFvQmlGLEVBQUksSSxNQ0t4QixJQUFJQyxFQUFrQixDQUNyQixJQUFLLEVBQ0wsSUFBSyxHQUdObEYsRUFBb0IwQyxFQUFFeEIsRUFBSSxDQUFDMEIsRUFBU0ksS0FFbEMsSUFBSW1DLEVBQXFCbkYsRUFBb0J1QyxFQUFFMkMsRUFBaUJ0QyxHQUFXc0MsRUFBZ0J0QyxRQUFXekMsRUFDdEcsR0FBMEIsSUFBdkJnRixFQUdGLEdBQUdBLEVBQ0ZuQyxFQUFTVSxLQUFLeUIsRUFBbUIsUUFDM0IsQ0FHTCxJQUFJQyxFQUFVLElBQUl2QyxTQUFRLENBQUN3QyxFQUFTQyxJQUFZSCxFQUFxQkQsRUFBZ0J0QyxHQUFXLENBQUN5QyxFQUFTQyxLQUMxR3RDLEVBQVNVLEtBQUt5QixFQUFtQixHQUFLQyxHQUd0QyxJQUFJNUIsRUFBTXhELEVBQW9CaUYsRUFBSWpGLEVBQW9CaUQsRUFBRUwsR0FFcERsSixFQUFRLElBQUk2TCxNQWdCaEJ2RixFQUFvQnVELEVBQUVDLEdBZkZ4SixJQUNuQixHQUFHZ0csRUFBb0J1QyxFQUFFMkMsRUFBaUJ0QyxLQUVmLEtBRDFCdUMsRUFBcUJELEVBQWdCdEMsTUFDUnNDLEVBQWdCdEMsUUFBV3pDLEdBQ3JEZ0YsR0FBb0IsQ0FDdEIsSUFBSUssRUFBWXhMLElBQXlCLFNBQWZBLEVBQU13QyxLQUFrQixVQUFZeEMsRUFBTXdDLE1BQ2hFaUosRUFBVXpMLEdBQVNBLEVBQU1zQixRQUFVdEIsRUFBTXNCLE9BQU84SSxJQUNwRDFLLEVBQU1GLFFBQVUsaUJBQW1Cb0osRUFBVSxjQUFnQjRDLEVBQVksS0FBT0MsRUFBVSxJQUMxRi9MLEVBQU13RCxLQUFPLGlCQUNieEQsRUFBTThDLEtBQU9nSixFQUNiOUwsRUFBTWdNLFFBQVVELEVBQ2hCTixFQUFtQixHQUFHekwsRUFDdkIsSUFHdUMsU0FBV2tKLEVBQVNBLEVBRS9ELEdBWUg1QyxFQUFvQlMsRUFBRVMsRUFBSzBCLEdBQTBDLElBQTdCc0MsRUFBZ0J0QyxHQUd4RCxJQUFJK0MsRUFBdUIsQ0FBQ0MsRUFBNEI5RyxLQUN2RCxJQUdJbUIsRUFBVTJDLEdBSFRqQyxFQUFVa0YsRUFBYUMsR0FBV2hILEVBR2hCa0MsRUFBSSxFQUMzQixHQUFHTCxFQUFTb0YsTUFBTTFMLEdBQWdDLElBQXhCNkssRUFBZ0I3SyxLQUFhLENBQ3RELElBQUk0RixLQUFZNEYsRUFDWjdGLEVBQW9CdUMsRUFBRXNELEVBQWE1RixLQUNyQ0QsRUFBb0JRLEVBQUVQLEdBQVk0RixFQUFZNUYsSUFHaEQsR0FBRzZGLEVBQVMsSUFBSXBGLEVBQVNvRixFQUFROUYsRUFDbEMsQ0FFQSxJQURHNEYsR0FBNEJBLEVBQTJCOUcsR0FDckRrQyxFQUFJTCxFQUFTdkYsT0FBUTRGLElBQ3pCNEIsRUFBVWpDLEVBQVNLLEdBQ2hCaEIsRUFBb0J1QyxFQUFFMkMsRUFBaUJ0QyxJQUFZc0MsRUFBZ0J0QyxJQUNyRXNDLEVBQWdCdEMsR0FBUyxLQUUxQnNDLEVBQWdCdEMsR0FBVyxFQUU1QixPQUFPNUMsRUFBb0JTLEVBQUVDLElBRzFCc0YsRUFBcUJDLEtBQW1DLDZCQUFJQSxLQUFtQyw4QkFBSyxHQUN4R0QsRUFBbUJ4RyxRQUFRbUcsRUFBcUJkLEtBQUssS0FBTSxJQUMzRG1CLEVBQW1CdEMsS0FBT2lDLEVBQXFCZCxLQUFLLEtBQU1tQixFQUFtQnRDLEtBQUttQixLQUFLbUIsRyxLQ25GdkYsSUFBSUUsRUFBc0JsRyxFQUFvQlMsT0FBRU4sRUFBVyxDQUFDLEdBQUcsTUFBTSxJQUFPSCxFQUFvQixRQUNoR2tHLEVBQXNCbEcsRUFBb0JTLEVBQUV5RixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NyZWF0ZSBmYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9hcGkuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9hcHAuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy91aS5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9ydW50aW1lSWQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWZlcnJlZCA9IFtdO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5PID0gKHJlc3VsdCwgY2h1bmtJZHMsIGZuLCBwcmlvcml0eSkgPT4ge1xuXHRpZihjaHVua0lkcykge1xuXHRcdHByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcblx0XHRmb3IodmFyIGkgPSBkZWZlcnJlZC5sZW5ndGg7IGkgPiAwICYmIGRlZmVycmVkW2kgLSAxXVsyXSA+IHByaW9yaXR5OyBpLS0pIGRlZmVycmVkW2ldID0gZGVmZXJyZWRbaSAtIDFdO1xuXHRcdGRlZmVycmVkW2ldID0gW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldO1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgbm90RnVsZmlsbGVkID0gSW5maW5pdHk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWQubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldID0gZGVmZXJyZWRbaV07XG5cdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBjaHVua0lkcy5sZW5ndGg7IGorKykge1xuXHRcdFx0aWYgKChwcmlvcml0eSAmIDEgPT09IDAgfHwgbm90RnVsZmlsbGVkID49IHByaW9yaXR5KSAmJiBPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLk8pLmV2ZXJ5KChrZXkpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fLk9ba2V5XShjaHVua0lkc1tqXSkpKSkge1xuXHRcdFx0XHRjaHVua0lkcy5zcGxpY2Uoai0tLCAxKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZ1bGZpbGxlZCA9IGZhbHNlO1xuXHRcdFx0XHRpZihwcmlvcml0eSA8IG5vdEZ1bGZpbGxlZCkgbm90RnVsZmlsbGVkID0gcHJpb3JpdHk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWQuc3BsaWNlKGktLSwgMSlcblx0XHRcdHZhciByID0gZm4oKTtcblx0XHRcdGlmIChyICE9PSB1bmRlZmluZWQpIHJlc3VsdCA9IHI7XG5cdFx0fVxuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59OyIsInZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiA/IChvYmopID0+IChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkgOiAob2JqKSA9PiAob2JqLl9fcHJvdG9fXyk7XG52YXIgbGVhZlByb3RvdHlwZXM7XG4vLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3Rcbi8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuLy8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3Rcbi8vIG1vZGUgJiAxNjogcmV0dXJuIHZhbHVlIHdoZW4gaXQncyBQcm9taXNlLWxpa2Vcbi8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbl9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG5cdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IHRoaXModmFsdWUpO1xuXHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuXHRpZih0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlKSB7XG5cdFx0aWYoKG1vZGUgJiA0KSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG5cdFx0aWYoKG1vZGUgJiAxNikgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicpIHJldHVybiB2YWx1ZTtcblx0fVxuXHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuXHR2YXIgZGVmID0ge307XG5cdGxlYWZQcm90b3R5cGVzID0gbGVhZlByb3RvdHlwZXMgfHwgW251bGwsIGdldFByb3RvKHt9KSwgZ2V0UHJvdG8oW10pLCBnZXRQcm90byhnZXRQcm90byldO1xuXHRmb3IodmFyIGN1cnJlbnQgPSBtb2RlICYgMiAmJiB2YWx1ZTsgdHlwZW9mIGN1cnJlbnQgPT0gJ29iamVjdCcgJiYgIX5sZWFmUHJvdG90eXBlcy5pbmRleE9mKGN1cnJlbnQpOyBjdXJyZW50ID0gZ2V0UHJvdG8oY3VycmVudCkpIHtcblx0XHRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IChkZWZba2V5XSA9ICgpID0+ICh2YWx1ZVtrZXldKSkpO1xuXHR9XG5cdGRlZlsnZGVmYXVsdCddID0gKCkgPT4gKHZhbHVlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBkZWYpO1xuXHRyZXR1cm4gbnM7XG59OyIsInZhciBpblByb2dyZXNzID0ge307XG52YXIgZGF0YVdlYnBhY2tQcmVmaXggPSBcInVyYmFuZG9jc193ZWJhcHA6XCI7XG4vLyBsb2FkU2NyaXB0IGZ1bmN0aW9uIHRvIGxvYWQgYSBzY3JpcHQgdmlhIHNjcmlwdCB0YWdcbl9fd2VicGFja19yZXF1aXJlX18ubCA9ICh1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkgPT4ge1xuXHRpZihpblByb2dyZXNzW3VybF0pIHsgaW5Qcm9ncmVzc1t1cmxdLnB1c2goZG9uZSk7IHJldHVybjsgfVxuXHR2YXIgc2NyaXB0LCBuZWVkQXR0YWNoO1xuXHRpZihrZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBzID0gc2NyaXB0c1tpXTtcblx0XHRcdGlmKHMuZ2V0QXR0cmlidXRlKFwic3JjXCIpID09IHVybCB8fCBzLmdldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiKSA9PSBkYXRhV2VicGFja1ByZWZpeCArIGtleSkgeyBzY3JpcHQgPSBzOyBicmVhazsgfVxuXHRcdH1cblx0fVxuXHRpZighc2NyaXB0KSB7XG5cdFx0bmVlZEF0dGFjaCA9IHRydWU7XG5cdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cblx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG5cdFx0c2NyaXB0LnRpbWVvdXQgPSAxMjA7XG5cdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubmMpIHtcblx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcblx0XHR9XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiLCBkYXRhV2VicGFja1ByZWZpeCArIGtleSk7XG5cblx0XHRzY3JpcHQuc3JjID0gdXJsO1xuXHR9XG5cdGluUHJvZ3Jlc3NbdXJsXSA9IFtkb25lXTtcblx0dmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpID0+IHtcblx0XHQvLyBhdm9pZCBtZW0gbGVha3MgaW4gSUUuXG5cdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcblx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0dmFyIGRvbmVGbnMgPSBpblByb2dyZXNzW3VybF07XG5cdFx0ZGVsZXRlIGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRzY3JpcHQucGFyZW50Tm9kZSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdGRvbmVGbnMgJiYgZG9uZUZucy5mb3JFYWNoKChmbikgPT4gKGZuKGV2ZW50KSkpO1xuXHRcdGlmKHByZXYpIHJldHVybiBwcmV2KGV2ZW50KTtcblx0fVxuXHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQob25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHVuZGVmaW5lZCwgeyB0eXBlOiAndGltZW91dCcsIHRhcmdldDogc2NyaXB0IH0pLCAxMjAwMDApO1xuXHRzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG5cdHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG5cdG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xufTsiLCIvLyBzcmMvanMvYXBpLmpzXHJcbi8qKlxyXG4gKiBTdXBhYmFzZSBBUEkgLSBNb2Rlcm5pemVkXHJcbiAqIEBtb2R1bGUgYXBpXHJcbiAqIEBkZXNjcmlwdGlvbiBDbGVhbiwgZWZmaWNpZW50IEFQSSBsYXllciB3aXRoIGVuaGFuY2VkIGVycm9yIGhhbmRsaW5nIGFuZCBzdGF0ZSBtYW5hZ2VtZW50XHJcbiAqIEB2ZXJzaW9uIDEuMC4wXHJcbiAqIEBhdXRob3IgR3JleVBhbmRhXHJcbiAqXHJcbiAqIEBjaGFuZ2Vsb2dcclxuICogLSAxLjAuMCAoMjAyNS0wMS0yOSk6IE1vZGVybml6ZWQgd2l0aCBzdGF0ZSBtYW5hZ2VtZW50IGFuZCBlbmhhbmNlZCBjb21wb25lbnRzXHJcbiAqIC0gMC4xLjAgKDIwMjUtMDUtMTUpOiBNaWdyYXRpbmcgU3VwYWJhc2UgQVBJIGNhbGxzIGZvciBpbXByb3ZlZCBwZXJmb3JtYW5jZS5cclxuICogLSAwLjAuMSAoMjAyNS0wNC0yNik6IEluaXRpYWwgdmVyc2lvbiB3aXRoIGJhc2ljIEFQSSBmdW5jdGlvbmFsaXR5LlxyXG4gKi9cclxuXHJcbi8vIEltcG9ydCBlbmhhbmNlZCBtb2R1bGVzXHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XHJcbmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tIFwiLi9zZXJ2aWNlcy9hcGktc2VydmljZS5qc1wiO1xyXG5pbXBvcnQgeyBzdGF0ZU1hbmFnZXIgfSBmcm9tIFwiLi9zdGF0ZS9zdGF0ZS1tYW5hZ2VyLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgdG9nZ2xlU3Bpbm5lcixcclxuICBzaG93U3RhdHVzLFxyXG4gIHBvcHVsYXRlU2VsZWN0LFxyXG4gIHJlc2V0U2VsZWN0LFxyXG4gIGRvbUVsZW1lbnRzLFxyXG59IGZyb20gXCIuL3VpLmpzXCI7XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgY2l0eSBsb2FkaW5nIHdpdGggY2FjaGluZyBhbmQgc3RhdGUgbWFuYWdlbWVudFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbG9hZENpdGllcygpIHtcclxuICBjb25zdCBjaXR5U2VsZWN0ID0gZG9tRWxlbWVudHMuZ2V0KFwiY2l0eVNlbGVjdFwiKTtcclxuICBjb25zdCBjaXR5U3Bpbm5lciA9IGRvbUVsZW1lbnRzLmdldChcImNpdHlTcGlubmVyXCIpO1xyXG5cclxuICBpZiAoIWNpdHlTZWxlY3QpIHJldHVybjtcclxuXHJcbiAgdG9nZ2xlU3Bpbm5lcihjaXR5U3Bpbm5lciwgdHJ1ZSk7XHJcbiAgc3RhdGVNYW5hZ2VyLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjaXRpZXMgPSBhd2FpdCBhcGlTZXJ2aWNlLmxvYWRDaXRpZXMoKTtcclxuXHJcbiAgICBjb25zdCBoYXNEYXRhID0gcG9wdWxhdGVTZWxlY3QoXHJcbiAgICAgIGNpdHlTZWxlY3QsXHJcbiAgICAgIGNpdGllcyxcclxuICAgICAgXCJTw6lsZWN0aW9ubmV6IHVuZSB2aWxsZVwiLFxyXG4gICAgICBcIkF1Y3VuZSB2aWxsZSBkaXNwb25pYmxlXCIsXHJcbiAgICAgIFwiY2l0eVwiXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChoYXNEYXRhKSB7XHJcbiAgICAgIHNob3dTdGF0dXMoXHJcbiAgICAgICAgYE5vdXZlbGxlcyB2aWxsZXMgZGlzcG9uaWJsZXMgISBSZXRyb3V2ZXogbGVzIHN5bnRow6hzZXMgZGUgTGlsbGUgZXQgQm9yZGVhdXhgLFxyXG4gICAgICAgIFwic3VjY2Vzc1wiXHJcbiAgICAgICk7XHJcbiAgICAgIHN0YXRlTWFuYWdlci5zZXRDaXRpZXMoY2l0aWVzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc3RhdGVNYW5hZ2VyLmdldFN0YXRlKFwidXNlclwiKTtcclxuICAgICAgY29uc3QgbWVzc2FnZSA9XHJcbiAgICAgICAgY3VycmVudFVzZXIgPT09IG51bGxcclxuICAgICAgICAgID8gXCJWZXVpbGxleiB2b3VzIGNvbm5lY3RlciBwb3VyIGFjY8OpZGVyIGF1eCBkb25uw6llcy5cIlxyXG4gICAgICAgICAgOiBcIkF1Y3VuZSB2aWxsZSB0cm91dsOpZS5cIjtcclxuICAgICAgc2hvd1N0YXR1cyhtZXNzYWdlLCBcIndhcm5pbmdcIik7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkdSBjaGFyZ2VtZW50IGRlcyB2aWxsZXM6XCIsIGVycm9yKTtcclxuICAgIHNob3dTdGF0dXMoXCJFcnJldXIgZGUgY2hhcmdlbWVudCBkZXMgdmlsbGVzXCIsIFwiZXJyb3JcIik7XHJcbiAgICByZXNldFNlbGVjdChjaXR5U2VsZWN0LCBcIkVycmV1ciBjaGFyZ2VtZW50XCIpO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICB0b2dnbGVTcGlubmVyKGNpdHlTcGlubmVyLCBmYWxzZSk7XHJcbiAgICBzdGF0ZU1hbmFnZXIuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgem9uaW5nIGxvYWRpbmcgd2l0aCBzdGF0ZSBtYW5hZ2VtZW50XHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsb2FkWm9uaW5ncyhjaXR5SWQpIHtcclxuICBjb25zdCB6b25pbmdTZWxlY3QgPSBkb21FbGVtZW50cy5nZXQoXCJ6b25pbmdTZWxlY3RcIik7XHJcbiAgY29uc3Qgem9uZVNlbGVjdCA9IGRvbUVsZW1lbnRzLmdldChcInpvbmVTZWxlY3RcIik7XHJcbiAgY29uc3Qgem9uaW5nU3Bpbm5lciA9IGRvbUVsZW1lbnRzLmdldChcInpvbmluZ1NwaW5uZXJcIik7XHJcbiAgY29uc3Qgc3ludGhlc2lzQnRuID0gZG9tRWxlbWVudHMuZ2V0KFwic3ludGhlc2lzQnRuXCIpO1xyXG5cclxuICAvLyBSZXNldCBkZXBlbmRlbnQgc2VsZWN0c1xyXG4gIHJlc2V0U2VsZWN0KHpvbmluZ1NlbGVjdCwgXCJTw6lsZWN0aW9ubmV6IGQnYWJvcmQgdW5lIHZpbGxlXCIpO1xyXG4gIHJlc2V0U2VsZWN0KHpvbmVTZWxlY3QsIFwiU8OpbGVjdGlvbm5leiBkJ2Fib3JkIHVuIHpvbmFnZVwiKTtcclxuICBpZiAoc3ludGhlc2lzQnRuKSBzeW50aGVzaXNCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuICBzdGF0ZU1hbmFnZXIuY2xlYXJTZWxlY3RlZERvY3VtZW50KCk7XHJcblxyXG4gIGlmICghY2l0eUlkKSB7XHJcbiAgICBzaG93U3RhdHVzKFwiVmV1aWxsZXogc8OpbGVjdGlvbm5lciB1bmUgdmlsbGUuXCIsIFwiaW5mb1wiKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHRvZ2dsZVNwaW5uZXIoem9uaW5nU3Bpbm5lciwgdHJ1ZSk7XHJcbiAgc3RhdGVNYW5hZ2VyLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB6b25pbmdzID0gYXdhaXQgYXBpU2VydmljZS5sb2FkWm9uaW5ncyhjaXR5SWQpO1xyXG5cclxuICAgIGNvbnN0IGhhc0RhdGEgPSBwb3B1bGF0ZVNlbGVjdChcclxuICAgICAgem9uaW5nU2VsZWN0LFxyXG4gICAgICB6b25pbmdzLFxyXG4gICAgICBcIlPDqWxlY3Rpb25uZXogdW4gem9uYWdlXCIsXHJcbiAgICAgIFwiQXVjdW4gem9uYWdlIGRpc3BvbmlibGVcIixcclxuICAgICAgXCJ6b25pbmdcIlxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoaGFzRGF0YSkge1xyXG4gICAgICBzaG93U3RhdHVzKGAke3pvbmluZ3MubGVuZ3RofSB6b25hZ2VzIGNoYXJnw6lzYCwgXCJzdWNjZXNzXCIpO1xyXG4gICAgICBzdGF0ZU1hbmFnZXIuc2V0Wm9uaW5ncyh6b25pbmdzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNob3dTdGF0dXMoXCJBdWN1biB6b25hZ2UgdHJvdXbDqSBwb3VyIGNldHRlIHZpbGxlLlwiLCBcIndhcm5pbmdcIik7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkdSBjaGFyZ2VtZW50IGRlcyB6b25hZ2VzOlwiLCBlcnJvcik7XHJcbiAgICBzaG93U3RhdHVzKFwiRXJyZXVyIGRlIGNoYXJnZW1lbnQgZGVzIHpvbmFnZXNcIiwgXCJlcnJvclwiKTtcclxuICAgIHJlc2V0U2VsZWN0KHpvbmluZ1NlbGVjdCwgXCJFcnJldXIgY2hhcmdlbWVudFwiKTtcclxuICB9IGZpbmFsbHkge1xyXG4gICAgdG9nZ2xlU3Bpbm5lcih6b25pbmdTcGlubmVyLCBmYWxzZSk7XHJcbiAgICBzdGF0ZU1hbmFnZXIuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgem9uZSBsb2FkaW5nIHdpdGggc3RhdGUgbWFuYWdlbWVudFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbG9hZFpvbmVzKHpvbmluZ0lkKSB7XHJcbiAgY29uc3Qgem9uZVNlbGVjdCA9IGRvbUVsZW1lbnRzLmdldChcInpvbmVTZWxlY3RcIik7XHJcbiAgY29uc3Qgem9uZVNwaW5uZXIgPSBkb21FbGVtZW50cy5nZXQoXCJ6b25lU3Bpbm5lclwiKTtcclxuICBjb25zdCBzeW50aGVzaXNCdG4gPSBkb21FbGVtZW50cy5nZXQoXCJzeW50aGVzaXNCdG5cIik7XHJcblxyXG4gIHJlc2V0U2VsZWN0KHpvbmVTZWxlY3QsIFwiU8OpbGVjdGlvbm5leiBkJ2Fib3JkIHVuIHpvbmFnZVwiKTtcclxuICBpZiAoc3ludGhlc2lzQnRuKSBzeW50aGVzaXNCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuICBzdGF0ZU1hbmFnZXIuY2xlYXJTZWxlY3RlZERvY3VtZW50KCk7XHJcblxyXG4gIGlmICghem9uaW5nSWQpIHtcclxuICAgIHNob3dTdGF0dXMoXCJWZXVpbGxleiBzw6lsZWN0aW9ubmVyIHVuIHpvbmFnZS5cIiwgXCJpbmZvXCIpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlU3Bpbm5lcih6b25lU3Bpbm5lciwgdHJ1ZSk7XHJcbiAgc3RhdGVNYW5hZ2VyLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB6b25lcyA9IGF3YWl0IGFwaVNlcnZpY2UubG9hZFpvbmVzKHpvbmluZ0lkKTtcclxuXHJcbiAgICBjb25zdCBoYXNEYXRhID0gcG9wdWxhdGVTZWxlY3QoXHJcbiAgICAgIHpvbmVTZWxlY3QsXHJcbiAgICAgIHpvbmVzLFxyXG4gICAgICBcIlPDqWxlY3Rpb25uZXogdW5lIHpvbmVcIixcclxuICAgICAgXCJBdWN1bmUgem9uZSBkaXNwb25pYmxlXCIsXHJcbiAgICAgIFwiem9uZVwiXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChoYXNEYXRhKSB7XHJcbiAgICAgIHNob3dTdGF0dXMoYCR7em9uZXMubGVuZ3RofSB6b25lcyBjaGFyZ8OpZXNgLCBcInN1Y2Nlc3NcIik7XHJcbiAgICAgIHN0YXRlTWFuYWdlci5zZXRab25lcyh6b25lcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzaG93U3RhdHVzKFwiQXVjdW5lIHpvbmUgdHJvdXbDqWUgcG91ciBjZSB6b25hZ2UuXCIsIFwid2FybmluZ1wiKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBsb3JzIGR1IGNoYXJnZW1lbnQgZGVzIHpvbmVzOlwiLCBlcnJvcik7XHJcbiAgICBzaG93U3RhdHVzKFwiRXJyZXVyIGRlIGNoYXJnZW1lbnQgZGVzIHpvbmVzXCIsIFwiZXJyb3JcIik7XHJcbiAgICByZXNldFNlbGVjdCh6b25lU2VsZWN0LCBcIkVycmV1ciBjaGFyZ2VtZW50XCIpO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICB0b2dnbGVTcGlubmVyKHpvbmVTcGlubmVyLCBmYWxzZSk7XHJcbiAgICBzdGF0ZU1hbmFnZXIuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgZG9jdW1lbnQgZmluZGVyIHdpdGggc3RhdGUgbWFuYWdlbWVudFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZmluZERvY3VtZW50KHpvbmluZ0lkLCB6b25lSWQsIHR5cG9sb2dpZUlkID0gbnVsbCkge1xyXG4gIGNvbnN0IHN5bnRoZXNpc0J0biA9IGRvbUVsZW1lbnRzLmdldChcInN5bnRoZXNpc0J0blwiKTtcclxuICBjb25zdCBkb2N1bWVudFNwaW5uZXIgPSBkb21FbGVtZW50cy5nZXQoXCJkb2N1bWVudFNwaW5uZXJcIik7XHJcblxyXG4gIGlmIChzeW50aGVzaXNCdG4pIHN5bnRoZXNpc0J0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgc3RhdGVNYW5hZ2VyLmNsZWFyU2VsZWN0ZWREb2N1bWVudCgpO1xyXG5cclxuICBjb25zdCBjdXJyZW50VXNlciA9IHN0YXRlTWFuYWdlci5nZXRTdGF0ZShcInVzZXJcIik7XHJcbiAgaWYgKCFjdXJyZW50VXNlcikge1xyXG4gICAgc2hvd1N0YXR1cyhcclxuICAgICAgXCJWZXVpbGxleiB2b3VzIGNvbm5lY3RlciBwb3VyIGFjY8OpZGVyIGF1eCBkb2N1bWVudHMuXCIsXHJcbiAgICAgIFwid2FybmluZ1wiXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBpZiAoIXpvbmluZ0lkIHx8ICF6b25lSWQpIHtcclxuICAgIHNob3dTdGF0dXMoXCJTw6lsZWN0aW9uIGluY29tcGzDqHRlIHBvdXIgcmVjaGVyY2hlciBsZSBkb2N1bWVudC5cIiwgXCJpbmZvXCIpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVTcGlubmVyKGRvY3VtZW50U3Bpbm5lciwgdHJ1ZSk7XHJcbiAgc3RhdGVNYW5hZ2VyLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkb2N1bWVudCA9IGF3YWl0IGFwaVNlcnZpY2UuZmluZERvY3VtZW50KFxyXG4gICAgICB6b25pbmdJZCxcclxuICAgICAgem9uZUlkLFxyXG4gICAgICB0eXBvbG9naWVJZFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoZG9jdW1lbnQpIHtcclxuICAgICAgc3RhdGVNYW5hZ2VyLnNldFNlbGVjdGVkRG9jdW1lbnQoZG9jdW1lbnQpO1xyXG4gICAgICBpZiAoc3ludGhlc2lzQnRuKSBzeW50aGVzaXNCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgc2hvd1N0YXR1cyhcIkRvY3VtZW50IHRyb3V2w6kgIVwiLCBcInN1Y2Nlc3NcIik7XHJcbiAgICAgIHJldHVybiBkb2N1bWVudDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNob3dTdGF0dXMoXCJBdWN1biBkb2N1bWVudCB0cm91dsOpIHBvdXIgY2V0dGUgc8OpbGVjdGlvbi5cIiwgXCJ3YXJuaW5nXCIpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBsb3JzIGRlIGxhIHJlY2hlcmNoZSBkdSBkb2N1bWVudDpcIiwgZXJyb3IpO1xyXG4gICAgc2hvd1N0YXR1cyhcIkVycmV1ciBsb3JzIGRlIGxhIHJlY2hlcmNoZSBkdSBkb2N1bWVudFwiLCBcImVycm9yXCIpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfSBmaW5hbGx5IHtcclxuICAgIHRvZ2dsZVNwaW5uZXIoZG9jdW1lbnRTcGlubmVyLCBmYWxzZSk7XHJcbiAgICBzdGF0ZU1hbmFnZXIuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IHNlbGVjdGVkIGRvY3VtZW50IGZyb20gc3RhdGVcclxuICovXHJcbmZ1bmN0aW9uIGdldFNlbGVjdGVkRG9jdW1lbnQoKSB7XHJcbiAgcmV0dXJuIHN0YXRlTWFuYWdlci5nZXRTdGF0ZShcInNlbGVjdGVkRG9jdW1lbnRcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBpbml0aWFsaXphdGlvbiB3aXRoIHN0YXRlIG1hbmFnZW1lbnRcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVBcHAoKSB7XHJcbiAgc3RhdGVNYW5hZ2VyLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBMb2FkIGluaXRpYWwgZGF0YVxyXG4gICAgYXdhaXQgbG9hZENpdGllcygpO1xyXG5cclxuICAgIC8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIHN0YXRlIGNoYW5nZXNcclxuICAgIHN0YXRlTWFuYWdlci5zdWJzY3JpYmUoXCJ1c2VyXCIsICh1c2VyKSA9PiB7XHJcbiAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgbG9hZENpdGllcygpOyAvLyBSZWxvYWQgY2l0aWVzIHdoZW4gdXNlciBsb2dzIGluXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHNob3dTdGF0dXMoXCJBcHBsaWNhdGlvbiBpbml0aWFsaXPDqWVcIiwgXCJzdWNjZXNzXCIpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGQnaW5pdGlhbGlzYXRpb246XCIsIGVycm9yKTtcclxuICAgIHNob3dTdGF0dXMoXCJFcnJldXIgZCdpbml0aWFsaXNhdGlvbiBkZSBsJ2FwcGxpY2F0aW9uXCIsIFwiZXJyb3JcIik7XHJcbiAgfSBmaW5hbGx5IHtcclxuICAgIHN0YXRlTWFuYWdlci5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEV4cG9ydCBjbGVhbiwgZm9jdXNlZCBBUElcclxuZXhwb3J0IHtcclxuICBsb2FkQ2l0aWVzLFxyXG4gIGxvYWRab25pbmdzLFxyXG4gIGxvYWRab25lcyxcclxuICBmaW5kRG9jdW1lbnQsXHJcbiAgZ2V0U2VsZWN0ZWREb2N1bWVudCxcclxuICBpbml0aWFsaXplQXBwLFxyXG59O1xyXG4iLCIvLyBwdWJsaWMvanMvYXBwLmpzIC0gTWFpbiBhcHBsaWNhdGlvbiBsb2dpY1xyXG4vKipcclxuICogRmlyZWJhc2UgQXBwXHJcbiAqIEBtb2R1bGUgYXBwXHJcbiAqIEBkZXNjcmlwdGlvbiBUaGlzIG1vZHVsZSBoYW5kbGVzIHRoZSBtYWluIGFwcGxpY2F0aW9uIGxvZ2ljLlxyXG4gKiBAdmVyc2lvbiAwLjAuN1xyXG4gKiBAYXV0aG9yIEdyZXlQYW5kYVxyXG4gKlxyXG4gKiBAY2hhbmdlbG9nXHJcbiAqIC0gMC4wLjcgKDIwMjUtMDEtMjkpOiBJbnRlZ3JhdGVkIHdpdGggZW5oYW5jZWQgc3RhdGUgbWFuYWdlbWVudCBhbmQgQVBJIHNlcnZpY2VcclxuICogLSAwLjAuNiAoMjAyNS0wMS0yNyk6IFJlZmFjdG9yZWQgdG8gdXNlIHNoYXJlZCBoZWFkZXIgYXV0aGVudGljYXRpb24gbW9kdWxlXHJcbiAqIC0gMC4wLjUgKDIwMjUtMDUtMTMpOiBBZGRpbmcgYWNjb3VudCBidXR0b24gdG8gdGhlIHByb2ZpbGUgcGFnZSwgY29ycmVjdGluZyB0aGUgbG9naW4gcHJvbXB0LlxyXG4gKiAtIDAuMC40ICgyMDI1LTA1LTA5KTogTW9kaWZpZWQgdGhlIGF1dGhlbnRpY2F0aW9uIHN0YXRlIG1hbmFnZW1lbnQgdG8gdXNlIFN1cGFiYXNlIEF1dGggc3lzdGVtLlxyXG4gKiAtIDAuMC4zICgyMDI1LTA1LTA4KTogTW92ZWQgRmlyZWJhc2UgY29uZmlndXJhdGlvbiBpbnRvIGEgc2VwYXJhdGUgZmlsZS5cclxuICogLSAwLjAuMiAoMjAyNS0wNC0yNyk6IEFkZGVkIGF1dGhlbnRpY2F0aW9uIHN0YXRlIG1hbmFnZW1lbnQgYW5kIGRvY3VtZW50IGRvd25sb2FkIGZ1bmN0aW9uYWxpdHkgd2l0aCBGaXJlYmFzZSBBdXRoLlxyXG4gKiAtIDAuMC4xICgyMDI1LTA0LTIxKTogSW5pdGlhbCB2ZXJzaW9uIHdpdGggYmFzaWMgZG9jdW1lbnQgZG93bmxvYWQgZnVuY3Rpb25hbGl0eS5cclxuICovXHJcblxyXG4vLyBJbXBvcnQgU3VwYWJhc2UgQ2xpZW50XHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XHJcblxyXG4vLyBJbXBvcnQgZW5oYW5jZWQgc3RhdGUgbWFuYWdlbWVudFxyXG5pbXBvcnQgeyBzdGF0ZU1hbmFnZXIgfSBmcm9tIFwiLi9zdGF0ZS9zdGF0ZS1tYW5hZ2VyLmpzXCI7XHJcblxyXG4vLyBJbXBvcnQgQVBJIGZ1bmN0aW9uc1xyXG5pbXBvcnQge1xyXG4gIGxvYWRDaXRpZXMsXHJcbiAgbG9hZFpvbmluZ3MsXHJcbiAgbG9hZFpvbmVzLFxyXG4gIGZpbmREb2N1bWVudCxcclxuICBnZXRTZWxlY3RlZERvY3VtZW50LCAvLyBGdW5jdGlvbiB0byBnZXQgdGhlIGRvY3VtZW50IGRldGFpbHMgZnJvbSBhcGkuanNcclxufSBmcm9tIFwiLi9hcGkuanNcIjtcclxuXHJcbi8vIEltcG9ydCBVSSBlbGVtZW50cyBhbmQgZnVuY3Rpb25zXHJcbmltcG9ydCB7XHJcbiAgY2l0eVNlbGVjdCxcclxuICB6b25pbmdTZWxlY3QsXHJcbiAgem9uZVNlbGVjdCxcclxuICBzeW50aGVzaXNCdG4sXHJcbiAgc2hvd1N0YXR1cyxcclxuICByZXNldFNlbGVjdCxcclxuICBmb3JtYXRBcGlOYW1lLFxyXG4gIC8vIFJlZmVyZW5jZXMgdG8gVUkgZWxlbWVudHMgZnJvbSB1aS5qc1xyXG4gIHVzZXJTdGF0dXMsXHJcbiAgbG9nb3V0QnRuLFxyXG4gIGxvZ2luTGluayxcclxuICBzaWdudXBMaW5rLFxyXG59IGZyb20gXCIuL3VpLmpzXCI7XHJcblxyXG5pbXBvcnQgKiBhcyBhdXRoTW9kdWxlIGZyb20gXCIuL2F1dGgvYXV0aC5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGluaXRIZWFkZXJBdXRoLFxyXG4gIGdldEN1cnJlbnRVc2VyIGFzIGdldEhlYWRlckN1cnJlbnRVc2VyLFxyXG59IGZyb20gXCIuL2F1dGgvaGVhZGVyLWF1dGguanNcIjtcclxuaW1wb3J0IHsgaW5pdERlbGV0aW9uR3VhcmQgfSBmcm9tIFwiLi9hdXRoL2RlbGV0aW9uLWd1YXJkLmpzXCI7XHJcblxyXG5sZXQgY3VycmVudFVzZXIgPSBudWxsOyAvLyBWYXJpYWJsZSB0byBob2xkIHRoZSBjdXJyZW50IHVzZXIgc3RhdGVcclxuXHJcbi8vIC0tLSBBdXRoZW50aWNhdGlvbiBTdGF0ZSBNYW5hZ2VtZW50IC0tLVxyXG5mdW5jdGlvbiB1cGRhdGVVSUZvckF1dGhTdGF0ZSh1c2VyKSB7XHJcbiAgY3VycmVudFVzZXIgPSB1c2VyOyAvLyBVcGRhdGUgZ2xvYmFsIHVzZXIgc3RhdGVcclxuICBzdGF0ZU1hbmFnZXIuc2V0VXNlcih1c2VyKTsgLy8gVXBkYXRlIHN0YXRlIG1hbmFnZXJcclxuXHJcbiAgaWYgKHVzZXIpIHtcclxuICAgIC8vIFVzZXIgaXMgc2lnbmVkIGluIC0gdXBkYXRlIHN5bnRoZXNpcyBidXR0b24gc3RhdGVcclxuICAgIGNvbnN0IHNlbGVjdGVkRG9jdW1lbnQgPSBnZXRTZWxlY3RlZERvY3VtZW50KCk7XHJcbiAgICBpZiAoc2VsZWN0ZWREb2N1bWVudCAmJiBzZWxlY3RlZERvY3VtZW50LmlkKSB7XHJcbiAgICAgIGlmIChzeW50aGVzaXNCdG4pIHN5bnRoZXNpc0J0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBzaG93U3RhdHVzKFxyXG4gICAgICAgIGBEb2N1bWVudCB0cm91dsOpIChTb3VyY2U6ICR7XHJcbiAgICAgICAgICBmb3JtYXRBcGlOYW1lKHNlbGVjdGVkRG9jdW1lbnQuc291cmNlX3BsdV9kYXRlKSB8fCBcIk5vbiBzcMOpY2lmacOpZVwiXHJcbiAgICAgICAgfSkuIFByw6p0IMOgIGNvbnN1bHRlci5gLFxyXG4gICAgICAgIFwic3VjY2Vzc1wiXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoc3ludGhlc2lzQnRuKSBzeW50aGVzaXNCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBVc2VyIGlzIHNpZ25lZCBvdXQgLSBkaXNhYmxlIHN5bnRoZXNpcyBidXR0b25cclxuICAgIGlmIChzeW50aGVzaXNCdG4pIHN5bnRoZXNpc0J0bi5kaXNhYmxlZCA9IHRydWU7IC8vIEFsd2F5cyBkaXNhYmxlIGRvd25sb2FkIGlmIGxvZ2dlZCBvdXRcclxuICB9XHJcbn1cclxuXHJcbi8vIEN1c3RvbSBhdXRoIHN0YXRlIGNoYW5nZSBsaXN0ZW5lciBmb3IgYXBwLXNwZWNpZmljIGZ1bmN0aW9uYWxpdHlcclxuc3VwYWJhc2UuYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZSgoZXZlbnQsIHNlc3Npb24pID0+IHtcclxuICBjb25zdCB1c2VyID0gc2Vzc2lvbj8udXNlciB8fCBudWxsO1xyXG5cclxuICAvLyBVcGRhdGUgYXBwLXNwZWNpZmljIFVJIHN0YXRlIChzeW50aGVzaXMgYnV0dG9uLCBldGMuKVxyXG4gIHVwZGF0ZVVJRm9yQXV0aFN0YXRlKHVzZXIpO1xyXG5cclxuICBpZiAoZXZlbnQgPT09IFwiU0lHTkVEX09VVFwiKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFwcDogVXNlciBzaWduZWQgb3V0XCIpO1xyXG4gICAgc3RhdGVNYW5hZ2VyLnJlc2V0U2VsZWN0aW9ucygpO1xyXG4gIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiU0lHTkVEX0lOXCIpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiQXBwOiBVc2VyIHNpZ25lZCBpblwiKTtcclxuICAgIC8vIFJlbG9hZCBjaXRpZXMgd2hlbiB1c2VyIHNpZ25zIGluXHJcbiAgICBpZiAoY2l0eVNlbGVjdCAmJiB6b25pbmdTZWxlY3QgJiYgem9uZVNlbGVjdCkge1xyXG4gICAgICBsb2FkQ2l0aWVzKCk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJJTklUSUFMX1NFU1NJT05cIikge1xyXG4gICAgY29uc29sZS5sb2coXCJBcHA6IEluaXRpYWwgc2Vzc2lvbiBsb2FkZWRcIik7XHJcbiAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJUT0tFTl9SRUZSRVNIRURcIikge1xyXG4gICAgY29uc29sZS5sb2coXCJBcHA6IFRva2VuIHJlZnJlc2hlZFwiKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gLS0tIERvY3VtZW50IERvd25sb2FkIExvZ2ljIC0tLVxyXG5mdW5jdGlvbiBkb3dubG9hZERvY3VtZW50KCkge1xyXG4gIGNvbnN0IHVzZXIgPSBnZXRIZWFkZXJDdXJyZW50VXNlcigpOyAvLyBHZXQgdXNlciBmcm9tIGhlYWRlciBhdXRoIG1vZHVsZVxyXG4gIGlmICghdXNlcikge1xyXG4gICAgc2hvd1N0YXR1cyhcIkF1dGhlbnRpZmljYXRpb24gcmVxdWlzZSBwb3VyIHTDqWzDqWNoYXJnZXIuXCIsIFwid2FybmluZ1wiKTtcclxuICAgIHN5bnRoZXNpc0J0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICByZXR1cm47IC8vIEV4aXQgaWYgbm90IGF1dGhlbnRpY2F0ZWRcclxuICB9XHJcblxyXG4gIGNvbnN0IHNlbGVjdGVkRG9jdW1lbnQgPSBnZXRTZWxlY3RlZERvY3VtZW50KCk7IC8vIEdldCBmcm9tIGFwaS5qc1xyXG4gIGlmIChzZWxlY3RlZERvY3VtZW50ICYmIHNlbGVjdGVkRG9jdW1lbnQuaWQpIHtcclxuICAgIHNob3dTdGF0dXMoXCJPdXZlcnR1cmUgZHUgZG9jdW1lbnQuLi5cIiwgXCJpbmZvXCIpO1xyXG4gICAgd2luZG93Lm9wZW4oYC9wbHUtc3VtbWFyeT9pZD0ke3NlbGVjdGVkRG9jdW1lbnQuaWR9YCwgXCJfYmxhbmtcIik7XHJcbiAgICAvLyBSZS1kaXNwbGF5IHN1Y2Nlc3MgbWVzc2FnZSBhZnRlciBhIGRlbGF5XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgLy8gQ2hlY2sgaWYgYnV0dG9uIGlzIHN0aWxsIGVuYWJsZWQgKGkuZS4sIGRvY3VtZW50IGlzIHN0aWxsIGNvbnNpZGVyZWQgdmFsaWQpXHJcbiAgICAgIGlmICghc3ludGhlc2lzQnRuLmRpc2FibGVkKSB7XHJcbiAgICAgICAgc2hvd1N0YXR1cyhcclxuICAgICAgICAgIGBEb2N1bWVudCB0cm91dsOpIChTb3VyY2U6ICR7XHJcbiAgICAgICAgICAgIGZvcm1hdEFwaU5hbWUoc2VsZWN0ZWREb2N1bWVudC5zb3VyY2VfcGx1X2RhdGUpIHx8IFwiTm9uIHNww6ljaWZpw6llXCJcclxuICAgICAgICAgIH0pLiBQcsOqdCDDoCBjb25zdWx0ZXIuYCxcclxuICAgICAgICAgIFwic3VjY2Vzc1wiXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfSwgMTUwMCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNob3dTdGF0dXMoXCJMaWVuIGR1IGRvY3VtZW50IG5vbiBkaXNwb25pYmxlLlwiLCBcIndhcm5pbmdcIik7XHJcbiAgICBzeW50aGVzaXNCdG4uZGlzYWJsZWQgPSB0cnVlOyAvLyBFbnN1cmUgYnV0dG9uIGlzIGRpc2FibGVkIGlmIG5vIFVSTFxyXG4gIH1cclxufVxyXG5cclxuLy8gPT09IEV2ZW50IGxpc3RlbmVycyA9PT1cclxuY2l0eVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xyXG4gIGNvbnN0IGNpdHlJZCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICBsb2FkWm9uaW5ncyhjaXR5SWQpOyAvLyBDYWxsIEFQSSBmdW5jdGlvblxyXG59KTtcclxuXHJcbnpvbmluZ1NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xyXG4gIGNvbnN0IHpvbmluZ0lkID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG4gIGxvYWRab25lcyh6b25pbmdJZCk7IC8vIENhbGwgQVBJIGZ1bmN0aW9uXHJcbn0pO1xyXG5cclxuem9uZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xyXG4gIGNvbnN0IHpvbmVJZCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICBjb25zdCB6b25pbmdJZCA9IHpvbmluZ1NlbGVjdC52YWx1ZTsgLy8gR2V0IGN1cnJlbnQgem9uaW5nIHNlbGVjdGlvblxyXG4gIC8vIFRPRE8gOiB0eXBvbG9naWVTZWxlY3QgbG9naWNcclxuICBpZiAoem9uZUlkICYmIHpvbmluZ0lkKSB7XHJcbiAgICBmaW5kRG9jdW1lbnQoem9uaW5nSWQsIHpvbmVJZCwgXCI3YzBmMjgzMC1mM2ZjLTRjNjktOTExYy00NzAyODZmOTE5ODJcIik7IC8vIENhbGwgQVBJIGZ1bmN0aW9uXHJcbiAgfSBlbHNlIHtcclxuICAgIHNob3dTdGF0dXMoXCJWZXVpbGxleiBkJ2Fib3JkIHPDqWxlY3Rpb25uZXIgdW4gem9uaW5nLlwiLCBcIndhcm5pbmdcIik7XHJcbiAgfVxyXG4gIC8vIGlmICh6b25pbmdJZCkge1xyXG4gIC8vICAgbG9hZFR5cG9sb2dpZXMoem9uZUlkLCB6b25pbmdJZCk7IC8vIENhbGwgQVBJIGZ1bmN0aW9uXHJcbiAgLy8gfSBlbHNlIHtcclxuICAvLyAgIHNob3dTdGF0dXMoXCJWZXVpbGxleiBkJ2Fib3JkIHPDqWxlY3Rpb25uZXIgdW4gem9uaW5nLlwiLCBcIndhcm5pbmdcIik7XHJcbiAgLy8gfVxyXG59KTtcclxuXHJcbi8vIHR5cG9sb2dpZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xyXG4vLyAgIGNvbnN0IHR5cG9sb2dpZUlkID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG4vLyAgIGNvbnN0IHpvbmVJZCA9IHpvbmVTZWxlY3QudmFsdWU7XHJcbi8vICAgY29uc3Qgem9uaW5nSWQgPSB6b25pbmdTZWxlY3QudmFsdWU7XHJcbi8vICAgaWYgKHpvbmVJZCAmJiB6b25pbmdJZCkge1xyXG4vLyAgICAgZmluZERvY3VtZW50KHpvbmluZ0lkLCB6b25lSWQsIHR5cG9sb2dpZUlkKTsgLy8gQ2FsbCBBUEkgZnVuY3Rpb25cclxuLy8gICB9IGVsc2Uge1xyXG4vLyAgICAgc2hvd1N0YXR1cyhcclxuLy8gICAgICAgXCJWZXVpbGxleiBkJ2Fib3JkIHPDqWxlY3Rpb25uZXIgdW4gem9uaW5nIGV0IHVuZSB6b25lLlwiLFxyXG4vLyAgICAgICBcIndhcm5pbmdcIlxyXG4vLyAgICAgKTtcclxuLy8gICB9XHJcbi8vIH0pO1xyXG5cclxuc3ludGhlc2lzQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBkb3dubG9hZERvY3VtZW50KTtcclxuXHJcbi8vID09PSBJbml0aWFsaXNhdGlvbiA9PT1cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBJbml0aWFsaXplIGRlbGV0aW9uIGd1YXJkIGZpcnN0IChibG9ja3MgYWNjZXNzIGlmIG5lZWRlZClcclxuICAgIGNvbnN0IGNhbkFjY2VzcyA9IGF3YWl0IGluaXREZWxldGlvbkd1YXJkKGZhbHNlKTtcclxuICAgIGlmICghY2FuQWNjZXNzKSB7XHJcbiAgICAgIHJldHVybjsgLy8gQWNjZXNzIHdhcyBibG9ja2VkLCBzdG9wIGluaXRpYWxpemF0aW9uXHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBoZWFkZXIgYXV0aGVudGljYXRpb24gZmlyc3RcclxuICAgIGluaXRIZWFkZXJBdXRoKCk7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBVSSBzdGF0ZVxyXG4gICAgcmVzZXRTZWxlY3QoY2l0eVNlbGVjdCwgXCJDaGFyZ2VtZW50Li4uXCIpO1xyXG4gICAgcmVzZXRTZWxlY3Qoem9uaW5nU2VsZWN0LCBcIlPDqWxlY3Rpb25uZXogZCdhYm9yZCB1bmUgdmlsbGVcIik7XHJcbiAgICByZXNldFNlbGVjdCh6b25lU2VsZWN0LCBcIlPDqWxlY3Rpb25uZXogZCdhYm9yZCB1biB6b25hZ2VcIik7XHJcbiAgICAvLyByZXNldFNlbGVjdCh0eXBvbG9naWVTZWxlY3QsIFwiU8OpbGVjdGlvbm5leiBkJ2Fib3JkIHVuZSB6b25lXCIpO1xyXG4gICAgaWYgKHN5bnRoZXNpc0J0bikgc3ludGhlc2lzQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuXHJcbiAgICAvLyBMb2FkIGluaXRpYWwgZGF0YSBpZiBvbiB0aGUgbWFpbiBwYWdlXHJcbiAgICBpZiAoY2l0eVNlbGVjdCAmJiB6b25pbmdTZWxlY3QgJiYgem9uZVNlbGVjdCkge1xyXG4gICAgICBzaG93U3RhdHVzKFwiSW5pdGlhbGlzYXRpb24uLi5cIiwgXCJpbmZvXCIpOyAvLyBTaG93IHRoaXMgb25seSB3aGVuIHJlbGV2YW50IHNlbGVjdG9ycyBhcmUgcHJlc2VudFxyXG4gICAgICBhd2FpdCBsb2FkQ2l0aWVzKCk7IC8vIFN0YXJ0IGxvYWRpbmcgY2l0aWVzXHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbml0aWFsaXppbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEV4cG9ydCBjdXJyZW50VXNlciBmb3IgdXNlIGluIGFwaS5qc1xyXG5leHBvcnQgeyBjdXJyZW50VXNlciB9O1xyXG4iLCIvLyBwdWJsaWMvanMvdWkuanNcclxuLyoqXHJcbiAqIFVJIE1vZHVsZVxyXG4gKiBAbW9kdWxlIHVpXHJcbiAqIEBkZXNjcmlwdGlvbiBVcGdyYWRlZCBVSSBtb2R1bGUgd2l0aCBlbmhhbmNlZCBjb21wb25lbnRzIGFuZCBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbiAqIEB2ZXJzaW9uIDAuMS4wXHJcbiAqIEBhdXRob3IgR3JleVBhbmRhXHJcbiAqXHJcbiAqIEBjaGFuZ2Vsb2dcclxuICogLSAwLjEuMCAoMjAyNS0wMS0yOSk6IE1ham9yIHJlZmFjdG9yIHdpdGggZW5oYW5jZWQgY29tcG9uZW50cyBhbmQgc3RhdGUgbWFuYWdlbWVudCBpbnRlZ3JhdGlvblxyXG4gKiAtIDAuMC4xICgyMDI1LTA0LTI2KTogSW5pdGlhbCB2ZXJzaW9uIHdpdGggYmFzaWMgVUkgZnVuY3Rpb25zIGFuZCBlbGVtZW50IHJlZmVyZW5jZXNcclxuICovXHJcblxyXG5pbXBvcnQgeyB6b25lTmFtZU1hcHBpbmdzIH0gZnJvbSBcIi4vbWFwcGluZ3MuanNcIjtcclxuXHJcbi8vIFNpbXBsZSBmYWxsYmFja3MgZm9yIGVuaGFuY2VkIGZlYXR1cmVzXHJcbmNvbnN0IFVJQ29tcG9uZW50cyA9IHtcclxuICBzaG93VG9hc3Q6IChtZXNzYWdlLCB0eXBlKSA9PiBjb25zb2xlLmxvZyhgVG9hc3Q6ICR7bWVzc2FnZX0gKCR7dHlwZX0pYCksXHJcbn07XHJcblxyXG5jb25zdCBzdGF0ZU1hbmFnZXIgPSB7XHJcbiAgc2V0VUlTdGF0ZTogKCkgPT4ge30sXHJcbiAgc2V0TG9hZGluZzogKCkgPT4ge30sXHJcbn07XHJcblxyXG4vLyAtLS0gRW5oYW5jZWQgRE9NIEVsZW1lbnQgTWFuYWdlbWVudCAtLS1cclxuY2xhc3MgRE9NRWxlbWVudHMge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5lbGVtZW50cyA9IG5ldyBNYXAoKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZUVsZW1lbnRzKCk7XHJcbiAgfVxyXG5cclxuICBpbml0aWFsaXplRWxlbWVudHMoKSB7XHJcbiAgICAvLyBGb3JtIGVsZW1lbnRzXHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwiY2l0eVNlbGVjdFwiLCBcImNpdHlTZWxlY3RcIik7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwiem9uaW5nU2VsZWN0XCIsIFwiem9uaW5nU2VsZWN0XCIpO1xyXG4gICAgdGhpcy5yZWdpc3RlcihcInpvbmVTZWxlY3RcIiwgXCJ6b25lU2VsZWN0XCIpO1xyXG4gICAgdGhpcy5yZWdpc3RlcihcInR5cG9sb2dpZVNlbGVjdFwiLCBcInR5cG9sb2dpZVNlbGVjdFwiKTtcclxuICAgIHRoaXMucmVnaXN0ZXIoXCJzeW50aGVzaXNCdG5cIiwgXCJzeW50aGVzaXNCdG5cIik7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwic3RhdHVzTWVzc2FnZVwiLCBcInN0YXR1c01lc3NhZ2VcIik7XHJcblxyXG4gICAgLy8gU3Bpbm5lciBlbGVtZW50c1xyXG4gICAgdGhpcy5yZWdpc3RlcihcImNpdHlTcGlubmVyXCIsIFwiY2l0eVNwaW5uZXJcIik7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwiem9uaW5nU3Bpbm5lclwiLCBcInpvbmluZ1NwaW5uZXJcIik7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwiem9uZVNwaW5uZXJcIiwgXCJ6b25lU3Bpbm5lclwiKTtcclxuICAgIHRoaXMucmVnaXN0ZXIoXCJ0eXBvbG9naWVTcGlubmVyXCIsIFwidHlwb2xvZ2llU3Bpbm5lclwiKTtcclxuICAgIHRoaXMucmVnaXN0ZXIoXCJkb2N1bWVudFNwaW5uZXJcIiwgXCJkb2N1bWVudFNwaW5uZXJcIik7XHJcblxyXG4gICAgLy8gQXV0aCBlbGVtZW50c1xyXG4gICAgdGhpcy5yZWdpc3RlcihcInVzZXJTdGF0dXNcIiwgXCJ1c2VyU3RhdHVzXCIpO1xyXG4gICAgdGhpcy5yZWdpc3RlcihcImxvZ291dEJ0blwiLCBcImxvZ291dEJ0blwiKTtcclxuICAgIHRoaXMucmVnaXN0ZXIoXCJsb2dpbkxpbmtcIiwgXCJsb2dpbkxpbmtcIik7XHJcbiAgICB0aGlzLnJlZ2lzdGVyKFwic2lnbnVwTGlua1wiLCBcInNpZ251cExpbmtcIik7XHJcbiAgfVxyXG5cclxuICByZWdpc3RlcihuYW1lLCBpZCkge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudHMuc2V0KG5hbWUsIGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0KG5hbWUpIHtcclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmdldChuYW1lKSB8fCBudWxsO1xyXG4gIH1cclxuXHJcbiAgZXhpc3RzKG5hbWUpIHtcclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmhhcyhuYW1lKSAmJiB0aGlzLmVsZW1lbnRzLmdldChuYW1lKSAhPT0gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbi8vIENyZWF0ZSBzaW5nbGV0b24gaW5zdGFuY2VcclxuY29uc3QgZG9tRWxlbWVudHMgPSBuZXcgRE9NRWxlbWVudHMoKTtcclxuXHJcbi8vIC0tLSBFbmhhbmNlZCBVSSBGdW5jdGlvbnMgLS0tXHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgc3RhdHVzIG1lc3NhZ2UgZGlzcGxheSB3aXRoIHRvYXN0IGludGVncmF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBzaG93U3RhdHVzKG1lc3NhZ2UsIHR5cGUgPSBcImluZm9cIikge1xyXG4gIGNvbnN0IHN0YXR1c0VsZW1lbnQgPSBkb21FbGVtZW50cy5nZXQoXCJzdGF0dXNNZXNzYWdlXCIpO1xyXG5cclxuICBpZiAoc3RhdHVzRWxlbWVudCkge1xyXG4gICAgLy8gVXBkYXRlIHRoZSBleGlzdGluZyBzdGF0dXMgbWVzc2FnZSBlbGVtZW50XHJcbiAgICBzdGF0dXNFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcclxuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NOYW1lID0gYHN0YXR1cy1tZXNzYWdlIGFsZXJ0IGFsZXJ0LSR7dHlwZX1gO1xyXG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gQWxzbyBzaG93IGEgdG9hc3QgZm9yIGJldHRlciBVWCAob3B0aW9uYWwsIGNhbiBiZSBkaXNhYmxlZClcclxuICBpZiAodHlwZSA9PT0gXCJlcnJvclwiIHx8IHR5cGUgPT09IFwid2FybmluZ1wiKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBVSUNvbXBvbmVudHMuc2hvd1RvYXN0KG1lc3NhZ2UsIHR5cGUsIDgwMDApOyAvLyBMb25nZXIgZHVyYXRpb24gZm9yIGVycm9yc1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiVG9hc3Qgbm90IGF2YWlsYWJsZTpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIHN0YXRlXHJcbiAgdHJ5IHtcclxuICAgIHN0YXRlTWFuYWdlci5zZXRVSVN0YXRlKHR5cGUsIG1lc3NhZ2UpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJTdGF0ZSBtYW5hZ2VyIG5vdCBhdmFpbGFibGU6XCIsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBzcGlubmVyIG1hbmFnZW1lbnQgd2l0aCBmYWxsYmFja1xyXG4gKi9cclxuZnVuY3Rpb24gdG9nZ2xlU3Bpbm5lcihlbGVtZW50TmFtZSwgc2hvdykge1xyXG4gIGNvbnN0IHNwaW5uZXJFbGVtZW50ID1cclxuICAgIHR5cGVvZiBlbGVtZW50TmFtZSA9PT0gXCJzdHJpbmdcIlxyXG4gICAgICA/IGRvbUVsZW1lbnRzLmdldChlbGVtZW50TmFtZSlcclxuICAgICAgOiBlbGVtZW50TmFtZTtcclxuXHJcbiAgaWYgKHNwaW5uZXJFbGVtZW50KSB7XHJcbiAgICBzcGlubmVyRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiZC1ub25lXCIsICFzaG93KTtcclxuICAgIHNwaW5uZXJFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIiwgIXNob3cpO1xyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIGdsb2JhbCBsb2FkaW5nIHN0YXRlXHJcbiAgdHJ5IHtcclxuICAgIHN0YXRlTWFuYWdlci5zZXRMb2FkaW5nKHNob3cpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJTdGF0ZSBtYW5hZ2VyIG5vdCBhdmFpbGFibGU6XCIsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBzZWxlY3QgcmVzZXQgd2l0aCBiZXR0ZXIgVVhcclxuICovXHJcbmZ1bmN0aW9uIHJlc2V0U2VsZWN0KHNlbGVjdEVsZW1lbnQsIGRlZmF1bHRUZXh0KSB7XHJcbiAgY29uc3QgZWxlbWVudCA9XHJcbiAgICB0eXBlb2Ygc2VsZWN0RWxlbWVudCA9PT0gXCJzdHJpbmdcIlxyXG4gICAgICA/IGRvbUVsZW1lbnRzLmdldChzZWxlY3RFbGVtZW50KVxyXG4gICAgICA6IHNlbGVjdEVsZW1lbnQ7XHJcblxyXG4gIGlmIChlbGVtZW50KSB7XHJcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IGA8b3B0aW9uIHZhbHVlPVwiXCI+JHtcclxuICAgICAgZGVmYXVsdFRleHQgfHwgXCJTw6lsZWN0aW9ubmV6IHVuZSBvcHRpb25cIlxyXG4gICAgfTwvb3B0aW9uPmA7XHJcbiAgICBlbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImVycm9yXCIpOyAvLyBSZW1vdmUgYW55IGVycm9yIHN0YXRlXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgbmFtZSBmb3JtYXR0aW5nIHdpdGggYmV0dGVyIFVuaWNvZGUgc3VwcG9ydFxyXG4gKi9cclxuZnVuY3Rpb24gZm9ybWF0QXBpTmFtZShuYW1lKSB7XHJcbiAgaWYgKCFuYW1lKSByZXR1cm4gXCJcIjtcclxuXHJcbiAgcmV0dXJuIG5hbWVcclxuICAgIC5yZXBsYWNlKC9fL2csIFwiIFwiKVxyXG4gICAgLnJlcGxhY2UoL1xcYlxcdy9nLCAoY2hhcikgPT4gY2hhci50b1VwcGVyQ2FzZSgpKVxyXG4gICAgLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIHNlbGVjdCBwb3B1bGF0aW9uIHdpdGggZXJyb3IgaGFuZGxpbmcgYW5kIGFuaW1hdGlvbnNcclxuICovXHJcbmZ1bmN0aW9uIHBvcHVsYXRlU2VsZWN0KFxyXG4gIHNlbGVjdEVsZW1lbnQsXHJcbiAgZGF0YSxcclxuICBkZWZhdWx0T3B0aW9uVGV4dCxcclxuICBlbXB0eURhdGFUZXh0LFxyXG4gIGRhdGFUeXBlXHJcbikge1xyXG4gIGNvbnN0IGVsZW1lbnQgPVxyXG4gICAgdHlwZW9mIHNlbGVjdEVsZW1lbnQgPT09IFwic3RyaW5nXCJcclxuICAgICAgPyBkb21FbGVtZW50cy5nZXQoc2VsZWN0RWxlbWVudClcclxuICAgICAgOiBzZWxlY3RFbGVtZW50O1xyXG5cclxuICBpZiAoIWVsZW1lbnQpIHtcclxuICAgIGNvbnNvbGUud2FybihgU2VsZWN0IGVsZW1lbnQgbm90IGZvdW5kOiAke3NlbGVjdEVsZW1lbnR9YCk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBSZXNldCBmaXJzdFxyXG4gIHJlc2V0U2VsZWN0KGVsZW1lbnQsIGRlZmF1bHRPcHRpb25UZXh0KTtcclxuXHJcbiAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IGA8b3B0aW9uIHZhbHVlPVwiXCI+JHtlbXB0eURhdGFUZXh0fTwvb3B0aW9uPmA7XHJcbiAgICBlbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIENyZWF0ZSBkb2N1bWVudCBmcmFnbWVudCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXHJcbiAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gIC8vIEFkZCBkZWZhdWx0IG9wdGlvblxyXG4gIGNvbnN0IGRlZmF1bHRPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG4gIGRlZmF1bHRPcHRpb24udmFsdWUgPSBcIlwiO1xyXG4gIGRlZmF1bHRPcHRpb24udGV4dENvbnRlbnQgPSBkZWZhdWx0T3B0aW9uVGV4dDtcclxuICBkZWZhdWx0T3B0aW9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICBkZWZhdWx0T3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcclxuICBmcmFnbWVudC5hcHBlbmRDaGlsZChkZWZhdWx0T3B0aW9uKTtcclxuXHJcbiAgLy8gQWRkIGRhdGEgb3B0aW9uc1xyXG4gIGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgIG9wdGlvbi52YWx1ZSA9IGl0ZW0uaWQ7XHJcblxyXG4gICAgLy8gRW5oYW5jZWQgZm9ybWF0dGluZyBsb2dpY1xyXG4gICAgbGV0IGRpc3BsYXlUZXh0ID0gXCJcIjtcclxuICAgIGlmIChkYXRhVHlwZSA9PT0gXCJ6b25lXCIgJiYgem9uZU5hbWVNYXBwaW5ncy5oYXNPd25Qcm9wZXJ0eShpdGVtLm5hbWUpKSB7XHJcbiAgICAgIGRpc3BsYXlUZXh0ID0gem9uZU5hbWVNYXBwaW5nc1tpdGVtLm5hbWVdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGlzcGxheVRleHQgPSBmb3JtYXRBcGlOYW1lKGl0ZW0ubmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gZGlzcGxheVRleHQ7XHJcbiAgICBvcHRpb24uc2V0QXR0cmlidXRlKFwiZGF0YS1yYXctbmFtZVwiLCBpdGVtLm5hbWUpOyAvLyBTdG9yZSBvcmlnaW5hbCBuYW1lXHJcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChvcHRpb24pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBVcGRhdGUgRE9NIGluIG9uZSBvcGVyYXRpb25cclxuICBlbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XHJcbiAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcbiAgZWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAvLyBBZGQgZmFkZS1pbiBhbmltYXRpb25cclxuICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJmYWRlLWluXCIpO1xyXG5cclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLy8gLS0tIEVuaGFuY2VkIEhlbHBlciBGdW5jdGlvbnMgLS0tXHJcblxyXG4vKipcclxuICogQ3JlYXRlIGVuaGFuY2VkIGZvcm0gZmllbGQgd2l0aCB2YWxpZGF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVFbmhhbmNlZEZpZWxkKGNvbmZpZykge1xyXG4gIGNvbnNvbGUud2FybihcIkVuaGFuY2VkIGZpZWxkIGNyZWF0aW9uIG5vdCBhdmFpbGFibGUgaW4gZmFsbGJhY2sgbW9kZVwiKTtcclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEJhdGNoIHVwZGF0ZSBtdWx0aXBsZSBzZWxlY3RzIGVmZmljaWVudGx5XHJcbiAqL1xyXG5mdW5jdGlvbiB1cGRhdGVTZWxlY3RTdGF0ZXModXBkYXRlcykge1xyXG4gIHVwZGF0ZXMuZm9yRWFjaCgoeyBlbGVtZW50LCBkYXRhLCBjb25maWcgfSkgPT4ge1xyXG4gICAgcG9wdWxhdGVTZWxlY3QoXHJcbiAgICAgIGVsZW1lbnQsXHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIGNvbmZpZy5kZWZhdWx0VGV4dCxcclxuICAgICAgY29uZmlnLmVtcHR5VGV4dCxcclxuICAgICAgY29uZmlnLmRhdGFUeXBlXHJcbiAgICApO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgZXJyb3IgZGlzcGxheSB3aXRoIGJldHRlciBVWFxyXG4gKi9cclxuZnVuY3Rpb24gc2hvd0ZpZWxkRXJyb3IoZmllbGROYW1lLCBlcnJvcikge1xyXG4gIGNvbnN0IGZpZWxkID0gZG9tRWxlbWVudHMuZ2V0KGZpZWxkTmFtZSk7XHJcbiAgaWYgKGZpZWxkKSB7XHJcbiAgICBmaWVsZC5jbGFzc0xpc3QuYWRkKFwiZXJyb3JcIik7XHJcblxyXG4gICAgLy8gU2hvdyBlcnJvciBtZXNzYWdlXHJcbiAgICBsZXQgZXJyb3JFbGVtZW50ID0gZmllbGQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKFwiLmZpZWxkLWVycm9yXCIpO1xyXG4gICAgaWYgKCFlcnJvckVsZW1lbnQpIHtcclxuICAgICAgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTmFtZSA9IFwiZmllbGQtZXJyb3JcIjtcclxuICAgICAgZmllbGQucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChlcnJvckVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgZmllbGQgZXJyb3Igc3RhdGVcclxuICovXHJcbmZ1bmN0aW9uIGNsZWFyRmllbGRFcnJvcihmaWVsZE5hbWUpIHtcclxuICBjb25zdCBmaWVsZCA9IGRvbUVsZW1lbnRzLmdldChmaWVsZE5hbWUpO1xyXG4gIGlmIChmaWVsZCkge1xyXG4gICAgZmllbGQuY2xhc3NMaXN0LnJlbW92ZShcImVycm9yXCIpO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZmllbGQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKFwiLmZpZWxkLWVycm9yXCIpO1xyXG4gICAgaWYgKGVycm9yRWxlbWVudCkge1xyXG4gICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBCYWNrd2FyZCBDb21wYXRpYmlsaXR5IExheWVyIC0tLVxyXG4vLyBFeHBvcnQgaW5kaXZpZHVhbCBlbGVtZW50cyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG5jb25zdCBjaXR5U2VsZWN0ID0gZG9tRWxlbWVudHMuZ2V0KFwiY2l0eVNlbGVjdFwiKTtcclxuY29uc3Qgem9uaW5nU2VsZWN0ID0gZG9tRWxlbWVudHMuZ2V0KFwiem9uaW5nU2VsZWN0XCIpO1xyXG5jb25zdCB6b25lU2VsZWN0ID0gZG9tRWxlbWVudHMuZ2V0KFwiem9uZVNlbGVjdFwiKTtcclxuY29uc3QgdHlwb2xvZ2llU2VsZWN0ID0gZG9tRWxlbWVudHMuZ2V0KFwidHlwb2xvZ2llU2VsZWN0XCIpO1xyXG5jb25zdCBzeW50aGVzaXNCdG4gPSBkb21FbGVtZW50cy5nZXQoXCJzeW50aGVzaXNCdG5cIik7XHJcbmNvbnN0IHN0YXR1c01lc3NhZ2UgPSBkb21FbGVtZW50cy5nZXQoXCJzdGF0dXNNZXNzYWdlXCIpO1xyXG5cclxuY29uc3QgY2l0eVNwaW5uZXIgPSBkb21FbGVtZW50cy5nZXQoXCJjaXR5U3Bpbm5lclwiKTtcclxuY29uc3Qgem9uaW5nU3Bpbm5lciA9IGRvbUVsZW1lbnRzLmdldChcInpvbmluZ1NwaW5uZXJcIik7XHJcbmNvbnN0IHpvbmVTcGlubmVyID0gZG9tRWxlbWVudHMuZ2V0KFwiem9uZVNwaW5uZXJcIik7XHJcbmNvbnN0IHR5cG9sb2dpZVNwaW5uZXIgPSBkb21FbGVtZW50cy5nZXQoXCJ0eXBvbG9naWVTcGlubmVyXCIpO1xyXG5jb25zdCBkb2N1bWVudFNwaW5uZXIgPSBkb21FbGVtZW50cy5nZXQoXCJkb2N1bWVudFNwaW5uZXJcIik7XHJcblxyXG5jb25zdCB1c2VyU3RhdHVzID0gZG9tRWxlbWVudHMuZ2V0KFwidXNlclN0YXR1c1wiKTtcclxuY29uc3QgbG9nb3V0QnRuID0gZG9tRWxlbWVudHMuZ2V0KFwibG9nb3V0QnRuXCIpO1xyXG5jb25zdCBsb2dpbkxpbmsgPSBkb21FbGVtZW50cy5nZXQoXCJsb2dpbkxpbmtcIik7XHJcbmNvbnN0IHNpZ251cExpbmsgPSBkb21FbGVtZW50cy5nZXQoXCJzaWdudXBMaW5rXCIpO1xyXG5cclxuLy8gLS0tIEVuaGFuY2VkIEV4cG9ydHMgLS0tXHJcbmV4cG9ydCB7XHJcbiAgLy8gQmFja3dhcmQgY29tcGF0aWJpbGl0eSAtIGluZGl2aWR1YWwgZWxlbWVudHNcclxuICBjaXR5U2VsZWN0LFxyXG4gIHpvbmluZ1NlbGVjdCxcclxuICB6b25lU2VsZWN0LFxyXG4gIHR5cG9sb2dpZVNlbGVjdCxcclxuICBzeW50aGVzaXNCdG4sXHJcbiAgc3RhdHVzTWVzc2FnZSxcclxuICBjaXR5U3Bpbm5lcixcclxuICB6b25pbmdTcGlubmVyLFxyXG4gIHpvbmVTcGlubmVyLFxyXG4gIHR5cG9sb2dpZVNwaW5uZXIsXHJcbiAgZG9jdW1lbnRTcGlubmVyLFxyXG4gIHVzZXJTdGF0dXMsXHJcbiAgbG9nb3V0QnRuLFxyXG4gIGxvZ2luTGluayxcclxuICBzaWdudXBMaW5rLFxyXG5cclxuICAvLyBFbmhhbmNlZCBmdW5jdGlvbnNcclxuICBzaG93U3RhdHVzLFxyXG4gIHRvZ2dsZVNwaW5uZXIsXHJcbiAgcmVzZXRTZWxlY3QsXHJcbiAgZm9ybWF0QXBpTmFtZSxcclxuICBwb3B1bGF0ZVNlbGVjdCxcclxuXHJcbiAgLy8gTmV3IGVuaGFuY2VkIGZ1bmN0aW9uc1xyXG4gIGNyZWF0ZUVuaGFuY2VkRmllbGQsXHJcbiAgdXBkYXRlU2VsZWN0U3RhdGVzLFxyXG4gIHNob3dGaWVsZEVycm9yLFxyXG4gIGNsZWFyRmllbGRFcnJvcixcclxuXHJcbiAgLy8gRW5oYW5jZWQgZWxlbWVudHMgbWFuYWdlclxyXG4gIGRvbUVsZW1lbnRzLFxyXG5cclxuICAvLyBSZS1leHBvcnQgVUkgY29tcG9uZW50cyBmb3IgY29udmVuaWVuY2VcclxuICBVSUNvbXBvbmVudHMsXHJcbn07XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gKGNodW5rSWQpID0+IHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcImpzL1wiICsgY2h1bmtJZCArIFwiLmNodW5rLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uaiA9IDUyNDsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0MjA5OiAwLFxuXHQ1MjQ6IDBcbn07XG5cbl9fd2VicGFja19yZXF1aXJlX18uZi5qID0gKGNodW5rSWQsIHByb21pc2VzKSA9PiB7XG5cdFx0Ly8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxuXHRcdHZhciBpbnN0YWxsZWRDaHVua0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSA/IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA6IHVuZGVmaW5lZDtcblx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIHsgLy8gMCBtZWFucyBcImFscmVhZHkgaW5zdGFsbGVkXCIuXG5cblx0XHRcdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYodHJ1ZSkgeyAvLyBhbGwgY2h1bmtzIGhhdmUgSlNcblx0XHRcdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiAoaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF0pKTtcblx0XHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSA9IHByb21pc2UpO1xuXG5cdFx0XHRcdFx0Ly8gc3RhcnQgY2h1bmsgbG9hZGluZ1xuXHRcdFx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuXHRcdFx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID0gJ0xvYWRpbmcgY2h1bmsgJyArIGNodW5rSWQgKyAnIGZhaWxlZC5cXG4oJyArIGVycm9yVHlwZSArICc6ICcgKyByZWFsU3JjICsgJyknO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm5hbWUgPSAnQ2h1bmtMb2FkRXJyb3InO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhWzFdKGVycm9yKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG59O1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZihjaHVua0lkcy5zb21lKChpZCkgPT4gKGluc3RhbGxlZENodW5rc1tpZF0gIT09IDApKSkge1xuXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdH1cblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLk8ocmVzdWx0KTtcbn1cblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3Niw2NzFdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXygxOTAwKSkpXG5fX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKF9fd2VicGFja19leHBvcnRzX18pO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibGVhZlByb3RvdHlwZXMiLCJnZXRQcm90byIsImluUHJvZ3Jlc3MiLCJkYXRhV2VicGFja1ByZWZpeCIsImFzeW5jIiwibG9hZENpdGllcyIsImNpdHlTZWxlY3QiLCJnZXQiLCJjaXR5U3Bpbm5lciIsInNldExvYWRpbmciLCJjaXRpZXMiLCJzZXRDaXRpZXMiLCJtZXNzYWdlIiwiZ2V0U3RhdGUiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRTZWxlY3RlZERvY3VtZW50IiwiY3VycmVudFVzZXIiLCJhdXRoIiwib25BdXRoU3RhdGVDaGFuZ2UiLCJldmVudCIsInNlc3Npb24iLCJ1c2VyIiwic2V0VXNlciIsInNlbGVjdGVkRG9jdW1lbnQiLCJpZCIsImRpc2FibGVkIiwic291cmNlX3BsdV9kYXRlIiwidXBkYXRlVUlGb3JBdXRoU3RhdGUiLCJsb2ciLCJyZXNldFNlbGVjdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiY2l0eUlkIiwiem9uaW5nU2VsZWN0Iiwiem9uZVNlbGVjdCIsInpvbmluZ1NwaW5uZXIiLCJzeW50aGVzaXNCdG4iLCJjbGVhclNlbGVjdGVkRG9jdW1lbnQiLCJ6b25pbmdzIiwibG9hZFpvbmluZ3MiLCJsZW5ndGgiLCJzZXRab25pbmdzIiwidGFyZ2V0IiwidmFsdWUiLCJ6b25pbmdJZCIsInpvbmVTcGlubmVyIiwiem9uZXMiLCJsb2FkWm9uZXMiLCJzZXRab25lcyIsInpvbmVJZCIsInR5cG9sb2dpZUlkIiwiZG9jdW1lbnRTcGlubmVyIiwiZG9jdW1lbnQiLCJmaW5kRG9jdW1lbnQiLCJzZXRTZWxlY3RlZERvY3VtZW50Iiwid2luZG93Iiwib3BlbiIsInNldFRpbWVvdXQiLCJVSUNvbXBvbmVudHMiLCJzaG93VG9hc3QiLCJ0eXBlIiwic3RhdGVNYW5hZ2VyIiwic2V0VUlTdGF0ZSIsImRvbUVsZW1lbnRzIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiZWxlbWVudHMiLCJNYXAiLCJpbml0aWFsaXplRWxlbWVudHMiLCJyZWdpc3RlciIsIm5hbWUiLCJlbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzZXQiLCJleGlzdHMiLCJoYXMiLCJzaG93U3RhdHVzIiwic3RhdHVzRWxlbWVudCIsInRleHRDb250ZW50IiwiY2xhc3NOYW1lIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwid2FybiIsInRvZ2dsZVNwaW5uZXIiLCJlbGVtZW50TmFtZSIsInNob3ciLCJzcGlubmVyRWxlbWVudCIsInRvZ2dsZSIsInJlc2V0U2VsZWN0Iiwic2VsZWN0RWxlbWVudCIsImRlZmF1bHRUZXh0IiwiaW5uZXJIVE1MIiwiZm9ybWF0QXBpTmFtZSIsInJlcGxhY2UiLCJjaGFyIiwidG9VcHBlckNhc2UiLCJ0cmltIiwicG9wdWxhdGVTZWxlY3QiLCJkYXRhIiwiZGVmYXVsdE9wdGlvblRleHQiLCJlbXB0eURhdGFUZXh0IiwiZGF0YVR5cGUiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJkZWZhdWx0T3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsInNlbGVjdGVkIiwiYXBwZW5kQ2hpbGQiLCJmb3JFYWNoIiwiaXRlbSIsIm9wdGlvbiIsImRpc3BsYXlUZXh0IiwiaGFzT3duUHJvcGVydHkiLCJzZXRBdHRyaWJ1dGUiLCJhZGQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJtIiwiTyIsInJlc3VsdCIsImNodW5rSWRzIiwiZm4iLCJwcmlvcml0eSIsIm5vdEZ1bGZpbGxlZCIsIkluZmluaXR5IiwiaSIsImZ1bGZpbGxlZCIsImoiLCJPYmplY3QiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJyIiwiZ2V0UHJvdG90eXBlT2YiLCJvYmoiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJ0aGVuIiwibnMiLCJjcmVhdGUiLCJkZWYiLCJjdXJyZW50IiwiaW5kZXhPZiIsImdldE93blByb3BlcnR5TmFtZXMiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJmIiwiZSIsImNodW5rSWQiLCJQcm9taXNlIiwiYWxsIiwicmVkdWNlIiwicHJvbWlzZXMiLCJ1IiwiZyIsImdsb2JhbFRoaXMiLCJGdW5jdGlvbiIsInByb3AiLCJwcm90b3R5cGUiLCJsIiwidXJsIiwiZG9uZSIsInB1c2giLCJzY3JpcHQiLCJuZWVkQXR0YWNoIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicyIsImdldEF0dHJpYnV0ZSIsImNoYXJzZXQiLCJ0aW1lb3V0IiwibmMiLCJzcmMiLCJvblNjcmlwdENvbXBsZXRlIiwicHJldiIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiYmluZCIsImhlYWQiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInAiLCJpbnN0YWxsZWRDaHVua3MiLCJpbnN0YWxsZWRDaHVua0RhdGEiLCJwcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIkVycm9yIiwiZXJyb3JUeXBlIiwicmVhbFNyYyIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==