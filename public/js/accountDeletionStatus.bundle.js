(()=>{"use strict";var e,t,n,o,r,i={3688:(e,t,n)=>{var o=n(9660),r=n(3715),i=n(2387);let a=null,s=null,d=null;async function c(){try{if(!await(0,i.Kv)(!0))return;if(!await(0,r.z6)())return;if(a=await(0,r.HW)(),!a)return void(window.location.href="/auth/login");await async function(){try{document.getElementById("loading-state").style.display="flex",document.getElementById("main-content").style.display="none",document.getElementById("error-state").style.display="none";const{data:e}=await o.N.auth.getSession();if(!e?.session?.access_token)throw new Error("No valid session");const t=await fetch(`${o.N.supabaseUrl}/functions/v1/account-management`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.session.access_token}`},body:JSON.stringify({action:"status"})}),n=await t.json();if(!n.success)throw new Error(n.error||"Failed to get deletion status");if(s=n.data,!s.deletion_scheduled)return void(window.location.href="/user/profile");if(s.time_remaining_seconds<=0)return void function(){f();const e=document.getElementById("main-content");e&&(e.innerHTML='\n      <div class="container">\n        <div class="deletion-status-card">\n          <div class="deletion-header">\n            <div class="deletion-icon">\n              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <circle cx="12" cy="12" r="10"></circle>\n                <line x1="15" y1="9" x2="9" y2="15"></line>\n                <line x1="9" y1="9" x2="15" y2="15"></line>\n              </svg>\n            </div>\n            <h1>Compte supprimé</h1>\n          </div>\n          \n          <div class="deletion-details">\n            <p class="deletion-message">\n              Votre compte a été définitivement supprimé.\n            </p>\n            <p class="deletion-warning">\n              Toutes vos données ont été effacées de nos serveurs.\n            </p>\n          </div>\n          \n          <div class="deletion-actions">\n            <button id="logout-btn" class="btn btn-primary">\n              Retour à l\'accueil\n            </button>\n          </div>\n        </div>\n      </div>\n    ',document.getElementById("logout-btn").addEventListener("click",(async()=>{await o.N.auth.signOut(),window.location.href="/"})),e.style.display="block"),setTimeout((async()=>{await o.N.auth.signOut(),window.location.href="/"}),5e3)}();!function(){const e=new Date(s.deletion_scheduled_for).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});if(document.getElementById("deletion-date").textContent=e,s.deletion_reason&&"User requested account deletion"!==s.deletion_reason){const e=document.getElementById("deletion-reason-container");document.getElementById("deletion-reason").textContent=s.deletion_reason,e.style.display="block"}l()}(),l(),d=setInterval(l,1e3),f()}catch(e){console.error("Error loading deletion status:",e),y("Erreur lors du chargement du statut de suppression")}}(),function(){const e=document.getElementById("cancel-deletion-btn");e&&e.addEventListener("click",u);const t=document.getElementById("logout-btn");t&&t.addEventListener("click",m)}(),await async function(){try{document.getElementById("footer-placeholder")&&window.loadFooter&&await window.loadFooter()}catch(e){console.warn("Could not load footer:",e)}}()}catch(e){console.error("Error initializing account deletion status page:",e),y("Erreur lors du chargement de la page")}}function l(){const e=new Date,t=new Date(s.deletion_scheduled_for).getTime()-e.getTime();if(t<=0){document.getElementById("days-remaining").textContent="0",document.getElementById("hours-remaining").textContent="0",d&&clearInterval(d),g("Votre compte a été supprimé.","error");const e=document.getElementById("cancel-deletion-btn");return e&&(e.disabled=!0,e.textContent="Compte supprimé"),void setTimeout((async()=>{await o.N.auth.signOut(),window.location.href="/"}),3e3)}const n=Math.floor(t/1e3),r=Math.floor(n/60),i=n%60;document.getElementById("days-remaining").textContent=r.toString(),document.getElementById("hours-remaining").textContent=i.toString();const a=document.querySelector(".countdown-item:first-child .countdown-label"),c=document.querySelector(".countdown-item:last-child .countdown-label");a&&(a.textContent="minutes"),c&&(c.textContent="secondes")}async function u(){if(confirm("Êtes-vous sûr de vouloir annuler la suppression de votre compte ?"))try{const e=document.getElementById("cancel-deletion-btn");e.textContent,e.textContent="Annulation...",e.disabled=!0;const{data:t}=await o.N.auth.getSession();if(!t?.session?.access_token)throw new Error("No valid session");const n=await fetch(`${o.N.supabaseUrl}/functions/v1/account-management`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.session.access_token}`},body:JSON.stringify({action:"cancel"})}),r=await n.json();if(!r.success)throw new Error(r.error||"Failed to cancel deletion");g("Suppression de compte annulée avec succès !","success"),setTimeout((()=>{window.location.href="/user/profile"}),2e3)}catch(e){console.error("Error canceling deletion:",e),g("Erreur lors de l'annulation de la suppression","error");const t=document.getElementById("cancel-deletion-btn");t.textContent="Annuler la suppression",t.disabled=!1}}async function m(){try{await o.N.auth.signOut(),window.location.href="/"}catch(e){console.error("Error during logout:",e),window.location.href="/"}}function f(){document.getElementById("loading-state").style.display="none",document.getElementById("main-content").style.display="block",document.getElementById("error-state").style.display="none"}function y(e){document.getElementById("loading-state").style.display="none",document.getElementById("main-content").style.display="none",document.getElementById("error-state").style.display="flex",document.getElementById("error-message").textContent=e}function g(e,t="info"){const n=document.getElementById("status-message");n&&(n.textContent=e,n.className=`status-message ${t}`,n.classList.remove("hidden"),"success"===t&&setTimeout((()=>{n.classList.add("hidden")}),5e3))}window.addEventListener("beforeunload",(function(){d&&(clearInterval(d),d=null)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return i[e].call(n.exports,n,n.exports,s),n.exports}s.m=i,e=[],s.O=(t,n,o,r)=>{if(!n){var i=1/0;for(l=0;l<e.length;l++){for(var[n,o,r]=e[l],a=!0,d=0;d<n.length;d++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](n[d])))?n.splice(d--,1):(a=!1,r<i&&(i=r));if(a){e.splice(l--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,o,r]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);s.r(r);var i={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(r,i),r},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>"js/"+e+".chunk.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},r="urbandocs_webapp:",s.l=(e,t,n,i)=>{if(o[e])o[e].push(t);else{var a,d;if(void 0!==n)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+n){a=u;break}}a||(d=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+n),a.src=e),o[e]=[t];var m=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=m.bind(null,a.onerror),a.onload=m.bind(null,a.onload),d&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=368,s.p="/",(()=>{var e={368:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",a.name="ChunkLoadError",a.type=r,a.request=i,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,a,d]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(d)var l=d(s)}for(t&&t(n);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(l)},n=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var d=s.O(void 0,[76],(()=>s(3688)));d=s.O(d)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RVMsRUFBSzhCLEdBQTBDLElBQTdCNEMsRUFBZ0I1QyxHQUd4RCxJQUFJcUQsRUFBdUIsQ0FBQ0MsRUFBNEJ2TCxLQUN2RCxJQUdJa0YsRUFBVStDLEdBSFR0QyxFQUFVNkYsRUFBYUMsR0FBV3pMLEVBR2hCZ0csRUFBSSxFQUMzQixHQUFHTCxFQUFTK0YsTUFBTUMsR0FBZ0MsSUFBeEJkLEVBQWdCYyxLQUFhLENBQ3RELElBQUl6RyxLQUFZc0csRUFDWnZHLEVBQW9CMEMsRUFBRTZELEVBQWF0RyxLQUNyQ0QsRUFBb0JRLEVBQUVQLEdBQVlzRyxFQUFZdEcsSUFHaEQsR0FBR3VHLEVBQVMsSUFBSXpLLEVBQVN5SyxFQUFReEcsRUFDbEMsQ0FFQSxJQURHc0csR0FBNEJBLEVBQTJCdkwsR0FDckRnRyxFQUFJTCxFQUFTTSxPQUFRRCxJQUN6QmlDLEVBQVV0QyxFQUFTSyxHQUNoQmYsRUFBb0IwQyxFQUFFa0QsRUFBaUI1QyxJQUFZNEMsRUFBZ0I1QyxJQUNyRTRDLEVBQWdCNUMsR0FBUyxLQUUxQjRDLEVBQWdCNUMsR0FBVyxFQUU1QixPQUFPaEQsRUFBb0JTLEVBQUUxRSxJQUcxQjRLLEVBQXFCQyxLQUFtQyw2QkFBSUEsS0FBbUMsOEJBQUssR0FDeEdELEVBQW1CcEUsUUFBUThELEVBQXFCaEIsS0FBSyxLQUFNLElBQzNEc0IsRUFBbUI1QyxLQUFPc0MsRUFBcUJoQixLQUFLLEtBQU1zQixFQUFtQjVDLEtBQUtzQixLQUFLc0IsRyxLQ2xGdkYsSUFBSUUsRUFBc0I3RyxFQUFvQlMsT0FBRU4sRUFBVyxDQUFDLEtBQUssSUFBT0gsRUFBb0IsUUFDNUY2RyxFQUFzQjdHLEVBQW9CUyxFQUFFb0csRSIsInNvdXJjZXMiOlsid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9jcmVhdGUgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2xvYWQgc2NyaXB0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYWNjb3VudC1kZWxldGlvbi1zdGF0dXMuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9lbnRyaWVzL2FjY291bnQtZGVsZXRpb24tc3RhdHVzLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZW5zdXJlIGNodW5rIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL3J1bnRpbWVJZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0dmFyIHIgPSBmbigpO1xuXHRcdFx0aWYgKHIgIT09IHVuZGVmaW5lZCkgcmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwidmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mID8gKG9iaikgPT4gKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopKSA6IChvYmopID0+IChvYmouX19wcm90b19fKTtcbnZhciBsZWFmUHJvdG90eXBlcztcbi8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLy8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4vLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbi8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLy8gbW9kZSAmIDE2OiByZXR1cm4gdmFsdWUgd2hlbiBpdCdzIFByb21pc2UtbGlrZVxuLy8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuX193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcblx0aWYobW9kZSAmIDEpIHZhbHVlID0gdGhpcyh2YWx1ZSk7XG5cdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG5cdGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUpIHtcblx0XHRpZigobW9kZSAmIDQpICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcblx0XHRpZigobW9kZSAmIDE2KSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHZhbHVlO1xuXHR9XG5cdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG5cdHZhciBkZWYgPSB7fTtcblx0bGVhZlByb3RvdHlwZXMgPSBsZWFmUHJvdG90eXBlcyB8fCBbbnVsbCwgZ2V0UHJvdG8oe30pLCBnZXRQcm90byhbXSksIGdldFByb3RvKGdldFByb3RvKV07XG5cdGZvcih2YXIgY3VycmVudCA9IG1vZGUgJiAyICYmIHZhbHVlOyB0eXBlb2YgY3VycmVudCA9PSAnb2JqZWN0JyAmJiAhfmxlYWZQcm90b3R5cGVzLmluZGV4T2YoY3VycmVudCk7IGN1cnJlbnQgPSBnZXRQcm90byhjdXJyZW50KSkge1xuXHRcdE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGN1cnJlbnQpLmZvckVhY2goKGtleSkgPT4gKGRlZltrZXldID0gKCkgPT4gKHZhbHVlW2tleV0pKSk7XG5cdH1cblx0ZGVmWydkZWZhdWx0J10gPSAoKSA9PiAodmFsdWUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGRlZik7XG5cdHJldHVybiBucztcbn07IiwidmFyIGluUHJvZ3Jlc3MgPSB7fTtcbnZhciBkYXRhV2VicGFja1ByZWZpeCA9IFwidXJiYW5kb2NzX3dlYmFwcDpcIjtcbi8vIGxvYWRTY3JpcHQgZnVuY3Rpb24gdG8gbG9hZCBhIHNjcmlwdCB2aWEgc2NyaXB0IHRhZ1xuX193ZWJwYWNrX3JlcXVpcmVfXy5sID0gKHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSA9PiB7XG5cdGlmKGluUHJvZ3Jlc3NbdXJsXSkgeyBpblByb2dyZXNzW3VybF0ucHVzaChkb25lKTsgcmV0dXJuOyB9XG5cdHZhciBzY3JpcHQsIG5lZWRBdHRhY2g7XG5cdGlmKGtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHMgPSBzY3JpcHRzW2ldO1xuXHRcdFx0aWYocy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgPT0gdXJsIHx8IHMuZ2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIpID09IGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KSB7IHNjcmlwdCA9IHM7IGJyZWFrOyB9XG5cdFx0fVxuXHR9XG5cdGlmKCFzY3JpcHQpIHtcblx0XHRuZWVkQXR0YWNoID0gdHJ1ZTtcblx0XHRzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblxuXHRcdHNjcmlwdC5jaGFyc2V0ID0gJ3V0Zi04Jztcblx0XHRzY3JpcHQudGltZW91dCA9IDEyMDtcblx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5uYykge1xuXHRcdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcIm5vbmNlXCIsIF9fd2VicGFja19yZXF1aXJlX18ubmMpO1xuXHRcdH1cblx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIsIGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KTtcblxuXHRcdHNjcmlwdC5zcmMgPSB1cmw7XG5cdH1cblx0aW5Qcm9ncmVzc1t1cmxdID0gW2RvbmVdO1xuXHR2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCkgPT4ge1xuXHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cblx0XHRzY3JpcHQub25lcnJvciA9IHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR2YXIgZG9uZUZucyA9IGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRkZWxldGUgaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdHNjcmlwdC5wYXJlbnROb2RlICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdFx0ZG9uZUZucyAmJiBkb25lRm5zLmZvckVhY2goKGZuKSA9PiAoZm4oZXZlbnQpKSk7XG5cdFx0aWYocHJldikgcmV0dXJuIHByZXYoZXZlbnQpO1xuXHR9XG5cdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgdW5kZWZpbmVkLCB7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSksIDEyMDAwMCk7XG5cdHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcblx0c2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcblx0bmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG59OyIsIi8qKlxyXG4gKiBBY2NvdW50IERlbGV0aW9uIFN0YXR1cyBNb2R1bGVcclxuICogQG1vZHVsZSBhY2NvdW50RGVsZXRpb25TdGF0dXNcclxuICogQGRlc2NyaXB0aW9uIEhhbmRsZXMgdGhlIGFjY291bnQgZGVsZXRpb24gc3RhdHVzIHBhZ2UgZnVuY3Rpb25hbGl0eVxyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XHJcbmltcG9ydCB7IHByb3RlY3RQYWdlLCBnZXRDdXJyZW50VXNlciB9IGZyb20gXCIuL2F1dGgvYXV0aC5qc1wiO1xyXG5pbXBvcnQgeyBpbml0RGVsZXRpb25HdWFyZCB9IGZyb20gXCIuL2F1dGgvZGVsZXRpb24tZ3VhcmQuanNcIjtcclxuXHJcbmxldCBjdXJyZW50VXNlciA9IG51bGw7XHJcbmxldCBkZWxldGlvblN0YXR1cyA9IG51bGw7XHJcbmxldCBjb3VudGRvd25JbnRlcnZhbCA9IG51bGw7XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSB0aGUgYWNjb3VudCBkZWxldGlvbiBzdGF0dXMgcGFnZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRBY2NvdW50RGVsZXRpb25TdGF0dXNQYWdlKCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBJbml0aWFsaXplIGRlbGV0aW9uIGd1YXJkIChhbGxvdyBhY2Nlc3MgdG8gdGhpcyBwYWdlKVxyXG4gICAgY29uc3QgY2FuQWNjZXNzID0gYXdhaXQgaW5pdERlbGV0aW9uR3VhcmQodHJ1ZSk7XHJcbiAgICBpZiAoIWNhbkFjY2Vzcykge1xyXG4gICAgICByZXR1cm47IC8vIEFjY2VzcyB3YXMgYmxvY2tlZFxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb3RlY3QgdGhlIHBhZ2UgYW5kIGdldCBjdXJyZW50IHVzZXJcclxuICAgIGlmICghKGF3YWl0IHByb3RlY3RQYWdlKCkpKSByZXR1cm47XHJcblxyXG4gICAgY3VycmVudFVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xyXG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2F1dGgvbG9naW5cIjtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExvYWQgZGVsZXRpb24gc3RhdHVzXHJcbiAgICBhd2FpdCBsb2FkRGVsZXRpb25TdGF0dXMoKTtcclxuXHJcbiAgICAvLyBTZXR1cCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvLyBMb2FkIGZvb3RlclxyXG4gICAgYXdhaXQgbG9hZEZvb3RlcigpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW5pdGlhbGl6aW5nIGFjY291bnQgZGVsZXRpb24gc3RhdHVzIHBhZ2U6XCIsIGVycm9yKTtcclxuICAgIHNob3dFcnJvcihcIkVycmV1ciBsb3JzIGR1IGNoYXJnZW1lbnQgZGUgbGEgcGFnZVwiKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2FkIHRoZSBhY2NvdW50IGRlbGV0aW9uIHN0YXR1c1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbG9hZERlbGV0aW9uU3RhdHVzKCkge1xyXG4gIHRyeSB7XHJcbiAgICBzaG93TG9hZGluZygpO1xyXG5cclxuICAgIC8vIENhbGwgdGhlIGFjY291bnQgbWFuYWdlbWVudCBlZGdlIGZ1bmN0aW9uIHRvIGdldCBzdGF0dXNcclxuICAgIGNvbnN0IHsgZGF0YTogc2Vzc2lvbiB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKCk7XHJcbiAgICBpZiAoIXNlc3Npb24/LnNlc3Npb24/LmFjY2Vzc190b2tlbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB2YWxpZCBzZXNzaW9uXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICAgIGAke3N1cGFiYXNlLnN1cGFiYXNlVXJsfS9mdW5jdGlvbnMvdjEvYWNjb3VudC1tYW5hZ2VtZW50YCxcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7c2Vzc2lvbi5zZXNzaW9uLmFjY2Vzc190b2tlbn1gLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgYWN0aW9uOiBcInN0YXR1c1wiLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IgfHwgXCJGYWlsZWQgdG8gZ2V0IGRlbGV0aW9uIHN0YXR1c1wiKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGlvblN0YXR1cyA9IHJlc3VsdC5kYXRhO1xyXG5cclxuICAgIC8vIENoZWNrIGlmIGFjY291bnQgaXMgYWN0dWFsbHkgc2NoZWR1bGVkIGZvciBkZWxldGlvblxyXG4gICAgaWYgKCFkZWxldGlvblN0YXR1cy5kZWxldGlvbl9zY2hlZHVsZWQpIHtcclxuICAgICAgLy8gUmVkaXJlY3QgdG8gcHJvZmlsZSBpZiBubyBkZWxldGlvbiBpcyBzY2hlZHVsZWRcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi91c2VyL3Byb2ZpbGVcIjtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIGFjY291bnQgaGFzIGFscmVhZHkgZXhwaXJlZFxyXG4gICAgaWYgKGRlbGV0aW9uU3RhdHVzLnRpbWVfcmVtYWluaW5nX3NlY29uZHMgPD0gMCkge1xyXG4gICAgICAvLyBBY2NvdW50IHNob3VsZCBiZSBkZWxldGVkLCBzaG93IGV4cGlyZWQgbWVzc2FnZSBhbmQgbG9nb3V0XHJcbiAgICAgIHNob3dBY2NvdW50RXhwaXJlZCgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGlzcGxheSB0aGUgZGVsZXRpb24gc3RhdHVzXHJcbiAgICBkaXNwbGF5RGVsZXRpb25TdGF0dXMoKTtcclxuXHJcbiAgICAvLyBTdGFydCBjb3VudGRvd25cclxuICAgIHN0YXJ0Q291bnRkb3duKCk7XHJcblxyXG4gICAgaGlkZUxvYWRpbmcoKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgZGVsZXRpb24gc3RhdHVzOlwiLCBlcnJvcik7XHJcbiAgICBzaG93RXJyb3IoXCJFcnJldXIgbG9ycyBkdSBjaGFyZ2VtZW50IGR1IHN0YXR1dCBkZSBzdXBwcmVzc2lvblwiKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IGFjY291bnQgZXhwaXJlZCBtZXNzYWdlXHJcbiAqL1xyXG5mdW5jdGlvbiBzaG93QWNjb3VudEV4cGlyZWQoKSB7XHJcbiAgaGlkZUxvYWRpbmcoKTtcclxuXHJcbiAgY29uc3QgbWFpbkNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW4tY29udGVudFwiKTtcclxuICBpZiAobWFpbkNvbnRlbnQpIHtcclxuICAgIG1haW5Db250ZW50LmlubmVySFRNTCA9IGBcclxuICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJkZWxldGlvbi1zdGF0dXMtY2FyZFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRlbGV0aW9uLWhlYWRlclwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVsZXRpb24taWNvblwiPlxyXG4gICAgICAgICAgICAgIDxzdmcgd2lkdGg9XCI0OFwiIGhlaWdodD1cIjQ4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiPlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiPjwvY2lyY2xlPlxyXG4gICAgICAgICAgICAgICAgPGxpbmUgeDE9XCIxNVwiIHkxPVwiOVwiIHgyPVwiOVwiIHkyPVwiMTVcIj48L2xpbmU+XHJcbiAgICAgICAgICAgICAgICA8bGluZSB4MT1cIjlcIiB5MT1cIjlcIiB4Mj1cIjE1XCIgeTI9XCIxNVwiPjwvbGluZT5cclxuICAgICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxoMT5Db21wdGUgc3VwcHJpbcOpPC9oMT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVsZXRpb24tZGV0YWlsc1wiPlxyXG4gICAgICAgICAgICA8cCBjbGFzcz1cImRlbGV0aW9uLW1lc3NhZ2VcIj5cclxuICAgICAgICAgICAgICBWb3RyZSBjb21wdGUgYSDDqXTDqSBkw6lmaW5pdGl2ZW1lbnQgc3VwcHJpbcOpLlxyXG4gICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzPVwiZGVsZXRpb24td2FybmluZ1wiPlxyXG4gICAgICAgICAgICAgIFRvdXRlcyB2b3MgZG9ubsOpZXMgb250IMOpdMOpIGVmZmFjw6llcyBkZSBub3Mgc2VydmV1cnMuXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVsZXRpb24tYWN0aW9uc1wiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwibG9nb3V0LWJ0blwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCI+XHJcbiAgICAgICAgICAgICAgUmV0b3VyIMOgIGwnYWNjdWVpbFxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIGA7XHJcblxyXG4gICAgLy8gQWRkIGxvZ291dCBldmVudCBsaXN0ZW5lclxyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLmdldEVsZW1lbnRCeUlkKFwibG9nb3V0LWJ0blwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKTtcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBtYWluQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIH1cclxuXHJcbiAgLy8gQXV0byBsb2dvdXQgYWZ0ZXIgNSBzZWNvbmRzXHJcbiAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKTtcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcbiAgfSwgNTAwMCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEaXNwbGF5IHRoZSBkZWxldGlvbiBzdGF0dXMgaW5mb3JtYXRpb25cclxuICovXHJcbmZ1bmN0aW9uIGRpc3BsYXlEZWxldGlvblN0YXR1cygpIHtcclxuICBjb25zdCBkZWxldGlvbkRhdGUgPSBuZXcgRGF0ZShkZWxldGlvblN0YXR1cy5kZWxldGlvbl9zY2hlZHVsZWRfZm9yKTtcclxuICBjb25zdCBmb3JtYXR0ZWREYXRlID0gZGVsZXRpb25EYXRlLnRvTG9jYWxlRGF0ZVN0cmluZyhcImZyLUZSXCIsIHtcclxuICAgIHdlZWtkYXk6IFwibG9uZ1wiLFxyXG4gICAgeWVhcjogXCJudW1lcmljXCIsXHJcbiAgICBtb250aDogXCJsb25nXCIsXHJcbiAgICBkYXk6IFwibnVtZXJpY1wiLFxyXG4gICAgaG91cjogXCIyLWRpZ2l0XCIsXHJcbiAgICBtaW51dGU6IFwiMi1kaWdpdFwiLFxyXG4gICAgc2Vjb25kOiBcIjItZGlnaXRcIiwgLy8gQWRkIHNlY29uZHMgZm9yIHRlc3RpbmdcclxuICB9KTtcclxuXHJcbiAgLy8gVXBkYXRlIGRlbGV0aW9uIGRhdGVcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0aW9uLWRhdGVcIikudGV4dENvbnRlbnQgPSBmb3JtYXR0ZWREYXRlO1xyXG5cclxuICAvLyBTaG93IGRlbGV0aW9uIHJlYXNvbiBpZiBhdmFpbGFibGVcclxuICBpZiAoXHJcbiAgICBkZWxldGlvblN0YXR1cy5kZWxldGlvbl9yZWFzb24gJiZcclxuICAgIGRlbGV0aW9uU3RhdHVzLmRlbGV0aW9uX3JlYXNvbiAhPT0gXCJVc2VyIHJlcXVlc3RlZCBhY2NvdW50IGRlbGV0aW9uXCJcclxuICApIHtcclxuICAgIGNvbnN0IHJlYXNvbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICBcImRlbGV0aW9uLXJlYXNvbi1jb250YWluZXJcIlxyXG4gICAgKTtcclxuICAgIGNvbnN0IHJlYXNvbkVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0aW9uLXJlYXNvblwiKTtcclxuICAgIHJlYXNvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZWxldGlvblN0YXR1cy5kZWxldGlvbl9yZWFzb247XHJcbiAgICByZWFzb25Db250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICB9XHJcblxyXG4gIC8vIFVwZGF0ZSBjb3VudGRvd25cclxuICB1cGRhdGVDb3VudGRvd24oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0YXJ0IHRoZSBjb3VudGRvd24gdGltZXJcclxuICovXHJcbmZ1bmN0aW9uIHN0YXJ0Q291bnRkb3duKCkge1xyXG4gIC8vIFVwZGF0ZSBpbW1lZGlhdGVseVxyXG4gIHVwZGF0ZUNvdW50ZG93bigpO1xyXG5cclxuICAvLyBVcGRhdGUgZXZlcnkgc2Vjb25kIGZvciB0ZXN0aW5nICh3YXMgZXZlcnkgbWludXRlKVxyXG4gIGNvdW50ZG93bkludGVydmFsID0gc2V0SW50ZXJ2YWwodXBkYXRlQ291bnRkb3duLCAxMDAwKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSB0aGUgY291bnRkb3duIGRpc3BsYXlcclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZUNvdW50ZG93bigpIHtcclxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIGNvbnN0IGRlbGV0aW9uRGF0ZSA9IG5ldyBEYXRlKGRlbGV0aW9uU3RhdHVzLmRlbGV0aW9uX3NjaGVkdWxlZF9mb3IpO1xyXG4gIGNvbnN0IHRpbWVEaWZmID0gZGVsZXRpb25EYXRlLmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCk7XHJcblxyXG4gIGlmICh0aW1lRGlmZiA8PSAwKSB7XHJcbiAgICAvLyBBY2NvdW50IHNob3VsZCBiZSBkZWxldGVkXHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRheXMtcmVtYWluaW5nXCIpLnRleHRDb250ZW50ID0gXCIwXCI7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhvdXJzLXJlbWFpbmluZ1wiKS50ZXh0Q29udGVudCA9IFwiMFwiO1xyXG5cclxuICAgIGlmIChjb3VudGRvd25JbnRlcnZhbCkge1xyXG4gICAgICBjbGVhckludGVydmFsKGNvdW50ZG93bkludGVydmFsKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93U3RhdHVzTWVzc2FnZShcIlZvdHJlIGNvbXB0ZSBhIMOpdMOpIHN1cHByaW3DqS5cIiwgXCJlcnJvclwiKTtcclxuXHJcbiAgICAvLyBEaXNhYmxlIGNhbmNlbCBidXR0b25cclxuICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsLWRlbGV0aW9uLWJ0blwiKTtcclxuICAgIGlmIChjYW5jZWxCdG4pIHtcclxuICAgICAgY2FuY2VsQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gXCJDb21wdGUgc3VwcHJpbcOpXCI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXV0byBsb2dvdXQgYWZ0ZXIgMyBzZWNvbmRzXHJcbiAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XHJcbiAgICB9LCAzMDAwKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBGb3IgdGVzdGluZyB3aXRoIHNlY29uZHMsIHNob3cgc2Vjb25kcyBpbnN0ZWFkIG9mIGRheXMvaG91cnNcclxuICBjb25zdCB0b3RhbFNlY29uZHMgPSBNYXRoLmZsb29yKHRpbWVEaWZmIC8gMTAwMCk7XHJcbiAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IodG90YWxTZWNvbmRzIC8gNjApO1xyXG4gIGNvbnN0IHNlY29uZHMgPSB0b3RhbFNlY29uZHMgJSA2MDtcclxuXHJcbiAgLy8gVXBkYXRlIGRpc3BsYXkgdG8gc2hvdyBtaW51dGVzIGFuZCBzZWNvbmRzIGZvciB0ZXN0aW5nXHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYXlzLXJlbWFpbmluZ1wiKS50ZXh0Q29udGVudCA9IG1pbnV0ZXMudG9TdHJpbmcoKTtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhvdXJzLXJlbWFpbmluZ1wiKS50ZXh0Q29udGVudCA9IHNlY29uZHMudG9TdHJpbmcoKTtcclxuXHJcbiAgLy8gVXBkYXRlIGxhYmVscyBmb3IgdGVzdGluZ1xyXG4gIGNvbnN0IGRheXNMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIi5jb3VudGRvd24taXRlbTpmaXJzdC1jaGlsZCAuY291bnRkb3duLWxhYmVsXCJcclxuICApO1xyXG4gIGNvbnN0IGhvdXJzTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgXCIuY291bnRkb3duLWl0ZW06bGFzdC1jaGlsZCAuY291bnRkb3duLWxhYmVsXCJcclxuICApO1xyXG4gIGlmIChkYXlzTGFiZWwpIGRheXNMYWJlbC50ZXh0Q29udGVudCA9IFwibWludXRlc1wiO1xyXG4gIGlmIChob3Vyc0xhYmVsKSBob3Vyc0xhYmVsLnRleHRDb250ZW50ID0gXCJzZWNvbmRlc1wiO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0dXAgZXZlbnQgbGlzdGVuZXJzXHJcbiAqL1xyXG5mdW5jdGlvbiBzZXR1cEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gIC8vIENhbmNlbCBkZWxldGlvbiBidXR0b25cclxuICBjb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbmNlbC1kZWxldGlvbi1idG5cIik7XHJcbiAgaWYgKGNhbmNlbEJ0bikge1xyXG4gICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDYW5jZWxEZWxldGlvbik7XHJcbiAgfVxyXG5cclxuICAvLyBMb2dvdXQgYnV0dG9uXHJcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXQtYnRuXCIpO1xyXG4gIGlmIChsb2dvdXRCdG4pIHtcclxuICAgIGxvZ291dEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlTG9nb3V0KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgY2FuY2VsaW5nIGFjY291bnQgZGVsZXRpb25cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNhbmNlbERlbGV0aW9uKCkge1xyXG4gIGlmIChcclxuICAgICFjb25maXJtKFxyXG4gICAgICBcIsOKdGVzLXZvdXMgc8O7ciBkZSB2b3Vsb2lyIGFubnVsZXIgbGEgc3VwcHJlc3Npb24gZGUgdm90cmUgY29tcHRlID9cIlxyXG4gICAgKVxyXG4gICkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsLWRlbGV0aW9uLWJ0blwiKTtcclxuICAgIGNvbnN0IG9yaWdpbmFsVGV4dCA9IGNhbmNlbEJ0bi50ZXh0Q29udGVudDtcclxuICAgIGNhbmNlbEJ0bi50ZXh0Q29udGVudCA9IFwiQW5udWxhdGlvbi4uLlwiO1xyXG4gICAgY2FuY2VsQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuXHJcbiAgICAvLyBDYWxsIHRoZSBhY2NvdW50IG1hbmFnZW1lbnQgZWRnZSBmdW5jdGlvbiB0byBjYW5jZWwgZGVsZXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogc2Vzc2lvbiB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKCk7XHJcbiAgICBpZiAoIXNlc3Npb24/LnNlc3Npb24/LmFjY2Vzc190b2tlbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB2YWxpZCBzZXNzaW9uXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICAgIGAke3N1cGFiYXNlLnN1cGFiYXNlVXJsfS9mdW5jdGlvbnMvdjEvYWNjb3VudC1tYW5hZ2VtZW50YCxcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7c2Vzc2lvbi5zZXNzaW9uLmFjY2Vzc190b2tlbn1gLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgYWN0aW9uOiBcImNhbmNlbFwiLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IgfHwgXCJGYWlsZWQgdG8gY2FuY2VsIGRlbGV0aW9uXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3dTdGF0dXNNZXNzYWdlKFwiU3VwcHJlc3Npb24gZGUgY29tcHRlIGFubnVsw6llIGF2ZWMgc3VjY8OocyAhXCIsIFwic3VjY2Vzc1wiKTtcclxuXHJcbiAgICAvLyBSZWRpcmVjdCB0byBwcm9maWxlIGFmdGVyIGEgc2hvcnQgZGVsYXlcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3VzZXIvcHJvZmlsZVwiO1xyXG4gICAgfSwgMjAwMCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjYW5jZWxpbmcgZGVsZXRpb246XCIsIGVycm9yKTtcclxuICAgIHNob3dTdGF0dXNNZXNzYWdlKFwiRXJyZXVyIGxvcnMgZGUgbCdhbm51bGF0aW9uIGRlIGxhIHN1cHByZXNzaW9uXCIsIFwiZXJyb3JcIik7XHJcblxyXG4gICAgLy8gUmUtZW5hYmxlIGJ1dHRvblxyXG4gICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWwtZGVsZXRpb24tYnRuXCIpO1xyXG4gICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gXCJBbm51bGVyIGxhIHN1cHByZXNzaW9uXCI7XHJcbiAgICBjYW5jZWxCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgbG9nb3V0XHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVMb2dvdXQoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xyXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBsb2dvdXQ6XCIsIGVycm9yKTtcclxuICAgIC8vIEZvcmNlIHJlZGlyZWN0IGV2ZW4gaWYgbG9nb3V0IGZhaWxzXHJcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIExvYWQgZm9vdGVyIGNvbXBvbmVudFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbG9hZEZvb3RlcigpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZm9vdGVyUGxhY2Vob2xkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvb3Rlci1wbGFjZWhvbGRlclwiKTtcclxuICAgIGlmIChmb290ZXJQbGFjZWhvbGRlciAmJiB3aW5kb3cubG9hZEZvb3Rlcikge1xyXG4gICAgICBhd2FpdCB3aW5kb3cubG9hZEZvb3RlcigpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgbG9hZCBmb290ZXI6XCIsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IGxvYWRpbmcgc3RhdGVcclxuICovXHJcbmZ1bmN0aW9uIHNob3dMb2FkaW5nKCkge1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZy1zdGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluLWNvbnRlbnRcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyb3Itc3RhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG59XHJcblxyXG4vKipcclxuICogSGlkZSBsb2FkaW5nIHN0YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBoaWRlTG9hZGluZygpIHtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRpbmctc3RhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpbi1jb250ZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlcnJvci1zdGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IGVycm9yIHN0YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBzaG93RXJyb3IobWVzc2FnZSkge1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZy1zdGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluLWNvbnRlbnRcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyb3Itc3RhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyb3ItbWVzc2FnZVwiKS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IHN0YXR1cyBtZXNzYWdlXHJcbiAqL1xyXG5mdW5jdGlvbiBzaG93U3RhdHVzTWVzc2FnZShtZXNzYWdlLCB0eXBlID0gXCJpbmZvXCIpIHtcclxuICBjb25zdCBzdGF0dXNFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0dXMtbWVzc2FnZVwiKTtcclxuICBpZiAoc3RhdHVzRWxlbWVudCkge1xyXG4gICAgc3RhdHVzRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTmFtZSA9IGBzdGF0dXMtbWVzc2FnZSAke3R5cGV9YDtcclxuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuXHJcbiAgICAvLyBBdXRvLWhpZGUgYWZ0ZXIgNSBzZWNvbmRzIGZvciBzdWNjZXNzIG1lc3NhZ2VzXHJcbiAgICBpZiAodHlwZSA9PT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG4gICAgICB9LCA1MDAwKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhbnVwIGZ1bmN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBjbGVhbnVwKCkge1xyXG4gIGlmIChjb3VudGRvd25JbnRlcnZhbCkge1xyXG4gICAgY2xlYXJJbnRlcnZhbChjb3VudGRvd25JbnRlcnZhbCk7XHJcbiAgICBjb3VudGRvd25JbnRlcnZhbCA9IG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDbGVhbnVwIG9uIHBhZ2UgdW5sb2FkXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYmVmb3JldW5sb2FkXCIsIGNsZWFudXApO1xyXG5cclxuLy8gSW5pdGlhbGl6ZSB3aGVuIERPTSBpcyBsb2FkZWRcclxuaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwibG9hZGluZ1wiKSB7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgaW5pdEFjY291bnREZWxldGlvblN0YXR1c1BhZ2UpO1xyXG59IGVsc2Uge1xyXG4gIGluaXRBY2NvdW50RGVsZXRpb25TdGF0dXNQYWdlKCk7XHJcbn1cclxuIiwiLyoqXHJcbiAqIEFjY291bnQgRGVsZXRpb24gU3RhdHVzIEVudHJ5IFBvaW50XHJcbiAqIEBtb2R1bGUgYWNjb3VudERlbGV0aW9uU3RhdHVzRW50cnlcclxuICogQGRlc2NyaXB0aW9uIEVudHJ5IHBvaW50IGZvciB0aGUgYWNjb3VudCBkZWxldGlvbiBzdGF0dXMgcGFnZVxyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IGluaXRBY2NvdW50RGVsZXRpb25TdGF0dXNQYWdlIH0gZnJvbSBcIi4uL2FjY291bnQtZGVsZXRpb24tc3RhdHVzLmpzXCI7XHJcblxyXG4vLyBJbml0aWFsaXplIHRoZSBwYWdlIHdoZW4gRE9NIGlzIGxvYWRlZFxyXG5pZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIpIHtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBpbml0QWNjb3VudERlbGV0aW9uU3RhdHVzUGFnZSk7XHJcbn0gZWxzZSB7XHJcbiAgaW5pdEFjY291bnREZWxldGlvblN0YXR1c1BhZ2UoKTtcclxufVxyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZiA9IHt9O1xuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIG9ubHkgdGhlIGVudHJ5IGNodW5rLlxuLy8gVGhlIGNodW5rIGxvYWRpbmcgZnVuY3Rpb24gZm9yIGFkZGl0aW9uYWwgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmUgPSAoY2h1bmtJZCkgPT4ge1xuXHRyZXR1cm4gUHJvbWlzZS5hbGwoT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5mKS5yZWR1Y2UoKHByb21pc2VzLCBrZXkpID0+IHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmZba2V5XShjaHVua0lkLCBwcm9taXNlcyk7XG5cdFx0cmV0dXJuIHByb21pc2VzO1xuXHR9LCBbXSkpO1xufTsiLCIvLyBUaGlzIGZ1bmN0aW9uIGFsbG93IHRvIHJlZmVyZW5jZSBhc3luYyBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18udSA9IChjaHVua0lkKSA9PiB7XG5cdC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBiYXNlZCBvbiB0ZW1wbGF0ZVxuXHRyZXR1cm4gXCJqcy9cIiArIGNodW5rSWQgKyBcIi5jaHVuay5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmogPSAzNjg7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7IiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDM2ODogMFxufTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSAoY2h1bmtJZCwgcHJvbWlzZXMpID0+IHtcblx0XHQvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG5cdFx0dmFyIGluc3RhbGxlZENodW5rRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpID8gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdIDogdW5kZWZpbmVkO1xuXHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgeyAvLyAwIG1lYW5zIFwiYWxyZWFkeSBpbnN0YWxsZWRcIi5cblxuXHRcdFx0Ly8gYSBQcm9taXNlIG1lYW5zIFwiY3VycmVudGx5IGxvYWRpbmdcIi5cblx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZih0cnVlKSB7IC8vIGFsbCBjaHVua3MgaGF2ZSBKU1xuXHRcdFx0XHRcdC8vIHNldHVwIFByb21pc2UgaW4gY2h1bmsgY2FjaGVcblx0XHRcdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IChpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XSkpO1xuXHRcdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSk7XG5cblx0XHRcdFx0XHQvLyBzdGFydCBjaHVuayBsb2FkaW5nXG5cdFx0XHRcdFx0dmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18ucCArIF9fd2VicGFja19yZXF1aXJlX18udShjaHVua0lkKTtcblx0XHRcdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cdFx0XHRcdFx0dmFyIGxvYWRpbmdFbmRlZCA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkpIHtcblx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9IGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmVhbFNyYyA9IGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuc3JjO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPSAnTG9hZGluZyBjaHVuayAnICsgY2h1bmtJZCArICcgZmFpbGVkLlxcbignICsgZXJyb3JUeXBlICsgJzogJyArIHJlYWxTcmMgKyAnKSc7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IudHlwZSA9IGVycm9yVHlwZTtcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmwodXJsLCBsb2FkaW5nRW5kZWQsIFwiY2h1bmstXCIgKyBjaHVua0lkLCBjaHVua0lkKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cbn07XG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbl9fd2VicGFja19yZXF1aXJlX18uTy5qID0gKGNodW5rSWQpID0+IChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPT09IDApO1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDA7XG5cdGlmKGNodW5rSWRzLnNvbWUoKGlkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMCkpKSB7XG5cdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0fVxuXHRpZihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uTyhyZXN1bHQpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzc2XSwgKCkgPT4gKF9fd2VicGFja19yZXF1aXJlX18oMzY4OCkpKVxuX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiJdLCJuYW1lcyI6WyJkZWZlcnJlZCIsImxlYWZQcm90b3R5cGVzIiwiZ2V0UHJvdG8iLCJpblByb2dyZXNzIiwiZGF0YVdlYnBhY2tQcmVmaXgiLCJjdXJyZW50VXNlciIsImRlbGV0aW9uU3RhdHVzIiwiY291bnRkb3duSW50ZXJ2YWwiLCJhc3luYyIsImluaXRBY2NvdW50RGVsZXRpb25TdGF0dXNQYWdlIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiZGlzcGxheSIsImRhdGEiLCJzZXNzaW9uIiwiYXV0aCIsImdldFNlc3Npb24iLCJhY2Nlc3NfdG9rZW4iLCJFcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJzdXBhYmFzZVVybCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhY3Rpb24iLCJyZXN1bHQiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwiZGVsZXRpb25fc2NoZWR1bGVkIiwidGltZV9yZW1haW5pbmdfc2Vjb25kcyIsImhpZGVMb2FkaW5nIiwibWFpbkNvbnRlbnQiLCJpbm5lckhUTUwiLCJhZGRFdmVudExpc3RlbmVyIiwic2lnbk91dCIsInNldFRpbWVvdXQiLCJzaG93QWNjb3VudEV4cGlyZWQiLCJmb3JtYXR0ZWREYXRlIiwiRGF0ZSIsImRlbGV0aW9uX3NjaGVkdWxlZF9mb3IiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ3ZWVrZGF5IiwieWVhciIsIm1vbnRoIiwiZGF5IiwiaG91ciIsIm1pbnV0ZSIsInNlY29uZCIsInRleHRDb250ZW50IiwiZGVsZXRpb25fcmVhc29uIiwicmVhc29uQ29udGFpbmVyIiwidXBkYXRlQ291bnRkb3duIiwiZGlzcGxheURlbGV0aW9uU3RhdHVzIiwic2V0SW50ZXJ2YWwiLCJjb25zb2xlIiwic2hvd0Vycm9yIiwibG9hZERlbGV0aW9uU3RhdHVzIiwiY2FuY2VsQnRuIiwiaGFuZGxlQ2FuY2VsRGVsZXRpb24iLCJsb2dvdXRCdG4iLCJoYW5kbGVMb2dvdXQiLCJzZXR1cEV2ZW50TGlzdGVuZXJzIiwibG9hZEZvb3RlciIsIndhcm4iLCJub3ciLCJ0aW1lRGlmZiIsImdldFRpbWUiLCJjbGVhckludGVydmFsIiwic2hvd1N0YXR1c01lc3NhZ2UiLCJkaXNhYmxlZCIsInRvdGFsU2Vjb25kcyIsIk1hdGgiLCJmbG9vciIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwidG9TdHJpbmciLCJkYXlzTGFiZWwiLCJxdWVyeVNlbGVjdG9yIiwiaG91cnNMYWJlbCIsImNvbmZpcm0iLCJtZXNzYWdlIiwidHlwZSIsInN0YXR1c0VsZW1lbnQiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJyZWFkeVN0YXRlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwibSIsIk8iLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImkiLCJsZW5ndGgiLCJmdWxmaWxsZWQiLCJqIiwiT2JqZWN0Iiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiciIsImdldFByb3RvdHlwZU9mIiwib2JqIiwidCIsInZhbHVlIiwibW9kZSIsInRoaXMiLCJfX2VzTW9kdWxlIiwidGhlbiIsIm5zIiwiY3JlYXRlIiwiZGVmIiwiY3VycmVudCIsImluZGV4T2YiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZm9yRWFjaCIsImQiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsImYiLCJlIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwibCIsInVybCIsImRvbmUiLCJwdXNoIiwic2NyaXB0IiwibmVlZEF0dGFjaCIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInMiLCJnZXRBdHRyaWJ1dGUiLCJjcmVhdGVFbGVtZW50IiwiY2hhcnNldCIsInRpbWVvdXQiLCJuYyIsInNldEF0dHJpYnV0ZSIsInNyYyIsIm9uU2NyaXB0Q29tcGxldGUiLCJwcmV2IiwiZXZlbnQiLCJvbmVycm9yIiwib25sb2FkIiwiY2xlYXJUaW1lb3V0IiwiZG9uZUZucyIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImJpbmQiLCJ0YXJnZXQiLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInAiLCJpbnN0YWxsZWRDaHVua3MiLCJpbnN0YWxsZWRDaHVua0RhdGEiLCJwcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImVycm9yVHlwZSIsInJlYWxTcmMiLCJuYW1lIiwicmVxdWVzdCIsIndlYnBhY2tKc29ucENhbGxiYWNrIiwicGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24iLCJtb3JlTW9kdWxlcyIsInJ1bnRpbWUiLCJzb21lIiwiaWQiLCJjaHVua0xvYWRpbmdHbG9iYWwiLCJzZWxmIiwiX193ZWJwYWNrX2V4cG9ydHNfXyJdLCJzb3VyY2VSb290IjoiIn0=