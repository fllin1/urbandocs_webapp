(()=>{"use strict";var e,t,n,o,r,s={4810:(e,t,n)=>{var o=n(3715),r=n(9660);let s=null,i=null;window.onloadTurnstileCallback=function(){console.log("Turnstile API ready (onloadTurnstileCallback executed).");const e=document.getElementById("turnstile-container");if(e&&window.turnstile&&!i){console.log("Rendering Turnstile widget from onloadTurnstileCallback...");try{i=window.turnstile.render(e,{sitekey:"0x4AAAAAABdzY3InOU2_In99",callback:function(e){s=e,console.log("Turnstile token obtained:",e)},"expired-callback":()=>{console.log("Turnstile token expired. Resetting widget. ID:",i),window.turnstile&&i&&window.turnstile.reset(i),s=null},"error-callback":e=>{s=null,console.error("Turnstile error callback:",e),(0,o.Qg)(`Erreur CAPTCHA: ${e}. Veuillez r√©essayer.`)}}),void 0===i?(console.error("Turnstile.render did not return a widgetId. Sitekey or container issue?"),(0,o.Qg)("Erreur initialisation CAPTCHA (ID widget non retourn√©).")):console.log("Turnstile widget rendered. ID:",i)}catch(e){console.error("Error rendering Turnstile:",e),(0,o.Qg)("Impossible d'afficher le CAPTCHA.")}}else e?window.turnstile?i&&console.log("onloadTurnstileCallback: Widget already seems rendered."):console.error("onloadTurnstileCallback: window.turnstile API not found."):console.error("onloadTurnstileCallback: #turnstile-container not found.")},document.addEventListener("DOMContentLoaded",(()=>{(function(){console.log("initSignupPage called");const e=document.getElementById("signupForm"),t=(document.getElementById("errorMessage"),document.getElementById("statusMessage"),document.getElementById("googleSignUpBtn")),n=document.getElementById("turnstile-container"),l=document.getElementById("tosCheckbox"),a=document.getElementById("tosModal"),d=document.getElementById("tosModalBody"),u=document.getElementById("signupBtn"),c=document.getElementById("tosStatusMessage"),g=document.getElementById("tosLink"),p=document.getElementById("tosModalClose");function m(){a&&(a.classList.remove("show"),a.style.display="none",document.body.style.overflow="")}u&&(u.disabled=!0),t&&(t.disabled=!0),l&&(l.disabled=!0),g&&a&&g.addEventListener("click",(e=>{e.preventDefault(),a&&(a.classList.add("show"),a.style.display="block",document.body.style.overflow="hidden",d&&"true"!==d.dataset.loaded&&async function(){try{d.innerHTML="<p>Chargement des conditions d'utilisation...</p>";const e=await fetch("/policies/terms");if(!e.ok)throw new Error(`Failed to load Terms of Service: ${e.status}`);const t=await e.text(),n=(new DOMParser).parseFromString(t,"text/html"),o=n.querySelector("main")||n.querySelector(".policy-container")||n.body;d.innerHTML=o?o.innerHTML:t,d.dataset.loaded="true",d.scrollTop=0,l&&(l.disabled=!1)}catch(e){console.error("Error loading ToS:",e),d.innerHTML='\n        <div style="color: #dc3545; padding: 1rem; border: 1px solid #dc3545; border-radius: 4px; background-color: #f8d7da;">\n          <p><strong>Erreur lors du chargement des conditions d\'utilisation.</strong></p>\n          <p>Veuillez r√©essayer ou consulter les conditions directement sur <a href="/policies/terms" target="_blank">cette page</a>.</p>\n        </div>\n      ',l&&(l.disabled=!1)}}(),l&&(l.disabled=!1))})),p&&p.addEventListener("click",(()=>{m()})),a&&a.addEventListener("click",(e=>{e.target===a&&m()})),l&&l.addEventListener("change",(()=>{const e=l.checked;if(u&&(u.disabled=!e),t&&(t.disabled=!e),c&&(e?c.classList.add("hidden"):c.classList.remove("hidden")),e){const e=document.getElementById("errorMessage");e&&e.innerHTML.includes("Conditions G√©n√©rales d'Utilisation")&&(0,o.Bt)("errorMessage")}else(0,o.Qg)("Veuillez accepter les Conditions G√©n√©rales d'Utilisation.","errorMessage")})),n||console.error("#turnstile-container not found in the DOM. CAPTCHA cannot be rendered."),e?e.addEventListener("submit",(async t=>{t.preventDefault();const n=document.getElementById("email").value.trim(),a=document.getElementById("password").value,d=document.getElementById("confirmPassword").value;let u=document.getElementById("phone").value.trim(),c=[];if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||c.push("L'adresse email n'est pas valide."),a!==d&&c.push("Les mots de passe ne correspondent pas."),(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/.test(a)||a.length<8)&&c.push("Le format du mot de passe est invalide."),u||c.push("Le num√©ro de t√©l√©phone est requis."),u&&!/^(0|\+33)[1-9]\d{8}$/.test(u)&&c.push("Le format du num√©ro de t√©l√©phone est invalide (ex: 0612345678 ou +33612345678)."),s||c.push("Veuillez compl√©ter le CAPTCHA."),l&&l.checked||c.push("Veuillez lire et accepter les Conditions G√©n√©rales d'Utilisation."),c.length>0)(0,o.Qg)(c.join("<br>"));else{(0,o.Cs)("signupBtn","signupSpinner");try{let t=u;u.startsWith("0")&&(t=`+33${u.substring(1)}`);const{data:o,error:i}=await r.N.auth.signUp({email:n,password:a,options:{captchaToken:s}});if(i)throw i;if(!o.user)throw new Error("Erreur lors de la cr√©ation de l'utilisateur.");if(t&&o.user.id)try{await new Promise((e=>setTimeout(e,100)));const{error:e}=await r.N.from("profiles").update({phone:t}).eq("id",o.user.id);e&&console.warn("Could not update profile with phone number:",e)}catch(e){console.warn("Profile update failed:",e)}!function(e){const t=document.getElementById("statusMessage");t&&(t.innerHTML=`\n      <div class="signup-success">\n        <h3>Compte cr√©√© avec succ√®s !</h3>\n        <p><strong>Un email de confirmation a √©t√© envoy√© √† :</strong><br>\n        <code>${e}</code></p>\n        \n        <div class="confirmation-instructions">\n          <h4>üìß Prochaines √©tapes :</h4>\n          <ol>\n            <li>V√©rifiez votre bo√Æte de r√©ception (et n'oubliez pas vos spams !)</li>\n            <li>Cliquez sur le lien de confirmation dans l'email</li>\n            <li>Vous pourrez ensuite vous connecter avec vos identifiants</li>\n          </ol>\n        </div>\n        \n        <div class="confirmation-note">\n          <p><strong>Note :</strong> Vous devez confirmer votre email avant de pouvoir vous connecter.</p>\n        </div>\n      </div>\n    `,t.classList.remove("hidden"),t.classList.add("success"))}(n),e&&(e.classList.add("hidden"),e.reset())}catch(e){console.error("Email/Password Signup error:",e);let t=e.message||"Une erreur est survenue.";e.message&&e.message.includes("User already registered")?t="Cette adresse email est d√©j√† utilis√©e. Veuillez vous connecter ou utiliser une autre adresse.":e.message&&e.message.includes("Unable to validate phone number")?t="Le num√©ro de t√©l√©phone fourni n'est pas valide.":e.message&&e.message.toLowerCase().includes("captcha protection")&&(t="Erreur CAPTCHA du serveur. Veuillez r√©essayer. ("+e.message+")"),(0,o.Qg)(t)}finally{(0,o.RZ)("signupBtn","signupSpinner"),window.turnstile&&i&&(window.turnstile.reset(i),console.log("Turnstile widget has been reset.")),s=null}}})):console.error("Signup form (signupForm) not found."),t?t.addEventListener("click",(async()=>{(0,o.Cs)("googleSignUpBtn","googleSignUpSpinner");try{const{error:e}=await r.N.auth.signInWithOAuth({provider:"google",options:{}});e&&(console.error("Error signing up with Google:",e),(0,o.Qg)(e.message||"Erreur lors de l'inscription avec Google."))}catch(e){console.error("Exception during Google sign-up:",e),(0,o.Qg)("Une exception est survenue lors de l'inscription avec Google.")}finally{(0,o.RZ)("googleSignUpBtn","googleSignUpSpinner")}})):console.warn("Google Sign-Up button (googleSignUpBtn) not found.")})(),console.log("Signup page initialized")}))}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return s[e].call(n.exports,n,n.exports,l),n.exports}l.m=s,e=[],l.O=(t,n,o,r)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,o,r]=e[u],i=!0,a=0;a<n.length;a++)(!1&r||s>=r)&&Object.keys(l.O).every((e=>l.O[e](n[a])))?n.splice(a--,1):(i=!1,r<s&&(s=r));if(i){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,o,r]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);l.r(r);var s={};t=t||[null,n({}),n([]),n(n)];for(var i=2&o&&e;"object"==typeof i&&!~t.indexOf(i);i=n(i))Object.getOwnPropertyNames(i).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,l.d(r,s),r},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,n)=>(l.f[n](e,t),t)),[])),l.u=e=>"js/"+e+".chunk.js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},r="urbandocs_webapp:",l.l=(e,t,n,s)=>{if(o[e])o[e].push(t);else{var i,a;if(void 0!==n)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==r+n){i=c;break}}i||(a=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",r+n),i.src=e),o[e]=[t];var g=(t,n)=>{i.onerror=i.onload=null,clearTimeout(p);var r=o[e];if(delete o[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=g.bind(null,i.onerror),i.onload=g.bind(null,i.onload),a&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.j=787,l.p="/",(()=>{var e={787:0};l.f.j=(t,n)=>{var o=l.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var s=l.p+l.u(t),i=new Error;l.l(s,(n=>{if(l.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",i.name="ChunkLoadError",i.type=r,i.request=s,o[1](i)}}),"chunk-"+t,t)}},l.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[s,i,a]=n,d=0;if(s.some((t=>0!==e[t]))){for(o in i)l.o(i,o)&&(l.m[o]=i[o]);if(a)var u=a(l)}for(t&&t(n);d<s.length;d++)r=s[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(u)},n=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=l.O(void 0,[76],(()=>l(4810)));a=l.O(a)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianMvc2lnbnVwLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoidUJBQUlBLEVDQ0FDLEVBREFDLEVDQUFDLEVBQ0FDLEUsMENDdUJKLElBQUlDLEVBQWUsS0FDZkMsRUFBb0IsS0FJeEJDLE9BQU9DLHdCQUEwQixXQUMvQkMsUUFBUUMsSUFBSSwyREFDWixNQUFNQyxFQUFxQkMsU0FBU0MsZUFBZSx1QkFFbkQsR0FBSUYsR0FBc0JKLE9BQU9PLFlBQWNSLEVBQW1CLENBQ2hFRyxRQUFRQyxJQUFJLDhEQUNaLElBQ0VKLEVBQW9CQyxPQUFPTyxVQUFVQyxPQUFPSixFQUFvQixDQUM5REssUUFBUywyQkFDVEMsU0FBVSxTQUFVQyxHQUNsQmIsRUFBZWEsRUFDZlQsUUFBUUMsSUFBSSw0QkFBNkJRLEVBQzNDLEVBQ0EsbUJBQW9CLEtBQ2xCVCxRQUFRQyxJQUNOLGlEQUNBSixHQUVFQyxPQUFPTyxXQUFhUixHQUN0QkMsT0FBT08sVUFBVUssTUFBTWIsR0FFekJELEVBQWUsTUFHakIsaUJBQW1CZSxJQUNqQmYsRUFBZSxLQUNmSSxRQUFRWSxNQUFNLDRCQUE2QkQsSUFDM0MsUUFBVSxtQkFBbUJBLGtDQUdQRSxJQUF0QmhCLEdBQ0ZHLFFBQVFZLE1BQ04sNEVBRUYsUUFBVSw0REFFVlosUUFBUUMsSUFBSSxpQ0FBa0NKLEVBRWxELENBQUUsTUFBT2lCLEdBQ1BkLFFBQVFZLE1BQU0sNkJBQThCRSxJQUM1QyxRQUFVLG9DQUNaLENBQ0YsTUFBWVosRUFFQUosT0FBT08sVUFFUlIsR0FDVEcsUUFBUUMsSUFBSSwyREFGWkQsUUFBUVksTUFBTSw0REFGZFosUUFBUVksTUFBTSwyREFNbEIsRUNuRUFULFNBQVNZLGlCQUFpQixvQkFBb0IsTUR3R3ZDLFdBQ0xmLFFBQVFDLElBQUkseUJBQ1osTUFBTWUsRUFBYWIsU0FBU0MsZUFBZSxjQUdyQ2EsR0FGa0JkLFNBQVNDLGVBQWUsZ0JBQzFCRCxTQUFTQyxlQUFlLGlCQUN0QkQsU0FBU0MsZUFBZSxvQkFDMUNGLEVBQXFCQyxTQUFTQyxlQUFlLHVCQUc3Q2MsRUFBY2YsU0FBU0MsZUFBZSxlQUN0Q2UsRUFBa0JoQixTQUFTQyxlQUFlLFlBQzFDZ0IsRUFBZWpCLFNBQVNDLGVBQWUsZ0JBQ3ZDaUIsRUFBWWxCLFNBQVNDLGVBQWUsYUFDcENrQixFQUFtQm5CLFNBQVNDLGVBQWUsb0JBQzNDbUIsRUFBVXBCLFNBQVNDLGVBQWUsV0FDbENvQixFQUFnQnJCLFNBQVNDLGVBQWUsaUJBc0Q5QyxTQUFTcUIsSUFDSE4sSUFDRkEsRUFBZ0JPLFVBQVVDLE9BQU8sUUFDakNSLEVBQWdCUyxNQUFNQyxRQUFVLE9BQ2hDMUIsU0FBUzJCLEtBQUtGLE1BQU1HLFNBQVcsR0FFbkMsQ0F6RElWLElBQ0ZBLEVBQVVXLFVBQVcsR0FFbkJmLElBQ0ZBLEVBQWdCZSxVQUFXLEdBRXpCZCxJQUNGQSxFQUFZYyxVQUFXLEdBSXJCVCxHQUFXSixHQUNiSSxFQUFRUixpQkFBaUIsU0FBVUQsSUFDakNBLEVBQUVtQixpQkFxQkFkLElBQ0ZBLEVBQWdCTyxVQUFVUSxJQUFJLFFBQzlCZixFQUFnQlMsTUFBTUMsUUFBVSxRQUNoQzFCLFNBQVMyQixLQUFLRixNQUFNRyxTQUFXLFNBRzNCWCxHQUFnRCxTQUFoQ0EsRUFBYWUsUUFBUUMsUUFtQjdDQyxpQkFDRSxJQUNFakIsRUFBYWtCLFVBQ1gsb0RBRUYsTUFBTUMsUUFBaUJDLE1BQU0sbUJBQzdCLElBQUtELEVBQVNFLEdBQ1osTUFBTSxJQUFJQyxNQUFNLG9DQUFvQ0gsRUFBU0ksVUFHL0QsTUFBTUMsUUFBZ0JMLEVBQVNNLE9BSXpCQyxHQURTLElBQUlDLFdBQ0FDLGdCQUFnQkosRUFBUyxhQUN0Q0ssRUFDSkgsRUFBSUksY0FBYyxTQUNsQkosRUFBSUksY0FBYyxzQkFDbEJKLEVBQUloQixLQUdKVixFQUFha0IsVUFEWFcsRUFDdUJBLEVBQVlYLFVBRVpNLEVBRzNCeEIsRUFBYWUsUUFBUUMsT0FBUyxPQUM5QmhCLEVBQWErQixVQUFZLEVBR3JCakMsSUFDRkEsRUFBWWMsVUFBVyxFQUUzQixDQUFFLE1BQU9wQixHQUNQWixRQUFRWSxNQUFNLHFCQUFzQkEsR0FDcENRLEVBQWFrQixVQUFZLGtZQVFyQnBCLElBQ0ZBLEVBQVljLFVBQVcsRUFFM0IsQ0FDRixDQWpFTW9CLEdBSUVsQyxJQUNGQSxFQUFZYyxVQUFXLE9BNUJ6QlIsR0FDRkEsRUFBY1QsaUJBQWlCLFNBQVMsS0FDdENVLE9BS0FOLEdBQ0ZBLEVBQWdCSixpQkFBaUIsU0FBVUQsSUFDckNBLEVBQUV1QyxTQUFXbEMsR0FDZk0sT0FpRkZQLEdBQ0ZBLEVBQVlILGlCQUFpQixVQUFVLEtBQ3JDLE1BQU11QyxFQUFZcEMsRUFBWXFDLFFBbUI5QixHQWhCSWxDLElBQ0ZBLEVBQVVXLFVBQVlzQixHQUVwQnJDLElBQ0ZBLEVBQWdCZSxVQUFZc0IsR0FJMUJoQyxJQUNFZ0MsRUFDRmhDLEVBQWlCSSxVQUFVUSxJQUFJLFVBRS9CWixFQUFpQkksVUFBVUMsT0FBTyxXQUlqQzJCLEVBS0UsQ0FFTCxNQUFNRSxFQUFlckQsU0FBU0MsZUFBZSxnQkFFM0NvRCxHQUNBQSxFQUFhbEIsVUFBVW1CLFNBQVMsd0NBRWhDLFFBQVksZUFFaEIsTUFiRSxRQUNFLDREQUNBLG1CQWdCSHZELEdBQ0hGLFFBQVFZLE1BQ04sMEVBSUFJLEVBQ0ZBLEVBQVdELGlCQUFpQixVQUFVc0IsTUFBT3ZCLElBQzNDQSxFQUFFbUIsaUJBRUYsTUFBTXlCLEVBQVF2RCxTQUFTQyxlQUFlLFNBQVN1RCxNQUFNQyxPQUMvQ0MsRUFBVzFELFNBQVNDLGVBQWUsWUFBWXVELE1BQy9DRyxFQUFrQjNELFNBQVNDLGVBQWUsbUJBQW1CdUQsTUFDbkUsSUFBSUksRUFBUTVELFNBQVNDLGVBQWUsU0FBU3VELE1BQU1DLE9BRS9DSSxFQUFtQixHQTRCdkIsR0EzQnFCLDZCQUNIQyxLQUFLUCxJQUNyQk0sRUFBaUJFLEtBQUsscUNBQ3BCTCxJQUFhQyxHQUNmRSxFQUFpQkUsS0FBSyw2Q0FDVSxxQ0FDSEQsS0FBS0osSUFBYUEsRUFBU00sT0FBUyxJQUNqRUgsRUFBaUJFLEtBQUssMkNBQ25CSCxHQUFPQyxFQUFpQkUsS0FBSyxzQ0FHOUJILElBRGlCLHVCQUNNRSxLQUFLRixJQUM5QkMsRUFBaUJFLEtBQ2YsbUZBR0N0RSxHQUVIb0UsRUFBaUJFLEtBQUssa0NBR25CaEQsR0FBZ0JBLEVBQVlxQyxTQUMvQlMsRUFBaUJFLEtBQ2YscUVBSUFGLEVBQWlCRyxPQUFTLEdBQzVCLFFBQVVILEVBQWlCSSxLQUFLLGFBRGxDLEVBS0EsUUFBWSxZQUFhLGlCQUN6QixJQUNFLElBQUlDLEVBQVlOLEVBQ1pBLEVBQU1PLFdBQVcsT0FDbkJELEVBQVksTUFBTU4sRUFBTVEsVUFBVSxNQUlwQyxNQUFNLEtBQUVDLEVBQU01RCxNQUFPNkQsU0FBc0IsSUFBU0MsS0FBS0MsT0FBTyxDQUM5RGpCLFFBQ0FHLFdBQ0FlLFFBQVMsQ0FBRWhGLGtCQUdiLEdBQUk2RSxFQUFhLE1BQU1BLEVBQ3ZCLElBQUtELEVBQUtLLEtBQ1IsTUFBTSxJQUFJbkMsTUFBTSxnREFJbEIsR0FBSTJCLEdBQWFHLEVBQUtLLEtBQUtDLEdBQ3pCLFVBRVEsSUFBSUMsU0FBU0MsR0FBWUMsV0FBV0QsRUFBUyxPQUVuRCxNQUFRcEUsTUFBT3NFLFNBQXVCLElBQ25DQyxLQUFLLFlBQ0xDLE9BQU8sQ0FBRXJCLE1BQU9NLElBQ2hCZ0IsR0FBRyxLQUFNYixFQUFLSyxLQUFLQyxJQUVsQkksR0FDRmxGLFFBQVFzRixLQUNOLDhDQUNBSixFQUlOLENBQUUsTUFBT0ssR0FDUHZGLFFBQVFzRixLQUFLLHlCQUEwQkMsRUFFekMsRUE5UlYsU0FBMkI3QixHQUN6QixNQUFNOEIsRUFBZ0JyRixTQUFTQyxlQUFlLGlCQUMxQ29GLElBQ0ZBLEVBQWNsRCxVQUFZLDhLQUlkb0IsdWxCQWdCWjhCLEVBQWM5RCxVQUFVQyxPQUFPLFVBQy9CNkQsRUFBYzlELFVBQVVRLElBQUksV0FFaEMsQ0F3UVF1RCxDQUFrQi9CLEdBR2QxQyxJQUNGQSxFQUFXVSxVQUFVUSxJQUFJLFVBQ3pCbEIsRUFBV04sUUFFZixDQUFFLE1BQU9FLEdBQ1BaLFFBQVFZLE1BQU0sK0JBQWdDQSxHQUM5QyxJQUFJOEUsRUFBZTlFLEVBQU0rRSxTQUFXLDJCQUVsQy9FLEVBQU0rRSxTQUNOL0UsRUFBTStFLFFBQVFsQyxTQUFTLDJCQUV2QmlDLEVBQ0UsZ0dBRUY5RSxFQUFNK0UsU0FDTi9FLEVBQU0rRSxRQUFRbEMsU0FBUyxtQ0FFdkJpQyxFQUFlLGtEQUVmOUUsRUFBTStFLFNBQ04vRSxFQUFNK0UsUUFBUUMsY0FBY25DLFNBQVMsd0JBRXJDaUMsRUFDRSxtREFDQTlFLEVBQU0rRSxRQUNOLE1BRUosUUFBVUQsRUFDWixDQUFFLFNBQ0EsUUFBWSxZQUFhLGlCQUNyQjVGLE9BQU9PLFdBQWFSLElBQ3RCQyxPQUFPTyxVQUFVSyxNQUFNYixHQUN2QkcsUUFBUUMsSUFBSSxxQ0FFZEwsRUFBZSxJQUNqQixDQXBGQSxLQXVGRkksUUFBUVksTUFBTSx1Q0FHWkssRUFDRkEsRUFBZ0JGLGlCQUFpQixTQUFTc0IsV0FDeEMsUUFBWSxrQkFBbUIsdUJBQy9CLElBQ0UsTUFBTSxNQUFFekIsU0FBZ0IsSUFBUzhELEtBQUttQixnQkFBZ0IsQ0FDcERDLFNBQVUsU0FDVmxCLFFBQVMsQ0FHVCxJQUVFaEUsSUFDRlosUUFBUVksTUFBTSxnQ0FBaUNBLElBQy9DLFFBQ0VBLEVBQU0rRSxTQUFXLDZDQUl2QixDQUFFLE1BQU8vRSxHQUNQWixRQUFRWSxNQUFNLG1DQUFvQ0EsSUFDbEQsUUFDRSxnRUFFSixDQUFFLFNBQ0EsUUFBWSxrQkFBbUIsc0JBQ2pDLEtBR0ZaLFFBQVFzRixLQUFLLHFEQUVqQixFQ25iRVMsR0FFQS9GLFFBQVFDLElBQUksNkIsR0NkVitGLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQnJGLElBQWpCc0YsRUFDSCxPQUFPQSxFQUFhQyxRQUdyQixJQUFJQyxFQUFTTCxFQUF5QkUsR0FBWSxDQUdqREUsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JKLEdBQVVLLEtBQUtGLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNILEdBR3BFSSxFQUFPRCxPQUNmLENBR0FILEVBQW9CTyxFQUFJRixFTHpCcEIvRyxFQUFXLEdBQ2YwRyxFQUFvQlEsRUFBSSxDQUFDQyxFQUFRQyxFQUFVQyxFQUFJQyxLQUM5QyxJQUFHRixFQUFILENBTUEsSUFBSUcsRUFBZUMsSUFDbkIsSUFBU0MsRUFBSSxFQUFHQSxFQUFJekgsRUFBUzRFLE9BQVE2QyxJQUFLLENBR3pDLElBRkEsSUFBS0wsRUFBVUMsRUFBSUMsR0FBWXRILEVBQVN5SCxHQUNwQ0MsR0FBWSxFQUNQQyxFQUFJLEVBQUdBLEVBQUlQLEVBQVN4QyxPQUFRK0MsTUFDcEIsRUFBWEwsR0FBc0JDLEdBQWdCRCxJQUFhTSxPQUFPQyxLQUFLbkIsRUFBb0JRLEdBQUdZLE9BQU9DLEdBQVNyQixFQUFvQlEsRUFBRWEsR0FBS1gsRUFBU08sTUFDOUlQLEVBQVNZLE9BQU9MLElBQUssSUFFckJELEdBQVksRUFDVEosRUFBV0MsSUFBY0EsRUFBZUQsSUFHN0MsR0FBR0ksRUFBVyxDQUNiMUgsRUFBU2dJLE9BQU9QLElBQUssR0FDckIsSUFBSVEsRUFBSVosU0FDRS9GLElBQU4yRyxJQUFpQmQsRUFBU2MsRUFDL0IsQ0FDRCxDQUNBLE9BQU9kLENBbkJQLENBSkNHLEVBQVdBLEdBQVksRUFDdkIsSUFBSSxJQUFJRyxFQUFJekgsRUFBUzRFLE9BQVE2QyxFQUFJLEdBQUt6SCxFQUFTeUgsRUFBSSxHQUFHLEdBQUtILEVBQVVHLElBQUt6SCxFQUFTeUgsR0FBS3pILEVBQVN5SCxFQUFJLEdBQ3JHekgsRUFBU3lILEdBQUssQ0FBQ0wsRUFBVUMsRUFBSUMsSUNMM0JwSCxFQUFXMEgsT0FBT00sZUFBa0JDLEdBQVNQLE9BQU9NLGVBQWVDLEdBQVNBLEdBQVNBLEVBQWEsVUFRdEd6QixFQUFvQjBCLEVBQUksU0FBU2hFLEVBQU9pRSxHQUV2QyxHQURVLEVBQVBBLElBQVVqRSxFQUFRa0UsS0FBS2xFLElBQ2hCLEVBQVBpRSxFQUFVLE9BQU9qRSxFQUNwQixHQUFvQixpQkFBVkEsR0FBc0JBLEVBQU8sQ0FDdEMsR0FBVyxFQUFQaUUsR0FBYWpFLEVBQU1tRSxXQUFZLE9BQU9uRSxFQUMxQyxHQUFXLEdBQVBpRSxHQUFvQyxtQkFBZmpFLEVBQU1vRSxLQUFxQixPQUFPcEUsQ0FDNUQsQ0FDQSxJQUFJcUUsRUFBS2IsT0FBT2MsT0FBTyxNQUN2QmhDLEVBQW9CdUIsRUFBRVEsR0FDdEIsSUFBSUUsRUFBTSxDQUFDLEVBQ1gxSSxFQUFpQkEsR0FBa0IsQ0FBQyxLQUFNQyxFQUFTLENBQUMsR0FBSUEsRUFBUyxJQUFLQSxFQUFTQSxJQUMvRSxJQUFJLElBQUkwSSxFQUFpQixFQUFQUCxHQUFZakUsRUFBeUIsaUJBQVh3RSxLQUF5QjNJLEVBQWU0SSxRQUFRRCxHQUFVQSxFQUFVMUksRUFBUzBJLEdBQ3hIaEIsT0FBT2tCLG9CQUFvQkYsR0FBU0csU0FBU2hCLEdBQVNZLEVBQUlaLEdBQU8sSUFBTzNELEVBQU0yRCxLQUkvRSxPQUZBWSxFQUFhLFFBQUksSUFBTSxFQUN2QmpDLEVBQW9Cc0MsRUFBRVAsRUFBSUUsR0FDbkJGLENBQ1IsRUt4QkEvQixFQUFvQnNDLEVBQUksQ0FBQ25DLEVBQVNvQyxLQUNqQyxJQUFJLElBQUlsQixLQUFPa0IsRUFDWHZDLEVBQW9Cd0MsRUFBRUQsRUFBWWxCLEtBQVNyQixFQUFvQndDLEVBQUVyQyxFQUFTa0IsSUFDNUVILE9BQU91QixlQUFldEMsRUFBU2tCLEVBQUssQ0FBRXFCLFlBQVksRUFBTUMsSUFBS0osRUFBV2xCLE1DSjNFckIsRUFBb0I0QyxFQUFJLENBQUMsRUFHekI1QyxFQUFvQm5GLEVBQUtnSSxHQUNqQi9ELFFBQVFnRSxJQUFJNUIsT0FBT0MsS0FBS25CLEVBQW9CNEMsR0FBR0csUUFBTyxDQUFDQyxFQUFVM0IsS0FDdkVyQixFQUFvQjRDLEVBQUV2QixHQUFLd0IsRUFBU0csR0FDN0JBLElBQ0wsS0NOSmhELEVBQW9CaUQsRUFBS0osR0FFakIsTUFBUUEsRUFBVSxZQ0gxQjdDLEVBQW9Ca0QsRUFBSSxXQUN2QixHQUEwQixpQkFBZkMsV0FBeUIsT0FBT0EsV0FDM0MsSUFDQyxPQUFPdkIsTUFBUSxJQUFJd0IsU0FBUyxjQUFiLEVBQ2hCLENBQUUsTUFBT3ZJLEdBQ1IsR0FBc0IsaUJBQVhoQixPQUFxQixPQUFPQSxNQUN4QyxDQUNBLENBUHVCLEdDQXhCbUcsRUFBb0J3QyxFQUFJLENBQUNmLEVBQUs0QixJQUFVbkMsT0FBT29DLFVBQVVDLGVBQWVqRCxLQUFLbUIsRUFBSzRCLEdSQTlFNUosRUFBYSxDQUFDLEVBQ2RDLEVBQW9CLG9CQUV4QnNHLEVBQW9Cd0QsRUFBSSxDQUFDQyxFQUFLQyxFQUFNckMsRUFBS3dCLEtBQ3hDLEdBQUdwSixFQUFXZ0ssR0FBUWhLLEVBQVdnSyxHQUFLeEYsS0FBS3lGLE9BQTNDLENBQ0EsSUFBSUMsRUFBUUMsRUFDWixRQUFXaEosSUFBUnlHLEVBRUYsSUFEQSxJQUFJd0MsRUFBVTNKLFNBQVM0SixxQkFBcUIsVUFDcEMvQyxFQUFJLEVBQUdBLEVBQUk4QyxFQUFRM0YsT0FBUTZDLElBQUssQ0FDdkMsSUFBSWdELEVBQUlGLEVBQVE5QyxHQUNoQixHQUFHZ0QsRUFBRUMsYUFBYSxRQUFVUCxHQUFPTSxFQUFFQyxhQUFhLGlCQUFtQnRLLEVBQW9CMkgsRUFBSyxDQUFFc0MsRUFBU0ksRUFBRyxLQUFPLENBQ3BILENBRUdKLElBQ0hDLEdBQWEsR0FDYkQsRUFBU3pKLFNBQVMrSixjQUFjLFdBRXpCQyxRQUFVLFFBQ2pCUCxFQUFPUSxRQUFVLElBQ2JuRSxFQUFvQm9FLElBQ3ZCVCxFQUFPVSxhQUFhLFFBQVNyRSxFQUFvQm9FLElBRWxEVCxFQUFPVSxhQUFhLGVBQWdCM0ssRUFBb0IySCxHQUV4RHNDLEVBQU9XLElBQU1iLEdBRWRoSyxFQUFXZ0ssR0FBTyxDQUFDQyxHQUNuQixJQUFJYSxFQUFtQixDQUFDQyxFQUFNQyxLQUU3QmQsRUFBT2UsUUFBVWYsRUFBT2dCLE9BQVMsS0FDakNDLGFBQWFULEdBQ2IsSUFBSVUsRUFBVXBMLEVBQVdnSyxHQUl6QixVQUhPaEssRUFBV2dLLEdBQ2xCRSxFQUFPbUIsWUFBY25CLEVBQU9tQixXQUFXQyxZQUFZcEIsR0FDbkRrQixHQUFXQSxFQUFReEMsU0FBUzFCLEdBQVFBLEVBQUc4RCxLQUNwQ0QsRUFBTSxPQUFPQSxFQUFLQyxJQUVsQk4sRUFBVW5GLFdBQVd1RixFQUFpQlMsS0FBSyxVQUFNcEssRUFBVyxDQUFFcUssS0FBTSxVQUFXN0gsT0FBUXVHLElBQVcsTUFDdEdBLEVBQU9lLFFBQVVILEVBQWlCUyxLQUFLLEtBQU1yQixFQUFPZSxTQUNwRGYsRUFBT2dCLE9BQVNKLEVBQWlCUyxLQUFLLEtBQU1yQixFQUFPZ0IsUUFDbkRmLEdBQWMxSixTQUFTZ0wsS0FBS0MsWUFBWXhCLEVBcENrQixHU0gzRDNELEVBQW9CdUIsRUFBS3BCLElBQ0gsb0JBQVhpRixRQUEwQkEsT0FBT0MsYUFDMUNuRSxPQUFPdUIsZUFBZXRDLEVBQVNpRixPQUFPQyxZQUFhLENBQUUzSCxNQUFPLFdBRTdEd0QsT0FBT3VCLGVBQWV0QyxFQUFTLGFBQWMsQ0FBRXpDLE9BQU8sS0NMdkRzQyxFQUFvQmlCLEVBQUksSUNBeEJqQixFQUFvQnNGLEVBQUksSSxNQ0t4QixJQUFJQyxFQUFrQixDQUNyQixJQUFLLEdBR052RixFQUFvQjRDLEVBQUUzQixFQUFJLENBQUM0QixFQUFTRyxLQUVsQyxJQUFJd0MsRUFBcUJ4RixFQUFvQndDLEVBQUUrQyxFQUFpQjFDLEdBQVcwQyxFQUFnQjFDLFFBQVdqSSxFQUN0RyxHQUEwQixJQUF2QjRLLEVBR0YsR0FBR0EsRUFDRnhDLEVBQVMvRSxLQUFLdUgsRUFBbUIsUUFDM0IsQ0FHTCxJQUFJQyxFQUFVLElBQUkzRyxTQUFRLENBQUNDLEVBQVMyRyxJQUFZRixFQUFxQkQsRUFBZ0IxQyxHQUFXLENBQUM5RCxFQUFTMkcsS0FDMUcxQyxFQUFTL0UsS0FBS3VILEVBQW1CLEdBQUtDLEdBR3RDLElBQUloQyxFQUFNekQsRUFBb0JzRixFQUFJdEYsRUFBb0JpRCxFQUFFSixHQUVwRGxJLEVBQVEsSUFBSThCLE1BZ0JoQnVELEVBQW9Cd0QsRUFBRUMsR0FmRmdCLElBQ25CLEdBQUd6RSxFQUFvQndDLEVBQUUrQyxFQUFpQjFDLEtBRWYsS0FEMUIyQyxFQUFxQkQsRUFBZ0IxQyxNQUNSMEMsRUFBZ0IxQyxRQUFXakksR0FDckQ0SyxHQUFvQixDQUN0QixJQUFJRyxFQUFZbEIsSUFBeUIsU0FBZkEsRUFBTVEsS0FBa0IsVUFBWVIsRUFBTVEsTUFDaEVXLEVBQVVuQixHQUFTQSxFQUFNckgsUUFBVXFILEVBQU1ySCxPQUFPa0gsSUFDcEQzSixFQUFNK0UsUUFBVSxpQkFBbUJtRCxFQUFVLGNBQWdCOEMsRUFBWSxLQUFPQyxFQUFVLElBQzFGakwsRUFBTWtMLEtBQU8saUJBQ2JsTCxFQUFNc0ssS0FBT1UsRUFDYmhMLEVBQU1tTCxRQUFVRixFQUNoQkosRUFBbUIsR0FBRzdLLEVBQ3ZCLElBR3VDLFNBQVdrSSxFQUFTQSxFQUUvRCxHQVlIN0MsRUFBb0JRLEVBQUVTLEVBQUs0QixHQUEwQyxJQUE3QjBDLEVBQWdCMUMsR0FHeEQsSUFBSWtELEVBQXVCLENBQUNDLEVBQTRCekgsS0FDdkQsSUFHSTBCLEVBQVU0QyxHQUhUbkMsRUFBVXVGLEVBQWFDLEdBQVczSCxFQUdoQndDLEVBQUksRUFDM0IsR0FBR0wsRUFBU3lGLE1BQU10SCxHQUFnQyxJQUF4QjBHLEVBQWdCMUcsS0FBYSxDQUN0RCxJQUFJb0IsS0FBWWdHLEVBQ1pqRyxFQUFvQndDLEVBQUV5RCxFQUFhaEcsS0FDckNELEVBQW9CTyxFQUFFTixHQUFZZ0csRUFBWWhHLElBR2hELEdBQUdpRyxFQUFTLElBQUl6RixFQUFTeUYsRUFBUWxHLEVBQ2xDLENBRUEsSUFER2dHLEdBQTRCQSxFQUEyQnpILEdBQ3JEd0MsRUFBSUwsRUFBU3hDLE9BQVE2QyxJQUN6QjhCLEVBQVVuQyxFQUFTSyxHQUNoQmYsRUFBb0J3QyxFQUFFK0MsRUFBaUIxQyxJQUFZMEMsRUFBZ0IxQyxJQUNyRTBDLEVBQWdCMUMsR0FBUyxLQUUxQjBDLEVBQWdCMUMsR0FBVyxFQUU1QixPQUFPN0MsRUFBb0JRLEVBQUVDLElBRzFCMkYsRUFBcUJDLEtBQW1DLDZCQUFJQSxLQUFtQyw4QkFBSyxHQUN4R0QsRUFBbUIvRCxRQUFRMEQsRUFBcUJmLEtBQUssS0FBTSxJQUMzRG9CLEVBQW1CbkksS0FBTzhILEVBQXFCZixLQUFLLEtBQU1vQixFQUFtQm5JLEtBQUsrRyxLQUFLb0IsRyxLQ2xGdkYsSUFBSUUsRUFBc0J0RyxFQUFvQlEsT0FBRTVGLEVBQVcsQ0FBQyxLQUFLLElBQU9vRixFQUFvQixRQUM1RnNHLEVBQXNCdEcsRUFBb0JRLEVBQUU4RixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NyZWF0ZSBmYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9hdXRoL3NpZ251cC5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2VudHJpZXMvc2lnbnVwLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZW5zdXJlIGNodW5rIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL3J1bnRpbWVJZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0dmFyIHIgPSBmbigpO1xuXHRcdFx0aWYgKHIgIT09IHVuZGVmaW5lZCkgcmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwidmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mID8gKG9iaikgPT4gKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopKSA6IChvYmopID0+IChvYmouX19wcm90b19fKTtcbnZhciBsZWFmUHJvdG90eXBlcztcbi8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLy8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4vLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbi8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLy8gbW9kZSAmIDE2OiByZXR1cm4gdmFsdWUgd2hlbiBpdCdzIFByb21pc2UtbGlrZVxuLy8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuX193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcblx0aWYobW9kZSAmIDEpIHZhbHVlID0gdGhpcyh2YWx1ZSk7XG5cdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG5cdGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUpIHtcblx0XHRpZigobW9kZSAmIDQpICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcblx0XHRpZigobW9kZSAmIDE2KSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHZhbHVlO1xuXHR9XG5cdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG5cdHZhciBkZWYgPSB7fTtcblx0bGVhZlByb3RvdHlwZXMgPSBsZWFmUHJvdG90eXBlcyB8fCBbbnVsbCwgZ2V0UHJvdG8oe30pLCBnZXRQcm90byhbXSksIGdldFByb3RvKGdldFByb3RvKV07XG5cdGZvcih2YXIgY3VycmVudCA9IG1vZGUgJiAyICYmIHZhbHVlOyB0eXBlb2YgY3VycmVudCA9PSAnb2JqZWN0JyAmJiAhfmxlYWZQcm90b3R5cGVzLmluZGV4T2YoY3VycmVudCk7IGN1cnJlbnQgPSBnZXRQcm90byhjdXJyZW50KSkge1xuXHRcdE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGN1cnJlbnQpLmZvckVhY2goKGtleSkgPT4gKGRlZltrZXldID0gKCkgPT4gKHZhbHVlW2tleV0pKSk7XG5cdH1cblx0ZGVmWydkZWZhdWx0J10gPSAoKSA9PiAodmFsdWUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGRlZik7XG5cdHJldHVybiBucztcbn07IiwidmFyIGluUHJvZ3Jlc3MgPSB7fTtcbnZhciBkYXRhV2VicGFja1ByZWZpeCA9IFwidXJiYW5kb2NzX3dlYmFwcDpcIjtcbi8vIGxvYWRTY3JpcHQgZnVuY3Rpb24gdG8gbG9hZCBhIHNjcmlwdCB2aWEgc2NyaXB0IHRhZ1xuX193ZWJwYWNrX3JlcXVpcmVfXy5sID0gKHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSA9PiB7XG5cdGlmKGluUHJvZ3Jlc3NbdXJsXSkgeyBpblByb2dyZXNzW3VybF0ucHVzaChkb25lKTsgcmV0dXJuOyB9XG5cdHZhciBzY3JpcHQsIG5lZWRBdHRhY2g7XG5cdGlmKGtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHMgPSBzY3JpcHRzW2ldO1xuXHRcdFx0aWYocy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgPT0gdXJsIHx8IHMuZ2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIpID09IGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KSB7IHNjcmlwdCA9IHM7IGJyZWFrOyB9XG5cdFx0fVxuXHR9XG5cdGlmKCFzY3JpcHQpIHtcblx0XHRuZWVkQXR0YWNoID0gdHJ1ZTtcblx0XHRzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblxuXHRcdHNjcmlwdC5jaGFyc2V0ID0gJ3V0Zi04Jztcblx0XHRzY3JpcHQudGltZW91dCA9IDEyMDtcblx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5uYykge1xuXHRcdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcIm5vbmNlXCIsIF9fd2VicGFja19yZXF1aXJlX18ubmMpO1xuXHRcdH1cblx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIsIGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KTtcblxuXHRcdHNjcmlwdC5zcmMgPSB1cmw7XG5cdH1cblx0aW5Qcm9ncmVzc1t1cmxdID0gW2RvbmVdO1xuXHR2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCkgPT4ge1xuXHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cblx0XHRzY3JpcHQub25lcnJvciA9IHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR2YXIgZG9uZUZucyA9IGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRkZWxldGUgaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdHNjcmlwdC5wYXJlbnROb2RlICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdFx0ZG9uZUZucyAmJiBkb25lRm5zLmZvckVhY2goKGZuKSA9PiAoZm4oZXZlbnQpKSk7XG5cdFx0aWYocHJldikgcmV0dXJuIHByZXYoZXZlbnQpO1xuXHR9XG5cdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgdW5kZWZpbmVkLCB7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSksIDEyMDAwMCk7XG5cdHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcblx0c2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcblx0bmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG59OyIsIi8vIHNyYy9hdXRoL3NpZ251cC5qc1xuLyoqXG4gKiBTaWdudXAgTW9kdWxlXG4gKiBAbW9kdWxlIHNpZ251cFxuICogQGRlc2NyaXB0aW9uIEhhbmRsZXMgdXNlciByZWdpc3RyYXRpb24gd2l0aCBjbGllbnQtc2lkZSB2YWxpZGF0aW9uLCBHb29nbGUgT0F1dGgsIGFuZCBwaG9uZSB2ZXJpZmljYXRpb24gdXNpbmcgU3VwYWJhc2UuXG4gKiBAdmVyc2lvbiAwLjIuMVxuICpcbiAqIEBjaGFuZ2Vsb2dcbiAqIC0gMC4yLjEgKDIwMjUtMDUtMTgpOiBBZGRlZCBjYXB0Y2hhIHdpdGggQ2xvdWRmbGFyZSBUdXJuc3RpbGUuXG4gKiAtIDAuMi4wICgyMDI1LTA1LTE4KTogQWRkZWQgcGhvbmUgbnVtYmVyIGlucHV0LCBPVFAgc2VuZGluZyBhbmQgdmVyaWZpY2F0aW9uIGZvciBlbWFpbC9wYXNzd29yZCBzaWdudXAuXG4gKiAtIDAuMS4xICgyMDI1LTA1LTE4KTogQWRkZWQgR29vZ2xlIFNpZ24tVXAgZnVuY3Rpb25hbGl0eS5cbiAqIC0gMC4xLjAgKDIwMjUtMDUtMTUpOiBNaWdyYXRlZCB0byBTdXBhYmFzZSBjbGllbnQtc2lkZSBhdXRoICh2ZXJzaW9uaW5nIGFkanVzdGVkKVxuICovXG5cbmltcG9ydCB7XG4gIHNob3dFcnJvcixcbiAgc2hvd1N0YXR1cyxcbiAgc2hvd0xvYWRpbmcsXG4gIGhpZGVMb2FkaW5nLFxuICBoaWRlRWxlbWVudCxcbn0gZnJvbSBcIi4vYXV0aC5qc1wiO1xuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5cbi8vIFN0b3JlIHBob25lIG51bWJlciB0ZW1wb3JhcmlseSBiZXR3ZWVuIHN0ZXBzXG5sZXQgY2FwdGNoYVRva2VuID0gbnVsbDsgLy8gVG8gc3RvcmUgdGhlIGNhcHRjaGEgdG9rZW4gKHVzZWQgYnkgYm90aCBoQ2FwdGNoYSBhbmQgVHVybnN0aWxlKVxubGV0IHR1cm5zdGlsZVdpZGdldElkID0gbnVsbDsgLy8gVG8gc3RvcmUgVHVybnN0aWxlIHdpZGdldCBJRFxuXG4vLyBUaGlzIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGJ5IHRoZSBDbG91ZGZsYXJlIFR1cm5zdGlsZSBzY3JpcHQgb25jZSBpdCdzIGxvYWRlZFxuLy8gKGR1ZSB0byAmb25sb2FkPW9ubG9hZFR1cm5zdGlsZUNhbGxiYWNrIGluIHRoZSBzY3JpcHQgdGFnIGluIHNpZ251cC5odG1sKVxud2luZG93Lm9ubG9hZFR1cm5zdGlsZUNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICBjb25zb2xlLmxvZyhcIlR1cm5zdGlsZSBBUEkgcmVhZHkgKG9ubG9hZFR1cm5zdGlsZUNhbGxiYWNrIGV4ZWN1dGVkKS5cIik7XG4gIGNvbnN0IHR1cm5zdGlsZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHVybnN0aWxlLWNvbnRhaW5lclwiKTtcblxuICBpZiAodHVybnN0aWxlQ29udGFpbmVyICYmIHdpbmRvdy50dXJuc3RpbGUgJiYgIXR1cm5zdGlsZVdpZGdldElkKSB7XG4gICAgY29uc29sZS5sb2coXCJSZW5kZXJpbmcgVHVybnN0aWxlIHdpZGdldCBmcm9tIG9ubG9hZFR1cm5zdGlsZUNhbGxiYWNrLi4uXCIpO1xuICAgIHRyeSB7XG4gICAgICB0dXJuc3RpbGVXaWRnZXRJZCA9IHdpbmRvdy50dXJuc3RpbGUucmVuZGVyKHR1cm5zdGlsZUNvbnRhaW5lciwge1xuICAgICAgICBzaXRla2V5OiBcIjB4NEFBQUFBQUJkelkzSW5PVTJfSW45OVwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgY2FwdGNoYVRva2VuID0gdG9rZW47XG4gICAgICAgICAgY29uc29sZS5sb2coXCJUdXJuc3RpbGUgdG9rZW4gb2J0YWluZWQ6XCIsIHRva2VuKTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJleHBpcmVkLWNhbGxiYWNrXCI6ICgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgIFwiVHVybnN0aWxlIHRva2VuIGV4cGlyZWQuIFJlc2V0dGluZyB3aWRnZXQuIElEOlwiLFxuICAgICAgICAgICAgdHVybnN0aWxlV2lkZ2V0SWRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICh3aW5kb3cudHVybnN0aWxlICYmIHR1cm5zdGlsZVdpZGdldElkKSB7XG4gICAgICAgICAgICB3aW5kb3cudHVybnN0aWxlLnJlc2V0KHR1cm5zdGlsZVdpZGdldElkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FwdGNoYVRva2VuID0gbnVsbDsgLy8gQ2xlYXIgdGhlIHRva2VuXG4gICAgICAgICAgLy8gV2lkZ2V0IHNob3VsZCBiZSByZWFkeSBmb3IgYSBuZXcgY2hhbGxlbmdlIGFmdGVyIHJlc2V0LlxuICAgICAgICB9LFxuICAgICAgICBcImVycm9yLWNhbGxiYWNrXCI6IChlcnIpID0+IHtcbiAgICAgICAgICBjYXB0Y2hhVG9rZW4gPSBudWxsO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJUdXJuc3RpbGUgZXJyb3IgY2FsbGJhY2s6XCIsIGVycik7XG4gICAgICAgICAgc2hvd0Vycm9yKGBFcnJldXIgQ0FQVENIQTogJHtlcnJ9LiBWZXVpbGxleiByw6llc3NheWVyLmApO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBpZiAodHVybnN0aWxlV2lkZ2V0SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIFwiVHVybnN0aWxlLnJlbmRlciBkaWQgbm90IHJldHVybiBhIHdpZGdldElkLiBTaXRla2V5IG9yIGNvbnRhaW5lciBpc3N1ZT9cIlxuICAgICAgICApO1xuICAgICAgICBzaG93RXJyb3IoXCJFcnJldXIgaW5pdGlhbGlzYXRpb24gQ0FQVENIQSAoSUQgd2lkZ2V0IG5vbiByZXRvdXJuw6kpLlwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVHVybnN0aWxlIHdpZGdldCByZW5kZXJlZC4gSUQ6XCIsIHR1cm5zdGlsZVdpZGdldElkKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVuZGVyaW5nIFR1cm5zdGlsZTpcIiwgZSk7XG4gICAgICBzaG93RXJyb3IoXCJJbXBvc3NpYmxlIGQnYWZmaWNoZXIgbGUgQ0FQVENIQS5cIik7XG4gICAgfVxuICB9IGVsc2UgaWYgKCF0dXJuc3RpbGVDb250YWluZXIpIHtcbiAgICBjb25zb2xlLmVycm9yKFwib25sb2FkVHVybnN0aWxlQ2FsbGJhY2s6ICN0dXJuc3RpbGUtY29udGFpbmVyIG5vdCBmb3VuZC5cIik7XG4gIH0gZWxzZSBpZiAoIXdpbmRvdy50dXJuc3RpbGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwib25sb2FkVHVybnN0aWxlQ2FsbGJhY2s6IHdpbmRvdy50dXJuc3RpbGUgQVBJIG5vdCBmb3VuZC5cIik7XG4gIH0gZWxzZSBpZiAodHVybnN0aWxlV2lkZ2V0SWQpIHtcbiAgICBjb25zb2xlLmxvZyhcIm9ubG9hZFR1cm5zdGlsZUNhbGxiYWNrOiBXaWRnZXQgYWxyZWFkeSBzZWVtcyByZW5kZXJlZC5cIik7XG4gIH1cbn07XG5cbi8qKlxuICogU2hvdyBkZXRhaWxlZCBzaWdudXAgc3VjY2VzcyBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gZW1haWwgLSBUaGUgZW1haWwgYWRkcmVzcyB1c2VkIGZvciBzaWdudXBcbiAqL1xuZnVuY3Rpb24gc2hvd1NpZ251cFN1Y2Nlc3MoZW1haWwpIHtcbiAgY29uc3Qgc3RhdHVzRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhdHVzTWVzc2FnZVwiKTtcbiAgaWYgKHN0YXR1c0VsZW1lbnQpIHtcbiAgICBzdGF0dXNFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgIDxkaXYgY2xhc3M9XCJzaWdudXAtc3VjY2Vzc1wiPlxuICAgICAgICA8aDM+Q29tcHRlIGNyw6nDqSBhdmVjIHN1Y2PDqHMgITwvaDM+XG4gICAgICAgIDxwPjxzdHJvbmc+VW4gZW1haWwgZGUgY29uZmlybWF0aW9uIGEgw6l0w6kgZW52b3nDqSDDoCA6PC9zdHJvbmc+PGJyPlxuICAgICAgICA8Y29kZT4ke2VtYWlsfTwvY29kZT48L3A+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29uZmlybWF0aW9uLWluc3RydWN0aW9uc1wiPlxuICAgICAgICAgIDxoND7wn5OnIFByb2NoYWluZXMgw6l0YXBlcyA6PC9oND5cbiAgICAgICAgICA8b2w+XG4gICAgICAgICAgICA8bGk+VsOpcmlmaWV6IHZvdHJlIGJvw650ZSBkZSByw6ljZXB0aW9uIChldCBuJ291YmxpZXogcGFzIHZvcyBzcGFtcyAhKTwvbGk+XG4gICAgICAgICAgICA8bGk+Q2xpcXVleiBzdXIgbGUgbGllbiBkZSBjb25maXJtYXRpb24gZGFucyBsJ2VtYWlsPC9saT5cbiAgICAgICAgICAgIDxsaT5Wb3VzIHBvdXJyZXogZW5zdWl0ZSB2b3VzIGNvbm5lY3RlciBhdmVjIHZvcyBpZGVudGlmaWFudHM8L2xpPlxuICAgICAgICAgIDwvb2w+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbmZpcm1hdGlvbi1ub3RlXCI+XG4gICAgICAgICAgPHA+PHN0cm9uZz5Ob3RlIDo8L3N0cm9uZz4gVm91cyBkZXZleiBjb25maXJtZXIgdm90cmUgZW1haWwgYXZhbnQgZGUgcG91dm9pciB2b3VzIGNvbm5lY3Rlci48L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYDtcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwic3VjY2Vzc1wiKTtcbiAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIHRoZSBzaWdudXAgcGFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFNpZ251cFBhZ2UoKSB7XG4gIGNvbnNvbGUubG9nKFwiaW5pdFNpZ251cFBhZ2UgY2FsbGVkXCIpO1xuICBjb25zdCBzaWdudXBGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzaWdudXBGb3JtXCIpO1xuICBjb25zdCBlcnJvck1lc3NhZ2VEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycm9yTWVzc2FnZVwiKTtcbiAgY29uc3Qgc3RhdHVzTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhdHVzTWVzc2FnZVwiKTtcbiAgY29uc3QgZ29vZ2xlU2lnblVwQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnb29nbGVTaWduVXBCdG5cIik7XG4gIGNvbnN0IHR1cm5zdGlsZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHVybnN0aWxlLWNvbnRhaW5lclwiKTtcblxuICAvLyAtLS0gVGVybXMgb2YgU2VydmljZSBMb2dpYyBmb3IgU2lnbnVwIC0tLVxuICBjb25zdCB0b3NDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zQ2hlY2tib3hcIik7XG4gIGNvbnN0IHRvc01vZGFsRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zTW9kYWxcIik7XG4gIGNvbnN0IHRvc01vZGFsQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zTW9kYWxCb2R5XCIpO1xuICBjb25zdCBzaWdudXBCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpZ251cEJ0blwiKTtcbiAgY29uc3QgdG9zU3RhdHVzTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zU3RhdHVzTWVzc2FnZVwiKTtcbiAgY29uc3QgdG9zTGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zTGlua1wiKTtcbiAgY29uc3QgdG9zTW9kYWxDbG9zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9zTW9kYWxDbG9zZVwiKTtcblxuICAvLyBJbml0aWFsbHkgZGlzYWJsZSBzaWdudXAgYnV0dG9uLCBHb29nbGUgYnV0dG9uLCBhbmQgY2hlY2tib3hcbiAgaWYgKHNpZ251cEJ0bikge1xuICAgIHNpZ251cEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbiAgaWYgKGdvb2dsZVNpZ25VcEJ0bikge1xuICAgIGdvb2dsZVNpZ25VcEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbiAgaWYgKHRvc0NoZWNrYm94KSB7XG4gICAgdG9zQ2hlY2tib3guZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgLy8gQ3VzdG9tIG1vZGFsIGhhbmRsaW5nXG4gIGlmICh0b3NMaW5rICYmIHRvc01vZGFsRWxlbWVudCkge1xuICAgIHRvc0xpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzaG93TW9kYWwoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmICh0b3NNb2RhbENsb3NlKSB7XG4gICAgdG9zTW9kYWxDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgaGlkZU1vZGFsKCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBDbG9zZSBtb2RhbCB3aGVuIGNsaWNraW5nIG91dHNpZGVcbiAgaWYgKHRvc01vZGFsRWxlbWVudCkge1xuICAgIHRvc01vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gdG9zTW9kYWxFbGVtZW50KSB7XG4gICAgICAgIGhpZGVNb2RhbCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd01vZGFsKCkge1xuICAgIGlmICh0b3NNb2RhbEVsZW1lbnQpIHtcbiAgICAgIHRvc01vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwic2hvd1wiKTtcbiAgICAgIHRvc01vZGFsRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cbiAgICAgIC8vIExvYWQgVG9TIGNvbnRlbnQgaWYgbm90IGFscmVhZHkgbG9hZGVkXG4gICAgICBpZiAodG9zTW9kYWxCb2R5ICYmIHRvc01vZGFsQm9keS5kYXRhc2V0LmxvYWRlZCAhPT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgbG9hZFRvU0NvbnRlbnQoKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW5hYmxlIGNoZWNrYm94IGltbWVkaWF0ZWx5IHdoZW4gbW9kYWwgb3BlbnNcbiAgICAgIGlmICh0b3NDaGVja2JveCkge1xuICAgICAgICB0b3NDaGVja2JveC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVNb2RhbCgpIHtcbiAgICBpZiAodG9zTW9kYWxFbGVtZW50KSB7XG4gICAgICB0b3NNb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInNob3dcIik7XG4gICAgICB0b3NNb2RhbEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiXCI7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gbG9hZFRvU0NvbnRlbnQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRvc01vZGFsQm9keS5pbm5lckhUTUwgPVxuICAgICAgICBcIjxwPkNoYXJnZW1lbnQgZGVzIGNvbmRpdGlvbnMgZCd1dGlsaXNhdGlvbi4uLjwvcD5cIjtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcIi9wb2xpY2llcy90ZXJtc1wiKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gbG9hZCBUZXJtcyBvZiBTZXJ2aWNlOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG9zSHRtbCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcblxuICAgICAgLy8gRXh0cmFjdCBqdXN0IHRoZSBjb250ZW50IGZyb20gdGhlIEhUTUxcbiAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcodG9zSHRtbCwgXCJ0ZXh0L2h0bWxcIik7XG4gICAgICBjb25zdCBtYWluQ29udGVudCA9XG4gICAgICAgIGRvYy5xdWVyeVNlbGVjdG9yKFwibWFpblwiKSB8fFxuICAgICAgICBkb2MucXVlcnlTZWxlY3RvcihcIi5wb2xpY3ktY29udGFpbmVyXCIpIHx8XG4gICAgICAgIGRvYy5ib2R5O1xuXG4gICAgICBpZiAobWFpbkNvbnRlbnQpIHtcbiAgICAgICAgdG9zTW9kYWxCb2R5LmlubmVySFRNTCA9IG1haW5Db250ZW50LmlubmVySFRNTDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvc01vZGFsQm9keS5pbm5lckhUTUwgPSB0b3NIdG1sO1xuICAgICAgfVxuXG4gICAgICB0b3NNb2RhbEJvZHkuZGF0YXNldC5sb2FkZWQgPSBcInRydWVcIjtcbiAgICAgIHRvc01vZGFsQm9keS5zY3JvbGxUb3AgPSAwO1xuXG4gICAgICAvLyBFbmFibGUgY2hlY2tib3ggYWZ0ZXIgY29udGVudCBpcyBsb2FkZWRcbiAgICAgIGlmICh0b3NDaGVja2JveCkge1xuICAgICAgICB0b3NDaGVja2JveC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgbG9hZGluZyBUb1M6XCIsIGVycm9yKTtcbiAgICAgIHRvc01vZGFsQm9keS5pbm5lckhUTUwgPSBgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJjb2xvcjogI2RjMzU0NTsgcGFkZGluZzogMXJlbTsgYm9yZGVyOiAxcHggc29saWQgI2RjMzU0NTsgYm9yZGVyLXJhZGl1czogNHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhkN2RhO1wiPlxuICAgICAgICAgIDxwPjxzdHJvbmc+RXJyZXVyIGxvcnMgZHUgY2hhcmdlbWVudCBkZXMgY29uZGl0aW9ucyBkJ3V0aWxpc2F0aW9uLjwvc3Ryb25nPjwvcD5cbiAgICAgICAgICA8cD5WZXVpbGxleiByw6llc3NheWVyIG91IGNvbnN1bHRlciBsZXMgY29uZGl0aW9ucyBkaXJlY3RlbWVudCBzdXIgPGEgaHJlZj1cIi9wb2xpY2llcy90ZXJtc1wiIHRhcmdldD1cIl9ibGFua1wiPmNldHRlIHBhZ2U8L2E+LjwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgO1xuXG4gICAgICAvLyBFbmFibGUgY2hlY2tib3ggZXZlbiBpZiB0aGVyZSdzIGFuIGVycm9yIGxvYWRpbmcgY29udGVudFxuICAgICAgaWYgKHRvc0NoZWNrYm94KSB7XG4gICAgICAgIHRvc0NoZWNrYm94LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gSGFuZGxlIGNoZWNrYm94IGNoYW5nZVxuICBpZiAodG9zQ2hlY2tib3gpIHtcbiAgICB0b3NDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IGlzQ2hlY2tlZCA9IHRvc0NoZWNrYm94LmNoZWNrZWQ7XG5cbiAgICAgIC8vIEVuYWJsZS9kaXNhYmxlIGJvdGggYnV0dG9ucyBiYXNlZCBvbiBUb1MgYWNjZXB0YW5jZVxuICAgICAgaWYgKHNpZ251cEJ0bikge1xuICAgICAgICBzaWdudXBCdG4uZGlzYWJsZWQgPSAhaXNDaGVja2VkO1xuICAgICAgfVxuICAgICAgaWYgKGdvb2dsZVNpZ25VcEJ0bikge1xuICAgICAgICBnb29nbGVTaWduVXBCdG4uZGlzYWJsZWQgPSAhaXNDaGVja2VkO1xuICAgICAgfVxuXG4gICAgICAvLyBIaWRlL3Nob3cgVG9TIHN0YXR1cyBtZXNzYWdlXG4gICAgICBpZiAodG9zU3RhdHVzTWVzc2FnZSkge1xuICAgICAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAgICAgdG9zU3RhdHVzTWVzc2FnZS5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvc1N0YXR1c01lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWlzQ2hlY2tlZCkge1xuICAgICAgICBzaG93RXJyb3IoXG4gICAgICAgICAgXCJWZXVpbGxleiBhY2NlcHRlciBsZXMgQ29uZGl0aW9ucyBHw6luw6lyYWxlcyBkJ1V0aWxpc2F0aW9uLlwiLFxuICAgICAgICAgIFwiZXJyb3JNZXNzYWdlXCJcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIENsZWFyIFRvUy1yZWxhdGVkIGVycm9yIG1lc3NhZ2VzXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyb3JNZXNzYWdlXCIpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZXJyb3JFbGVtZW50ICYmXG4gICAgICAgICAgZXJyb3JFbGVtZW50LmlubmVySFRNTC5pbmNsdWRlcyhcIkNvbmRpdGlvbnMgR8OpbsOpcmFsZXMgZCdVdGlsaXNhdGlvblwiKVxuICAgICAgICApIHtcbiAgICAgICAgICBoaWRlRWxlbWVudChcImVycm9yTWVzc2FnZVwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8vIC0tLSBFbmQgVGVybXMgb2YgU2VydmljZSBMb2dpYyBmb3IgU2lnbnVwIC0tLVxuXG4gIGlmICghdHVybnN0aWxlQ29udGFpbmVyKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiI3R1cm5zdGlsZS1jb250YWluZXIgbm90IGZvdW5kIGluIHRoZSBET00uIENBUFRDSEEgY2Fubm90IGJlIHJlbmRlcmVkLlwiXG4gICAgKTtcbiAgfVxuXG4gIGlmIChzaWdudXBGb3JtKSB7XG4gICAgc2lnbnVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGFzeW5jIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGNvbnN0IGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbWFpbFwiKS52YWx1ZS50cmltKCk7XG4gICAgICBjb25zdCBwYXNzd29yZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGFzc3dvcmRcIikudmFsdWU7XG4gICAgICBjb25zdCBjb25maXJtUGFzc3dvcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1QYXNzd29yZFwiKS52YWx1ZTtcbiAgICAgIGxldCBwaG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGhvbmVcIikudmFsdWUudHJpbSgpOyAvLyBHZXQgcGhvbmUgbnVtYmVyXG5cbiAgICAgIGxldCB2YWxpZGF0aW9uRXJyb3JzID0gW107XG4gICAgICBjb25zdCBlbWFpbFBhdHRlcm4gPSAvXlteXFxzQF0rQFteXFxzQF0rXFwuW15cXHNAXSskLztcbiAgICAgIGlmICghZW1haWxQYXR0ZXJuLnRlc3QoZW1haWwpKVxuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzLnB1c2goXCJMJ2FkcmVzc2UgZW1haWwgbidlc3QgcGFzIHZhbGlkZS5cIik7XG4gICAgICBpZiAocGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZClcbiAgICAgICAgdmFsaWRhdGlvbkVycm9ycy5wdXNoKFwiTGVzIG1vdHMgZGUgcGFzc2UgbmUgY29ycmVzcG9uZGVudCBwYXMuXCIpO1xuICAgICAgY29uc3QgcGFzc3dvcmRDb21wbGV4aXR5UGF0dGVybiA9IC9eKD89LipbYS16XSkoPz0uKltBLVpdKSg/PS4qXFxkKS4rJC87XG4gICAgICBpZiAoIXBhc3N3b3JkQ29tcGxleGl0eVBhdHRlcm4udGVzdChwYXNzd29yZCkgfHwgcGFzc3dvcmQubGVuZ3RoIDwgOClcbiAgICAgICAgdmFsaWRhdGlvbkVycm9ycy5wdXNoKFwiTGUgZm9ybWF0IGR1IG1vdCBkZSBwYXNzZSBlc3QgaW52YWxpZGUuXCIpO1xuICAgICAgaWYgKCFwaG9uZSkgdmFsaWRhdGlvbkVycm9ycy5wdXNoKFwiTGUgbnVtw6lybyBkZSB0w6lsw6lwaG9uZSBlc3QgcmVxdWlzLlwiKTtcbiAgICAgIC8vIEJhc2ljIHBob25lIHZhbGlkYXRpb24gKHlvdSBtaWdodCB3YW50IGEgbW9yZSByb2J1c3Qgb25lKVxuICAgICAgY29uc3QgcGhvbmVQYXR0ZXJuID0gL14oMHxcXCszMylbMS05XVxcZHs4fSQvOyAvLyBFeGFtcGxlOiAwNjEyMzQ1Njc4IG9yICszMzYxMjM0NTY3OFxuICAgICAgaWYgKHBob25lICYmICFwaG9uZVBhdHRlcm4udGVzdChwaG9uZSkpXG4gICAgICAgIHZhbGlkYXRpb25FcnJvcnMucHVzaChcbiAgICAgICAgICBcIkxlIGZvcm1hdCBkdSBudW3DqXJvIGRlIHTDqWzDqXBob25lIGVzdCBpbnZhbGlkZSAoZXg6IDA2MTIzNDU2Nzggb3UgKzMzNjEyMzQ1Njc4KS5cIlxuICAgICAgICApO1xuXG4gICAgICBpZiAoIWNhcHRjaGFUb2tlbikge1xuICAgICAgICAvLyBDaGVjayBpZiBjYXB0Y2hhIGlzIHNvbHZlZFxuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzLnB1c2goXCJWZXVpbGxleiBjb21wbMOpdGVyIGxlIENBUFRDSEEuXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRvc0NoZWNrYm94IHx8ICF0b3NDaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgIHZhbGlkYXRpb25FcnJvcnMucHVzaChcbiAgICAgICAgICBcIlZldWlsbGV6IGxpcmUgZXQgYWNjZXB0ZXIgbGVzIENvbmRpdGlvbnMgR8OpbsOpcmFsZXMgZCdVdGlsaXNhdGlvbi5cIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAodmFsaWRhdGlvbkVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNob3dFcnJvcih2YWxpZGF0aW9uRXJyb3JzLmpvaW4oXCI8YnI+XCIpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzaG93TG9hZGluZyhcInNpZ251cEJ0blwiLCBcInNpZ251cFNwaW5uZXJcIik7XG4gICAgICB0cnkge1xuICAgICAgICBsZXQgZTE2NFBob25lID0gcGhvbmU7XG4gICAgICAgIGlmIChwaG9uZS5zdGFydHNXaXRoKFwiMFwiKSkge1xuICAgICAgICAgIGUxNjRQaG9uZSA9IGArMzMke3Bob25lLnN1YnN0cmluZygxKX1gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3RlcCAxOiBTaWduIHVwIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHNpZ25VcEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25VcCh7XG4gICAgICAgICAgZW1haWwsXG4gICAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgICAgb3B0aW9uczogeyBjYXB0Y2hhVG9rZW4gfSwgLy8gUGFzcyBjYXB0Y2hhIHRva2VuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChzaWduVXBFcnJvcikgdGhyb3cgc2lnblVwRXJyb3I7XG4gICAgICAgIGlmICghZGF0YS51c2VyKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVycmV1ciBsb3JzIGRlIGxhIGNyw6lhdGlvbiBkZSBsJ3V0aWxpc2F0ZXVyLlwiKTtcblxuICAgICAgICAvLyBTdGVwIDI6IFVwZGF0ZSBwcm9maWxlIHdpdGggcGhvbmUgbnVtYmVyIGlmIHByb3ZpZGVkXG4gICAgICAgIC8vIE5vdGU6IFRoZSBwcm9maWxlIHNob3VsZCBiZSBhdXRvbWF0aWNhbGx5IGNyZWF0ZWQgYnkgdGhlIGRhdGFiYXNlIHRyaWdnZXJcbiAgICAgICAgaWYgKGUxNjRQaG9uZSAmJiBkYXRhLnVzZXIuaWQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2FpdCBhIG1vbWVudCBmb3IgdGhlIHRyaWdnZXIgdG8gY3JlYXRlIHRoZSBwcm9maWxlXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcblxuICAgICAgICAgICAgY29uc3QgeyBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbShcInByb2ZpbGVzXCIpXG4gICAgICAgICAgICAgIC51cGRhdGUoeyBwaG9uZTogZTE2NFBob25lIH0pXG4gICAgICAgICAgICAgIC5lcShcImlkXCIsIGRhdGEudXNlci5pZCk7XG5cbiAgICAgICAgICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICAgIFwiQ291bGQgbm90IHVwZGF0ZSBwcm9maWxlIHdpdGggcGhvbmUgbnVtYmVyOlwiLFxuICAgICAgICAgICAgICAgIHByb2ZpbGVFcnJvclxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAvLyBEb24ndCB0aHJvdyBlcnJvciBoZXJlIGFzIHRoZSBtYWluIHNpZ251cCB3YXMgc3VjY2Vzc2Z1bFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKHByb2ZpbGVVcGRhdGVFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiUHJvZmlsZSB1cGRhdGUgZmFpbGVkOlwiLCBwcm9maWxlVXBkYXRlRXJyb3IpO1xuICAgICAgICAgICAgLy8gRG9uJ3QgdGhyb3cgZXJyb3IgaGVyZSBhcyB0aGUgbWFpbiBzaWdudXAgd2FzIHN1Y2Nlc3NmdWxcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZSB3aXRoIGRldGFpbGVkIGluc3RydWN0aW9uc1xuICAgICAgICBzaG93U2lnbnVwU3VjY2VzcyhlbWFpbCk7XG5cbiAgICAgICAgLy8gSGlkZSB0aGUgZm9ybSBhbmQgcmVzZXQgaXRcbiAgICAgICAgaWYgKHNpZ251cEZvcm0pIHtcbiAgICAgICAgICBzaWdudXBGb3JtLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7IC8vIEhpZGUgdGhlIGZvcm1cbiAgICAgICAgICBzaWdudXBGb3JtLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFbWFpbC9QYXNzd29yZCBTaWdudXAgZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgbGV0IGRpc3BsYXlFcnJvciA9IGVycm9yLm1lc3NhZ2UgfHwgXCJVbmUgZXJyZXVyIGVzdCBzdXJ2ZW51ZS5cIjtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGVycm9yLm1lc3NhZ2UgJiZcbiAgICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiVXNlciBhbHJlYWR5IHJlZ2lzdGVyZWRcIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgZGlzcGxheUVycm9yID1cbiAgICAgICAgICAgIFwiQ2V0dGUgYWRyZXNzZSBlbWFpbCBlc3QgZMOpasOgIHV0aWxpc8OpZS4gVmV1aWxsZXogdm91cyBjb25uZWN0ZXIgb3UgdXRpbGlzZXIgdW5lIGF1dHJlIGFkcmVzc2UuXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgZXJyb3IubWVzc2FnZSAmJlxuICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJVbmFibGUgdG8gdmFsaWRhdGUgcGhvbmUgbnVtYmVyXCIpXG4gICAgICAgICkge1xuICAgICAgICAgIGRpc3BsYXlFcnJvciA9IFwiTGUgbnVtw6lybyBkZSB0w6lsw6lwaG9uZSBmb3Vybmkgbidlc3QgcGFzIHZhbGlkZS5cIjtcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICBlcnJvci5tZXNzYWdlICYmXG4gICAgICAgICAgZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY2FwdGNoYSBwcm90ZWN0aW9uXCIpXG4gICAgICAgICkge1xuICAgICAgICAgIGRpc3BsYXlFcnJvciA9XG4gICAgICAgICAgICBcIkVycmV1ciBDQVBUQ0hBIGR1IHNlcnZldXIuIFZldWlsbGV6IHLDqWVzc2F5ZXIuIChcIiArXG4gICAgICAgICAgICBlcnJvci5tZXNzYWdlICtcbiAgICAgICAgICAgIFwiKVwiO1xuICAgICAgICB9XG4gICAgICAgIHNob3dFcnJvcihkaXNwbGF5RXJyb3IpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaGlkZUxvYWRpbmcoXCJzaWdudXBCdG5cIiwgXCJzaWdudXBTcGlubmVyXCIpO1xuICAgICAgICBpZiAod2luZG93LnR1cm5zdGlsZSAmJiB0dXJuc3RpbGVXaWRnZXRJZCkge1xuICAgICAgICAgIHdpbmRvdy50dXJuc3RpbGUucmVzZXQodHVybnN0aWxlV2lkZ2V0SWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHVybnN0aWxlIHdpZGdldCBoYXMgYmVlbiByZXNldC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY2FwdGNoYVRva2VuID0gbnVsbDsgLy8gQ2xlYXIgdG9rZW4gYWZ0ZXIgdXNlXG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNpZ251cCBmb3JtIChzaWdudXBGb3JtKSBub3QgZm91bmQuXCIpO1xuICB9XG5cbiAgaWYgKGdvb2dsZVNpZ25VcEJ0bikge1xuICAgIGdvb2dsZVNpZ25VcEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgc2hvd0xvYWRpbmcoXCJnb29nbGVTaWduVXBCdG5cIiwgXCJnb29nbGVTaWduVXBTcGlubmVyXCIpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoT0F1dGgoe1xuICAgICAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIC8vIEdvb2dsZSBPQXV0IGggd2lsbCBoYW5kbGUgdGhlIHJlZGlyZWN0IGFmdGVyIHN1Y2Nlc3NmdWwgYXV0aGVudGljYXRpb25cbiAgICAgICAgICAgIC8vIE5vIGN1c3RvbSByZWRpcmVjdFRvIG5lZWRlZCAtIGxldCBTdXBhYmFzZSBoYW5kbGUgdGhlIGRlZmF1bHQgZmxvd1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2lnbmluZyB1cCB3aXRoIEdvb2dsZTpcIiwgZXJyb3IpO1xuICAgICAgICAgIHNob3dFcnJvcihcbiAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgfHwgXCJFcnJldXIgbG9ycyBkZSBsJ2luc2NyaXB0aW9uIGF2ZWMgR29vZ2xlLlwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBPbiBzdWNjZXNzLCBTdXBhYmFzZSBoYW5kbGVzIHRoZSByZWRpcmVjdCBhdXRvbWF0aWNhbGx5XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXhjZXB0aW9uIGR1cmluZyBHb29nbGUgc2lnbi11cDpcIiwgZXJyb3IpO1xuICAgICAgICBzaG93RXJyb3IoXG4gICAgICAgICAgXCJVbmUgZXhjZXB0aW9uIGVzdCBzdXJ2ZW51ZSBsb3JzIGRlIGwnaW5zY3JpcHRpb24gYXZlYyBHb29nbGUuXCJcbiAgICAgICAgKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGhpZGVMb2FkaW5nKFwiZ29vZ2xlU2lnblVwQnRuXCIsIFwiZ29vZ2xlU2lnblVwU3Bpbm5lclwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLndhcm4oXCJHb29nbGUgU2lnbi1VcCBidXR0b24gKGdvb2dsZVNpZ25VcEJ0bikgbm90IGZvdW5kLlwiKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGluaXRTaWdudXBQYWdlLFxufTtcbiIsIi8vIHNyYy9lbnRyaWVzL3NpZ251cC5qc1xuLyoqXG4gKiBTaWdudXAgRW50cnkgUG9pbnRcbiAqXG4gKiBUaGlzIG1vZHVsZSBzZXJ2ZXMgYXMgdGhlIGVudHJ5IHBvaW50IGZvciB0aGUgc2lnbnVwIHBhZ2UuXG4gKi9cblxuLy8gSW1wb3J0IG91ciBzaWdudXAgbW9kdWxlXG5pbXBvcnQgeyBpbml0U2lnbnVwUGFnZSB9IGZyb20gXCIuLi9hdXRoL3NpZ251cC5qc1wiO1xuXG4vLyBJbml0aWFsaXplIHNpZ251cCBwYWdlIHdoZW4gRE9NIGlzIGxvYWRlZFxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICAvLyBJbml0aWFsaXplIHNpZ251cCBwYWdlXG4gIGluaXRTaWdudXBQYWdlKCk7XG5cbiAgY29uc29sZS5sb2coXCJTaWdudXAgcGFnZSBpbml0aWFsaXplZFwiKTtcbn0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwianMvXCIgKyBjaHVua0lkICsgXCIuY2h1bmsuanNcIjtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5qID0gNzg3OyIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ3ODc6IDBcbn07XG5cbl9fd2VicGFja19yZXF1aXJlX18uZi5qID0gKGNodW5rSWQsIHByb21pc2VzKSA9PiB7XG5cdFx0Ly8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxuXHRcdHZhciBpbnN0YWxsZWRDaHVua0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSA/IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA6IHVuZGVmaW5lZDtcblx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIHsgLy8gMCBtZWFucyBcImFscmVhZHkgaW5zdGFsbGVkXCIuXG5cblx0XHRcdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYodHJ1ZSkgeyAvLyBhbGwgY2h1bmtzIGhhdmUgSlNcblx0XHRcdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiAoaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF0pKTtcblx0XHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSA9IHByb21pc2UpO1xuXG5cdFx0XHRcdFx0Ly8gc3RhcnQgY2h1bmsgbG9hZGluZ1xuXHRcdFx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuXHRcdFx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID0gJ0xvYWRpbmcgY2h1bmsgJyArIGNodW5rSWQgKyAnIGZhaWxlZC5cXG4oJyArIGVycm9yVHlwZSArICc6ICcgKyByZWFsU3JjICsgJyknO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm5hbWUgPSAnQ2h1bmtMb2FkRXJyb3InO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhWzFdKGVycm9yKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG59O1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZihjaHVua0lkcy5zb21lKChpZCkgPT4gKGluc3RhbGxlZENodW5rc1tpZF0gIT09IDApKSkge1xuXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdH1cblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLk8ocmVzdWx0KTtcbn1cblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3Nl0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4MTApKSlcbl9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4iXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJsZWFmUHJvdG90eXBlcyIsImdldFByb3RvIiwiaW5Qcm9ncmVzcyIsImRhdGFXZWJwYWNrUHJlZml4IiwiY2FwdGNoYVRva2VuIiwidHVybnN0aWxlV2lkZ2V0SWQiLCJ3aW5kb3ciLCJvbmxvYWRUdXJuc3RpbGVDYWxsYmFjayIsImNvbnNvbGUiLCJsb2ciLCJ0dXJuc3RpbGVDb250YWluZXIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidHVybnN0aWxlIiwicmVuZGVyIiwic2l0ZWtleSIsImNhbGxiYWNrIiwidG9rZW4iLCJyZXNldCIsImVyciIsImVycm9yIiwidW5kZWZpbmVkIiwiZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzaWdudXBGb3JtIiwiZ29vZ2xlU2lnblVwQnRuIiwidG9zQ2hlY2tib3giLCJ0b3NNb2RhbEVsZW1lbnQiLCJ0b3NNb2RhbEJvZHkiLCJzaWdudXBCdG4iLCJ0b3NTdGF0dXNNZXNzYWdlIiwidG9zTGluayIsInRvc01vZGFsQ2xvc2UiLCJoaWRlTW9kYWwiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzdHlsZSIsImRpc3BsYXkiLCJib2R5Iiwib3ZlcmZsb3ciLCJkaXNhYmxlZCIsInByZXZlbnREZWZhdWx0IiwiYWRkIiwiZGF0YXNldCIsImxvYWRlZCIsImFzeW5jIiwiaW5uZXJIVE1MIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJ0b3NIdG1sIiwidGV4dCIsImRvYyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsIm1haW5Db250ZW50IiwicXVlcnlTZWxlY3RvciIsInNjcm9sbFRvcCIsImxvYWRUb1NDb250ZW50IiwidGFyZ2V0IiwiaXNDaGVja2VkIiwiY2hlY2tlZCIsImVycm9yRWxlbWVudCIsImluY2x1ZGVzIiwiZW1haWwiLCJ2YWx1ZSIsInRyaW0iLCJwYXNzd29yZCIsImNvbmZpcm1QYXNzd29yZCIsInBob25lIiwidmFsaWRhdGlvbkVycm9ycyIsInRlc3QiLCJwdXNoIiwibGVuZ3RoIiwiam9pbiIsImUxNjRQaG9uZSIsInN0YXJ0c1dpdGgiLCJzdWJzdHJpbmciLCJkYXRhIiwic2lnblVwRXJyb3IiLCJhdXRoIiwic2lnblVwIiwib3B0aW9ucyIsInVzZXIiLCJpZCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInByb2ZpbGVFcnJvciIsImZyb20iLCJ1cGRhdGUiLCJlcSIsIndhcm4iLCJwcm9maWxlVXBkYXRlRXJyb3IiLCJzdGF0dXNFbGVtZW50Iiwic2hvd1NpZ251cFN1Y2Nlc3MiLCJkaXNwbGF5RXJyb3IiLCJtZXNzYWdlIiwidG9Mb3dlckNhc2UiLCJzaWduSW5XaXRoT0F1dGgiLCJwcm92aWRlciIsImluaXRTaWdudXBQYWdlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwibSIsIk8iLCJyZXN1bHQiLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImkiLCJmdWxmaWxsZWQiLCJqIiwiT2JqZWN0Iiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiciIsImdldFByb3RvdHlwZU9mIiwib2JqIiwidCIsIm1vZGUiLCJ0aGlzIiwiX19lc01vZHVsZSIsInRoZW4iLCJucyIsImNyZWF0ZSIsImRlZiIsImN1cnJlbnQiLCJpbmRleE9mIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImZvckVhY2giLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJmIiwiY2h1bmtJZCIsImFsbCIsInJlZHVjZSIsInByb21pc2VzIiwidSIsImciLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJsIiwidXJsIiwiZG9uZSIsInNjcmlwdCIsIm5lZWRBdHRhY2giLCJzY3JpcHRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzIiwiZ2V0QXR0cmlidXRlIiwiY3JlYXRlRWxlbWVudCIsImNoYXJzZXQiLCJ0aW1lb3V0IiwibmMiLCJzZXRBdHRyaWJ1dGUiLCJzcmMiLCJvblNjcmlwdENvbXBsZXRlIiwicHJldiIsImV2ZW50Iiwib25lcnJvciIsIm9ubG9hZCIsImNsZWFyVGltZW91dCIsImRvbmVGbnMiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJiaW5kIiwidHlwZSIsImhlYWQiLCJhcHBlbmRDaGlsZCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwicCIsImluc3RhbGxlZENodW5rcyIsImluc3RhbGxlZENodW5rRGF0YSIsInByb21pc2UiLCJyZWplY3QiLCJlcnJvclR5cGUiLCJyZWFsU3JjIiwibmFtZSIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==