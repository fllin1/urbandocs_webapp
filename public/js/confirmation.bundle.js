(()=>{"use strict";var e,t,o,r,n,i={618:(e,t,o)=>{function r(e,t="info",o="statusMessage"){const r=document.getElementById(o);r?(r.textContent=e,r.classList.forEach((e=>{e.startsWith("alert-")&&r.classList.remove(e)})),r.classList.add(`alert-${t}`),r.classList.remove("hidden")):console.error("Status element not found:",o)}function n(e,t){const o=document.getElementById(e),r=document.getElementById(t);o&&(o.disabled=!1),r&&r.classList.add("hidden")}function i(){const e=new URLSearchParams(window.location.search).get("confirmation_url"),t=document.getElementById("confirmButton"),o=(document.getElementById("statusMessage"),document.getElementById("tosCheckbox")),i=document.getElementById("tosModal"),a=document.getElementById("tosModalBody");if(!e)return function(e,t="errorMessage"){const o=document.getElementById(t);o?(o.innerHTML=e,o.classList.remove("hidden")):console.error("Error element not found:",t)}("Erreur: URL de confirmation manquante."),void(t.disabled=!0);i&&(i.addEventListener("show.bs.modal",(async()=>{if("true"!==a.dataset.loaded)try{const e=await fetch("/terms");if(!e.ok)throw new Error(`Failed to load Terms of Service: ${e.status}`);const t=await e.text();a.innerHTML=t,a.dataset.loaded="true"}catch(e){console.error(e)}})),a.addEventListener("scroll",(()=>{a.scrollHeight-a.scrollTop<=a.clientHeight+2&&(o.disabled=!1)}))),o&&o.addEventListener("change",(()=>{t.disabled=!o.checked})),t.addEventListener("click",(()=>{!async function(e){document.getElementById("confirmButton"),document.getElementById("statusMessage");const t=document.getElementById("loading"),o=(document.getElementById("confirmSpinner"),document.getElementById("tosCheckbox"),()=>{n("confirmButton","confirmSpinner"),t&&t.classList.add("d-none"),r("Votre email a été vérifié! Redirection vers la page de connexion...","success"),setTimeout((()=>{window.location.href="/login"}),2e3)});(function(e,t){const o=document.getElementById(e),r=document.getElementById(t);o&&(o.disabled=!0),r&&r.classList.remove("hidden")})("confirmButton","confirmSpinner"),t&&t.classList.remove("d-none");try{const t=decodeURIComponent(e);console.log("Confirming email with URL:",t);const r=await fetch(t,{redirect:"manual"});if("opaqueredirect"===r.type)console.log("Supabase confirmation successful, redirect indicated (opaqueredirect)."),o();else{if(!r.ok){let e;console.log("Supabase confirmation failed with status:",r.status);const t=r.headers.get("content-type");t&&t.includes("application/json")?(e=await r.json(),console.log("Error Response JSON:",e)):(e=await r.text(),console.log("Error Response text:",e));let o="La confirmation a échoué.";throw e&&"object"==typeof e?e.error_description?o=e.error_description:e.msg?o=e.msg:e.error&&(o=e.error):e&&"string"==typeof e&&""!==e.trim()&&(o=e),new Error(o)}console.log("Supabase confirmation successful with a direct 2xx response."),o()}}catch(e){console.error("Confirmation processing error:",e),e.stack&&console.error("Error stack:",e.stack),n("confirmButton","confirmSpinner"),t&&t.classList.add("d-none"),r(`Une erreur est survenue durant la confirmation: ${e.message}`,"danger")}}(e)}))}(0,o(303).UU)("https://ofeyssipibktmbfebibo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mZXlzc2lwaWJrdG1iZmViaWJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM5MjUwOTQsImV4cCI6MjA1OTUwMTA5NH0.w71CAKfolktzRl-TmLVhHYaEbhCfVk4A7YraEUCglrU"),document.addEventListener("DOMContentLoaded",(()=>{i(),console.log("Confirmation page initialized")}))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return i[e].call(o.exports,o,o.exports,s),o.exports}s.m=i,e=[],s.O=(t,o,r,n)=>{if(!o){var i=1/0;for(l=0;l<e.length;l++){for(var[o,r,n]=e[l],a=!0,c=0;c<o.length;c++)(!1&n||i>=n)&&Object.keys(s.O).every((e=>s.O[e](o[c])))?o.splice(c--,1):(a=!1,n<i&&(i=n));if(a){e.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}n=n||0;for(var l=e.length;l>0&&e[l-1][2]>n;l--)e[l]=e[l-1];e[l]=[o,r,n]},o=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var n=Object.create(null);s.r(n);var i={};t=t||[null,o({}),o([]),o(o)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=o(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(n,i),n},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"js/"+e+".bundle.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},n="urbandocs_webapp:",s.l=(e,t,o,i)=>{if(r[e])r[e].push(t);else{var a,c;if(void 0!==o)for(var d=document.getElementsByTagName("script"),l=0;l<d.length;l++){var u=d[l];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+o){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",n+o),a.src=e),r[e]=[t];var m=(t,o)=>{a.onerror=a.onload=null,clearTimeout(f);var n=r[e];if(delete r[e],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((e=>e(o))),t)return t(o)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=m.bind(null,a.onerror),a.onload=m.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../"})(),(()=>{var e={508:0};s.f.j=(t,o)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var n=new Promise(((o,n)=>r=e[t]=[o,n]));o.push(r[2]=n);var i=s.p+s.u(t),a=new Error;s.l(i,(o=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",a.name="ChunkLoadError",a.type=n,a.request=i,r[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,o)=>{var r,n,[i,a,c]=o,d=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(c)var l=c(s)}for(t&&t(o);d<i.length;d++)n=i[d],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(l)},o=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var c=s.O(void 0,[303],(()=>s(618)));c=s.O(c)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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InNvdXJjZXMiOlsid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9jcmVhdGUgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2xvYWQgc2NyaXB0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYXV0aC9hdXRoLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYXV0aC9jb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9zdXBhYmFzZS1jbGllbnQuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9lbnRyaWVzL2NvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0dmFyIHIgPSBmbigpO1xuXHRcdFx0aWYgKHIgIT09IHVuZGVmaW5lZCkgcmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwidmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mID8gKG9iaikgPT4gKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopKSA6IChvYmopID0+IChvYmouX19wcm90b19fKTtcbnZhciBsZWFmUHJvdG90eXBlcztcbi8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLy8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4vLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbi8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLy8gbW9kZSAmIDE2OiByZXR1cm4gdmFsdWUgd2hlbiBpdCdzIFByb21pc2UtbGlrZVxuLy8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuX193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcblx0aWYobW9kZSAmIDEpIHZhbHVlID0gdGhpcyh2YWx1ZSk7XG5cdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG5cdGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUpIHtcblx0XHRpZigobW9kZSAmIDQpICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcblx0XHRpZigobW9kZSAmIDE2KSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHZhbHVlO1xuXHR9XG5cdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG5cdHZhciBkZWYgPSB7fTtcblx0bGVhZlByb3RvdHlwZXMgPSBsZWFmUHJvdG90eXBlcyB8fCBbbnVsbCwgZ2V0UHJvdG8oe30pLCBnZXRQcm90byhbXSksIGdldFByb3RvKGdldFByb3RvKV07XG5cdGZvcih2YXIgY3VycmVudCA9IG1vZGUgJiAyICYmIHZhbHVlOyB0eXBlb2YgY3VycmVudCA9PSAnb2JqZWN0JyAmJiAhfmxlYWZQcm90b3R5cGVzLmluZGV4T2YoY3VycmVudCk7IGN1cnJlbnQgPSBnZXRQcm90byhjdXJyZW50KSkge1xuXHRcdE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGN1cnJlbnQpLmZvckVhY2goKGtleSkgPT4gKGRlZltrZXldID0gKCkgPT4gKHZhbHVlW2tleV0pKSk7XG5cdH1cblx0ZGVmWydkZWZhdWx0J10gPSAoKSA9PiAodmFsdWUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGRlZik7XG5cdHJldHVybiBucztcbn07IiwidmFyIGluUHJvZ3Jlc3MgPSB7fTtcbnZhciBkYXRhV2VicGFja1ByZWZpeCA9IFwidXJiYW5kb2NzX3dlYmFwcDpcIjtcbi8vIGxvYWRTY3JpcHQgZnVuY3Rpb24gdG8gbG9hZCBhIHNjcmlwdCB2aWEgc2NyaXB0IHRhZ1xuX193ZWJwYWNrX3JlcXVpcmVfXy5sID0gKHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSA9PiB7XG5cdGlmKGluUHJvZ3Jlc3NbdXJsXSkgeyBpblByb2dyZXNzW3VybF0ucHVzaChkb25lKTsgcmV0dXJuOyB9XG5cdHZhciBzY3JpcHQsIG5lZWRBdHRhY2g7XG5cdGlmKGtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHMgPSBzY3JpcHRzW2ldO1xuXHRcdFx0aWYocy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgPT0gdXJsIHx8IHMuZ2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIpID09IGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KSB7IHNjcmlwdCA9IHM7IGJyZWFrOyB9XG5cdFx0fVxuXHR9XG5cdGlmKCFzY3JpcHQpIHtcblx0XHRuZWVkQXR0YWNoID0gdHJ1ZTtcblx0XHRzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblxuXHRcdHNjcmlwdC5jaGFyc2V0ID0gJ3V0Zi04Jztcblx0XHRzY3JpcHQudGltZW91dCA9IDEyMDtcblx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5uYykge1xuXHRcdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcIm5vbmNlXCIsIF9fd2VicGFja19yZXF1aXJlX18ubmMpO1xuXHRcdH1cblx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIsIGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KTtcblxuXHRcdHNjcmlwdC5zcmMgPSB1cmw7XG5cdH1cblx0aW5Qcm9ncmVzc1t1cmxdID0gW2RvbmVdO1xuXHR2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCkgPT4ge1xuXHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cblx0XHRzY3JpcHQub25lcnJvciA9IHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR2YXIgZG9uZUZucyA9IGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRkZWxldGUgaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdHNjcmlwdC5wYXJlbnROb2RlICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdFx0ZG9uZUZucyAmJiBkb25lRm5zLmZvckVhY2goKGZuKSA9PiAoZm4oZXZlbnQpKSk7XG5cdFx0aWYocHJldikgcmV0dXJuIHByZXYoZXZlbnQpO1xuXHR9XG5cdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgdW5kZWZpbmVkLCB7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSksIDEyMDAwMCk7XG5cdHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcblx0c2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcblx0bmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG59OyIsIi8vIHNyYy9hdXRoL2F1dGguanNcbi8qKlxuICogQXV0aGVudGljYXRpb24gTW9kdWxlIC0gQmFzZVxuICogQG1vZHVsZSBhdXRoXG4gKiBAZGVzY3JpcHRpb24gQmFzZSBtb2R1bGUgZm9yIGF1dGhlbnRpY2F0aW9uIHdpdGggY29tbW9uIGZ1bmN0aW9ucyBhbmQgY29uZmlndXJhdGlvblxuICogQHZlcnNpb24gMC4wLjVcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMC41ICgyMDI1LTA1LTE1KTogQWRkZWQgc2Vzc2lvbiB2YWxpZGF0aW9uIGFuZCBwcm90ZWN0aW9uIGFnYWluc3Qgc3RhbGUgc2Vzc2lvbnMuXG4gKiAtIDAuMC40ICgyMDI1LTA1LTE1KTogUmVtb3ZhbCBvZiBGaXJlYmFzZSBDbG91ZCBGdW5jdGlvbnMgY29uc3RhbnRzLlxuICogLSAwLjAuMyAoMjAyNS0wNS0xMyk6IE1vZGlmaWVkIHRoZSBhdXRoZW50aWNhdGlvbiBzdGF0ZSBtYW5hZ2VtZW50IHRvIHVzZSBTdXBhYmFzZSBBdXRoIHN5c3RlbS5cbiAqIC0gMC4wLjIgKDIwMjUtMDUtMTMpOiBSZW9yZ2FuaXphdGlvbiBpbnRvIHNlcGFyYXRlIG1vZHVsZXNcbiAqIC0gMC4wLjEgKDIwMjUtMDUtMDMpOiBJbml0aWFsIGNyZWF0aW9uXG4gKi9cblxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5cbi8vIEdsb2JhbCBhdXRoZW50aWNhdGlvbiBzdGF0ZVxubGV0IGN1cnJlbnRVc2VyID0gbnVsbDtcbmxldCBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG5cbi8qKlxuICogU2V0cyB0aGUgY3VycmVudCB1c2VyXG4gKiBAcGFyYW0ge09iamVjdH0gdXNlciAtIFVzZXIgZGF0YVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudFVzZXIodXNlcikge1xuICBjdXJyZW50VXNlciA9IHVzZXI7XG4gIC8vIFBvc3NpYmxlIHN0b3JhZ2UgaW4gbG9jYWxTdG9yYWdlL3Nlc3Npb25TdG9yYWdlXG4gIGlmICh1c2VyKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50VXNlclwiLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gIH0gZWxzZSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBpZiB0aGUgY3VycmVudCBzZXNzaW9uIGlzIGFjdGl2ZSB3aXRoIFN1cGFiYXNlXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gVHJ1ZSBpZiBzZXNzaW9uIGlzIHZhbGlkLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlU2Vzc2lvbigpIHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgY3VycmVudCBzZXNzaW9uIGZyb20gU3VwYWJhc2VcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHNlc3Npb24gfSxcbiAgICAgIGVycm9yOiBzZXNzaW9uRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuXG4gICAgLy8gTm8gc2Vzc2lvbiBvciBlcnJvciByZXRyaWV2aW5nIHNlc3Npb25cbiAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk5vIHZhbGlkIHNlc3Npb24gZm91bmRcIik7XG4gICAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBUcnkgdG8gcmVmcmVzaCB0aGUgdG9rZW4gdG8gdmFsaWRhdGUgaXQgd2l0aCB0aGUgc2VydmVyXG4gICAgY29uc3QgeyBlcnJvcjogcmVmcmVzaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnJlZnJlc2hTZXNzaW9uKCk7XG5cbiAgICBpZiAocmVmcmVzaEVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJTZXNzaW9uIHZhbGlkYXRpb24gZmFpbGVkOlwiLCByZWZyZXNoRXJyb3IpO1xuICAgICAgLy8gRm9yY2UgY2xlYXIgdGhlIGludmFsaWQgc2Vzc2lvblxuICAgICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG4gICAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBTZXNzaW9uIGlzIHZhbGlkLCB1cGRhdGUgdGhlIGN1cnJlbnQgdXNlclxuICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgc2Vzc2lvblZhbGlkYXRlZCA9IHRydWU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2Vzc2lvbiB2YWxpZGF0aW9uIGVycm9yOlwiLCBlKTtcbiAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogUmV0cmlldmVzIHRoZSBjdXJyZW50IHVzZXJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsaWRhdGUgLSBXaGV0aGVyIHRvIHZhbGlkYXRlIHRoZSBzZXNzaW9uIHdpdGggU3VwYWJhc2VcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdHxudWxsPn0gVGhlIGN1cnJlbnQgdXNlciBvciBudWxsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcih2YWxpZGF0ZSA9IHRydWUpIHtcbiAgLy8gSWYgd2UgbmVlZCB0byB2YWxpZGF0ZSBhbmQgaGF2ZW4ndCBkb25lIHNvIHlldFxuICBpZiAodmFsaWRhdGUgJiYgIXNlc3Npb25WYWxpZGF0ZWQpIHtcbiAgICBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcbiAgfVxuXG4gIC8vIElmIG5vIHZhbGlkYXRpb24gbmVlZGVkIG9yIGFscmVhZHkgdmFsaWRhdGVkXG4gIGlmICghdmFsaWRhdGUgJiYgIWN1cnJlbnRVc2VyKSB7XG4gICAgLy8gVHJ5IHRvIHJldHJpZXZlIGZyb20gc3RvcmFnZSBpZiBub3QgaW4gbWVtb3J5XG4gICAgY29uc3Qgc3RvcmVkVXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgaWYgKHN0b3JlZFVzZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJldHJpZXZpbmcgdXNlcjpcIiwgZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRVc2VyO1xufVxuXG4vKipcbiAqIFN5bmNocm9ub3VzIHZlcnNpb24gb2YgZ2V0Q3VycmVudFVzZXIgZm9yIG5vbi1hc3luYyBjb250ZXh0c1xuICogV0FSTklORzogVGhpcyBtYXkgcmV0dXJuIHN0YWxlIGRhdGEgaWYgc2Vzc2lvbiBpcyBpbnZhbGlkXG4gKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9IFRoZSBjdXJyZW50IHVzZXIgb3IgbnVsbFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXJTeW5jKCkge1xuICBpZiAoIWN1cnJlbnRVc2VyKSB7XG4gICAgY29uc3Qgc3RvcmVkVXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgaWYgKHN0b3JlZFVzZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJldHJpZXZpbmcgdXNlcjpcIiwgZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRVc2VyO1xufVxuXG4vKipcbiAqIExvZ3Mgb3V0IHRoZSB1c2VyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgdHJ5IHtcbiAgICAvLyBTaWduIG91dCBmcm9tIFN1cGFiYXNlXG4gICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG5cbiAgICAvLyBDbGVhciBsb2NhbCBzdGF0ZVxuICAgIGN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcblxuICAgIC8vIFJlZGlyZWN0IHRvIHRoZSBob21lIHBhZ2UgYWZ0ZXIgbG9nb3V0XG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZHVyaW5nIGxvZ291dDpcIiwgZXJyb3IpO1xuICAgIC8vIFN0aWxsIGNsZWFyIGxvY2FsIHN0YXRlIGV2ZW4gaWYgU3VwYWJhc2Ugc2lnbk91dCBmYWlsc1xuICAgIGN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiB3aXRoIHZhbGlkIHNlc3Npb25cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsaWRhdGUgLSBXaGV0aGVyIHRvIHZhbGlkYXRlIHdpdGggU3VwYWJhc2UgZmlyc3RcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBUcnVlIGlmIHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiB3aXRoIHZhbGlkIHNlc3Npb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzTG9nZ2VkSW4odmFsaWRhdGUgPSB0cnVlKSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcih2YWxpZGF0ZSk7XG4gIHJldHVybiB1c2VyICE9PSBudWxsO1xufVxuXG4vKipcbiAqIFN5bmNocm9ub3VzIHZlcnNpb24gb2YgaXNMb2dnZWRJblxuICogV0FSTklORzogVGhpcyBtYXkgcmV0dXJuIGluY29ycmVjdCByZXN1bHRzIGlmIHNlc3Npb24gaXMgaW52YWxpZFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdXNlciBhcHBlYXJzIHRvIGJlIGxvZ2dlZCBpbiBsb2NhbGx5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvZ2dlZEluU3luYygpIHtcbiAgcmV0dXJuIGdldEN1cnJlbnRVc2VyU3luYygpICE9PSBudWxsO1xufVxuXG4vKipcbiAqIFByb3RlY3RzIGEgcGFnZSB0aGF0IHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVkaXJlY3RVcmwgLSBVUkwgdG8gcmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWRcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBUcnVlIGlmIGF1dGhlbnRpY2F0ZWQsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvdGVjdFBhZ2UocmVkaXJlY3RVcmwgPSBcIi9sb2dpblwiKSB7XG4gIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcblxuICBpZiAoIWlzVmFsaWQpIHtcbiAgICAvLyBSZWRpcmVjdCB0byBsb2dpbiBwYWdlXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSByZWRpcmVjdFVybDtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhdXRoIG9uIHBhZ2UgbG9hZFxuICogQ2FsbCB0aGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgeW91ciBhcHAgaW5pdGlhbGl6YXRpb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRBdXRoKCkge1xuICAvLyBWYWxpZGF0ZSBzZXNzaW9uIG9uIHBhZ2UgbG9hZFxuICBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcblxuICAvLyBTZXQgdXAgYXV0aCBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXJcbiAgc3VwYWJhc2UuYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZShhc3luYyAoZXZlbnQsIHNlc3Npb24pID0+IHtcbiAgICBjb25zb2xlLmxvZyhcIkF1dGggc3RhdGUgY2hhbmdlZDpcIiwgZXZlbnQpO1xuXG4gICAgaWYgKGV2ZW50ID09PSBcIlNJR05FRF9JTlwiICYmIHNlc3Npb24pIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBcIlNJR05FRF9PVVRcIikge1xuICAgICAgc2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJUT0tFTl9SRUZSRVNIRURcIikge1xuICAgICAgc2V0Q3VycmVudFVzZXIoc2Vzc2lvbi51c2VyKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiVVNFUl9VUERBVEVEXCIpIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIERpc3BsYXlzIGFuIGVycm9yIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gRXJyb3IgbWVzc2FnZSB0byBkaXNwbGF5XG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgd2hlcmUgdG8gZGlzcGxheSB0aGUgZXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dFcnJvcihtZXNzYWdlLCBlbGVtZW50SWQgPSBcImVycm9yTWVzc2FnZVwiKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChlcnJvckVsZW1lbnQpIHtcbiAgICBlcnJvckVsZW1lbnQuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZWxlbWVudCBub3QgZm91bmQ6XCIsIGVsZW1lbnRJZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNwbGF5cyBhIHN0YXR1cyBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIE1lc3NhZ2UgdG8gZGlzcGxheVxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBNZXNzYWdlIHR5cGUgKHN1Y2Nlc3MsIGluZm8sIHdhcm5pbmcsIGRhbmdlcilcbiAqIEBwYXJhbSB7c3RyaW5nfSBlbGVtZW50SWQgLSBJRCBvZiB0aGUgZWxlbWVudCB3aGVyZSB0byBkaXNwbGF5IHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93U3RhdHVzKFxuICBtZXNzYWdlLFxuICB0eXBlID0gXCJpbmZvXCIsXG4gIGVsZW1lbnRJZCA9IFwic3RhdHVzTWVzc2FnZVwiXG4pIHtcbiAgY29uc3Qgc3RhdHVzRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChzdGF0dXNFbGVtZW50KSB7XG4gICAgc3RhdHVzRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAvLyBSZW1vdmUgYWxsIGFsZXJ0LSogY2xhc3Nlc1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LmZvckVhY2goKGNsYXNzTmFtZSkgPT4ge1xuICAgICAgaWYgKGNsYXNzTmFtZS5zdGFydHNXaXRoKFwiYWxlcnQtXCIpKSB7XG4gICAgICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIHRoZSBjbGFzcyBjb3JyZXNwb25kaW5nIHRvIHRoZSB0eXBlXG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QuYWRkKGBhbGVydC0ke3R5cGV9YCk7XG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTdGF0dXMgZWxlbWVudCBub3QgZm91bmQ6XCIsIGVsZW1lbnRJZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBIaWRlcyBhbiBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgdG8gaGlkZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGlkZUVsZW1lbnQoZWxlbWVudElkKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFNob3dzIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBlbGVtZW50SWQgLSBJRCBvZiB0aGUgZWxlbWVudCB0byBzaG93XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93RWxlbWVudChlbGVtZW50SWQpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICB9XG59XG5cbi8qKlxuICogU2hvd3MgdGhlIGxvYWRpbmcgaW5kaWNhdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gYnV0dG9uSWQgLSBJRCBvZiB0aGUgYnV0dG9uXG4gKiBAcGFyYW0ge3N0cmluZ30gc3Bpbm5lcklkIC0gSUQgb2YgdGhlIHNwaW5uZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dMb2FkaW5nKGJ1dHRvbklkLCBzcGlubmVySWQpIHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYnV0dG9uSWQpO1xuICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc3Bpbm5lcklkKTtcblxuICBpZiAoYnV0dG9uKSBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICBpZiAoc3Bpbm5lcikgc3Bpbm5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xufVxuXG4vKipcbiAqIEhpZGVzIHRoZSBsb2FkaW5nIGluZGljYXRvclxuICogQHBhcmFtIHtzdHJpbmd9IGJ1dHRvbklkIC0gSUQgb2YgdGhlIGJ1dHRvblxuICogQHBhcmFtIHtzdHJpbmd9IHNwaW5uZXJJZCAtIElEIG9mIHRoZSBzcGlubmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoaWRlTG9hZGluZyhidXR0b25JZCwgc3Bpbm5lcklkKSB7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJ1dHRvbklkKTtcbiAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNwaW5uZXJJZCk7XG5cbiAgaWYgKGJ1dHRvbikgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIGlmIChzcGlubmVyKSBzcGlubmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG59XG5cbi8vIEV4cG9ydCB0aGUgbmVjZXNzYXJ5IGZ1bmN0aW9ucyBhbmQgdmFyaWFibGVzXG5leHBvcnQgZGVmYXVsdCB7XG4gIGdldEN1cnJlbnRVc2VyLFxuICBnZXRDdXJyZW50VXNlclN5bmMsXG4gIHNldEN1cnJlbnRVc2VyLFxuICBsb2dvdXQsXG4gIGlzTG9nZ2VkSW4sXG4gIGlzTG9nZ2VkSW5TeW5jLFxuICB2YWxpZGF0ZVNlc3Npb24sXG4gIHByb3RlY3RQYWdlLFxuICBpbml0QXV0aCxcbiAgc2hvd0Vycm9yLFxuICBzaG93U3RhdHVzLFxuICBoaWRlRWxlbWVudCxcbiAgc2hvd0VsZW1lbnQsXG4gIHNob3dMb2FkaW5nLFxuICBoaWRlTG9hZGluZyxcbn07XG4iLCIvLyBzcmMvYXV0aC9jb25maXJtYXRpb24uanNcbi8qKlxuICogQ29uZmlybWF0aW9uIE1vZHVsZVxuICogQG1vZHVsZSBjb25maXJtYXRpb25cbiAqIEBkZXNjcmlwdGlvbiBIYW5kbGVzIGVtYWlsIGNvbmZpcm1hdGlvbiB3aXRoIFN1cGFiYXNlIEFQSVxuICogQHZlcnNpb24gMC4xLjFcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMS4xICgyMDI1LTA1LTE3KTogQ29ycmVjdGVkIHN1Y2Nlc3MgbWVzc2FnZSBhbmQgcmVkaXJlY3QgdG8gbG9naW4gcGFnZS5cbiAqIC0gMC4xLjAgKDIwMjUtMDUtMTUpOiBDb252ZXJ0ZWQgdG8gdXNlIGRpcmVjdCBTdXBhYmFzZSBBUEkgY2FsbHMgaW5zdGVhZCBvZiBGaXJlYmFzZSBDbG91ZCBGdW5jdGlvbnMuXG4gKiAtIDAuMC4zICgyMDI1LTA1LTEyKTogVXBkYXRlZCB0ZXJtcyBvZiBzZXJ2aWNlIG1vZGFsIGFuZCBjb25maXJtYXRpb24gZW1haWwuXG4gKiAtIDAuMC4yICgyMDI1LTA1LTEwKTogQWRkZWQgdGVybXMgb2Ygc2VydmljZSBhbmQgY29uZmlybWF0aW9uIGVtYWlsLlxuICogLSAwLjAuMSAoMjAyNS0wNS0wOCk6IENyZWF0ZWQgdGhlIGNvbmZpcm1hdGlvbiBtb2R1bGUgd2l0aCBiYXNpYyBmdW5jdGlvbmFsaXR5LlxuICovXG5cbmltcG9ydCB7IHNob3dTdGF0dXMsIHNob3dFcnJvciwgc2hvd0xvYWRpbmcsIGhpZGVMb2FkaW5nIH0gZnJvbSBcIi4vYXV0aC5qc1wiO1xuXG4vKipcbiAqIEluaXRpYWxpemVzIHRoZSBlbWFpbCBjb25maXJtYXRpb24gcGFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdENvbmZpcm1hdGlvblBhZ2UoKSB7XG4gIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG4gIGNvbnN0IGNvbmZpcm1hdGlvblVybCA9IHVybFBhcmFtcy5nZXQoXCJjb25maXJtYXRpb25fdXJsXCIpO1xuXG4gIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1CdXR0b25cIik7XG4gIGNvbnN0IHN0YXR1c01lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXR1c01lc3NhZ2VcIik7XG4gIGNvbnN0IHRvc0NoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3NDaGVja2JveFwiKTtcbiAgY29uc3QgdG9zTW9kYWxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3NNb2RhbFwiKTtcbiAgY29uc3QgdG9zTW9kYWxCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3NNb2RhbEJvZHlcIik7XG5cbiAgLy8gRXhpdCBlYXJseSBpZiBubyBjb25maXJtYXRpb24gVVJMIGlzIHByZXNlbnRcbiAgaWYgKCFjb25maXJtYXRpb25VcmwpIHtcbiAgICBzaG93RXJyb3IoXCJFcnJldXI6IFVSTCBkZSBjb25maXJtYXRpb24gbWFucXVhbnRlLlwiKTtcbiAgICBjb25maXJtQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodG9zTW9kYWxFbGVtZW50KSB7XG4gICAgdG9zTW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzaG93LmJzLm1vZGFsXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICh0b3NNb2RhbEJvZHkuZGF0YXNldC5sb2FkZWQgIT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcIi90ZXJtc1wiKTsgLy8gVXNlIGNsZWFuIFVSTFxuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYEZhaWxlZCB0byBsb2FkIFRlcm1zIG9mIFNlcnZpY2U6ICR7cmVzcG9uc2Uuc3RhdHVzfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHRvc0h0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgdG9zTW9kYWxCb2R5LmlubmVySFRNTCA9IHRvc0h0bWw7XG4gICAgICAgICAgdG9zTW9kYWxCb2R5LmRhdGFzZXQubG9hZGVkID0gXCJ0cnVlXCI7IC8vIE1hcmsgYXMgbG9hZGVkIHRvIHByZXZlbnQgbXVsdGlwbGUgZmV0Y2hlc1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0b3NNb2RhbEJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoKSA9PiB7XG4gICAgICAvLyBDaGVjayBpZiBzY3JvbGxlZCB0byB0aGUgYm90dG9tICh3aXRoIGEgc21hbGwgdG9sZXJhbmNlKVxuICAgICAgaWYgKFxuICAgICAgICB0b3NNb2RhbEJvZHkuc2Nyb2xsSGVpZ2h0IC0gdG9zTW9kYWxCb2R5LnNjcm9sbFRvcCA8PVxuICAgICAgICB0b3NNb2RhbEJvZHkuY2xpZW50SGVpZ2h0ICsgMlxuICAgICAgKSB7XG4gICAgICAgIC8vICsyIGZvciB0b2xlcmFuY2VcbiAgICAgICAgdG9zQ2hlY2tib3guZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGlmICh0b3NDaGVja2JveCkge1xuICAgIHRvc0NoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKCkgPT4ge1xuICAgICAgY29uZmlybUJ1dHRvbi5kaXNhYmxlZCA9ICF0b3NDaGVja2JveC5jaGVja2VkO1xuICAgIH0pO1xuICB9XG5cbiAgY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNvbmZpcm1FbWFpbChjb25maXJtYXRpb25VcmwpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBDb25maXJtcyB0aGUgZW1haWwgYWRkcmVzcyBkaXJlY3RseSB3aXRoIFN1cGFiYXNlIHVzaW5nIHRoZSBjb25maXJtYXRpb24gVVJMXG4gKiBAcGFyYW0ge3N0cmluZ30gY29uZmlybWF0aW9uVXJsIC0gQ29uZmlybWF0aW9uIFVSTCByZWNlaXZlZCBieSBlbWFpbFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29uZmlybUVtYWlsKGNvbmZpcm1hdGlvblVybCkge1xuICBjb25zdCBjb25maXJtQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtQnV0dG9uXCIpO1xuICBjb25zdCBzdGF0dXNNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0dXNNZXNzYWdlXCIpO1xuICBjb25zdCBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2FkaW5nXCIpO1xuICBjb25zdCBjb25maXJtU3Bpbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybVNwaW5uZXJcIik7XG4gIGNvbnN0IHRvc0NoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3NDaGVja2JveFwiKTtcblxuICAvLyBJZiB0aGUgY29uZmlybWF0aW9uIGlzIHN1Y2Nlc3NmdWwsIHNob3cgYSBzdWNjZXNzIG1lc3NhZ2UgYW5kIHJlZGlyZWN0IHRvIHRoZSBsb2dpbiBwYWdlXG4gIGNvbnN0IHJlZGlyZWN0VG9Mb2dpbiA9ICgpID0+IHtcbiAgICAvLyBIaWRlIGxvYWRpbmdcbiAgICBoaWRlTG9hZGluZyhcImNvbmZpcm1CdXR0b25cIiwgXCJjb25maXJtU3Bpbm5lclwiKTtcbiAgICBpZiAobG9hZGluZykgbG9hZGluZy5jbGFzc0xpc3QuYWRkKFwiZC1ub25lXCIpO1xuXG4gICAgc2hvd1N0YXR1cyhcbiAgICAgIFwiVm90cmUgZW1haWwgYSDDqXTDqSB2w6lyaWZpw6khIFJlZGlyZWN0aW9uIHZlcnMgbGEgcGFnZSBkZSBjb25uZXhpb24uLi5cIixcbiAgICAgIFwic3VjY2Vzc1wiXG4gICAgKTtcbiAgICAvLyBSZWRpcmVjdCB0byB0aGUgbG9naW4gcGFnZSBhZnRlciAyIHNlY29uZHNcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9naW5cIjtcbiAgICB9LCAyMDAwKTsgLy8gMiBzZWNvbmRzIGRlbGF5XG4gIH07XG5cbiAgLy8gU2hvdyBsb2FkaW5nIGluZGljYXRvclxuICBzaG93TG9hZGluZyhcImNvbmZpcm1CdXR0b25cIiwgXCJjb25maXJtU3Bpbm5lclwiKTtcblxuICBpZiAobG9hZGluZykgbG9hZGluZy5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xuXG4gIHRyeSB7XG4gICAgLy8gRGVjb2RlIHRoZSBVUkwgaWYgaXQncyBlbmNvZGVkXG4gICAgY29uc3QgZGVjb2RlZFVybCA9IGRlY29kZVVSSUNvbXBvbmVudChjb25maXJtYXRpb25VcmwpO1xuXG4gICAgY29uc29sZS5sb2coXCJDb25maXJtaW5nIGVtYWlsIHdpdGggVVJMOlwiLCBkZWNvZGVkVXJsKTtcblxuICAgIC8vIERpcmVjdCByZXF1ZXN0IHRvIFN1cGFiYXNlIGNvbmZpcm1hdGlvbiBVUkwsIGJ1dCBwcmV2ZW50IGZldGNoIGZyb20gYXV0b21hdGljYWxseSBmb2xsb3dpbmcgdGhlIHJlZGlyZWN0LlxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZGVjb2RlZFVybCwgeyByZWRpcmVjdDogXCJtYW51YWxcIiB9KTtcblxuICAgIC8vIElmIHJlc3BvbnNlLnR5cGUgaXMgJ29wYXF1ZXJlZGlyZWN0JywgaXQgbWVhbnMgU3VwYWJhc2UgaXMgdHJ5aW5nIHRvIHJlZGlyZWN0LlxuICAgIC8vIEZvciBTdXBhYmFzZSBlbWFpbCBjb25maXJtYXRpb24sIGEgcmVkaXJlY3QgaW1wbGllcyB0aGUgY29uZmlybWF0aW9uIHdhcyBzdWNjZXNzZnVsXG4gICAgLy8gYW5kIGl0J3MgdHJ5aW5nIHRvIHNlbmQgdGhlIHVzZXIgdG8gdGhlIHJlZGlyZWN0X3RvIFVSTCBzcGVjaWZpZWQgaW4gdGhlIGNvbmZpcm1hdGlvbiBsaW5rLlxuICAgIGlmIChyZXNwb25zZS50eXBlID09PSBcIm9wYXF1ZXJlZGlyZWN0XCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBcIlN1cGFiYXNlIGNvbmZpcm1hdGlvbiBzdWNjZXNzZnVsLCByZWRpcmVjdCBpbmRpY2F0ZWQgKG9wYXF1ZXJlZGlyZWN0KS5cIlxuICAgICAgKTtcbiAgICAgIHJlZGlyZWN0VG9Mb2dpbigpO1xuICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgIC8vIFRoaXMgY2FzZSBpcyBsZXNzIGxpa2VseSBmb3IgU3VwYWJhc2UgY29uZmlybWF0aW9uIHdoaWNoIHVzdWFsbHkgcmVkaXJlY3RzLFxuICAgICAgLy8gYnV0IGhhbmRsZSBpdCBpZiBTdXBhYmFzZSByZXNwb25kcyB3aXRoIDJ4eCB3aXRob3V0IGEgcmVkaXJlY3QuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgXCJTdXBhYmFzZSBjb25maXJtYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIGEgZGlyZWN0IDJ4eCByZXNwb25zZS5cIlxuICAgICAgKTtcbiAgICAgIHJlZGlyZWN0VG9Mb2dpbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJZiBpdCdzIG5vdCBhbiBvcGFxdWVyZWRpcmVjdCBhbmQgbm90IHJlc3BvbnNlLm9rLCB0aGVuIGl0J3MgYW4gZXJyb3IgZnJvbSBTdXBhYmFzZS5cbiAgICAgIGNvbnNvbGUubG9nKFwiU3VwYWJhc2UgY29uZmlybWF0aW9uIGZhaWxlZCB3aXRoIHN0YXR1czpcIiwgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGxldCByZXNwb25zZURhdGE7XG4gICAgICBjb25zdCBjb250ZW50VHlwZSA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpO1xuICAgICAgaWYgKGNvbnRlbnRUeXBlICYmIGNvbnRlbnRUeXBlLmluY2x1ZGVzKFwiYXBwbGljYXRpb24vanNvblwiKSkge1xuICAgICAgICByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgUmVzcG9uc2UgSlNPTjpcIiwgcmVzcG9uc2VEYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBSZXNwb25zZSB0ZXh0OlwiLCByZXNwb25zZURhdGEpO1xuICAgICAgfVxuXG4gICAgICBsZXQgZXJyb3JNZXNzYWdlID0gXCJMYSBjb25maXJtYXRpb24gYSDDqWNob3XDqS5cIjtcbiAgICAgIGlmIChyZXNwb25zZURhdGEgJiYgdHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAocmVzcG9uc2VEYXRhLmVycm9yX2Rlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gcmVzcG9uc2VEYXRhLmVycm9yX2Rlc2NyaXB0aW9uO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlRGF0YS5tc2cpIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSByZXNwb25zZURhdGEubXNnO1xuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlRGF0YS5lcnJvcikge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IHJlc3BvbnNlRGF0YS5lcnJvcjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgcmVzcG9uc2VEYXRhICYmXG4gICAgICAgIHR5cGVvZiByZXNwb25zZURhdGEgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgcmVzcG9uc2VEYXRhLnRyaW0oKSAhPT0gXCJcIlxuICAgICAgKSB7XG4gICAgICAgIC8vIElmIHJlc3BvbnNlRGF0YSBpcyBhIG5vbi1lbXB0eSBzdHJpbmcsIHVzZSBpdC5cbiAgICAgICAgZXJyb3JNZXNzYWdlID0gcmVzcG9uc2VEYXRhO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIC8vIEhhbmRsZSBlcnJvcnMgZnJvbSBkZWNvZGVVUklDb21wb25lbnQsIG5ldHdvcmsgZXJyb3JzIGZvciBmZXRjaCwgb3IgZXJyb3JzIHRocm93biBhYm92ZS5cbiAgICBjb25zb2xlLmVycm9yKFwiQ29uZmlybWF0aW9uIHByb2Nlc3NpbmcgZXJyb3I6XCIsIGVycm9yKTtcbiAgICBpZiAoZXJyb3Iuc3RhY2spIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzdGFjazpcIiwgZXJyb3Iuc3RhY2spO1xuICAgIH1cblxuICAgIC8vIEhpZGUgbG9hZGluZ1xuICAgIGhpZGVMb2FkaW5nKFwiY29uZmlybUJ1dHRvblwiLCBcImNvbmZpcm1TcGlubmVyXCIpO1xuICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLmNsYXNzTGlzdC5hZGQoXCJkLW5vbmVcIik7XG5cbiAgICAvLyBTaG93IGVycm9yIG1lc3NhZ2VcbiAgICAvLyBUaGUgZXJyb3IubWVzc2FnZSBoZXJlIHdpbGwgYmUgZnJvbSBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKSBvciBvdGhlciBKUyBlcnJvcnMuXG4gICAgc2hvd1N0YXR1cyhcbiAgICAgIGBVbmUgZXJyZXVyIGVzdCBzdXJ2ZW51ZSBkdXJhbnQgbGEgY29uZmlybWF0aW9uOiAke2Vycm9yLm1lc3NhZ2V9YCwgLy8gU3RhbmRhcmRpemVkIGVycm9yIHByZWZpeFxuICAgICAgXCJkYW5nZXJcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBpbml0Q29uZmlybWF0aW9uUGFnZSxcbiAgY29uZmlybUVtYWlsLFxufTtcbiIsIi8vIHNyYy9qcy9zdXBhYmFzZS1jbGllbnQuanNcbi8qKlxuICogU3VwYWJhc2UgQ2xpZW50XG4gKiBAbW9kdWxlIHN1cGFiYXNlLWNsaWVudFxuICogQGRlc2NyaXB0aW9uIFRoaXMgbW9kdWxlIGhhbmRsZXMgdGhlIFN1cGFiYXNlIGNsaWVudCBpbml0aWFsaXphdGlvbiBhbmQgY29uZmlndXJhdGlvbi5cbiAqIEB2ZXJzaW9uIDAuMC4yXG4gKiBAYXV0aG9yIEdyZXlQYW5kYVxuICpcbiAqIEBjaGFuZ2Vsb2dcbiAqIC0gMC4wLjIgKDIwMjUtMDUtMjcpOiBBZGRlZCBlbnZpcm9uZW1lbnQgdmFyaWFibGVzIGVycm9yIGhhbmRsaW5nIGZvciBtaXNzaW5nLlxuICogLSAwLjAuMSAoMjAyNS0wNS0wOSk6IEluaXRpYWwgdmVyc2lvbiB3aXRoIGJhc2ljIFN1cGFiYXNlIGNsaWVudCBpbml0aWFsaXphdGlvbi5cbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gXCJodHRwczovL29mZXlzc2lwaWJrdG1iZmViaWJvLnN1cGFiYXNlLmNvXCI7XG5jb25zdCBzdXBhYmFzZUFub25LZXkgPVxuICBcImV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUpwYzNNaU9pSnpkWEJoWW1GelpTSXNJbkpsWmlJNkltOW1aWGx6YzJsd2FXSnJkRzFpWm1WaWFXSnZJaXdpY205c1pTSTZJbUZ1YjI0aUxDSnBZWFFpT2pFM05ETTVNalV3T1RRc0ltVjRjQ0k2TWpBMU9UVXdNVEE1TkgwLnc3MUNBS2ZvbGt0elJsLVRtTFZoSFlhRWJoQ2ZWazRBN1lyYUVVQ2dsclVcIjtcblxuaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XG4gIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzXCIpO1xufVxuXG5jb25zdCBjbGllbnQgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNsaWVudDtcbiIsIi8vIHNyYy9lbnRyaWVzL2NvbmZpcm1hdGlvbi5qc1xuLyoqXG4gKiBDb25maXJtYXRpb24gRW50cnkgUG9pbnRcbiAqXG4gKiBUaGlzIG1vZHVsZSBzZXJ2ZXMgYXMgdGhlIGVudHJ5IHBvaW50IGZvciB0aGUgZW1haWwgY29uZmlybWF0aW9uIHBhZ2UuXG4gKi9cblxuLy8gSW1wb3J0IG91ciBjb25maXJtYXRpb24gbW9kdWxlXG5pbXBvcnQgeyBpbml0Q29uZmlybWF0aW9uUGFnZSB9IGZyb20gXCIuLi9hdXRoL2NvbmZpcm1hdGlvbi5qc1wiO1xuXG4vLyBJbml0aWFsaXplIGNvbmZpcm1hdGlvbiBwYWdlIHdoZW4gRE9NIGlzIGxvYWRlZFxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICAvLyBJbml0aWFsaXplIGNvbmZpcm1hdGlvbiBwYWdlXG4gIGluaXRDb25maXJtYXRpb25QYWdlKCk7XG5cbiAgY29uc29sZS5sb2coXCJDb25maXJtYXRpb24gcGFnZSBpbml0aWFsaXplZFwiKTtcbn0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwianMvXCIgKyBjaHVua0lkICsgXCIuYnVuZGxlLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdCAmJiBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gJ1NDUklQVCcpXG5cdFx0c2NyaXB0VXJsID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM7XG5cdGlmICghc2NyaXB0VXJsKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRpZihzY3JpcHRzLmxlbmd0aCkge1xuXHRcdFx0dmFyIGkgPSBzY3JpcHRzLmxlbmd0aCAtIDE7XG5cdFx0XHR3aGlsZSAoaSA+IC0xICYmICghc2NyaXB0VXJsIHx8ICEvXmh0dHAocz8pOi8udGVzdChzY3JpcHRVcmwpKSkgc2NyaXB0VXJsID0gc2NyaXB0c1tpLS1dLnNyYztcblx0XHR9XG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvXmJsb2I6LywgXCJcIikucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsICsgXCIuLi9cIjsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0NTA4OiAwXG59O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuaiA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHRcdC8vIEpTT05QIGNodW5rIGxvYWRpbmcgZm9yIGphdmFzY3JpcHRcblx0XHR2YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgPyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gOiB1bmRlZmluZWQ7XG5cdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7IC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdFx0XHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0XHRcdHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gKGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IFtyZXNvbHZlLCByZWplY3RdKSk7XG5cdFx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKTtcblxuXHRcdFx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdFx0XHR2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgX193ZWJwYWNrX3JlcXVpcmVfXy51KGNodW5rSWQpO1xuXHRcdFx0XHRcdC8vIGNyZWF0ZSBlcnJvciBiZWZvcmUgc3RhY2sgdW53b3VuZCB0byBnZXQgdXNlZnVsIHN0YWNrdHJhY2UgbGF0ZXJcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdFx0XHR2YXIgbG9hZGluZ0VuZGVkID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSkge1xuXHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF07XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID0gZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubWVzc2FnZSA9ICdMb2FkaW5nIGNodW5rICcgKyBjaHVua0lkICsgJyBmYWlsZWQuXFxuKCcgKyBlcnJvclR5cGUgKyAnOiAnICsgcmVhbFNyYyArICcpJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci50eXBlID0gZXJyb3JUeXBlO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnJlcXVlc3QgPSByZWFsU3JjO1xuXHRcdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubCh1cmwsIGxvYWRpbmdFbmRlZCwgXCJjaHVuay1cIiArIGNodW5rSWQsIGNodW5rSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxufTtcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5PLmogPSAoY2h1bmtJZCkgPT4gKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9PT0gMCk7XG5cbi8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uLCBkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYoY2h1bmtJZHMuc29tZSgoaWQpID0+IChpbnN0YWxsZWRDaHVua3NbaWRdICE9PSAwKSkpIHtcblx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcblx0fVxuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHJlc3VsdCk7XG59XG5cbnZhciBjaHVua0xvYWRpbmdHbG9iYWwgPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8odW5kZWZpbmVkLCBbMzAzXSwgKCkgPT4gKF9fd2VicGFja19yZXF1aXJlX18oNjE4KSkpXG5fX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKF9fd2VicGFja19leHBvcnRzX18pO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibGVhZlByb3RvdHlwZXMiLCJnZXRQcm90byIsImluUHJvZ3Jlc3MiLCJkYXRhV2VicGFja1ByZWZpeCIsInNob3dTdGF0dXMiLCJtZXNzYWdlIiwidHlwZSIsImVsZW1lbnRJZCIsInN0YXR1c0VsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJmb3JFYWNoIiwiY2xhc3NOYW1lIiwic3RhcnRzV2l0aCIsInJlbW92ZSIsImFkZCIsImNvbnNvbGUiLCJlcnJvciIsImhpZGVMb2FkaW5nIiwiYnV0dG9uSWQiLCJzcGlubmVySWQiLCJidXR0b24iLCJzcGlubmVyIiwiZGlzYWJsZWQiLCJpbml0Q29uZmlybWF0aW9uUGFnZSIsImNvbmZpcm1hdGlvblVybCIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiZ2V0IiwiY29uZmlybUJ1dHRvbiIsInRvc0NoZWNrYm94IiwidG9zTW9kYWxFbGVtZW50IiwidG9zTW9kYWxCb2R5IiwiZXJyb3JFbGVtZW50IiwiaW5uZXJIVE1MIiwic2hvd0Vycm9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFzeW5jIiwiZGF0YXNldCIsImxvYWRlZCIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIkVycm9yIiwic3RhdHVzIiwidG9zSHRtbCIsInRleHQiLCJzY3JvbGxIZWlnaHQiLCJzY3JvbGxUb3AiLCJjbGllbnRIZWlnaHQiLCJjaGVja2VkIiwibG9hZGluZyIsInJlZGlyZWN0VG9Mb2dpbiIsInNldFRpbWVvdXQiLCJocmVmIiwic2hvd0xvYWRpbmciLCJkZWNvZGVkVXJsIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwibG9nIiwicmVkaXJlY3QiLCJyZXNwb25zZURhdGEiLCJjb250ZW50VHlwZSIsImhlYWRlcnMiLCJpbmNsdWRlcyIsImpzb24iLCJlcnJvck1lc3NhZ2UiLCJlcnJvcl9kZXNjcmlwdGlvbiIsIm1zZyIsInRyaW0iLCJzdGFjayIsImNvbmZpcm1FbWFpbCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJPIiwicmVzdWx0IiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwiZnVsZmlsbGVkIiwiaiIsIk9iamVjdCIsImtleXMiLCJldmVyeSIsImtleSIsInNwbGljZSIsInIiLCJnZXRQcm90b3R5cGVPZiIsIm9iaiIsInQiLCJ2YWx1ZSIsIm1vZGUiLCJ0aGlzIiwiX19lc01vZHVsZSIsInRoZW4iLCJucyIsImNyZWF0ZSIsImRlZiIsImN1cnJlbnQiLCJpbmRleE9mIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImQiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJlIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwibCIsInVybCIsImRvbmUiLCJwdXNoIiwic2NyaXB0IiwibmVlZEF0dGFjaCIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInMiLCJnZXRBdHRyaWJ1dGUiLCJjcmVhdGVFbGVtZW50IiwiY2hhcnNldCIsInRpbWVvdXQiLCJuYyIsInNldEF0dHJpYnV0ZSIsInNyYyIsIm9uU2NyaXB0Q29tcGxldGUiLCJwcmV2IiwiZXZlbnQiLCJvbmVycm9yIiwib25sb2FkIiwiY2xlYXJUaW1lb3V0IiwiZG9uZUZucyIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImJpbmQiLCJ0YXJnZXQiLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInNjcmlwdFVybCIsImltcG9ydFNjcmlwdHMiLCJjdXJyZW50U2NyaXB0IiwidGFnTmFtZSIsInRvVXBwZXJDYXNlIiwidGVzdCIsInJlcGxhY2UiLCJwIiwiaW5zdGFsbGVkQ2h1bmtzIiwiaW5zdGFsbGVkQ2h1bmtEYXRhIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnJvclR5cGUiLCJyZWFsU3JjIiwibmFtZSIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwiZGF0YSIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsInNvbWUiLCJpZCIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==