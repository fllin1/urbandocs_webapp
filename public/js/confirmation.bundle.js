(()=>{"use strict";var e,n,t,o,r,i={1008:(e,n,t)=>{var o=t(3715),r=t(9660);let i=null,a=null,s=null;async function l(e){if(e.preventDefault(),!a)return void(0,o.Qg)("Veuillez compléter le CAPTCHA avant de confirmer.");if(!i)return void(0,o.Qg)("Données de confirmation manquantes.");const n=document.getElementById("confirmBtn"),t=document.getElementById("confirmSpinner");n&&(n.disabled=!0),t&&t.classList.remove("hidden");try{"url"===i.type?await async function(e){try{const n=decodeURIComponent(e);console.log("Attempting email confirmation with URL:",n);const t=new URL(n),o=t.searchParams.get("token"),i=t.searchParams.get("type");if(!o)throw new Error("Token manquant dans l'URL de confirmation.");console.log("Extracted from URL - token:",o.substring(0,20)+"...","type:",i);const{data:a,error:s}=await r.N.auth.verifyOtp({token_hash:o,type:"email"});if(s)throw console.error("Error during URL-based confirmation:",s),new Error("Erreur lors de la confirmation: "+s.message);if(!a.user||!a.session)throw new Error("Impossible de confirmer l'email. Le lien est peut-être expiré ou déjà utilisé.");console.log("Email confirmed successfully via URL:",a.user.email),c()}catch(e){throw console.error("Confirmation processing error:",e),e}}(i.data):"token"===i.type&&await async function(e,n="signup"){try{console.log("Attempting token confirmation with type:",n);const{data:t,error:o}=await r.N.auth.verifyOtp({token_hash:e,type:"email"});if(o)throw console.error("Error during verifyOtp:",o),new Error("Erreur lors de la vérification du token: "+o.message);if(!t.user||!t.session)throw new Error("Impossible de confirmer l'email. Le token est peut-être invalide ou a expiré.");console.log("Email confirmed successfully:",t.user.email),c()}catch(e){throw console.error("Error during token-based confirmation:",e),e}}(i.data,i.tokenType)}catch(e){console.error("Confirmation error:",e),(0,o.Qg)(`Erreur lors de la confirmation: ${e.message}`)}finally{n&&(n.disabled=!1),t&&t.classList.add("hidden"),window.turnstile&&s&&window.turnstile.reset(s),a=null,n&&(n.disabled=!0)}}function c(e){const n=document.getElementById("confirmationForm"),t=document.getElementById("successMessage");n&&n.classList.add("hidden"),t&&(t.innerHTML='\n      <div class="confirmation-success">\n        <span class="success-icon">✅</span>\n        <h3>Confirmation réussie !</h3>\n        <p>Votre compte a été confirmé avec succès.</p>\n        <p>Vous allez être redirigé vers la page de connexion dans quelques secondes...</p>\n      </div>\n    ',t.classList.remove("hidden")),setTimeout((()=>{window.location.href="/auth/login"}),3e3)}window.onloadTurnstileCallback=function(){console.log("Turnstile API ready for confirmation page.");const e=document.getElementById("turnstile-container");if(e&&window.turnstile&&!s){console.log("Rendering Turnstile widget for confirmation...");try{s=window.turnstile.render(e,{sitekey:"0x4AAAAAABdzY3InOU2_In99",callback:function(e){a=e,console.log("Turnstile token obtained for confirmation:",e);const n=document.getElementById("confirmBtn");n&&(n.disabled=!1)},"expired-callback":()=>{console.log("Turnstile token expired on confirmation page."),window.turnstile&&s&&window.turnstile.reset(s),a=null;const e=document.getElementById("confirmBtn");e&&(e.disabled=!0)},"error-callback":e=>{a=null,console.error("Turnstile error on confirmation page:",e),(0,o.Qg)(`Erreur CAPTCHA: ${e}. Veuillez réessayer.`);const n=document.getElementById("confirmBtn");n&&(n.disabled=!0)}}),void 0===s?(console.error("Turnstile.render did not return a widgetId for confirmation."),(0,o.Qg)("Erreur initialisation CAPTCHA.")):console.log("Turnstile widget rendered for confirmation. ID:",s)}catch(e){console.error("Error rendering Turnstile on confirmation page:",e),(0,o.Qg)("Impossible d'afficher le CAPTCHA.")}}},document.addEventListener("DOMContentLoaded",(()=>{(function(){const e=new URLSearchParams(window.location.search),n=window.location.hash;let t=e.get("token");const r=e.get("type");let a=e.get("confirmation_url");if(n){const e=new URLSearchParams(n.substring(1));t||(t=e.get("access_token")||e.get("token"))}console.log("Confirmation page initialized with:",{confirmationToken:t?"present":"missing",type:r,confirmationUrl:a?"present":"missing",urlHash:n||"none"}),document.getElementById("statusMessage"),document.getElementById("errorMessage");const s=document.getElementById("loading"),c=document.getElementById("confirmationForm"),d=document.getElementById("confirmForm");if(s&&s.classList.remove("hidden"),a)i={type:"url",data:a},u();else{if(!t||"signup"!==r&&"email_change"!==r)return s&&s.classList.add("hidden"),void(0,o.Qg)("Erreur: URL ou jeton de confirmation manquant ou invalide.");i={type:"token",data:t,tokenType:r},u()}function u(){s&&s.classList.add("hidden"),c&&c.classList.remove("hidden"),(0,o.wc)("Lien de confirmation valide. Veuillez compléter le CAPTCHA et confirmer.","info")}d&&d.addEventListener("submit",l)})(),console.log("Confirmation page initialized")}))}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var t=a[e]={exports:{}};return i[e].call(t.exports,t,t.exports,s),t.exports}s.m=i,e=[],s.O=(n,t,o,r)=>{if(!t){var i=1/0;for(d=0;d<e.length;d++){for(var[t,o,r]=e[d],a=!0,l=0;l<t.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](t[l])))?t.splice(l--,1):(a=!1,r<i&&(i=r));if(a){e.splice(d--,1);var c=o();void 0!==c&&(n=c)}}return n}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,o,r]},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);s.r(r);var i={};n=n||[null,t({}),t([]),t(t)];for(var a=2&o&&e;"object"==typeof a&&!~n.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((n=>i[n]=()=>e[n]));return i.default=()=>e,s.d(r,i),r},s.d=(e,n)=>{for(var t in n)s.o(n,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((n,t)=>(s.f[t](e,n),n)),[])),s.u=e=>"js/"+e+".chunk.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o={},r="urbandocs_webapp:",s.l=(e,n,t,i)=>{if(o[e])o[e].push(n);else{var a,l;if(void 0!==t)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+t){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+t),a.src=e),o[e]=[n];var f=(n,t)=>{a.onerror=a.onload=null,clearTimeout(m);var r=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(t))),n)return n(t)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=508,s.p="/",(()=>{var e={508:0};s.f.j=(n,t)=>{var o=s.o(e,n)?e[n]:void 0;if(0!==o)if(o)t.push(o[2]);else{var r=new Promise(((t,r)=>o=e[n]=[t,r]));t.push(o[2]=r);var i=s.p+s.u(n),a=new Error;s.l(i,(t=>{if(s.o(e,n)&&(0!==(o=e[n])&&(e[n]=void 0),o)){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;a.message="Loading chunk "+n+" failed.\n("+r+": "+i+")",a.name="ChunkLoadError",a.type=r,a.request=i,o[1](a)}}),"chunk-"+n,n)}},s.O.j=n=>0===e[n];var n=(n,t)=>{var o,r,[i,a,l]=t,c=0;if(i.some((n=>0!==e[n]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(n&&n(t);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},t=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var l=s.O(void 0,[76],(()=>s(1008)));l=s.O(l)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianMvY29uZmlybWF0aW9uLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoidUJBQUlBLEVDQ0FDLEVBREFDLEVDQUFDLEVBQ0FDLEUsMENDb0JKLElBQUlDLEVBQW1CLEtBQ25CQyxFQUFlLEtBQ2ZDLEVBQW9CLEtBNEl4QkMsZUFBZUMsRUFBbUJDLEdBR2hDLEdBRkFBLEVBQUVDLGtCQUVHTCxFQUVILFlBREEsUUFBVSxxREFJWixJQUFLRCxFQUVILFlBREEsUUFBVSx1Q0FJWixNQUFNTyxFQUFhQyxTQUFTQyxlQUFlLGNBQ3JDQyxFQUFpQkYsU0FBU0MsZUFBZSxrQkFHM0NGLElBQVlBLEVBQVdJLFVBQVcsR0FDbENELEdBQWdCQSxFQUFlRSxVQUFVQyxPQUFPLFVBRXBELElBQ2dDLFFBQTFCYixFQUFpQmMsV0FnRXpCWCxlQUFtQ1ksR0FDakMsSUFDRSxNQUFNQyxFQUFhQyxtQkFBbUJGLEdBQ3RDRyxRQUFRQyxJQUFJLDBDQUEyQ0gsR0FHdkQsTUFBTUksRUFBTSxJQUFJQyxJQUFJTCxHQUNkTSxFQUFRRixFQUFJRyxhQUFhQyxJQUFJLFNBQzdCVixFQUFPTSxFQUFJRyxhQUFhQyxJQUFJLFFBRWxDLElBQUtGLEVBQ0gsTUFBTSxJQUFJRyxNQUFNLDhDQUdsQlAsUUFBUUMsSUFDTiw4QkFDQUcsRUFBTUksVUFBVSxFQUFHLElBQU0sTUFDekIsUUFDQVosR0FJRixNQUFNLEtBQUVhLEVBQUksTUFBRUMsU0FBZ0IsSUFBU0MsS0FBS0MsVUFBVSxDQUNwREMsV0FBWVQsRUFDWlIsS0FBTSxVQUdSLEdBQUljLEVBRUYsTUFEQVYsUUFBUVUsTUFBTSx1Q0FBd0NBLEdBQ2hELElBQUlILE1BQU0sbUNBQXFDRyxFQUFNSSxTQUc3RCxJQUFJTCxFQUFLTSxPQUFRTixFQUFLTyxRQU1wQixNQUFNLElBQUlULE1BQ1Isa0ZBTkZQLFFBQVFDLElBQUksd0NBQXlDUSxFQUFLTSxLQUFLRSxPQUMvREMsR0FRSixDQUFFLE1BQU9SLEdBRVAsTUFEQVYsUUFBUVUsTUFBTSxpQ0FBa0NBLEdBQzFDQSxDQUNSLENBQ0YsQ0E3R1lTLENBQW9CckMsRUFBaUIyQixNQUNSLFVBQTFCM0IsRUFBaUJjLFlBMEJoQ1gsZUFBcUNtQixFQUFPZ0IsRUFBWSxVQUN0RCxJQUNFcEIsUUFBUUMsSUFBSSwyQ0FBNENtQixHQUd4RCxNQUFNLEtBQUVYLEVBQUksTUFBRUMsU0FBZ0IsSUFBU0MsS0FBS0MsVUFBVSxDQUNwREMsV0FBWVQsRUFDWlIsS0FBTSxVQUdSLEdBQUljLEVBRUYsTUFEQVYsUUFBUVUsTUFBTSwwQkFBMkJBLEdBQ25DLElBQUlILE1BQ1IsNENBQThDRyxFQUFNSSxTQUl4RCxJQUFJTCxFQUFLTSxPQUFRTixFQUFLTyxRQU1wQixNQUFNLElBQUlULE1BQ1IsaUZBTkZQLFFBQVFDLElBQUksZ0NBQWlDUSxFQUFLTSxLQUFLRSxPQUN2REMsR0FRSixDQUFFLE1BQU9SLEdBRVAsTUFEQVYsUUFBUVUsTUFBTSx5Q0FBMENBLEdBQ2xEQSxDQUNSLENBQ0YsQ0F4RFlXLENBQ0p2QyxFQUFpQjJCLEtBQ2pCM0IsRUFBaUJzQyxVQUd2QixDQUFFLE1BQU9WLEdBQ1BWLFFBQVFVLE1BQU0sc0JBQXVCQSxJQUNyQyxRQUFVLG1DQUFtQ0EsRUFBTUksVUFDckQsQ0FBRSxRQUVJekIsSUFBWUEsRUFBV0ksVUFBVyxHQUNsQ0QsR0FBZ0JBLEVBQWVFLFVBQVU0QixJQUFJLFVBRzdDQyxPQUFPQyxXQUFheEMsR0FDdEJ1QyxPQUFPQyxVQUFVQyxNQUFNekMsR0FFekJELEVBQWUsS0FDWE0sSUFBWUEsRUFBV0ksVUFBVyxFQUN4QyxDQUNGLENBNEZBLFNBQVN5QixFQUF1QkosR0FDOUIsTUFBTVksRUFBbUJwQyxTQUFTQyxlQUFlLG9CQUMzQ29DLEVBQWlCckMsU0FBU0MsZUFBZSxrQkFFM0NtQyxHQUFrQkEsRUFBaUJoQyxVQUFVNEIsSUFBSSxVQUVqREssSUFDRkEsRUFBZUMsVUFBWSw2U0FRM0JELEVBQWVqQyxVQUFVQyxPQUFPLFdBR2xDa0MsWUFBVyxLQUNUTixPQUFPTyxTQUFTQyxLQUFPLGdCQUN0QixJQUNMLENBdFNBUixPQUFPUyx3QkFBMEIsV0FDL0JoQyxRQUFRQyxJQUFJLDhDQUNaLE1BQU1nQyxFQUFxQjNDLFNBQVNDLGVBQWUsdUJBRW5ELEdBQUkwQyxHQUFzQlYsT0FBT0MsWUFBY3hDLEVBQW1CLENBQ2hFZ0IsUUFBUUMsSUFBSSxrREFDWixJQUNFakIsRUFBb0J1QyxPQUFPQyxVQUFVVSxPQUFPRCxFQUFvQixDQUM5REUsUUFBUywyQkFDVEMsU0FBVSxTQUFVaEMsR0FDbEJyQixFQUFlcUIsRUFDZkosUUFBUUMsSUFBSSw2Q0FBOENHLEdBRzFELE1BQU1mLEVBQWFDLFNBQVNDLGVBQWUsY0FDdkNGLElBQ0ZBLEVBQVdJLFVBQVcsRUFFMUIsRUFDQSxtQkFBb0IsS0FDbEJPLFFBQVFDLElBQUksaURBQ1JzQixPQUFPQyxXQUFheEMsR0FDdEJ1QyxPQUFPQyxVQUFVQyxNQUFNekMsR0FFekJELEVBQWUsS0FHZixNQUFNTSxFQUFhQyxTQUFTQyxlQUFlLGNBQ3ZDRixJQUNGQSxFQUFXSSxVQUFXLElBRzFCLGlCQUFtQjRDLElBQ2pCdEQsRUFBZSxLQUNmaUIsUUFBUVUsTUFBTSx3Q0FBeUMyQixJQUN2RCxRQUFVLG1CQUFtQkEsMEJBRzdCLE1BQU1oRCxFQUFhQyxTQUFTQyxlQUFlLGNBQ3ZDRixJQUNGQSxFQUFXSSxVQUFXLFdBS0Y2QyxJQUF0QnRELEdBQ0ZnQixRQUFRVSxNQUNOLGlFQUVGLFFBQVUsbUNBRVZWLFFBQVFDLElBQ04sa0RBQ0FqQixFQUdOLENBQUUsTUFBT0csR0FDUGEsUUFBUVUsTUFBTSxrREFBbUR2QixJQUNqRSxRQUFVLG9DQUNaLENBQ0YsQ0FDRixFQzVFQUcsU0FBU2lELGlCQUFpQixvQkFBb0IsTURpRnZDLFdBQ0wsTUFBTUMsRUFBWSxJQUFJQyxnQkFBZ0JsQixPQUFPTyxTQUFTWSxRQUNoREMsRUFBVXBCLE9BQU9PLFNBQVNjLEtBR2hDLElBQUlDLEVBQW9CTCxFQUFVbEMsSUFBSSxTQUN0QyxNQUFNVixFQUFPNEMsRUFBVWxDLElBQUksUUFDM0IsSUFBSXdDLEVBQWtCTixFQUFVbEMsSUFBSSxvQkFHcEMsR0FBSXFDLEVBQVMsQ0FDWCxNQUFNSSxFQUFhLElBQUlOLGdCQUFnQkUsRUFBUW5DLFVBQVUsSUFDcERxQyxJQUNIQSxFQUNFRSxFQUFXekMsSUFBSSxpQkFBbUJ5QyxFQUFXekMsSUFBSSxTQUV2RCxDQUVBTixRQUFRQyxJQUFJLHNDQUF1QyxDQUNqRDRDLGtCQUFtQkEsRUFBb0IsVUFBWSxVQUNuRGpELE9BQ0FrRCxnQkFBaUJBLEVBQWtCLFVBQVksVUFDL0NILFFBQVNBLEdBQVcsU0FHQXJELFNBQVNDLGVBQWUsaUJBQ3pCRCxTQUFTQyxlQUFlLGdCQUQ3QyxNQUVNeUQsRUFBVTFELFNBQVNDLGVBQWUsV0FDbENtQyxFQUFtQnBDLFNBQVNDLGVBQWUsb0JBQzNDMEQsRUFBYzNELFNBQVNDLGVBQWUsZUFLNUMsR0FISXlELEdBQVNBLEVBQVF0RCxVQUFVQyxPQUFPLFVBR2xDbUQsRUFDRmhFLEVBQW1CLENBQUVjLEtBQU0sTUFBT2EsS0FBTXFDLEdBQ3hDSSxRQUNLLEtBQ0xMLEdBQ1UsV0FBVGpELEdBQThCLGlCQUFUQSxFQVd0QixPQUZJb0QsR0FBU0EsRUFBUXRELFVBQVU0QixJQUFJLGVBQ25DLFFBQVUsOERBUlZ4QyxFQUFtQixDQUNqQmMsS0FBTSxRQUNOYSxLQUFNb0MsRUFDTnpCLFVBQVd4QixHQUVic0QsR0FLRixDQU9BLFNBQVNBLElBQ0hGLEdBQVNBLEVBQVF0RCxVQUFVNEIsSUFBSSxVQUMvQkksR0FBa0JBLEVBQWlCaEMsVUFBVUMsT0FBTyxXQUN4RCxRQUNFLDJFQUNBLE9BRUosQ0FYSXNELEdBQ0ZBLEVBQVlWLGlCQUFpQixTQUFVckQsRUFXM0MsRUNqSkVpRSxHQUVBbkQsUUFBUUMsSUFBSSxtQyxHQ2RWbUQsRUFBMkIsQ0FBQyxFQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCaEIsSUFBakJpQixFQUNILE9BQU9BLEVBQWFDLFFBR3JCLElBQUlDLEVBQVNMLEVBQXlCRSxHQUFZLENBR2pERSxRQUFTLENBQUMsR0FPWCxPQUhBRSxFQUFvQkosR0FBVUssS0FBS0YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0gsR0FHcEVJLEVBQU9ELE9BQ2YsQ0FHQUgsRUFBb0JPLEVBQUlGLEVMekJwQmpGLEVBQVcsR0FDZjRFLEVBQW9CUSxFQUFJLENBQUNDLEVBQVFDLEVBQVVDLEVBQUlDLEtBQzlDLElBQUdGLEVBQUgsQ0FNQSxJQUFJRyxFQUFlQyxJQUNuQixJQUFTQyxFQUFJLEVBQUdBLEVBQUkzRixFQUFTNEYsT0FBUUQsSUFBSyxDQUd6QyxJQUZBLElBQUtMLEVBQVVDLEVBQUlDLEdBQVl4RixFQUFTMkYsR0FDcENFLEdBQVksRUFDUEMsRUFBSSxFQUFHQSxFQUFJUixFQUFTTSxPQUFRRSxNQUNwQixFQUFYTixHQUFzQkMsR0FBZ0JELElBQWFPLE9BQU9DLEtBQUtwQixFQUFvQlEsR0FBR2EsT0FBT0MsR0FBU3RCLEVBQW9CUSxFQUFFYyxHQUFLWixFQUFTUSxNQUM5SVIsRUFBU2EsT0FBT0wsSUFBSyxJQUVyQkQsR0FBWSxFQUNUTCxFQUFXQyxJQUFjQSxFQUFlRCxJQUc3QyxHQUFHSyxFQUFXLENBQ2I3RixFQUFTbUcsT0FBT1IsSUFBSyxHQUNyQixJQUFJUyxFQUFJYixTQUNFMUIsSUFBTnVDLElBQWlCZixFQUFTZSxFQUMvQixDQUNELENBQ0EsT0FBT2YsQ0FuQlAsQ0FKQ0csRUFBV0EsR0FBWSxFQUN2QixJQUFJLElBQUlHLEVBQUkzRixFQUFTNEYsT0FBUUQsRUFBSSxHQUFLM0YsRUFBUzJGLEVBQUksR0FBRyxHQUFLSCxFQUFVRyxJQUFLM0YsRUFBUzJGLEdBQUszRixFQUFTMkYsRUFBSSxHQUNyRzNGLEVBQVMyRixHQUFLLENBQUNMLEVBQVVDLEVBQUlDLElDTDNCdEYsRUFBVzZGLE9BQU9NLGVBQWtCQyxHQUFTUCxPQUFPTSxlQUFlQyxHQUFTQSxHQUFTQSxFQUFhLFVBUXRHMUIsRUFBb0IyQixFQUFJLFNBQVNDLEVBQU9DLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUQsRUFBUUUsS0FBS0YsSUFDaEIsRUFBUEMsRUFBVSxPQUFPRCxFQUNwQixHQUFvQixpQkFBVkEsR0FBc0JBLEVBQU8sQ0FDdEMsR0FBVyxFQUFQQyxHQUFhRCxFQUFNRyxXQUFZLE9BQU9ILEVBQzFDLEdBQVcsR0FBUEMsR0FBb0MsbUJBQWZELEVBQU1JLEtBQXFCLE9BQU9KLENBQzVELENBQ0EsSUFBSUssRUFBS2QsT0FBT2UsT0FBTyxNQUN2QmxDLEVBQW9Cd0IsRUFBRVMsR0FDdEIsSUFBSUUsRUFBTSxDQUFDLEVBQ1g5RyxFQUFpQkEsR0FBa0IsQ0FBQyxLQUFNQyxFQUFTLENBQUMsR0FBSUEsRUFBUyxJQUFLQSxFQUFTQSxJQUMvRSxJQUFJLElBQUk4RyxFQUFpQixFQUFQUCxHQUFZRCxFQUF5QixpQkFBWFEsS0FBeUIvRyxFQUFlZ0gsUUFBUUQsR0FBVUEsRUFBVTlHLEVBQVM4RyxHQUN4SGpCLE9BQU9tQixvQkFBb0JGLEdBQVNHLFNBQVNqQixHQUFTYSxFQUFJYixHQUFPLElBQU9NLEVBQU1OLEtBSS9FLE9BRkFhLEVBQWEsUUFBSSxJQUFNLEVBQ3ZCbkMsRUFBb0J3QyxFQUFFUCxFQUFJRSxHQUNuQkYsQ0FDUixFS3hCQWpDLEVBQW9Cd0MsRUFBSSxDQUFDckMsRUFBU3NDLEtBQ2pDLElBQUksSUFBSW5CLEtBQU9tQixFQUNYekMsRUFBb0IwQyxFQUFFRCxFQUFZbkIsS0FBU3RCLEVBQW9CMEMsRUFBRXZDLEVBQVNtQixJQUM1RUgsT0FBT3dCLGVBQWV4QyxFQUFTbUIsRUFBSyxDQUFFc0IsWUFBWSxFQUFNM0YsSUFBS3dGLEVBQVduQixNQ0ozRXRCLEVBQW9CNkMsRUFBSSxDQUFDLEVBR3pCN0MsRUFBb0JsRSxFQUFLZ0gsR0FDakJDLFFBQVFDLElBQUk3QixPQUFPQyxLQUFLcEIsRUFBb0I2QyxHQUFHSSxRQUFPLENBQUNDLEVBQVU1QixLQUN2RXRCLEVBQW9CNkMsRUFBRXZCLEdBQUt3QixFQUFTSSxHQUM3QkEsSUFDTCxLQ05KbEQsRUFBb0JtRCxFQUFLTCxHQUVqQixNQUFRQSxFQUFVLFlDSDFCOUMsRUFBb0JvRCxFQUFJLFdBQ3ZCLEdBQTBCLGlCQUFmQyxXQUF5QixPQUFPQSxXQUMzQyxJQUNDLE9BQU92QixNQUFRLElBQUl3QixTQUFTLGNBQWIsRUFDaEIsQ0FBRSxNQUFPeEgsR0FDUixHQUFzQixpQkFBWG9DLE9BQXFCLE9BQU9BLE1BQ3hDLENBQ0EsQ0FQdUIsR0NBeEI4QixFQUFvQjBDLEVBQUksQ0FBQ2hCLEVBQUs2QixJQUFVcEMsT0FBT3FDLFVBQVVDLGVBQWVuRCxLQUFLb0IsRUFBSzZCLEdSQTlFaEksRUFBYSxDQUFDLEVBQ2RDLEVBQW9CLG9CQUV4QndFLEVBQW9CMEQsRUFBSSxDQUFDN0csRUFBSzhHLEVBQU1yQyxFQUFLd0IsS0FDeEMsR0FBR3ZILEVBQVdzQixHQUFRdEIsRUFBV3NCLEdBQUsrRyxLQUFLRCxPQUEzQyxDQUNBLElBQUlFLEVBQVFDLEVBQ1osUUFBVzdFLElBQVJxQyxFQUVGLElBREEsSUFBSXlDLEVBQVU5SCxTQUFTK0gscUJBQXFCLFVBQ3BDakQsRUFBSSxFQUFHQSxFQUFJZ0QsRUFBUS9DLE9BQVFELElBQUssQ0FDdkMsSUFBSWtELEVBQUlGLEVBQVFoRCxHQUNoQixHQUFHa0QsRUFBRUMsYUFBYSxRQUFVckgsR0FBT29ILEVBQUVDLGFBQWEsaUJBQW1CMUksRUFBb0I4RixFQUFLLENBQUV1QyxFQUFTSSxFQUFHLEtBQU8sQ0FDcEgsQ0FFR0osSUFDSEMsR0FBYSxHQUNiRCxFQUFTNUgsU0FBU2tJLGNBQWMsV0FFekJDLFFBQVUsUUFDakJQLEVBQU9RLFFBQVUsSUFDYnJFLEVBQW9Cc0UsSUFDdkJULEVBQU9VLGFBQWEsUUFBU3ZFLEVBQW9Cc0UsSUFFbERULEVBQU9VLGFBQWEsZUFBZ0IvSSxFQUFvQjhGLEdBRXhEdUMsRUFBT1csSUFBTTNILEdBRWR0QixFQUFXc0IsR0FBTyxDQUFDOEcsR0FDbkIsSUFBSWMsRUFBbUIsQ0FBQ0MsRUFBTUMsS0FFN0JkLEVBQU9lLFFBQVVmLEVBQU9nQixPQUFTLEtBQ2pDQyxhQUFhVCxHQUNiLElBQUlVLEVBQVV4SixFQUFXc0IsR0FJekIsVUFIT3RCLEVBQVdzQixHQUNsQmdILEVBQU9tQixZQUFjbkIsRUFBT21CLFdBQVdDLFlBQVlwQixHQUNuRGtCLEdBQVdBLEVBQVF4QyxTQUFTNUIsR0FBUUEsRUFBR2dFLEtBQ3BDRCxFQUFNLE9BQU9BLEVBQUtDLElBRWxCTixFQUFVN0YsV0FBV2lHLEVBQWlCUyxLQUFLLFVBQU1qRyxFQUFXLENBQUUxQyxLQUFNLFVBQVc0SSxPQUFRdEIsSUFBVyxNQUN0R0EsRUFBT2UsUUFBVUgsRUFBaUJTLEtBQUssS0FBTXJCLEVBQU9lLFNBQ3BEZixFQUFPZ0IsT0FBU0osRUFBaUJTLEtBQUssS0FBTXJCLEVBQU9nQixRQUNuRGYsR0FBYzdILFNBQVNtSixLQUFLQyxZQUFZeEIsRUFwQ2tCLEdTSDNEN0QsRUFBb0J3QixFQUFLckIsSUFDSCxvQkFBWG1GLFFBQTBCQSxPQUFPQyxhQUMxQ3BFLE9BQU93QixlQUFleEMsRUFBU21GLE9BQU9DLFlBQWEsQ0FBRTNELE1BQU8sV0FFN0RULE9BQU93QixlQUFleEMsRUFBUyxhQUFjLENBQUV5QixPQUFPLEtDTHZENUIsRUFBb0JrQixFQUFJLElDQXhCbEIsRUFBb0J3RixFQUFJLEksTUNLeEIsSUFBSUMsRUFBa0IsQ0FDckIsSUFBSyxHQUdOekYsRUFBb0I2QyxFQUFFM0IsRUFBSSxDQUFDNEIsRUFBU0ksS0FFbEMsSUFBSXdDLEVBQXFCMUYsRUFBb0IwQyxFQUFFK0MsRUFBaUIzQyxHQUFXMkMsRUFBZ0IzQyxRQUFXN0QsRUFDdEcsR0FBMEIsSUFBdkJ5RyxFQUdGLEdBQUdBLEVBQ0Z4QyxFQUFTVSxLQUFLOEIsRUFBbUIsUUFDM0IsQ0FHTCxJQUFJQyxFQUFVLElBQUk1QyxTQUFRLENBQUM2QyxFQUFTQyxJQUFZSCxFQUFxQkQsRUFBZ0IzQyxHQUFXLENBQUM4QyxFQUFTQyxLQUMxRzNDLEVBQVNVLEtBQUs4QixFQUFtQixHQUFLQyxHQUd0QyxJQUFJOUksRUFBTW1ELEVBQW9Cd0YsRUFBSXhGLEVBQW9CbUQsRUFBRUwsR0FFcER6RixFQUFRLElBQUlILE1BZ0JoQjhDLEVBQW9CMEQsRUFBRTdHLEdBZkY4SCxJQUNuQixHQUFHM0UsRUFBb0IwQyxFQUFFK0MsRUFBaUIzQyxLQUVmLEtBRDFCNEMsRUFBcUJELEVBQWdCM0MsTUFDUjJDLEVBQWdCM0MsUUFBVzdELEdBQ3JEeUcsR0FBb0IsQ0FDdEIsSUFBSUksRUFBWW5CLElBQXlCLFNBQWZBLEVBQU1wSSxLQUFrQixVQUFZb0ksRUFBTXBJLE1BQ2hFd0osRUFBVXBCLEdBQVNBLEVBQU1RLFFBQVVSLEVBQU1RLE9BQU9YLElBQ3BEbkgsRUFBTUksUUFBVSxpQkFBbUJxRixFQUFVLGNBQWdCZ0QsRUFBWSxLQUFPQyxFQUFVLElBQzFGMUksRUFBTTJJLEtBQU8saUJBQ2IzSSxFQUFNZCxLQUFPdUosRUFDYnpJLEVBQU00SSxRQUFVRixFQUNoQkwsRUFBbUIsR0FBR3JJLEVBQ3ZCLElBR3VDLFNBQVd5RixFQUFTQSxFQUUvRCxHQVlIOUMsRUFBb0JRLEVBQUVVLEVBQUs0QixHQUEwQyxJQUE3QjJDLEVBQWdCM0MsR0FHeEQsSUFBSW9ELEVBQXVCLENBQUNDLEVBQTRCL0ksS0FDdkQsSUFHSTZDLEVBQVU2QyxHQUhUcEMsRUFBVTBGLEVBQWFDLEdBQVdqSixFQUdoQjJELEVBQUksRUFDM0IsR0FBR0wsRUFBUzRGLE1BQU1DLEdBQWdDLElBQXhCZCxFQUFnQmMsS0FBYSxDQUN0RCxJQUFJdEcsS0FBWW1HLEVBQ1pwRyxFQUFvQjBDLEVBQUUwRCxFQUFhbkcsS0FDckNELEVBQW9CTyxFQUFFTixHQUFZbUcsRUFBWW5HLElBR2hELEdBQUdvRyxFQUFTLElBQUk1RixFQUFTNEYsRUFBUXJHLEVBQ2xDLENBRUEsSUFER21HLEdBQTRCQSxFQUEyQi9JLEdBQ3JEMkQsRUFBSUwsRUFBU00sT0FBUUQsSUFDekIrQixFQUFVcEMsRUFBU0ssR0FDaEJmLEVBQW9CMEMsRUFBRStDLEVBQWlCM0MsSUFBWTJDLEVBQWdCM0MsSUFDckUyQyxFQUFnQjNDLEdBQVMsS0FFMUIyQyxFQUFnQjNDLEdBQVcsRUFFNUIsT0FBTzlDLEVBQW9CUSxFQUFFQyxJQUcxQitGLEVBQXFCQyxLQUFtQyw2QkFBSUEsS0FBbUMsOEJBQUssR0FDeEdELEVBQW1CakUsUUFBUTJELEVBQXFCaEIsS0FBSyxLQUFNLElBQzNEc0IsRUFBbUI1QyxLQUFPc0MsRUFBcUJoQixLQUFLLEtBQU1zQixFQUFtQjVDLEtBQUtzQixLQUFLc0IsRyxLQ2xGdkYsSUFBSUUsRUFBc0IxRyxFQUFvQlEsT0FBRXZCLEVBQVcsQ0FBQyxLQUFLLElBQU9lLEVBQW9CLFFBQzVGMEcsRUFBc0IxRyxFQUFvQlEsRUFBRWtHLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9jaHVuayBsb2FkZWQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY3JlYXRlIGZha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9sb2FkIHNjcmlwdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2F1dGgvY29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvZW50cmllcy9jb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcnVudGltZUlkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJ2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgPyAob2JqKSA9PiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikpIDogKG9iaikgPT4gKG9iai5fX3Byb3RvX18pO1xudmFyIGxlYWZQcm90b3R5cGVzO1xuLy8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4vLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbi8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuLy8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4vLyBtb2RlICYgMTY6IHJldHVybiB2YWx1ZSB3aGVuIGl0J3MgUHJvbWlzZS1saWtlXG4vLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuXHRpZihtb2RlICYgMSkgdmFsdWUgPSB0aGlzKHZhbHVlKTtcblx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcblx0aWYodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSkge1xuXHRcdGlmKChtb2RlICYgNCkgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuXHRcdGlmKChtb2RlICYgMTYpICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdmFsdWU7XG5cdH1cblx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcblx0dmFyIGRlZiA9IHt9O1xuXHRsZWFmUHJvdG90eXBlcyA9IGxlYWZQcm90b3R5cGVzIHx8IFtudWxsLCBnZXRQcm90byh7fSksIGdldFByb3RvKFtdKSwgZ2V0UHJvdG8oZ2V0UHJvdG8pXTtcblx0Zm9yKHZhciBjdXJyZW50ID0gbW9kZSAmIDIgJiYgdmFsdWU7IHR5cGVvZiBjdXJyZW50ID09ICdvYmplY3QnICYmICF+bGVhZlByb3RvdHlwZXMuaW5kZXhPZihjdXJyZW50KTsgY3VycmVudCA9IGdldFByb3RvKGN1cnJlbnQpKSB7XG5cdFx0T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoY3VycmVudCkuZm9yRWFjaCgoa2V5KSA9PiAoZGVmW2tleV0gPSAoKSA9PiAodmFsdWVba2V5XSkpKTtcblx0fVxuXHRkZWZbJ2RlZmF1bHQnXSA9ICgpID0+ICh2YWx1ZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChucywgZGVmKTtcblx0cmV0dXJuIG5zO1xufTsiLCJ2YXIgaW5Qcm9ncmVzcyA9IHt9O1xudmFyIGRhdGFXZWJwYWNrUHJlZml4ID0gXCJ1cmJhbmRvY3Nfd2ViYXBwOlwiO1xuLy8gbG9hZFNjcmlwdCBmdW5jdGlvbiB0byBsb2FkIGEgc2NyaXB0IHZpYSBzY3JpcHQgdGFnXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSAodXJsLCBkb25lLCBrZXksIGNodW5rSWQpID0+IHtcblx0aWYoaW5Qcm9ncmVzc1t1cmxdKSB7IGluUHJvZ3Jlc3NbdXJsXS5wdXNoKGRvbmUpOyByZXR1cm47IH1cblx0dmFyIHNjcmlwdCwgbmVlZEF0dGFjaDtcblx0aWYoa2V5ICE9PSB1bmRlZmluZWQpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgcyA9IHNjcmlwdHNbaV07XG5cdFx0XHRpZihzLmdldEF0dHJpYnV0ZShcInNyY1wiKSA9PSB1cmwgfHwgcy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIikgPT0gZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpIHsgc2NyaXB0ID0gczsgYnJlYWs7IH1cblx0XHR9XG5cdH1cblx0aWYoIXNjcmlwdCkge1xuXHRcdG5lZWRBdHRhY2ggPSB0cnVlO1xuXHRcdHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG5cdFx0c2NyaXB0LmNoYXJzZXQgPSAndXRmLTgnO1xuXHRcdHNjcmlwdC50aW1lb3V0ID0gMTIwO1xuXHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKSB7XG5cdFx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgX193ZWJwYWNrX3JlcXVpcmVfXy5uYyk7XG5cdFx0fVxuXHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIiwgZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpO1xuXG5cdFx0c2NyaXB0LnNyYyA9IHVybDtcblx0fVxuXHRpblByb2dyZXNzW3VybF0gPSBbZG9uZV07XG5cdHZhciBvblNjcmlwdENvbXBsZXRlID0gKHByZXYsIGV2ZW50KSA9PiB7XG5cdFx0Ly8gYXZvaWQgbWVtIGxlYWtzIGluIElFLlxuXHRcdHNjcmlwdC5vbmVycm9yID0gc2NyaXB0Lm9ubG9hZCA9IG51bGw7XG5cdFx0Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXHRcdHZhciBkb25lRm5zID0gaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdGRlbGV0ZSBpblByb2dyZXNzW3VybF07XG5cdFx0c2NyaXB0LnBhcmVudE5vZGUgJiYgc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcblx0XHRkb25lRm5zICYmIGRvbmVGbnMuZm9yRWFjaCgoZm4pID0+IChmbihldmVudCkpKTtcblx0XHRpZihwcmV2KSByZXR1cm4gcHJldihldmVudCk7XG5cdH1cblx0dmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCB1bmRlZmluZWQsIHsgdHlwZTogJ3RpbWVvdXQnLCB0YXJnZXQ6IHNjcmlwdCB9KSwgMTIwMDAwKTtcblx0c2NyaXB0Lm9uZXJyb3IgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9uZXJyb3IpO1xuXHRzY3JpcHQub25sb2FkID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmxvYWQpO1xuXHRuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbn07IiwiLy8gc3JjL2F1dGgvY29uZmlybWF0aW9uLmpzXG4vKipcbiAqIENvbmZpcm1hdGlvbiBNb2R1bGVcbiAqIEBtb2R1bGUgY29uZmlybWF0aW9uXG4gKiBAZGVzY3JpcHRpb24gSGFuZGxlcyBlbWFpbCBjb25maXJtYXRpb24gd2l0aCBtYW51YWwgY29uZmlybWF0aW9uIGJ1dHRvbiBhbmQgQ0FQVENIQSB2ZXJpZmljYXRpb24uXG4gKiBAdmVyc2lvbiAwLjMuMFxuICpcbiAqIEBjaGFuZ2Vsb2dcbiAqIC0gMC4zLjAgKDIwMjUtMDEtWFgpOiBBZGRlZCBtYW51YWwgY29uZmlybWF0aW9uIHdpdGggQ0FQVENIQSByZXF1aXJlbWVudC5cbiAqIC0gMC4yLjAgKDIwMjUtMDUtMzEpOiBTaW1wbGlmaWVkIHBhZ2UgdG8gYXV0by1jb25maXJtIGFuZCByZWRpcmVjdC4gUmVtb3ZlZCBUb1MgYWdyZWVtZW50IGZyb20gdGhpcyBwYWdlLlxuICogLSAwLjEuMSAoMjAyNS0wNS0xNyk6IENvcnJlY3RlZCBzdWNjZXNzIG1lc3NhZ2UgYW5kIHJlZGlyZWN0IHRvIGxvZ2luIHBhZ2UuXG4gKiAtIDAuMS4wICgyMDI1LTA1LTE1KTogQ29udmVydGVkIHRvIHVzZSBkaXJlY3QgU3VwYWJhc2UgQVBJIGNhbGxzIGluc3RlYWQgb2YgRmlyZWJhc2UgQ2xvdWQgRnVuY3Rpb25zLlxuICogLSAwLjAuMyAoMjAyNS0wNS0xMik6IFVwZGF0ZWQgdGVybXMgb2Ygc2VydmljZSBtb2RhbCBhbmQgY29uZmlybWF0aW9uIGVtYWlsLlxuICogLSAwLjAuMiAoMjAyNS0wNS0xMCk6IEFkZGVkIHRlcm1zIG9mIHNlcnZpY2UgYW5kIGNvbmZpcm1hdGlvbiBlbWFpbC5cbiAqIC0gMC4wLjEgKDIwMjUtMDUtMDgpOiBDcmVhdGVkIHRoZSBjb25maXJtYXRpb24gbW9kdWxlIHdpdGggYmFzaWMgZnVuY3Rpb25hbGl0eS5cbiAqL1xuXG5pbXBvcnQgeyBzaG93U3RhdHVzLCBzaG93RXJyb3IsIHNob3dMb2FkaW5nLCBoaWRlTG9hZGluZyB9IGZyb20gXCIuL2F1dGguanNcIjtcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4uL3N1cGFiYXNlLWNsaWVudC5qc1wiO1xuXG4vLyBTdG9yZSBjb25maXJtYXRpb24gZGF0YSBhbmQgY2FwdGNoYSB0b2tlblxubGV0IGNvbmZpcm1hdGlvbkRhdGEgPSBudWxsO1xubGV0IGNhcHRjaGFUb2tlbiA9IG51bGw7XG5sZXQgdHVybnN0aWxlV2lkZ2V0SWQgPSBudWxsO1xuXG4vLyBUdXJuc3RpbGUgY2FsbGJhY2sgZnVuY3Rpb25cbndpbmRvdy5vbmxvYWRUdXJuc3RpbGVDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc29sZS5sb2coXCJUdXJuc3RpbGUgQVBJIHJlYWR5IGZvciBjb25maXJtYXRpb24gcGFnZS5cIik7XG4gIGNvbnN0IHR1cm5zdGlsZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHVybnN0aWxlLWNvbnRhaW5lclwiKTtcblxuICBpZiAodHVybnN0aWxlQ29udGFpbmVyICYmIHdpbmRvdy50dXJuc3RpbGUgJiYgIXR1cm5zdGlsZVdpZGdldElkKSB7XG4gICAgY29uc29sZS5sb2coXCJSZW5kZXJpbmcgVHVybnN0aWxlIHdpZGdldCBmb3IgY29uZmlybWF0aW9uLi4uXCIpO1xuICAgIHRyeSB7XG4gICAgICB0dXJuc3RpbGVXaWRnZXRJZCA9IHdpbmRvdy50dXJuc3RpbGUucmVuZGVyKHR1cm5zdGlsZUNvbnRhaW5lciwge1xuICAgICAgICBzaXRla2V5OiBcIjB4NEFBQUFBQUJkelkzSW5PVTJfSW45OVwiLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgY2FwdGNoYVRva2VuID0gdG9rZW47XG4gICAgICAgICAgY29uc29sZS5sb2coXCJUdXJuc3RpbGUgdG9rZW4gb2J0YWluZWQgZm9yIGNvbmZpcm1hdGlvbjpcIiwgdG9rZW4pO1xuXG4gICAgICAgICAgLy8gRW5hYmxlIGNvbmZpcm0gYnV0dG9uIHdoZW4gQ0FQVENIQSBpcyBzb2x2ZWRcbiAgICAgICAgICBjb25zdCBjb25maXJtQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtQnRuXCIpO1xuICAgICAgICAgIGlmIChjb25maXJtQnRuKSB7XG4gICAgICAgICAgICBjb25maXJtQnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImV4cGlyZWQtY2FsbGJhY2tcIjogKCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHVybnN0aWxlIHRva2VuIGV4cGlyZWQgb24gY29uZmlybWF0aW9uIHBhZ2UuXCIpO1xuICAgICAgICAgIGlmICh3aW5kb3cudHVybnN0aWxlICYmIHR1cm5zdGlsZVdpZGdldElkKSB7XG4gICAgICAgICAgICB3aW5kb3cudHVybnN0aWxlLnJlc2V0KHR1cm5zdGlsZVdpZGdldElkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FwdGNoYVRva2VuID0gbnVsbDtcblxuICAgICAgICAgIC8vIERpc2FibGUgY29uZmlybSBidXR0b24gd2hlbiBDQVBUQ0hBIGV4cGlyZXNcbiAgICAgICAgICBjb25zdCBjb25maXJtQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtQnRuXCIpO1xuICAgICAgICAgIGlmIChjb25maXJtQnRuKSB7XG4gICAgICAgICAgICBjb25maXJtQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiZXJyb3ItY2FsbGJhY2tcIjogKGVycikgPT4ge1xuICAgICAgICAgIGNhcHRjaGFUb2tlbiA9IG51bGw7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIlR1cm5zdGlsZSBlcnJvciBvbiBjb25maXJtYXRpb24gcGFnZTpcIiwgZXJyKTtcbiAgICAgICAgICBzaG93RXJyb3IoYEVycmV1ciBDQVBUQ0hBOiAke2Vycn0uIFZldWlsbGV6IHLDqWVzc2F5ZXIuYCk7XG5cbiAgICAgICAgICAvLyBEaXNhYmxlIGNvbmZpcm0gYnV0dG9uIG9uIENBUFRDSEEgZXJyb3JcbiAgICAgICAgICBjb25zdCBjb25maXJtQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtQnRuXCIpO1xuICAgICAgICAgIGlmIChjb25maXJtQnRuKSB7XG4gICAgICAgICAgICBjb25maXJtQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKHR1cm5zdGlsZVdpZGdldElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBcIlR1cm5zdGlsZS5yZW5kZXIgZGlkIG5vdCByZXR1cm4gYSB3aWRnZXRJZCBmb3IgY29uZmlybWF0aW9uLlwiXG4gICAgICAgICk7XG4gICAgICAgIHNob3dFcnJvcihcIkVycmV1ciBpbml0aWFsaXNhdGlvbiBDQVBUQ0hBLlwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIFwiVHVybnN0aWxlIHdpZGdldCByZW5kZXJlZCBmb3IgY29uZmlybWF0aW9uLiBJRDpcIixcbiAgICAgICAgICB0dXJuc3RpbGVXaWRnZXRJZFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZW5kZXJpbmcgVHVybnN0aWxlIG9uIGNvbmZpcm1hdGlvbiBwYWdlOlwiLCBlKTtcbiAgICAgIHNob3dFcnJvcihcIkltcG9zc2libGUgZCdhZmZpY2hlciBsZSBDQVBUQ0hBLlwiKTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgdGhlIGVtYWlsIGNvbmZpcm1hdGlvbiBwYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0Q29uZmlybWF0aW9uUGFnZSgpIHtcbiAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgY29uc3QgdXJsSGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuXG4gIC8vIENoZWNrIGZvciBkaWZmZXJlbnQgdHlwZXMgb2YgY29uZmlybWF0aW9uIGRhdGFcbiAgbGV0IGNvbmZpcm1hdGlvblRva2VuID0gdXJsUGFyYW1zLmdldChcInRva2VuXCIpO1xuICBjb25zdCB0eXBlID0gdXJsUGFyYW1zLmdldChcInR5cGVcIik7XG4gIGxldCBjb25maXJtYXRpb25VcmwgPSB1cmxQYXJhbXMuZ2V0KFwiY29uZmlybWF0aW9uX3VybFwiKTtcblxuICAvLyBBbHNvIGNoZWNrIFVSTCBoYXNoIGZvciB0b2tlbnMgKFN1cGFiYXNlIHNvbWV0aW1lcyBwdXRzIHRva2VucyBpbiBoYXNoKVxuICBpZiAodXJsSGFzaCkge1xuICAgIGNvbnN0IGhhc2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHVybEhhc2guc3Vic3RyaW5nKDEpKTtcbiAgICBpZiAoIWNvbmZpcm1hdGlvblRva2VuKSB7XG4gICAgICBjb25maXJtYXRpb25Ub2tlbiA9XG4gICAgICAgIGhhc2hQYXJhbXMuZ2V0KFwiYWNjZXNzX3Rva2VuXCIpIHx8IGhhc2hQYXJhbXMuZ2V0KFwidG9rZW5cIik7XG4gICAgfVxuICB9XG5cbiAgY29uc29sZS5sb2coXCJDb25maXJtYXRpb24gcGFnZSBpbml0aWFsaXplZCB3aXRoOlwiLCB7XG4gICAgY29uZmlybWF0aW9uVG9rZW46IGNvbmZpcm1hdGlvblRva2VuID8gXCJwcmVzZW50XCIgOiBcIm1pc3NpbmdcIixcbiAgICB0eXBlLFxuICAgIGNvbmZpcm1hdGlvblVybDogY29uZmlybWF0aW9uVXJsID8gXCJwcmVzZW50XCIgOiBcIm1pc3NpbmdcIixcbiAgICB1cmxIYXNoOiB1cmxIYXNoIHx8IFwibm9uZVwiLFxuICB9KTtcblxuICBjb25zdCBzdGF0dXNNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0dXNNZXNzYWdlXCIpO1xuICBjb25zdCBlcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycm9yTWVzc2FnZVwiKTtcbiAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZ1wiKTtcbiAgY29uc3QgY29uZmlybWF0aW9uRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybWF0aW9uRm9ybVwiKTtcbiAgY29uc3QgY29uZmlybUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1Gb3JtXCIpO1xuXG4gIGlmIChsb2FkaW5nKSBsb2FkaW5nLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG5cbiAgLy8gVmFsaWRhdGUgdGhhdCB3ZSBoYXZlIHRoZSBuZWNlc3NhcnkgY29uZmlybWF0aW9uIGRhdGFcbiAgaWYgKGNvbmZpcm1hdGlvblVybCkge1xuICAgIGNvbmZpcm1hdGlvbkRhdGEgPSB7IHR5cGU6IFwidXJsXCIsIGRhdGE6IGNvbmZpcm1hdGlvblVybCB9O1xuICAgIHNob3dDb25maXJtYXRpb25Gb3JtKCk7XG4gIH0gZWxzZSBpZiAoXG4gICAgY29uZmlybWF0aW9uVG9rZW4gJiZcbiAgICAodHlwZSA9PT0gXCJzaWdudXBcIiB8fCB0eXBlID09PSBcImVtYWlsX2NoYW5nZVwiKVxuICApIHtcbiAgICBjb25maXJtYXRpb25EYXRhID0ge1xuICAgICAgdHlwZTogXCJ0b2tlblwiLFxuICAgICAgZGF0YTogY29uZmlybWF0aW9uVG9rZW4sXG4gICAgICB0b2tlblR5cGU6IHR5cGUsXG4gICAgfTtcbiAgICBzaG93Q29uZmlybWF0aW9uRm9ybSgpO1xuICB9IGVsc2Uge1xuICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgc2hvd0Vycm9yKFwiRXJyZXVyOiBVUkwgb3UgamV0b24gZGUgY29uZmlybWF0aW9uIG1hbnF1YW50IG91IGludmFsaWRlLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBTZXQgdXAgZm9ybSBzdWJtaXNzaW9uIGhhbmRsZXJcbiAgaWYgKGNvbmZpcm1Gb3JtKSB7XG4gICAgY29uZmlybUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVDb25maXJtYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd0NvbmZpcm1hdGlvbkZvcm0oKSB7XG4gICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBpZiAoY29uZmlybWF0aW9uRm9ybSkgY29uZmlybWF0aW9uRm9ybS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgIHNob3dTdGF0dXMoXG4gICAgICBcIkxpZW4gZGUgY29uZmlybWF0aW9uIHZhbGlkZS4gVmV1aWxsZXogY29tcGzDqXRlciBsZSBDQVBUQ0hBIGV0IGNvbmZpcm1lci5cIixcbiAgICAgIFwiaW5mb1wiXG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIEhhbmRsZXMgdGhlIG1hbnVhbCBjb25maXJtYXRpb24gcHJvY2Vzc1xuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDb25maXJtYXRpb24oZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgaWYgKCFjYXB0Y2hhVG9rZW4pIHtcbiAgICBzaG93RXJyb3IoXCJWZXVpbGxleiBjb21wbMOpdGVyIGxlIENBUFRDSEEgYXZhbnQgZGUgY29uZmlybWVyLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIWNvbmZpcm1hdGlvbkRhdGEpIHtcbiAgICBzaG93RXJyb3IoXCJEb25uw6llcyBkZSBjb25maXJtYXRpb24gbWFucXVhbnRlcy5cIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY29uZmlybUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybUJ0blwiKTtcbiAgY29uc3QgY29uZmlybVNwaW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1TcGlubmVyXCIpO1xuXG4gIC8vIFNob3cgbG9hZGluZyBzdGF0ZVxuICBpZiAoY29uZmlybUJ0bikgY29uZmlybUJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gIGlmIChjb25maXJtU3Bpbm5lcikgY29uZmlybVNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcblxuICB0cnkge1xuICAgIGlmIChjb25maXJtYXRpb25EYXRhLnR5cGUgPT09IFwidXJsXCIpIHtcbiAgICAgIGF3YWl0IGNvbmZpcm1FbWFpbFdpdGhVcmwoY29uZmlybWF0aW9uRGF0YS5kYXRhKTtcbiAgICB9IGVsc2UgaWYgKGNvbmZpcm1hdGlvbkRhdGEudHlwZSA9PT0gXCJ0b2tlblwiKSB7XG4gICAgICBhd2FpdCBjb25maXJtRW1haWxXaXRoVG9rZW4oXG4gICAgICAgIGNvbmZpcm1hdGlvbkRhdGEuZGF0YSxcbiAgICAgICAgY29uZmlybWF0aW9uRGF0YS50b2tlblR5cGVcbiAgICAgICk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJDb25maXJtYXRpb24gZXJyb3I6XCIsIGVycm9yKTtcbiAgICBzaG93RXJyb3IoYEVycmV1ciBsb3JzIGRlIGxhIGNvbmZpcm1hdGlvbjogJHtlcnJvci5tZXNzYWdlfWApO1xuICB9IGZpbmFsbHkge1xuICAgIC8vIFJlc2V0IGxvYWRpbmcgc3RhdGVcbiAgICBpZiAoY29uZmlybUJ0bikgY29uZmlybUJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGlmIChjb25maXJtU3Bpbm5lcikgY29uZmlybVNwaW5uZXIuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcblxuICAgIC8vIFJlc2V0IENBUFRDSEFcbiAgICBpZiAod2luZG93LnR1cm5zdGlsZSAmJiB0dXJuc3RpbGVXaWRnZXRJZCkge1xuICAgICAgd2luZG93LnR1cm5zdGlsZS5yZXNldCh0dXJuc3RpbGVXaWRnZXRJZCk7XG4gICAgfVxuICAgIGNhcHRjaGFUb2tlbiA9IG51bGw7XG4gICAgaWYgKGNvbmZpcm1CdG4pIGNvbmZpcm1CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG59XG5cbi8qKlxuICogQ29uZmlybXMgdGhlIGVtYWlsIGFkZHJlc3Mgd2l0aCB0b2tlbi1iYXNlZCBjb25maXJtYXRpb25cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29uZmlybUVtYWlsV2l0aFRva2VuKHRva2VuLCB0b2tlblR5cGUgPSBcInNpZ251cFwiKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJBdHRlbXB0aW5nIHRva2VuIGNvbmZpcm1hdGlvbiB3aXRoIHR5cGU6XCIsIHRva2VuVHlwZSk7XG5cbiAgICAvLyBGb3Igc2lnbnVwIGNvbmZpcm1hdGlvbnMsIHVzZSB2ZXJpZnlPdHAgd2l0aCB0aGUgdG9rZW5faGFzaFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGgudmVyaWZ5T3RwKHtcbiAgICAgIHRva2VuX2hhc2g6IHRva2VuLFxuICAgICAgdHlwZTogXCJlbWFpbFwiLCAvLyBVc2UgJ2VtYWlsJyB0eXBlIGZvciBlbWFpbCBjb25maXJtYXRpb25zXG4gICAgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkdXJpbmcgdmVyaWZ5T3RwOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiRXJyZXVyIGxvcnMgZGUgbGEgdsOpcmlmaWNhdGlvbiBkdSB0b2tlbjogXCIgKyBlcnJvci5tZXNzYWdlXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChkYXRhLnVzZXIgJiYgZGF0YS5zZXNzaW9uKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkVtYWlsIGNvbmZpcm1lZCBzdWNjZXNzZnVsbHk6XCIsIGRhdGEudXNlci5lbWFpbCk7XG4gICAgICBzaG93U3VjY2Vzc0FuZFJlZGlyZWN0KFxuICAgICAgICBcIkVtYWlsIHbDqXJpZmnDqSBhdmVjIHN1Y2PDqHMgISBSZWRpcmVjdGlvbiB2ZXJzIGxhIGNvbm5leGlvbi4uLlwiXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiSW1wb3NzaWJsZSBkZSBjb25maXJtZXIgbCdlbWFpbC4gTGUgdG9rZW4gZXN0IHBldXQtw6p0cmUgaW52YWxpZGUgb3UgYSBleHBpcsOpLlwiXG4gICAgICApO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZHVyaW5nIHRva2VuLWJhc2VkIGNvbmZpcm1hdGlvbjpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogQ29uZmlybXMgdGhlIGVtYWlsIGFkZHJlc3MgZGlyZWN0bHkgd2l0aCBTdXBhYmFzZSB1c2luZyB0aGUgY29uZmlybWF0aW9uIFVSTFxuICovXG5hc3luYyBmdW5jdGlvbiBjb25maXJtRW1haWxXaXRoVXJsKGNvbmZpcm1hdGlvblVybFBhcmFtKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGVjb2RlZFVybCA9IGRlY29kZVVSSUNvbXBvbmVudChjb25maXJtYXRpb25VcmxQYXJhbSk7XG4gICAgY29uc29sZS5sb2coXCJBdHRlbXB0aW5nIGVtYWlsIGNvbmZpcm1hdGlvbiB3aXRoIFVSTDpcIiwgZGVjb2RlZFVybCk7XG5cbiAgICAvLyBFeHRyYWN0IHRva2VuIGZyb20gdGhlIGNvbmZpcm1hdGlvbiBVUkxcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGRlY29kZWRVcmwpO1xuICAgIGNvbnN0IHRva2VuID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ0b2tlblwiKTtcbiAgICBjb25zdCB0eXBlID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ0eXBlXCIpO1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9rZW4gbWFucXVhbnQgZGFucyBsJ1VSTCBkZSBjb25maXJtYXRpb24uXCIpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgXCJFeHRyYWN0ZWQgZnJvbSBVUkwgLSB0b2tlbjpcIixcbiAgICAgIHRva2VuLnN1YnN0cmluZygwLCAyMCkgKyBcIi4uLlwiLFxuICAgICAgXCJ0eXBlOlwiLFxuICAgICAgdHlwZVxuICAgICk7XG5cbiAgICAvLyBVc2UgdmVyaWZ5T3RwIHdpdGggdG9rZW5faGFzaCBmb3IgZW1haWwgY29uZmlybWF0aW9uc1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGgudmVyaWZ5T3RwKHtcbiAgICAgIHRva2VuX2hhc2g6IHRva2VuLFxuICAgICAgdHlwZTogXCJlbWFpbFwiLCAvLyBVc2UgJ2VtYWlsJyB0eXBlIGZvciBlbWFpbCBjb25maXJtYXRpb25zIHJlZ2FyZGxlc3Mgb2YgVVJMIHR5cGVcbiAgICB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBVUkwtYmFzZWQgY29uZmlybWF0aW9uOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsYSBjb25maXJtYXRpb246IFwiICsgZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuXG4gICAgaWYgKGRhdGEudXNlciAmJiBkYXRhLnNlc3Npb24pIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRW1haWwgY29uZmlybWVkIHN1Y2Nlc3NmdWxseSB2aWEgVVJMOlwiLCBkYXRhLnVzZXIuZW1haWwpO1xuICAgICAgc2hvd1N1Y2Nlc3NBbmRSZWRpcmVjdChcbiAgICAgICAgXCJFbWFpbCB2w6lyaWZpw6kgYXZlYyBzdWNjw6hzICEgVm91cyBhbGxleiDDqnRyZSByZWRpcmlnw6kgdmVycyBsYSBwYWdlIGRlIGNvbm5leGlvbi5cIlxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkltcG9zc2libGUgZGUgY29uZmlybWVyIGwnZW1haWwuIExlIGxpZW4gZXN0IHBldXQtw6p0cmUgZXhwaXLDqSBvdSBkw6lqw6AgdXRpbGlzw6kuXCJcbiAgICAgICk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJDb25maXJtYXRpb24gcHJvY2Vzc2luZyBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogU2hvd3Mgc3VjY2VzcyBtZXNzYWdlIGFuZCByZWRpcmVjdHMgdG8gbG9naW5cbiAqL1xuZnVuY3Rpb24gc2hvd1N1Y2Nlc3NBbmRSZWRpcmVjdChtZXNzYWdlKSB7XG4gIGNvbnN0IGNvbmZpcm1hdGlvbkZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1hdGlvbkZvcm1cIik7XG4gIGNvbnN0IHN1Y2Nlc3NNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWNjZXNzTWVzc2FnZVwiKTtcblxuICBpZiAoY29uZmlybWF0aW9uRm9ybSkgY29uZmlybWF0aW9uRm9ybS5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuXG4gIGlmIChzdWNjZXNzTWVzc2FnZSkge1xuICAgIHN1Y2Nlc3NNZXNzYWdlLmlubmVySFRNTCA9IGBcbiAgICAgIDxkaXYgY2xhc3M9XCJjb25maXJtYXRpb24tc3VjY2Vzc1wiPlxuICAgICAgICA8c3BhbiBjbGFzcz1cInN1Y2Nlc3MtaWNvblwiPuKchTwvc3Bhbj5cbiAgICAgICAgPGgzPkNvbmZpcm1hdGlvbiByw6l1c3NpZSAhPC9oMz5cbiAgICAgICAgPHA+Vm90cmUgY29tcHRlIGEgw6l0w6kgY29uZmlybcOpIGF2ZWMgc3VjY8Oocy48L3A+XG4gICAgICAgIDxwPlZvdXMgYWxsZXogw6p0cmUgcmVkaXJpZ8OpIHZlcnMgbGEgcGFnZSBkZSBjb25uZXhpb24gZGFucyBxdWVscXVlcyBzZWNvbmRlcy4uLjwvcD5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG4gICAgc3VjY2Vzc01lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfVxuXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvYXV0aC9sb2dpblwiO1xuICB9LCAzMDAwKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBpbml0Q29uZmlybWF0aW9uUGFnZSxcbn07XG4iLCIvLyBzcmMvZW50cmllcy9jb25maXJtYXRpb24uanNcbi8qKlxuICogQ29uZmlybWF0aW9uIEVudHJ5IFBvaW50XG4gKlxuICogVGhpcyBtb2R1bGUgc2VydmVzIGFzIHRoZSBlbnRyeSBwb2ludCBmb3IgdGhlIGVtYWlsIGNvbmZpcm1hdGlvbiBwYWdlLlxuICovXG5cbi8vIEltcG9ydCBvdXIgY29uZmlybWF0aW9uIG1vZHVsZVxuaW1wb3J0IHsgaW5pdENvbmZpcm1hdGlvblBhZ2UgfSBmcm9tIFwiLi4vYXV0aC9jb25maXJtYXRpb24uanNcIjtcblxuLy8gSW5pdGlhbGl6ZSBjb25maXJtYXRpb24gcGFnZSB3aGVuIERPTSBpcyBsb2FkZWRcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgLy8gSW5pdGlhbGl6ZSBjb25maXJtYXRpb24gcGFnZVxuICBpbml0Q29uZmlybWF0aW9uUGFnZSgpO1xuXG4gIGNvbnNvbGUubG9nKFwiQ29uZmlybWF0aW9uIHBhZ2UgaW5pdGlhbGl6ZWRcIik7XG59KTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gKGNodW5rSWQpID0+IHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcImpzL1wiICsgY2h1bmtJZCArIFwiLmNodW5rLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uaiA9IDUwODsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0NTA4OiAwXG59O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuaiA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHRcdC8vIEpTT05QIGNodW5rIGxvYWRpbmcgZm9yIGphdmFzY3JpcHRcblx0XHR2YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgPyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gOiB1bmRlZmluZWQ7XG5cdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7IC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdFx0XHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0XHRcdHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gKGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IFtyZXNvbHZlLCByZWplY3RdKSk7XG5cdFx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKTtcblxuXHRcdFx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdFx0XHR2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgX193ZWJwYWNrX3JlcXVpcmVfXy51KGNodW5rSWQpO1xuXHRcdFx0XHRcdC8vIGNyZWF0ZSBlcnJvciBiZWZvcmUgc3RhY2sgdW53b3VuZCB0byBnZXQgdXNlZnVsIHN0YWNrdHJhY2UgbGF0ZXJcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdFx0XHR2YXIgbG9hZGluZ0VuZGVkID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSkge1xuXHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF07XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID0gZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubWVzc2FnZSA9ICdMb2FkaW5nIGNodW5rICcgKyBjaHVua0lkICsgJyBmYWlsZWQuXFxuKCcgKyBlcnJvclR5cGUgKyAnOiAnICsgcmVhbFNyYyArICcpJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci50eXBlID0gZXJyb3JUeXBlO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnJlcXVlc3QgPSByZWFsU3JjO1xuXHRcdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubCh1cmwsIGxvYWRpbmdFbmRlZCwgXCJjaHVuay1cIiArIGNodW5rSWQsIGNodW5rSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxufTtcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5PLmogPSAoY2h1bmtJZCkgPT4gKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9PT0gMCk7XG5cbi8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uLCBkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYoY2h1bmtJZHMuc29tZSgoaWQpID0+IChpbnN0YWxsZWRDaHVua3NbaWRdICE9PSAwKSkpIHtcblx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcblx0fVxuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHJlc3VsdCk7XG59XG5cbnZhciBjaHVua0xvYWRpbmdHbG9iYWwgPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8odW5kZWZpbmVkLCBbNzZdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXygxMDA4KSkpXG5fX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKF9fd2VicGFja19leHBvcnRzX18pO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibGVhZlByb3RvdHlwZXMiLCJnZXRQcm90byIsImluUHJvZ3Jlc3MiLCJkYXRhV2VicGFja1ByZWZpeCIsImNvbmZpcm1hdGlvbkRhdGEiLCJjYXB0Y2hhVG9rZW4iLCJ0dXJuc3RpbGVXaWRnZXRJZCIsImFzeW5jIiwiaGFuZGxlQ29uZmlybWF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY29uZmlybUJ0biIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25maXJtU3Bpbm5lciIsImRpc2FibGVkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidHlwZSIsImNvbmZpcm1hdGlvblVybFBhcmFtIiwiZGVjb2RlZFVybCIsImRlY29kZVVSSUNvbXBvbmVudCIsImNvbnNvbGUiLCJsb2ciLCJ1cmwiLCJVUkwiLCJ0b2tlbiIsInNlYXJjaFBhcmFtcyIsImdldCIsIkVycm9yIiwic3Vic3RyaW5nIiwiZGF0YSIsImVycm9yIiwiYXV0aCIsInZlcmlmeU90cCIsInRva2VuX2hhc2giLCJtZXNzYWdlIiwidXNlciIsInNlc3Npb24iLCJlbWFpbCIsInNob3dTdWNjZXNzQW5kUmVkaXJlY3QiLCJjb25maXJtRW1haWxXaXRoVXJsIiwidG9rZW5UeXBlIiwiY29uZmlybUVtYWlsV2l0aFRva2VuIiwiYWRkIiwid2luZG93IiwidHVybnN0aWxlIiwicmVzZXQiLCJjb25maXJtYXRpb25Gb3JtIiwic3VjY2Vzc01lc3NhZ2UiLCJpbm5lckhUTUwiLCJzZXRUaW1lb3V0IiwibG9jYXRpb24iLCJocmVmIiwib25sb2FkVHVybnN0aWxlQ2FsbGJhY2siLCJ0dXJuc3RpbGVDb250YWluZXIiLCJyZW5kZXIiLCJzaXRla2V5IiwiY2FsbGJhY2siLCJlcnIiLCJ1bmRlZmluZWQiLCJhZGRFdmVudExpc3RlbmVyIiwidXJsUGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwic2VhcmNoIiwidXJsSGFzaCIsImhhc2giLCJjb25maXJtYXRpb25Ub2tlbiIsImNvbmZpcm1hdGlvblVybCIsImhhc2hQYXJhbXMiLCJsb2FkaW5nIiwiY29uZmlybUZvcm0iLCJzaG93Q29uZmlybWF0aW9uRm9ybSIsImluaXRDb25maXJtYXRpb25QYWdlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwibSIsIk8iLCJyZXN1bHQiLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImkiLCJsZW5ndGgiLCJmdWxmaWxsZWQiLCJqIiwiT2JqZWN0Iiwia2V5cyIsImV2ZXJ5Iiwia2V5Iiwic3BsaWNlIiwiciIsImdldFByb3RvdHlwZU9mIiwib2JqIiwidCIsInZhbHVlIiwibW9kZSIsInRoaXMiLCJfX2VzTW9kdWxlIiwidGhlbiIsIm5zIiwiY3JlYXRlIiwiZGVmIiwiY3VycmVudCIsImluZGV4T2YiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZm9yRWFjaCIsImQiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJjaHVua0lkIiwiUHJvbWlzZSIsImFsbCIsInJlZHVjZSIsInByb21pc2VzIiwidSIsImciLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJsIiwiZG9uZSIsInB1c2giLCJzY3JpcHQiLCJuZWVkQXR0YWNoIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicyIsImdldEF0dHJpYnV0ZSIsImNyZWF0ZUVsZW1lbnQiLCJjaGFyc2V0IiwidGltZW91dCIsIm5jIiwic2V0QXR0cmlidXRlIiwic3JjIiwib25TY3JpcHRDb21wbGV0ZSIsInByZXYiLCJldmVudCIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiYmluZCIsInRhcmdldCIsImhlYWQiLCJhcHBlbmRDaGlsZCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwicCIsImluc3RhbGxlZENodW5rcyIsImluc3RhbGxlZENodW5rRGF0YSIsInByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZXJyb3JUeXBlIiwicmVhbFNyYyIsIm5hbWUiLCJyZXF1ZXN0Iiwid2VicGFja0pzb25wQ2FsbGJhY2siLCJwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsInNvbWUiLCJpZCIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==