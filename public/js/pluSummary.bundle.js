(()=>{"use strict";var e,t,n,o,r,a={5852:(e,t,n)=>{var o=n(9660),r=n(9251),a=n(2387);let i=null,c=null,d=null,l=[],s=null;async function u(){try{const{data:e,error:t}=await o.N.from("ratings").select("rating, user_id").eq("document_id",c.id);if(t)throw t;if(l=e||[],l.length>0){const e=l.reduce(((e,t)=>e+t.rating),0)/l.length;document.getElementById("average-rating").textContent=e.toFixed(1),document.getElementById("rating-count").textContent=l.length;const t=function(e){const t={1:0,2:0,3:0,4:0,5:0};return e.forEach((e=>{t[e.rating]++})),t}(l);m(t);const n=l.find((e=>e.user_id===i.id));s=n?n.rating:null}else document.getElementById("average-rating").textContent="0",document.getElementById("rating-count").textContent="0",m({1:0,2:0,3:0,4:0,5:0}),s=null;y()}catch(e){console.error("Error loading ratings:",e)}}function m(e){const t=l.length||1;for(let n=1;n<=5;n++){const o=e[n]/t*100;document.getElementById(`rating-${n}`).style.width=`${o}%`,document.getElementById(`rating-${n}-percent`).textContent=`${Math.round(o)}%`}}async function g(){try{const{data:e,error:t}=await o.N.from("comments").select("*").eq("document_id",c.id).order("created_at",{ascending:!1});if(t)throw t;if(0===e.length)return void p([]);const n=[...new Set(e.map((e=>e.user_id)))],{data:r,error:a}=await o.N.from("profiles").select("id, full_name, avatar_url").in("id",n);if(a)return console.warn("Could not fetch profiles:",a),void p(e.map((e=>({...e,profiles:null}))));const i=r.reduce(((e,t)=>(e[t.id]=t,e)),{});p(e.map((e=>({...e,profiles:i[e.user_id]||null}))))}catch(e){console.error("Error loading comments:",e),p([])}}function p(e){const t=document.getElementById("comments-list");t.innerHTML="",0!==e.length?e.forEach((e=>{const n=function(e){const t=document.createElement("div");t.className="comment",t.dataset.commentId=e.id;const n=e.user_id===i.id,o=e.profiles?.full_name||"Utilisateur anonyme",r=e.profiles?.avatar_url||"assets/icons/default-avatar.svg",a=new Date(e.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),c=document.createElement("div");c.className="comment-header";const d=document.createElement("div");d.style.display="flex",d.style.alignItems="center",d.style.gap="1rem",d.innerHTML=`\n    <img src="${r}" alt="${o}" class="comment-avatar">\n    <div class="comment-meta">\n      <div class="comment-author">${o}</div>\n      <div class="comment-date">${a}${e.updated_at!==e.created_at?" (modifié)":""}</div>\n    </div>\n  `,c.appendChild(d),t.appendChild(c);const l=document.createElement("div");if(l.className="comment-content",l.textContent=e.content,t.appendChild(l),n){const n=document.createElement("div");n.className="comment-actions",n.innerHTML=`\n      <button class="comment-action edit-comment" data-id="${e.id}">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>\n          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>\n        </svg>\n        Modifier\n      </button>\n      <button class="comment-action delete-comment" data-id="${e.id}">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <polyline points="3 6 5 6 21 6"></polyline>\n          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>\n        </svg>\n        Supprimer\n      </button>\n    `,t.appendChild(n)}return t}(e);t.appendChild(n)})):t.innerHTML='<p style="text-align: center; color: var(--text-gray); padding: 2rem;">Aucun commentaire pour le moment. Soyez le premier à commenter!</p>'}function f(e){const t=e.target.dataset.tab;document.querySelectorAll(".tab-btn").forEach((e=>{e.classList.toggle("active",e.dataset.tab===t)})),document.getElementById("synthese-tab").style.display="synthese"===t?"block":"none",document.getElementById("commentaires-tab").style.display="commentaires"===t?"block":"none",document.getElementById("sources-tab").style.display="sources"===t?"block":"none"}function y(){const e=document.querySelectorAll("#user-rating .star-btn");if(s)e.forEach(((e,t)=>{e.classList.toggle("selected",t<s),e.classList.remove("hovered"),e.setAttribute("data-star-type","full")}));else{const t=parseFloat(document.getElementById("average-rating").textContent);!isNaN(t)&&t>0?displayAverageRating(t):e.forEach((e=>{e.classList.remove("selected","hovered"),e.setAttribute("data-star-type","empty")}))}}async function h(e){const t=parseInt(e.target.dataset.rating);if(s!==t)try{const{data:e}=await o.N.from("ratings").select("id").eq("document_id",c.id).eq("user_id",i.id).single();e?await o.N.from("ratings").update({rating:t,updated_at:(new Date).toISOString()}).eq("id",e.id):await o.N.from("ratings").insert({document_id:c.id,user_id:i.id,rating:t}),s=t,await u()}catch(e){console.error("Error rating document:",e),alert("Erreur lors de l'enregistrement de votre note")}else try{const{error:e}=await o.N.from("ratings").delete().eq("document_id",c.id).eq("user_id",i.id);if(e)throw e;s=null,await u()}catch(e){console.error("Error removing rating:",e),alert("Erreur lors de la suppression de votre note")}}async function v(){try{console.log("PDF storage path:",c.pdf_storage_path);const e=c.pdf_storage_path.replace(/^\//,""),{data:t,error:n}=await o.N.storage.from("pdfs").createSignedUrl(e,60,{download:!0});if(n)throw console.error("URL Error details:",n),n;await o.N.from("downloads").insert({document_id:c.id,user_id:i.id});const r=document.createElement("a");r.href=t.signedUrl,r.download=`PLU_${c.zoning.city.name}_${c.zone.name}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(e){console.error("Error downloading document:",e),e.message&&e.message.includes("Object not found")?alert("Le fichier PDF n'a pas été trouvé. Veuillez contacter l'administrateur."):alert("Erreur lors du téléchargement")}}async function E(){const e=document.getElementById("comment-input").value.trim();if(e)try{const{error:t}=await o.N.from("comments").insert({document_id:c.id,user_id:i.id,content:e});if(t)throw t;document.getElementById("comment-input").value="",await g()}catch(e){console.error("Error submitting comment:",e),alert("Erreur lors de la publication du commentaire")}else alert("Veuillez entrer un commentaire")}function b(e){const t=e.target.closest(".edit-comment"),n=e.target.closest(".delete-comment");t?async function(e){d=e;const{data:t}=await o.N.from("comments").select("content").eq("id",e).single();document.getElementById("edit-comment-input").value=t.content,document.getElementById("edit-modal").style.display="flex"}(t.dataset.id):n&&async function(e){if(confirm("Êtes-vous sûr de vouloir supprimer ce commentaire?"))try{const{data:t,error:n}=await o.N.rpc("soft_delete_comment",{comment_id:e,user_id:i.id});if(n)throw n;alert("Commentaire supprimé. Il sera définitivement supprimé dans 30 jours. Contactez le support si vous souhaitez le récupérer."),await g()}catch(e){console.error("Error deleting comment:",e),alert("Erreur lors de la suppression")}}(n.dataset.id)}function w(){document.getElementById("edit-modal").style.display="none",d=null}async function _(){const e=document.getElementById("edit-comment-input").value.trim();if(e)try{await o.N.from("comments").update({content:e,updated_at:(new Date).toISOString()}).eq("id",d),w(),await g()}catch(e){console.error("Error updating comment:",e),alert("Erreur lors de la modification")}else alert("Le commentaire ne peut pas être vide")}async function I(){await o.N.auth.signOut(),window.location.href="/auth/login"}function L(e){document.getElementById("loading-state").style.display="none",document.getElementById("error-message").textContent=e,document.getElementById("error-state").style.display="flex"}document.addEventListener("DOMContentLoaded",(async()=>{try{if(!await(0,a.Kv)(!1))return;(0,r.Mt)();const{data:{user:e}}=await o.N.auth.getUser();if(!e)return void(window.location.href="/auth/login");i=e;const t=new URLSearchParams(window.location.search).get("id");if(!t)return void L("Aucun document spécifié");await async function(e){try{const{data:t,error:n}=await o.N.from("documents").select("\n          id,\n          zoning:zonings(name, city:cities(name)),\n          zone:zones(name),\n          html_content,\n          pdf_storage_path,\n          source_plu_date,\n          source_plu_url\n        ").eq("id",e).single();if(n)throw n;c=t,function(e){const t=(a=e.zoning.city.name)?a.replace(/\b\w/g,(e=>e.toUpperCase())):a,n=e.zone.name,o=e.source_plu_date?new Date(e.source_plu_date).toLocaleDateString("fr-FR",{year:"numeric",month:"long"}):"Date inconnue",r=document.getElementById("city-breadcrumb");var a;r.textContent=t,r.href=`/city?name=${encodeURIComponent(e.zoning.city.name)}`,document.getElementById("zone-breadcrumb").textContent=`Zone ${n}`,document.getElementById("document-title").textContent=`Synthèse du PLU de ${t} pour la zone ${n}`,document.getElementById("document-subtitle").textContent=`Basé sur le PLU de ${o}`}(t),document.getElementById("plu-content").innerHTML=t.html_content,await u(),await g(),t.source_plu_url&&(document.getElementById("source-plu-link").href=t.source_plu_url),document.getElementById("loading-state").style.display="none",document.getElementById("document-content").style.display="block"}catch(e){console.error("Error loading document:",e),L("Impossible de charger le document")}}(t),function(){document.querySelectorAll(".tab-btn").forEach((e=>{e.addEventListener("click",f)})),document.querySelectorAll("#user-rating .star-btn").forEach((e=>{e.addEventListener("click",h)})),document.querySelectorAll("#user-rating .star-btn").forEach(((e,t)=>{e.addEventListener("mouseenter",(()=>{return e=t+1,void document.querySelectorAll("#user-rating .star-btn").forEach(((t,n)=>{n<e?t.classList.add("hovered"):t.classList.remove("hovered")}));var e}))})),document.getElementById("user-rating").addEventListener("mouseleave",(()=>{y()})),document.getElementById("download-btn").addEventListener("click",v),document.getElementById("submit-comment").addEventListener("click",E),document.getElementById("comments-list").addEventListener("click",b),document.querySelector(".modal-close").addEventListener("click",w),document.getElementById("cancel-edit").addEventListener("click",w),document.getElementById("save-edit").addEventListener("click",_);const e=document.getElementById("logout-btn");e&&e.addEventListener("click",I)}(),function(){const e=document.getElementById("back-to-top");window.addEventListener("scroll",(()=>{window.scrollY>300?e.classList.add("visible"):e.classList.remove("visible")})),e.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})}))}()}catch(e){console.error("Error initializing PLU summary page:",e),L("Erreur lors de l'initialisation de la page")}}))}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e].call(n.exports,n,n.exports,c),n.exports}c.m=a,e=[],c.O=(t,n,o,r)=>{if(!n){var a=1/0;for(s=0;s<e.length;s++){for(var[n,o,r]=e[s],i=!0,d=0;d<n.length;d++)(!1&r||a>=r)&&Object.keys(c.O).every((e=>c.O[e](n[d])))?n.splice(d--,1):(i=!1,r<a&&(a=r));if(i){e.splice(s--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[n,o,r]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);c.r(r);var a={};t=t||[null,n({}),n([]),n(n)];for(var i=2&o&&e;"object"==typeof i&&!~t.indexOf(i);i=n(i))Object.getOwnPropertyNames(i).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,c.d(r,a),r},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,n)=>(c.f[n](e,t),t)),[])),c.u=e=>"js/"+e+".chunk.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},r="urbandocs_webapp:",c.l=(e,t,n,a)=>{if(o[e])o[e].push(t);else{var i,d;if(void 0!==n)for(var l=document.getElementsByTagName("script"),s=0;s<l.length;s++){var u=l[s];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+n){i=u;break}}i||(d=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,c.nc&&i.setAttribute("nonce",c.nc),i.setAttribute("data-webpack",r+n),i.src=e),o[e]=[t];var m=(t,n)=>{i.onerror=i.onload=null,clearTimeout(g);var r=o[e];if(delete o[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(n))),t)return t(n)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),d&&document.head.appendChild(i)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.j=628,c.p="/",(()=>{var e={628:0};c.f.j=(t,n)=>{var o=c.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var a=c.p+c.u(t),i=new Error;c.l(a,(n=>{if(c.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",i.name="ChunkLoadError",i.type=r,i.request=a,o[1](i)}}),"chunk-"+t,t)}},c.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[a,i,d]=n,l=0;if(a.some((t=>0!==e[t]))){for(o in i)c.o(i,o)&&(c.m[o]=i[o]);if(d)var s=d(c)}for(t&&t(n);l<a.length;l++)r=a[l],c.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return c.O(s)},n=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var d=c.O(void 0,[76],(()=>c(5852)));d=c.O(d)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFFL0QsR0FZSDFDLEVBQW9CUyxFQUFFUSxFQUFLeUIsR0FBMEMsSUFBN0J3QyxFQUFnQnhDLEdBR3hELElBQUlpRCxFQUF1QixDQUFDQyxFQUE0QnBSLEtBQ3ZELElBR0l5TCxFQUFVeUMsR0FIVC9CLEVBQVVrRixFQUFhQyxHQUFXdFIsRUFHaEIyQixFQUFJLEVBQzNCLEdBQUd3SyxFQUFTb0YsTUFBTWpSLEdBQWdDLElBQXhCb1EsRUFBZ0JwUSxLQUFhLENBQ3RELElBQUltTCxLQUFZNEYsRUFDWjdGLEVBQW9Cc0MsRUFBRXVELEVBQWE1RixLQUNyQ0QsRUFBb0JRLEVBQUVQLEdBQVk0RixFQUFZNUYsSUFHaEQsR0FBRzZGLEVBQVMsSUFBSXBGLEVBQVNvRixFQUFROUYsRUFDbEMsQ0FFQSxJQURHNEYsR0FBNEJBLEVBQTJCcFIsR0FDckQyQixFQUFJd0ssRUFBUzVMLE9BQVFvQixJQUN6QnVNLEVBQVUvQixFQUFTeEssR0FDaEI2SixFQUFvQnNDLEVBQUU0QyxFQUFpQnhDLElBQVl3QyxFQUFnQnhDLElBQ3JFd0MsRUFBZ0J4QyxHQUFTLEtBRTFCd0MsRUFBZ0J4QyxHQUFXLEVBRTVCLE9BQU8xQyxFQUFvQlMsRUFBRUMsSUFHMUJzRixFQUFxQkMsS0FBbUMsNkJBQUlBLEtBQW1DLDhCQUFLLEdBQ3hHRCxFQUFtQnRRLFFBQVFpUSxFQUFxQmYsS0FBSyxLQUFNLElBQzNEb0IsRUFBbUJ4QyxLQUFPbUMsRUFBcUJmLEtBQUssS0FBTW9CLEVBQW1CeEMsS0FBS29CLEtBQUtvQixHLEtDbEZ2RixJQUFJRSxFQUFzQmxHLEVBQW9CUyxPQUFFTixFQUFXLENBQUMsS0FBSyxJQUFPSCxFQUFvQixRQUM1RmtHLEVBQXNCbEcsRUFBb0JTLEVBQUV5RixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NyZWF0ZSBmYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9wbHUtc3VtbWFyeS5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9ydW50aW1lSWQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWZlcnJlZCA9IFtdO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5PID0gKHJlc3VsdCwgY2h1bmtJZHMsIGZuLCBwcmlvcml0eSkgPT4ge1xuXHRpZihjaHVua0lkcykge1xuXHRcdHByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcblx0XHRmb3IodmFyIGkgPSBkZWZlcnJlZC5sZW5ndGg7IGkgPiAwICYmIGRlZmVycmVkW2kgLSAxXVsyXSA+IHByaW9yaXR5OyBpLS0pIGRlZmVycmVkW2ldID0gZGVmZXJyZWRbaSAtIDFdO1xuXHRcdGRlZmVycmVkW2ldID0gW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldO1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgbm90RnVsZmlsbGVkID0gSW5maW5pdHk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWQubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldID0gZGVmZXJyZWRbaV07XG5cdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBjaHVua0lkcy5sZW5ndGg7IGorKykge1xuXHRcdFx0aWYgKChwcmlvcml0eSAmIDEgPT09IDAgfHwgbm90RnVsZmlsbGVkID49IHByaW9yaXR5KSAmJiBPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLk8pLmV2ZXJ5KChrZXkpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fLk9ba2V5XShjaHVua0lkc1tqXSkpKSkge1xuXHRcdFx0XHRjaHVua0lkcy5zcGxpY2Uoai0tLCAxKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZ1bGZpbGxlZCA9IGZhbHNlO1xuXHRcdFx0XHRpZihwcmlvcml0eSA8IG5vdEZ1bGZpbGxlZCkgbm90RnVsZmlsbGVkID0gcHJpb3JpdHk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWQuc3BsaWNlKGktLSwgMSlcblx0XHRcdHZhciByID0gZm4oKTtcblx0XHRcdGlmIChyICE9PSB1bmRlZmluZWQpIHJlc3VsdCA9IHI7XG5cdFx0fVxuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59OyIsInZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiA/IChvYmopID0+IChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkgOiAob2JqKSA9PiAob2JqLl9fcHJvdG9fXyk7XG52YXIgbGVhZlByb3RvdHlwZXM7XG4vLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3Rcbi8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuLy8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3Rcbi8vIG1vZGUgJiAxNjogcmV0dXJuIHZhbHVlIHdoZW4gaXQncyBQcm9taXNlLWxpa2Vcbi8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbl9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG5cdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IHRoaXModmFsdWUpO1xuXHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuXHRpZih0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlKSB7XG5cdFx0aWYoKG1vZGUgJiA0KSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG5cdFx0aWYoKG1vZGUgJiAxNikgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicpIHJldHVybiB2YWx1ZTtcblx0fVxuXHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuXHR2YXIgZGVmID0ge307XG5cdGxlYWZQcm90b3R5cGVzID0gbGVhZlByb3RvdHlwZXMgfHwgW251bGwsIGdldFByb3RvKHt9KSwgZ2V0UHJvdG8oW10pLCBnZXRQcm90byhnZXRQcm90byldO1xuXHRmb3IodmFyIGN1cnJlbnQgPSBtb2RlICYgMiAmJiB2YWx1ZTsgdHlwZW9mIGN1cnJlbnQgPT0gJ29iamVjdCcgJiYgIX5sZWFmUHJvdG90eXBlcy5pbmRleE9mKGN1cnJlbnQpOyBjdXJyZW50ID0gZ2V0UHJvdG8oY3VycmVudCkpIHtcblx0XHRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IChkZWZba2V5XSA9ICgpID0+ICh2YWx1ZVtrZXldKSkpO1xuXHR9XG5cdGRlZlsnZGVmYXVsdCddID0gKCkgPT4gKHZhbHVlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBkZWYpO1xuXHRyZXR1cm4gbnM7XG59OyIsInZhciBpblByb2dyZXNzID0ge307XG52YXIgZGF0YVdlYnBhY2tQcmVmaXggPSBcInVyYmFuZG9jc193ZWJhcHA6XCI7XG4vLyBsb2FkU2NyaXB0IGZ1bmN0aW9uIHRvIGxvYWQgYSBzY3JpcHQgdmlhIHNjcmlwdCB0YWdcbl9fd2VicGFja19yZXF1aXJlX18ubCA9ICh1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkgPT4ge1xuXHRpZihpblByb2dyZXNzW3VybF0pIHsgaW5Qcm9ncmVzc1t1cmxdLnB1c2goZG9uZSk7IHJldHVybjsgfVxuXHR2YXIgc2NyaXB0LCBuZWVkQXR0YWNoO1xuXHRpZihrZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBzID0gc2NyaXB0c1tpXTtcblx0XHRcdGlmKHMuZ2V0QXR0cmlidXRlKFwic3JjXCIpID09IHVybCB8fCBzLmdldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiKSA9PSBkYXRhV2VicGFja1ByZWZpeCArIGtleSkgeyBzY3JpcHQgPSBzOyBicmVhazsgfVxuXHRcdH1cblx0fVxuXHRpZighc2NyaXB0KSB7XG5cdFx0bmVlZEF0dGFjaCA9IHRydWU7XG5cdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cblx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG5cdFx0c2NyaXB0LnRpbWVvdXQgPSAxMjA7XG5cdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubmMpIHtcblx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcblx0XHR9XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiLCBkYXRhV2VicGFja1ByZWZpeCArIGtleSk7XG5cblx0XHRzY3JpcHQuc3JjID0gdXJsO1xuXHR9XG5cdGluUHJvZ3Jlc3NbdXJsXSA9IFtkb25lXTtcblx0dmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpID0+IHtcblx0XHQvLyBhdm9pZCBtZW0gbGVha3MgaW4gSUUuXG5cdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcblx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0dmFyIGRvbmVGbnMgPSBpblByb2dyZXNzW3VybF07XG5cdFx0ZGVsZXRlIGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRzY3JpcHQucGFyZW50Tm9kZSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdGRvbmVGbnMgJiYgZG9uZUZucy5mb3JFYWNoKChmbikgPT4gKGZuKGV2ZW50KSkpO1xuXHRcdGlmKHByZXYpIHJldHVybiBwcmV2KGV2ZW50KTtcblx0fVxuXHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQob25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHVuZGVmaW5lZCwgeyB0eXBlOiAndGltZW91dCcsIHRhcmdldDogc2NyaXB0IH0pLCAxMjAwMDApO1xuXHRzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG5cdHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG5cdG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xufTsiLCIvLyBzcmMvanMvcGx1LXN1bW1hcnkuanNcbi8qKlxuICogUExVIFN1bW1hcnkgLSBSZWRlc2lnbmVkXG4gKiBAbW9kdWxlIHBsdS1zdW1tYXJ5XG4gKiBAZGVzY3JpcHRpb24gVGhpcyBtb2R1bGUgaGFuZGxlcyB0aGUgUExVIHN1bW1hcnkgcGFnZSB3aXRoIG5ldyBkZXNpZ24uXG4gKiBAdmVyc2lvbiAwLjEuMFxuICogQGF1dGhvciBHcmV5UGFuZGFcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMS4wICgyMDI1LTAxLTI5KTogQ29tcGxldGUgcmVkZXNpZ24gd2l0aCBuZXcgdGFiIHN0cnVjdHVyZSBhbmQgc3R5bGluZ1xuICogLSAwLjAuMyAoMjAyNS0wMS0yNyk6IEFkZGVkIGhlYWRlciBhdXRoZW50aWNhdGlvbiBmb3IgZHluYW1pYyBoZWFkZXIgdXBkYXRlc1xuICogLSAwLjAuMiAoMjAyNS0wNS0yNyk6IFJld29yayBVSS5cbiAqIC0gMC4wLjEgKDIwMjUtMDUtMTYpOiBJbml0aWFsIHZlcnNpb24gd2l0aCBiYXNpYyBQTFUgc3VtbWFyeSBwYWdlLlxuICovXG5cbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5pbXBvcnQgeyBpbml0SGVhZGVyQXV0aCB9IGZyb20gXCIuL2F1dGgvaGVhZGVyLWF1dGguanNcIjtcbmltcG9ydCB7IGluaXREZWxldGlvbkd1YXJkIH0gZnJvbSBcIi4vYXV0aC9kZWxldGlvbi1ndWFyZC5qc1wiO1xuXG4vLyBHbG9iYWwgdmFyaWFibGVzXG5sZXQgY3VycmVudFVzZXIgPSBudWxsO1xubGV0IGN1cnJlbnREb2N1bWVudCA9IG51bGw7XG5sZXQgY3VycmVudENvbW1lbnRJZCA9IG51bGw7XG5sZXQgcmF0aW5nc0RhdGEgPSBbXTtcbmxldCB1c2VyQ3VycmVudFJhdGluZyA9IG51bGw7XG5cbi8vIEluaXRpYWxpemUgcGFnZVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgYXN5bmMgKCkgPT4ge1xuICB0cnkge1xuICAgIC8vIEluaXRpYWxpemUgZGVsZXRpb24gZ3VhcmQgZmlyc3QgKGJsb2NrcyBhY2Nlc3MgaWYgbmVlZGVkKVxuICAgIGNvbnN0IGNhbkFjY2VzcyA9IGF3YWl0IGluaXREZWxldGlvbkd1YXJkKGZhbHNlKTtcbiAgICBpZiAoIWNhbkFjY2Vzcykge1xuICAgICAgcmV0dXJuOyAvLyBBY2Nlc3Mgd2FzIGJsb2NrZWQsIHN0b3AgaW5pdGlhbGl6YXRpb25cbiAgICB9XG5cbiAgICAvLyBJbml0aWFsaXplIGhlYWRlciBhdXRoZW50aWNhdGlvblxuICAgIGluaXRIZWFkZXJBdXRoKCk7XG5cbiAgICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvYXV0aC9sb2dpblwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjdXJyZW50VXNlciA9IHVzZXI7XG5cbiAgICAvLyBHZXQgZG9jdW1lbnQgSUQgZnJvbSBVUkxcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IGRvY3VtZW50SWQgPSB1cmxQYXJhbXMuZ2V0KFwiaWRcIik7XG5cbiAgICBpZiAoIWRvY3VtZW50SWQpIHtcbiAgICAgIHNob3dFcnJvcihcIkF1Y3VuIGRvY3VtZW50IHNww6ljaWZpw6lcIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTG9hZCBkb2N1bWVudFxuICAgIGF3YWl0IGxvYWREb2N1bWVudChkb2N1bWVudElkKTtcblxuICAgIC8vIFNldHVwIGV2ZW50IGxpc3RlbmVyc1xuICAgIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIC8vIEluaXRpYWxpemUgYmFjayB0byB0b3AgZnVuY3Rpb25hbGl0eVxuICAgIGluaXRCYWNrVG9Ub3AoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW5pdGlhbGl6aW5nIFBMVSBzdW1tYXJ5IHBhZ2U6XCIsIGVycm9yKTtcbiAgICBzaG93RXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsJ2luaXRpYWxpc2F0aW9uIGRlIGxhIHBhZ2VcIik7XG4gIH1cbn0pO1xuXG4vLyBMb2FkIGRvY3VtZW50IGZyb20gU3VwYWJhc2VcbmFzeW5jIGZ1bmN0aW9uIGxvYWREb2N1bWVudChkb2N1bWVudElkKSB7XG4gIHRyeSB7XG4gICAgLy8gRmV0Y2ggZG9jdW1lbnQgd2l0aCByZWxhdGVkIGRhdGFcbiAgICBjb25zdCB7IGRhdGE6IGRvY3VtZW50RGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcImRvY3VtZW50c1wiKVxuICAgICAgLnNlbGVjdChcbiAgICAgICAgYFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIHpvbmluZzp6b25pbmdzKG5hbWUsIGNpdHk6Y2l0aWVzKG5hbWUpKSxcbiAgICAgICAgICB6b25lOnpvbmVzKG5hbWUpLFxuICAgICAgICAgIGh0bWxfY29udGVudCxcbiAgICAgICAgICBwZGZfc3RvcmFnZV9wYXRoLFxuICAgICAgICAgIHNvdXJjZV9wbHVfZGF0ZSxcbiAgICAgICAgICBzb3VyY2VfcGx1X3VybFxuICAgICAgICBgXG4gICAgICApXG4gICAgICAuZXEoXCJpZFwiLCBkb2N1bWVudElkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcblxuICAgIGN1cnJlbnREb2N1bWVudCA9IGRvY3VtZW50RGF0YTtcblxuICAgIC8vIFVwZGF0ZSBVSSB3aXRoIGRvY3VtZW50IGluZm9cbiAgICB1cGRhdGVEb2N1bWVudEluZm8oZG9jdW1lbnREYXRhKTtcblxuICAgIC8vIEluc2VydCBIVE1MIGNvbnRlbnRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsdS1jb250ZW50XCIpLmlubmVySFRNTCA9XG4gICAgICBkb2N1bWVudERhdGEuaHRtbF9jb250ZW50O1xuXG4gICAgLy8gTG9hZCByYXRpbmdzXG4gICAgYXdhaXQgbG9hZFJhdGluZ3MoKTtcblxuICAgIC8vIExvYWQgY29tbWVudHNcbiAgICBhd2FpdCBsb2FkQ29tbWVudHMoKTtcblxuICAgIC8vIFVwZGF0ZSBzb3VyY2UgbGlua1xuICAgIGlmIChkb2N1bWVudERhdGEuc291cmNlX3BsdV91cmwpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic291cmNlLXBsdS1saW5rXCIpLmhyZWYgPVxuICAgICAgICBkb2N1bWVudERhdGEuc291cmNlX3BsdV91cmw7XG4gICAgfVxuXG4gICAgLy8gSGlkZSBsb2FkaW5nLCBzaG93IGNvbnRlbnRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRpbmctc3RhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZG9jdW1lbnQtY29udGVudFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIGRvY3VtZW50OlwiLCBlcnJvcik7XG4gICAgc2hvd0Vycm9yKFwiSW1wb3NzaWJsZSBkZSBjaGFyZ2VyIGxlIGRvY3VtZW50XCIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNhcGl0YWxpemVXb3JkcyhzdHIpIHtcbiAgaWYgKCFzdHIpIHJldHVybiBzdHI7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXFxiXFx3L2csIChsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKTtcbn1cblxuLy8gVXBkYXRlIGRvY3VtZW50IGluZm9ybWF0aW9uIGluIFVJXG5mdW5jdGlvbiB1cGRhdGVEb2N1bWVudEluZm8oZG9jdW1lbnREYXRhKSB7XG4gIGNvbnN0IGNpdHlOYW1lID0gY2FwaXRhbGl6ZVdvcmRzKGRvY3VtZW50RGF0YS56b25pbmcuY2l0eS5uYW1lKTtcbiAgY29uc3Qgem9uZU5hbWUgPSBkb2N1bWVudERhdGEuem9uZS5uYW1lO1xuICBjb25zdCBzb3VyY2VQbHVEYXRlID0gZG9jdW1lbnREYXRhLnNvdXJjZV9wbHVfZGF0ZVxuICAgID8gbmV3IERhdGUoZG9jdW1lbnREYXRhLnNvdXJjZV9wbHVfZGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZnItRlJcIiwge1xuICAgICAgICB5ZWFyOiBcIm51bWVyaWNcIixcbiAgICAgICAgbW9udGg6IFwibG9uZ1wiLFxuICAgICAgfSlcbiAgICA6IFwiRGF0ZSBpbmNvbm51ZVwiO1xuXG4gIC8vIEJyZWFkY3J1bWJcbiAgY29uc3QgY2l0eUJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNpdHktYnJlYWRjcnVtYlwiKTtcbiAgY2l0eUJyZWFkY3J1bWIudGV4dENvbnRlbnQgPSBjaXR5TmFtZTtcbiAgY2l0eUJyZWFkY3J1bWIuaHJlZiA9IGAvY2l0eT9uYW1lPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgIGRvY3VtZW50RGF0YS56b25pbmcuY2l0eS5uYW1lXG4gICl9YDtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInpvbmUtYnJlYWRjcnVtYlwiKS50ZXh0Q29udGVudCA9IGBab25lICR7em9uZU5hbWV9YDtcblxuICAvLyBUaXRsZSBhbmQgc3VidGl0bGVcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgXCJkb2N1bWVudC10aXRsZVwiXG4gICkudGV4dENvbnRlbnQgPSBgU3ludGjDqHNlIGR1IFBMVSBkZSAke2NpdHlOYW1lfSBwb3VyIGxhIHpvbmUgJHt6b25lTmFtZX1gO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICBcImRvY3VtZW50LXN1YnRpdGxlXCJcbiAgKS50ZXh0Q29udGVudCA9IGBCYXPDqSBzdXIgbGUgUExVIGRlICR7c291cmNlUGx1RGF0ZX1gO1xufVxuXG4vLyBMb2FkIGFuZCBkaXNwbGF5IHJhdGluZ3NcbmFzeW5jIGZ1bmN0aW9uIGxvYWRSYXRpbmdzKCkge1xuICB0cnkge1xuICAgIC8vIEdldCBhbGwgcmF0aW5ncyBmb3IgdGhpcyBkb2N1bWVudFxuICAgIGNvbnN0IHsgZGF0YTogcmF0aW5ncywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcInJhdGluZ3NcIilcbiAgICAgIC5zZWxlY3QoXCJyYXRpbmcsIHVzZXJfaWRcIilcbiAgICAgIC5lcShcImRvY3VtZW50X2lkXCIsIGN1cnJlbnREb2N1bWVudC5pZCk7XG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuXG4gICAgcmF0aW5nc0RhdGEgPSByYXRpbmdzIHx8IFtdO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgYW5kIGRpc3RyaWJ1dGlvblxuICAgIGlmIChyYXRpbmdzRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBhdmVyYWdlID1cbiAgICAgICAgcmF0aW5nc0RhdGEucmVkdWNlKChzdW0sIHIpID0+IHN1bSArIHIucmF0aW5nLCAwKSAvIHJhdGluZ3NEYXRhLmxlbmd0aDtcblxuICAgICAgLy8gVXBkYXRlIGF2ZXJhZ2UgcmF0aW5nIGRpc3BsYXlcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZlcmFnZS1yYXRpbmdcIikudGV4dENvbnRlbnQgPVxuICAgICAgICBhdmVyYWdlLnRvRml4ZWQoMSk7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJhdGluZy1jb3VudFwiKS50ZXh0Q29udGVudCA9IHJhdGluZ3NEYXRhLmxlbmd0aDtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGRpc3RyaWJ1dGlvblxuICAgICAgY29uc3QgZGlzdHJpYnV0aW9uID0gY2FsY3VsYXRlUmF0aW5nRGlzdHJpYnV0aW9uKHJhdGluZ3NEYXRhKTtcbiAgICAgIHVwZGF0ZVJhdGluZ0JhcnMoZGlzdHJpYnV0aW9uKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgY3VycmVudCB1c2VyIGhhcyByYXRlZFxuICAgICAgY29uc3QgdXNlclJhdGluZyA9IHJhdGluZ3NEYXRhLmZpbmQoKHIpID0+IHIudXNlcl9pZCA9PT0gY3VycmVudFVzZXIuaWQpO1xuICAgICAgaWYgKHVzZXJSYXRpbmcpIHtcbiAgICAgICAgdXNlckN1cnJlbnRSYXRpbmcgPSB1c2VyUmF0aW5nLnJhdGluZztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVzZXJDdXJyZW50UmF0aW5nID0gbnVsbDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmVyYWdlLXJhdGluZ1wiKS50ZXh0Q29udGVudCA9IFwiMFwiO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyYXRpbmctY291bnRcIikudGV4dENvbnRlbnQgPSBcIjBcIjtcbiAgICAgIHVwZGF0ZVJhdGluZ0JhcnMoeyAxOiAwLCAyOiAwLCAzOiAwLCA0OiAwLCA1OiAwIH0pO1xuICAgICAgdXNlckN1cnJlbnRSYXRpbmcgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBzdGFycyBkaXNwbGF5XG4gICAgdXBkYXRlU3RhcnNEaXNwbGF5KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgcmF0aW5nczpcIiwgZXJyb3IpO1xuICB9XG59XG4vLyBDYWxjdWxhdGUgcmF0aW5nIGRpc3RyaWJ1dGlvblxuZnVuY3Rpb24gY2FsY3VsYXRlUmF0aW5nRGlzdHJpYnV0aW9uKHJhdGluZ3MpIHtcbiAgY29uc3QgZGlzdHJpYnV0aW9uID0geyAxOiAwLCAyOiAwLCAzOiAwLCA0OiAwLCA1OiAwIH07XG4gIHJhdGluZ3MuZm9yRWFjaCgocikgPT4ge1xuICAgIGRpc3RyaWJ1dGlvbltyLnJhdGluZ10rKztcbiAgfSk7XG4gIHJldHVybiBkaXN0cmlidXRpb247XG59XG5cbi8vIFVwZGF0ZSByYXRpbmcgYmFyc1xuZnVuY3Rpb24gdXBkYXRlUmF0aW5nQmFycyhkaXN0cmlidXRpb24pIHtcbiAgY29uc3QgdG90YWwgPSByYXRpbmdzRGF0YS5sZW5ndGggfHwgMTtcblxuICBmb3IgKGxldCBpID0gMTsgaSA8PSA1OyBpKyspIHtcbiAgICBjb25zdCBwZXJjZW50YWdlID0gKGRpc3RyaWJ1dGlvbltpXSAvIHRvdGFsKSAqIDEwMDtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgcmF0aW5nLSR7aX1gKS5zdHlsZS53aWR0aCA9IGAke3BlcmNlbnRhZ2V9JWA7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHJhdGluZy0ke2l9LXBlcmNlbnRgKS50ZXh0Q29udGVudCA9IGAke01hdGgucm91bmQoXG4gICAgICBwZXJjZW50YWdlXG4gICAgKX0lYDtcbiAgfVxufVxuXG4vLyBMb2FkIGNvbW1lbnRzXG5hc3luYyBmdW5jdGlvbiBsb2FkQ29tbWVudHMoKSB7XG4gIHRyeSB7XG4gICAgLy8gRmlyc3QsIGdldCB0aGUgY29tbWVudHNcbiAgICBjb25zdCB7IGRhdGE6IGNvbW1lbnRzLCBlcnJvcjogY29tbWVudHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwiY29tbWVudHNcIilcbiAgICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgICAuZXEoXCJkb2N1bWVudF9pZFwiLCBjdXJyZW50RG9jdW1lbnQuaWQpXG4gICAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGlmIChjb21tZW50c0Vycm9yKSB0aHJvdyBjb21tZW50c0Vycm9yO1xuXG4gICAgaWYgKGNvbW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmVuZGVyQ29tbWVudHMoW10pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB1bmlxdWUgdXNlciBJRHNcbiAgICBjb25zdCB1c2VySWRzID0gWy4uLm5ldyBTZXQoY29tbWVudHMubWFwKChjKSA9PiBjLnVzZXJfaWQpKV07XG5cbiAgICAvLyBGZXRjaCBwcm9maWxlcyBmb3IgdGhvc2UgdXNlcnNcbiAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGVzLCBlcnJvcjogcHJvZmlsZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwicHJvZmlsZXNcIilcbiAgICAgIC5zZWxlY3QoXCJpZCwgZnVsbF9uYW1lLCBhdmF0YXJfdXJsXCIpXG4gICAgICAuaW4oXCJpZFwiLCB1c2VySWRzKTtcblxuICAgIGlmIChwcm9maWxlc0Vycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgZmV0Y2ggcHJvZmlsZXM6XCIsIHByb2ZpbGVzRXJyb3IpO1xuICAgICAgY29uc3QgY29tbWVudHNXaXRob3V0UHJvZmlsZXMgPSBjb21tZW50cy5tYXAoKGNvbW1lbnQpID0+ICh7XG4gICAgICAgIC4uLmNvbW1lbnQsXG4gICAgICAgIHByb2ZpbGVzOiBudWxsLFxuICAgICAgfSkpO1xuICAgICAgcmVuZGVyQ29tbWVudHMoY29tbWVudHNXaXRob3V0UHJvZmlsZXMpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE1hcCBwcm9maWxlcyB0byBjb21tZW50c1xuICAgIGNvbnN0IHByb2ZpbGVzTWFwID0gcHJvZmlsZXMucmVkdWNlKChhY2MsIHByb2ZpbGUpID0+IHtcbiAgICAgIGFjY1twcm9maWxlLmlkXSA9IHByb2ZpbGU7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcblxuICAgIC8vIEF0dGFjaCBwcm9maWxlcyB0byBjb21tZW50c1xuICAgIGNvbnN0IGNvbW1lbnRzV2l0aFByb2ZpbGVzID0gY29tbWVudHMubWFwKChjb21tZW50KSA9PiAoe1xuICAgICAgLi4uY29tbWVudCxcbiAgICAgIHByb2ZpbGVzOiBwcm9maWxlc01hcFtjb21tZW50LnVzZXJfaWRdIHx8IG51bGwsXG4gICAgfSkpO1xuXG4gICAgLy8gUmVuZGVyIGNvbW1lbnRzXG4gICAgcmVuZGVyQ29tbWVudHMoY29tbWVudHNXaXRoUHJvZmlsZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIGNvbW1lbnRzOlwiLCBlcnJvcik7XG4gICAgcmVuZGVyQ29tbWVudHMoW10pO1xuICB9XG59XG5cbi8vIFJlbmRlciBjb21tZW50cyBpbiBVSVxuZnVuY3Rpb24gcmVuZGVyQ29tbWVudHMoY29tbWVudHMpIHtcbiAgY29uc3QgY29tbWVudHNMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50cy1saXN0XCIpO1xuICBjb21tZW50c0xpc3QuaW5uZXJIVE1MID0gXCJcIjtcblxuICBpZiAoY29tbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgY29tbWVudHNMaXN0LmlubmVySFRNTCA9XG4gICAgICAnPHAgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOiB2YXIoLS10ZXh0LWdyYXkpOyBwYWRkaW5nOiAycmVtO1wiPkF1Y3VuIGNvbW1lbnRhaXJlIHBvdXIgbGUgbW9tZW50LiBTb3lleiBsZSBwcmVtaWVyIMOgIGNvbW1lbnRlciE8L3A+JztcbiAgICByZXR1cm47XG4gIH1cblxuICBjb21tZW50cy5mb3JFYWNoKChjb21tZW50KSA9PiB7XG4gICAgY29uc3QgY29tbWVudEVsID0gY3JlYXRlQ29tbWVudEVsZW1lbnQoY29tbWVudCk7XG4gICAgY29tbWVudHNMaXN0LmFwcGVuZENoaWxkKGNvbW1lbnRFbCk7XG4gIH0pO1xufVxuXG4vLyBDcmVhdGUgY29tbWVudCBlbGVtZW50XG5mdW5jdGlvbiBjcmVhdGVDb21tZW50RWxlbWVudChjb21tZW50KSB7XG4gIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGRpdi5jbGFzc05hbWUgPSBcImNvbW1lbnRcIjtcbiAgZGl2LmRhdGFzZXQuY29tbWVudElkID0gY29tbWVudC5pZDtcblxuICBjb25zdCBpc093bmVyID0gY29tbWVudC51c2VyX2lkID09PSBjdXJyZW50VXNlci5pZDtcbiAgY29uc3QgdXNlck5hbWUgPSBjb21tZW50LnByb2ZpbGVzPy5mdWxsX25hbWUgfHwgXCJVdGlsaXNhdGV1ciBhbm9ueW1lXCI7XG4gIGNvbnN0IGF2YXRhclVybCA9XG4gICAgY29tbWVudC5wcm9maWxlcz8uYXZhdGFyX3VybCB8fCBcImFzc2V0cy9pY29ucy9kZWZhdWx0LWF2YXRhci5zdmdcIjtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGNvbW1lbnQuY3JlYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZnItRlJcIiwge1xuICAgIGRheTogXCJudW1lcmljXCIsXG4gICAgbW9udGg6IFwibG9uZ1wiLFxuICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICB9KTtcblxuICBjb25zdCBjb21tZW50SGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29tbWVudEhlYWRlci5jbGFzc05hbWUgPSBcImNvbW1lbnQtaGVhZGVyXCI7XG5cbiAgLy8gQXZhdGFyIGFuZCBtZXRhXG4gIGNvbnN0IGF2YXRhck1ldGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBhdmF0YXJNZXRhLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbiAgYXZhdGFyTWV0YS5zdHlsZS5hbGlnbkl0ZW1zID0gXCJjZW50ZXJcIjtcbiAgYXZhdGFyTWV0YS5zdHlsZS5nYXAgPSBcIjFyZW1cIjtcbiAgYXZhdGFyTWV0YS5pbm5lckhUTUwgPSBgXG4gICAgPGltZyBzcmM9XCIke2F2YXRhclVybH1cIiBhbHQ9XCIke3VzZXJOYW1lfVwiIGNsYXNzPVwiY29tbWVudC1hdmF0YXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY29tbWVudC1tZXRhXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudC1hdXRob3JcIj4ke3VzZXJOYW1lfTwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImNvbW1lbnQtZGF0ZVwiPiR7ZGF0ZX0ke1xuICAgIGNvbW1lbnQudXBkYXRlZF9hdCAhPT0gY29tbWVudC5jcmVhdGVkX2F0ID8gXCIgKG1vZGlmacOpKVwiIDogXCJcIlxuICB9PC9kaXY+XG4gICAgPC9kaXY+XG4gIGA7XG4gIGNvbW1lbnRIZWFkZXIuYXBwZW5kQ2hpbGQoYXZhdGFyTWV0YSk7XG5cbiAgZGl2LmFwcGVuZENoaWxkKGNvbW1lbnRIZWFkZXIpO1xuXG4gIC8vIENvbW1lbnQgY29udGVudFxuICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29udGVudC5jbGFzc05hbWUgPSBcImNvbW1lbnQtY29udGVudFwiO1xuICBjb250ZW50LnRleHRDb250ZW50ID0gY29tbWVudC5jb250ZW50O1xuICBkaXYuYXBwZW5kQ2hpbGQoY29udGVudCk7XG5cbiAgLy8gQWN0aW9ucyBmb3Igb3duZXJcbiAgaWYgKGlzT3duZXIpIHtcbiAgICBjb25zdCBhY3Rpb25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBhY3Rpb25zLmNsYXNzTmFtZSA9IFwiY29tbWVudC1hY3Rpb25zXCI7XG4gICAgYWN0aW9ucy5pbm5lckhUTUwgPSBgXG4gICAgICA8YnV0dG9uIGNsYXNzPVwiY29tbWVudC1hY3Rpb24gZWRpdC1jb21tZW50XCIgZGF0YS1pZD1cIiR7Y29tbWVudC5pZH1cIj5cbiAgICAgICAgPHN2ZyB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCI+XG4gICAgICAgICAgPHBhdGggZD1cIk0xMSA0SDRhMiAyIDAgMCAwLTIgMnYxNGEyIDIgMCAwIDAgMiAyaDE0YTIgMiAwIDAgMCAyLTJ2LTdcIj48L3BhdGg+XG4gICAgICAgICAgPHBhdGggZD1cIk0xOC41IDIuNWEyLjEyMSAyLjEyMSAwIDAgMSAzIDNMMTIgMTVsLTQgMSAxLTQgOS41LTkuNXpcIj48L3BhdGg+XG4gICAgICAgIDwvc3ZnPlxuICAgICAgICBNb2RpZmllclxuICAgICAgPC9idXR0b24+XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiY29tbWVudC1hY3Rpb24gZGVsZXRlLWNvbW1lbnRcIiBkYXRhLWlkPVwiJHtjb21tZW50LmlkfVwiPlxuICAgICAgICA8c3ZnIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIj5cbiAgICAgICAgICA8cG9seWxpbmUgcG9pbnRzPVwiMyA2IDUgNiAyMSA2XCI+PC9wb2x5bGluZT5cbiAgICAgICAgICA8cGF0aCBkPVwiTTE5IDZ2MTRhMiAyIDAgMCAxLTIgMkg3YTIgMiAwIDAgMS0yLTJWNm0zIDBWNGEyIDIgMCAwIDEgMi0yaDRhMiAyIDAgMCAxIDIgMnYyXCI+PC9wYXRoPlxuICAgICAgICA8L3N2Zz5cbiAgICAgICAgU3VwcHJpbWVyXG4gICAgICA8L2J1dHRvbj5cbiAgICBgO1xuICAgIGRpdi5hcHBlbmRDaGlsZChhY3Rpb25zKTtcbiAgfVxuXG4gIHJldHVybiBkaXY7XG59XG5cbi8vIFNldHVwIGV2ZW50IGxpc3RlbmVyc1xuZnVuY3Rpb24gc2V0dXBFdmVudExpc3RlbmVycygpIHtcbiAgLy8gVGFiIHN3aXRjaGluZ1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRhYi1idG5cIikuZm9yRWFjaCgoYnRuKSA9PiB7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzd2l0Y2hUYWIpO1xuICB9KTtcblxuICAvLyBSYXRpbmcgc3RhcnMgY2xpY2tcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiN1c2VyLXJhdGluZyAuc3Rhci1idG5cIikuZm9yRWFjaCgoc3RhcikgPT4ge1xuICAgIHN0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZVJhdGluZyk7XG4gIH0pO1xuXG4gIC8vIFJhdGluZyBzdGFycyBob3ZlclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI3VzZXItcmF0aW5nIC5zdGFyLWJ0blwiKS5mb3JFYWNoKChzdGFyLCBpbmRleCkgPT4ge1xuICAgIHN0YXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKCkgPT4gaGFuZGxlU3RhckhvdmVyKGluZGV4ICsgMSkpO1xuICB9KTtcblxuICAvLyBSZXNldCBzdGFycyBvbiBtb3VzZSBsZWF2ZVxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXItcmF0aW5nXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtcbiAgICB1cGRhdGVTdGFyc0Rpc3BsYXkoKTtcbiAgfSk7XG5cbiAgLy8gRG93bmxvYWQgYnV0dG9uXG4gIGRvY3VtZW50XG4gICAgLmdldEVsZW1lbnRCeUlkKFwiZG93bmxvYWQtYnRuXCIpXG4gICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVEb3dubG9hZCk7XG5cbiAgLy8gQ29tbWVudCBzdWJtaXNzaW9uXG4gIGRvY3VtZW50XG4gICAgLmdldEVsZW1lbnRCeUlkKFwic3VibWl0LWNvbW1lbnRcIilcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHN1Ym1pdENvbW1lbnQpO1xuXG4gIC8vIENvbW1lbnQgYWN0aW9ucyAoZGVsZWdhdGlvbilcbiAgZG9jdW1lbnRcbiAgICAuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50cy1saXN0XCIpXG4gICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDb21tZW50QWN0aW9uKTtcblxuICAvLyBNb2RhbCBldmVudHNcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1jbG9zZVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VNb2RhbCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsLWVkaXRcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlTW9kYWwpO1xuICBkb2N1bWVudFxuICAgIC5nZXRFbGVtZW50QnlJZChcInNhdmUtZWRpdFwiKVxuICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2F2ZUNvbW1lbnRFZGl0KTtcblxuICAvLyBMb2dvdXRcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXQtYnRuXCIpO1xuICBpZiAobG9nb3V0QnRuKSB7XG4gICAgbG9nb3V0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVMb2dvdXQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVN0YXJIb3ZlcihyYXRpbmcpIHtcbiAgY29uc3Qgc3RhcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI3VzZXItcmF0aW5nIC5zdGFyLWJ0blwiKTtcbiAgc3RhcnMuZm9yRWFjaCgoc3RhciwgaW5kZXgpID0+IHtcbiAgICBpZiAoaW5kZXggPCByYXRpbmcpIHtcbiAgICAgIHN0YXIuY2xhc3NMaXN0LmFkZChcImhvdmVyZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXIuY2xhc3NMaXN0LnJlbW92ZShcImhvdmVyZWRcIik7XG4gICAgfVxuICB9KTtcbn1cbi8vIEluaXRpYWxpemUgYmFjayB0byB0b3AgZnVuY3Rpb25hbGl0eVxuZnVuY3Rpb24gaW5pdEJhY2tUb1RvcCgpIHtcbiAgY29uc3QgYmFja1RvVG9wQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrLXRvLXRvcFwiKTtcblxuICAvLyBTaG93L2hpZGUgYnV0dG9uIGJhc2VkIG9uIHNjcm9sbCBwb3NpdGlvblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoKSA9PiB7XG4gICAgaWYgKHdpbmRvdy5zY3JvbGxZID4gMzAwKSB7XG4gICAgICBiYWNrVG9Ub3BCdG4uY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJhY2tUb1RvcEJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIFNtb290aCBzY3JvbGwgdG8gdG9wXG4gIGJhY2tUb1RvcEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHdpbmRvdy5zY3JvbGxUbyh7XG4gICAgICB0b3A6IDAsXG4gICAgICBiZWhhdmlvcjogXCJzbW9vdGhcIixcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8vIFN3aXRjaCB0YWJzXG5mdW5jdGlvbiBzd2l0Y2hUYWIoZSkge1xuICBjb25zdCB0YXJnZXRUYWIgPSBlLnRhcmdldC5kYXRhc2V0LnRhYjtcblxuICAvLyBVcGRhdGUgYWN0aXZlIHN0YXRlc1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRhYi1idG5cIikuZm9yRWFjaCgoYnRuKSA9PiB7XG4gICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIiwgYnRuLmRhdGFzZXQudGFiID09PSB0YXJnZXRUYWIpO1xuICB9KTtcblxuICAvLyBTaG93L2hpZGUgY29udGVudFxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN5bnRoZXNlLXRhYlwiKS5zdHlsZS5kaXNwbGF5ID1cbiAgICB0YXJnZXRUYWIgPT09IFwic3ludGhlc2VcIiA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbW1lbnRhaXJlcy10YWJcIikuc3R5bGUuZGlzcGxheSA9XG4gICAgdGFyZ2V0VGFiID09PSBcImNvbW1lbnRhaXJlc1wiID8gXCJibG9ja1wiIDogXCJub25lXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic291cmNlcy10YWJcIikuc3R5bGUuZGlzcGxheSA9XG4gICAgdGFyZ2V0VGFiID09PSBcInNvdXJjZXNcIiA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVTdGFyc0Rpc3BsYXkoKSB7XG4gIGNvbnN0IHN0YXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiN1c2VyLXJhdGluZyAuc3Rhci1idG5cIik7XG5cbiAgLy8gSWYgdXNlciBoYXMgYSByYXRpbmcsIHNob3cgaXRcbiAgaWYgKHVzZXJDdXJyZW50UmF0aW5nKSB7XG4gICAgc3RhcnMuZm9yRWFjaCgoc3RhciwgaW5kZXgpID0+IHtcbiAgICAgIHN0YXIuY2xhc3NMaXN0LnRvZ2dsZShcInNlbGVjdGVkXCIsIGluZGV4IDwgdXNlckN1cnJlbnRSYXRpbmcpO1xuICAgICAgc3Rhci5jbGFzc0xpc3QucmVtb3ZlKFwiaG92ZXJlZFwiKTtcbiAgICAgIHN0YXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zdGFyLXR5cGVcIiwgXCJmdWxsXCIpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIFNob3cgYXZlcmFnZSByYXRpbmcgd2l0aCBoYWxmIHN0YXJzXG4gICAgY29uc3QgYXZnUmF0aW5nID0gcGFyc2VGbG9hdChcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZlcmFnZS1yYXRpbmdcIikudGV4dENvbnRlbnRcbiAgICApO1xuICAgIGlmICghaXNOYU4oYXZnUmF0aW5nKSAmJiBhdmdSYXRpbmcgPiAwKSB7XG4gICAgICBkaXNwbGF5QXZlcmFnZVJhdGluZyhhdmdSYXRpbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBObyByYXRpbmdzIGF0IGFsbCwgc2hvdyBlbXB0eSBzdGFyc1xuICAgICAgc3RhcnMuZm9yRWFjaCgoc3RhcikgPT4ge1xuICAgICAgICBzdGFyLmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3RlZFwiLCBcImhvdmVyZWRcIik7XG4gICAgICAgIHN0YXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zdGFyLXR5cGVcIiwgXCJlbXB0eVwiKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG4vLyBIYW5kbGUgcmF0aW5nXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSYXRpbmcoZSkge1xuICBjb25zdCByYXRpbmcgPSBwYXJzZUludChlLnRhcmdldC5kYXRhc2V0LnJhdGluZyk7XG5cbiAgLy8gSWYgY2xpY2tpbmcgb24gdGhlIHNhbWUgcmF0aW5nLCByZW1vdmUgaXRcbiAgaWYgKHVzZXJDdXJyZW50UmF0aW5nID09PSByYXRpbmcpIHtcbiAgICB0cnkge1xuICAgICAgLy8gRGVsZXRlIHRoZSByYXRpbmdcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKFwicmF0aW5nc1wiKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKFwiZG9jdW1lbnRfaWRcIiwgY3VycmVudERvY3VtZW50LmlkKVxuICAgICAgICAuZXEoXCJ1c2VyX2lkXCIsIGN1cnJlbnRVc2VyLmlkKTtcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcblxuICAgICAgdXNlckN1cnJlbnRSYXRpbmcgPSBudWxsO1xuXG4gICAgICAvLyBSZWxvYWQgcmF0aW5ncyB0byB1cGRhdGUgYXZlcmFnZVxuICAgICAgYXdhaXQgbG9hZFJhdGluZ3MoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlbW92aW5nIHJhdGluZzpcIiwgZXJyb3IpO1xuICAgICAgYWxlcnQoXCJFcnJldXIgbG9ycyBkZSBsYSBzdXBwcmVzc2lvbiBkZSB2b3RyZSBub3RlXCIpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBPdGhlcndpc2UsIHNldC91cGRhdGUgdGhlIHJhdGluZ1xuICB0cnkge1xuICAgIC8vIENoZWNrIGlmIHVzZXIgYWxyZWFkeSByYXRlZFxuICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmcgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcInJhdGluZ3NcIilcbiAgICAgIC5zZWxlY3QoXCJpZFwiKVxuICAgICAgLmVxKFwiZG9jdW1lbnRfaWRcIiwgY3VycmVudERvY3VtZW50LmlkKVxuICAgICAgLmVxKFwidXNlcl9pZFwiLCBjdXJyZW50VXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChleGlzdGluZykge1xuICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIHJhdGluZ1xuICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oXCJyYXRpbmdzXCIpXG4gICAgICAgIC51cGRhdGUoeyByYXRpbmcsIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KVxuICAgICAgICAuZXEoXCJpZFwiLCBleGlzdGluZy5pZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEluc2VydCBuZXcgcmF0aW5nXG4gICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKFwicmF0aW5nc1wiKS5pbnNlcnQoe1xuICAgICAgICBkb2N1bWVudF9pZDogY3VycmVudERvY3VtZW50LmlkLFxuICAgICAgICB1c2VyX2lkOiBjdXJyZW50VXNlci5pZCxcbiAgICAgICAgcmF0aW5nLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdXNlckN1cnJlbnRSYXRpbmcgPSByYXRpbmc7XG5cbiAgICAvLyBSZWxvYWQgcmF0aW5ncyB0byB1cGRhdGUgYXZlcmFnZVxuICAgIGF3YWl0IGxvYWRSYXRpbmdzKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJhdGluZyBkb2N1bWVudDpcIiwgZXJyb3IpO1xuICAgIGFsZXJ0KFwiRXJyZXVyIGxvcnMgZGUgbCdlbnJlZ2lzdHJlbWVudCBkZSB2b3RyZSBub3RlXCIpO1xuICB9XG59XG5cbi8vIEhhbmRsZSBkb3dubG9hZFxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlRG93bmxvYWQoKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJQREYgc3RvcmFnZSBwYXRoOlwiLCBjdXJyZW50RG9jdW1lbnQucGRmX3N0b3JhZ2VfcGF0aCk7XG5cbiAgICAvLyBSZW1vdmUgYW55IGxlYWRpbmcgc2xhc2hlcyBpZiBwcmVzZW50XG4gICAgY29uc3QgY2xlYW5QYXRoID0gY3VycmVudERvY3VtZW50LnBkZl9zdG9yYWdlX3BhdGgucmVwbGFjZSgvXlxcLy8sIFwiXCIpO1xuXG4gICAgLy8gR2V0IGRvd25sb2FkIFVSTCBmcm9tIFN1cGFiYXNlIFN0b3JhZ2Ugd2l0aCBkb3dubG9hZCBwYXJhbWV0ZXJcbiAgICBjb25zdCB7IGRhdGE6IHVybERhdGEsIGVycm9yOiB1cmxFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2Uuc3RvcmFnZVxuICAgICAgLmZyb20oXCJwZGZzXCIpXG4gICAgICAuY3JlYXRlU2lnbmVkVXJsKGNsZWFuUGF0aCwgNjAsIHtcbiAgICAgICAgZG93bmxvYWQ6IHRydWUsIC8vIFRoaXMgZm9yY2VzIHRoZSBkb3dubG9hZCBiZWhhdmlvclxuICAgICAgfSk7XG5cbiAgICBpZiAodXJsRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJVUkwgRXJyb3IgZGV0YWlsczpcIiwgdXJsRXJyb3IpO1xuICAgICAgdGhyb3cgdXJsRXJyb3I7XG4gICAgfVxuXG4gICAgLy8gVHJhY2sgZG93bmxvYWRcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKFwiZG93bmxvYWRzXCIpLmluc2VydCh7XG4gICAgICBkb2N1bWVudF9pZDogY3VycmVudERvY3VtZW50LmlkLFxuICAgICAgdXNlcl9pZDogY3VycmVudFVzZXIuaWQsXG4gICAgfSk7XG5cbiAgICAvLyBUcmlnZ2VyIGRvd25sb2FkXG4gICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgIGEuaHJlZiA9IHVybERhdGEuc2lnbmVkVXJsO1xuICAgIGEuZG93bmxvYWQgPSBgUExVXyR7Y3VycmVudERvY3VtZW50LnpvbmluZy5jaXR5Lm5hbWV9XyR7Y3VycmVudERvY3VtZW50LnpvbmUubmFtZX0ucGRmYDtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOyAvLyBBZGQgdG8gRE9NXG4gICAgYS5jbGljaygpO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7IC8vIFJlbW92ZSBmcm9tIERPTVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkb3dubG9hZGluZyBkb2N1bWVudDpcIiwgZXJyb3IpO1xuXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcIk9iamVjdCBub3QgZm91bmRcIikpIHtcbiAgICAgIGFsZXJ0KFxuICAgICAgICBcIkxlIGZpY2hpZXIgUERGIG4nYSBwYXMgw6l0w6kgdHJvdXbDqS4gVmV1aWxsZXogY29udGFjdGVyIGwnYWRtaW5pc3RyYXRldXIuXCJcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KFwiRXJyZXVyIGxvcnMgZHUgdMOpbMOpY2hhcmdlbWVudFwiKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gU3VibWl0IGNvbW1lbnRcbmFzeW5jIGZ1bmN0aW9uIHN1Ym1pdENvbW1lbnQoKSB7XG4gIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbW1lbnQtaW5wdXRcIikudmFsdWUudHJpbSgpO1xuXG4gIGlmICghY29udGVudCkge1xuICAgIGFsZXJ0KFwiVmV1aWxsZXogZW50cmVyIHVuIGNvbW1lbnRhaXJlXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcImNvbW1lbnRzXCIpLmluc2VydCh7XG4gICAgICBkb2N1bWVudF9pZDogY3VycmVudERvY3VtZW50LmlkLFxuICAgICAgdXNlcl9pZDogY3VycmVudFVzZXIuaWQsXG4gICAgICBjb250ZW50LFxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcblxuICAgIC8vIENsZWFyIGlucHV0XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50LWlucHV0XCIpLnZhbHVlID0gXCJcIjtcblxuICAgIC8vIFJlbG9hZCBjb21tZW50c1xuICAgIGF3YWl0IGxvYWRDb21tZW50cygpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzdWJtaXR0aW5nIGNvbW1lbnQ6XCIsIGVycm9yKTtcbiAgICBhbGVydChcIkVycmV1ciBsb3JzIGRlIGxhIHB1YmxpY2F0aW9uIGR1IGNvbW1lbnRhaXJlXCIpO1xuICB9XG59XG5cbi8vIEhhbmRsZSBjb21tZW50IGFjdGlvbnNcbmZ1bmN0aW9uIGhhbmRsZUNvbW1lbnRBY3Rpb24oZSkge1xuICBjb25zdCBlZGl0QnRuID0gZS50YXJnZXQuY2xvc2VzdChcIi5lZGl0LWNvbW1lbnRcIik7XG4gIGNvbnN0IGRlbGV0ZUJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuZGVsZXRlLWNvbW1lbnRcIik7XG5cbiAgaWYgKGVkaXRCdG4pIHtcbiAgICBvcGVuRWRpdE1vZGFsKGVkaXRCdG4uZGF0YXNldC5pZCk7XG4gIH0gZWxzZSBpZiAoZGVsZXRlQnRuKSB7XG4gICAgZGVsZXRlQ29tbWVudChkZWxldGVCdG4uZGF0YXNldC5pZCk7XG4gIH1cbn1cblxuLy8gT3BlbiBlZGl0IG1vZGFsXG5hc3luYyBmdW5jdGlvbiBvcGVuRWRpdE1vZGFsKGNvbW1lbnRJZCkge1xuICBjdXJyZW50Q29tbWVudElkID0gY29tbWVudElkO1xuXG4gIC8vIEdldCBjb21tZW50IGNvbnRlbnRcbiAgY29uc3QgeyBkYXRhOiBjb21tZW50IH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiY29tbWVudHNcIilcbiAgICAuc2VsZWN0KFwiY29udGVudFwiKVxuICAgIC5lcShcImlkXCIsIGNvbW1lbnRJZClcbiAgICAuc2luZ2xlKCk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWNvbW1lbnQtaW5wdXRcIikudmFsdWUgPSBjb21tZW50LmNvbnRlbnQ7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1tb2RhbFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG59XG5cbi8vIENsb3NlIG1vZGFsXG5mdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtbW9kYWxcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBjdXJyZW50Q29tbWVudElkID0gbnVsbDtcbn1cblxuLy8gU2F2ZSBjb21tZW50IGVkaXRcbmFzeW5jIGZ1bmN0aW9uIHNhdmVDb21tZW50RWRpdCgpIHtcbiAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1jb21tZW50LWlucHV0XCIpLnZhbHVlLnRyaW0oKTtcblxuICBpZiAoIWNvbnRlbnQpIHtcbiAgICBhbGVydChcIkxlIGNvbW1lbnRhaXJlIG5lIHBldXQgcGFzIMOqdHJlIHZpZGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJjb21tZW50c1wiKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH0pXG4gICAgICAuZXEoXCJpZFwiLCBjdXJyZW50Q29tbWVudElkKTtcblxuICAgIGNsb3NlTW9kYWwoKTtcbiAgICBhd2FpdCBsb2FkQ29tbWVudHMoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgY29tbWVudDpcIiwgZXJyb3IpO1xuICAgIGFsZXJ0KFwiRXJyZXVyIGxvcnMgZGUgbGEgbW9kaWZpY2F0aW9uXCIpO1xuICB9XG59XG5cbi8vIERlbGV0ZSBjb21tZW50XG5hc3luYyBmdW5jdGlvbiBkZWxldGVDb21tZW50KGNvbW1lbnRJZCkge1xuICBpZiAoIWNvbmZpcm0oXCLDinRlcy12b3VzIHPDu3IgZGUgdm91bG9pciBzdXBwcmltZXIgY2UgY29tbWVudGFpcmU/XCIpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBVc2UgdGhlIHNvZnQgZGVsZXRlIGZ1bmN0aW9uIGluc3RlYWQgb2YgZGlyZWN0IGRlbGV0aW9uXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFwic29mdF9kZWxldGVfY29tbWVudFwiLCB7XG4gICAgICBjb21tZW50X2lkOiBjb21tZW50SWQsXG4gICAgICB1c2VyX2lkOiBjdXJyZW50VXNlci5pZCxcbiAgICB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgLy8gU2hvdyBzdWNjZXNzIG1lc3NhZ2Ugd2l0aCBpbmZvcm1hdGlvbiBhYm91dCByZWNvdmVyeSBwZXJpb2RcbiAgICBhbGVydChcbiAgICAgIFwiQ29tbWVudGFpcmUgc3VwcHJpbcOpLiBJbCBzZXJhIGTDqWZpbml0aXZlbWVudCBzdXBwcmltw6kgZGFucyAzMCBqb3Vycy4gQ29udGFjdGV6IGxlIHN1cHBvcnQgc2kgdm91cyBzb3VoYWl0ZXogbGUgcsOpY3Vww6lyZXIuXCJcbiAgICApO1xuXG4gICAgYXdhaXQgbG9hZENvbW1lbnRzKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNvbW1lbnQ6XCIsIGVycm9yKTtcbiAgICBhbGVydChcIkVycmV1ciBsb3JzIGRlIGxhIHN1cHByZXNzaW9uXCIpO1xuICB9XG59XG5cbi8vIEhhbmRsZSBsb2dvdXRcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUxvZ291dCgpIHtcbiAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG4gIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvYXV0aC9sb2dpblwiO1xufVxuXG4vLyBTaG93IGVycm9yIHN0YXRlXG5mdW5jdGlvbiBzaG93RXJyb3IobWVzc2FnZSkge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRpbmctc3RhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycm9yLW1lc3NhZ2VcIikudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycm9yLXN0YXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbn1cblxuLy8gVXRpbGl0eSBmdW5jdGlvbiB0byBlc2NhcGUgSFRNTFxuZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7XG4gIGNvbnN0IG1hcCA9IHtcbiAgICBcIiZcIjogXCImYW1wO1wiLFxuICAgIFwiPFwiOiBcIiZsdDtcIixcbiAgICBcIj5cIjogXCImZ3Q7XCIsXG4gICAgJ1wiJzogXCImcXVvdDtcIixcbiAgICBcIidcIjogXCImIzAzOTtcIixcbiAgfTtcbiAgcmV0dXJuIHRleHQucmVwbGFjZSgvWyY8PlwiJ10vZywgKG0pID0+IG1hcFttXSk7XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZiA9IHt9O1xuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIG9ubHkgdGhlIGVudHJ5IGNodW5rLlxuLy8gVGhlIGNodW5rIGxvYWRpbmcgZnVuY3Rpb24gZm9yIGFkZGl0aW9uYWwgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmUgPSAoY2h1bmtJZCkgPT4ge1xuXHRyZXR1cm4gUHJvbWlzZS5hbGwoT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5mKS5yZWR1Y2UoKHByb21pc2VzLCBrZXkpID0+IHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmZba2V5XShjaHVua0lkLCBwcm9taXNlcyk7XG5cdFx0cmV0dXJuIHByb21pc2VzO1xuXHR9LCBbXSkpO1xufTsiLCIvLyBUaGlzIGZ1bmN0aW9uIGFsbG93IHRvIHJlZmVyZW5jZSBhc3luYyBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18udSA9IChjaHVua0lkKSA9PiB7XG5cdC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBiYXNlZCBvbiB0ZW1wbGF0ZVxuXHRyZXR1cm4gXCJqcy9cIiArIGNodW5rSWQgKyBcIi5jaHVuay5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmogPSA2Mjg7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7IiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDYyODogMFxufTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSAoY2h1bmtJZCwgcHJvbWlzZXMpID0+IHtcblx0XHQvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG5cdFx0dmFyIGluc3RhbGxlZENodW5rRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpID8gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdIDogdW5kZWZpbmVkO1xuXHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgeyAvLyAwIG1lYW5zIFwiYWxyZWFkeSBpbnN0YWxsZWRcIi5cblxuXHRcdFx0Ly8gYSBQcm9taXNlIG1lYW5zIFwiY3VycmVudGx5IGxvYWRpbmdcIi5cblx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZih0cnVlKSB7IC8vIGFsbCBjaHVua3MgaGF2ZSBKU1xuXHRcdFx0XHRcdC8vIHNldHVwIFByb21pc2UgaW4gY2h1bmsgY2FjaGVcblx0XHRcdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IChpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XSkpO1xuXHRcdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSk7XG5cblx0XHRcdFx0XHQvLyBzdGFydCBjaHVuayBsb2FkaW5nXG5cdFx0XHRcdFx0dmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18ucCArIF9fd2VicGFja19yZXF1aXJlX18udShjaHVua0lkKTtcblx0XHRcdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cdFx0XHRcdFx0dmFyIGxvYWRpbmdFbmRlZCA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkpIHtcblx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9IGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmVhbFNyYyA9IGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuc3JjO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPSAnTG9hZGluZyBjaHVuayAnICsgY2h1bmtJZCArICcgZmFpbGVkLlxcbignICsgZXJyb3JUeXBlICsgJzogJyArIHJlYWxTcmMgKyAnKSc7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IudHlwZSA9IGVycm9yVHlwZTtcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmwodXJsLCBsb2FkaW5nRW5kZWQsIFwiY2h1bmstXCIgKyBjaHVua0lkLCBjaHVua0lkKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cbn07XG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbl9fd2VicGFja19yZXF1aXJlX18uTy5qID0gKGNodW5rSWQpID0+IChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPT09IDApO1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDA7XG5cdGlmKGNodW5rSWRzLnNvbWUoKGlkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMCkpKSB7XG5cdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0fVxuXHRpZihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uTyhyZXN1bHQpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzc2XSwgKCkgPT4gKF9fd2VicGFja19yZXF1aXJlX18oNTg1MikpKVxuX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiJdLCJuYW1lcyI6WyJkZWZlcnJlZCIsImxlYWZQcm90b3R5cGVzIiwiZ2V0UHJvdG8iLCJpblByb2dyZXNzIiwiZGF0YVdlYnBhY2tQcmVmaXgiLCJjdXJyZW50VXNlciIsImN1cnJlbnREb2N1bWVudCIsImN1cnJlbnRDb21tZW50SWQiLCJyYXRpbmdzRGF0YSIsInVzZXJDdXJyZW50UmF0aW5nIiwiYXN5bmMiLCJsb2FkUmF0aW5ncyIsImRhdGEiLCJyYXRpbmdzIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsImxlbmd0aCIsImF2ZXJhZ2UiLCJyZWR1Y2UiLCJzdW0iLCJyIiwicmF0aW5nIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRleHRDb250ZW50IiwidG9GaXhlZCIsImRpc3RyaWJ1dGlvbiIsImZvckVhY2giLCJjYWxjdWxhdGVSYXRpbmdEaXN0cmlidXRpb24iLCJ1cGRhdGVSYXRpbmdCYXJzIiwidXNlclJhdGluZyIsImZpbmQiLCJ1c2VyX2lkIiwidXBkYXRlU3RhcnNEaXNwbGF5IiwiY29uc29sZSIsInRvdGFsIiwiaSIsInBlcmNlbnRhZ2UiLCJzdHlsZSIsIndpZHRoIiwiTWF0aCIsInJvdW5kIiwibG9hZENvbW1lbnRzIiwiY29tbWVudHMiLCJjb21tZW50c0Vycm9yIiwib3JkZXIiLCJhc2NlbmRpbmciLCJyZW5kZXJDb21tZW50cyIsInVzZXJJZHMiLCJTZXQiLCJtYXAiLCJjIiwicHJvZmlsZXMiLCJwcm9maWxlc0Vycm9yIiwiaW4iLCJ3YXJuIiwiY29tbWVudCIsInByb2ZpbGVzTWFwIiwiYWNjIiwicHJvZmlsZSIsImNvbW1lbnRzTGlzdCIsImlubmVySFRNTCIsImNvbW1lbnRFbCIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJkYXRhc2V0IiwiY29tbWVudElkIiwiaXNPd25lciIsInVzZXJOYW1lIiwiZnVsbF9uYW1lIiwiYXZhdGFyVXJsIiwiYXZhdGFyX3VybCIsImRhdGUiLCJEYXRlIiwiY3JlYXRlZF9hdCIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImRheSIsIm1vbnRoIiwieWVhciIsImNvbW1lbnRIZWFkZXIiLCJhdmF0YXJNZXRhIiwiZGlzcGxheSIsImFsaWduSXRlbXMiLCJnYXAiLCJ1cGRhdGVkX2F0IiwiYXBwZW5kQ2hpbGQiLCJjb250ZW50IiwiYWN0aW9ucyIsImNyZWF0ZUNvbW1lbnRFbGVtZW50Iiwic3dpdGNoVGFiIiwiZSIsInRhcmdldFRhYiIsInRhcmdldCIsInRhYiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidG4iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJzdGFycyIsInN0YXIiLCJpbmRleCIsInJlbW92ZSIsInNldEF0dHJpYnV0ZSIsImF2Z1JhdGluZyIsInBhcnNlRmxvYXQiLCJpc05hTiIsImRpc3BsYXlBdmVyYWdlUmF0aW5nIiwiaGFuZGxlUmF0aW5nIiwicGFyc2VJbnQiLCJleGlzdGluZyIsInNpbmdsZSIsInVwZGF0ZSIsInRvSVNPU3RyaW5nIiwiaW5zZXJ0IiwiZG9jdW1lbnRfaWQiLCJhbGVydCIsImRlbGV0ZSIsImhhbmRsZURvd25sb2FkIiwibG9nIiwicGRmX3N0b3JhZ2VfcGF0aCIsImNsZWFuUGF0aCIsInJlcGxhY2UiLCJ1cmxEYXRhIiwidXJsRXJyb3IiLCJzdG9yYWdlIiwiY3JlYXRlU2lnbmVkVXJsIiwiZG93bmxvYWQiLCJhIiwiaHJlZiIsInNpZ25lZFVybCIsInpvbmluZyIsImNpdHkiLCJuYW1lIiwiem9uZSIsImJvZHkiLCJjbGljayIsInJlbW92ZUNoaWxkIiwibWVzc2FnZSIsImluY2x1ZGVzIiwic3VibWl0Q29tbWVudCIsInZhbHVlIiwidHJpbSIsImhhbmRsZUNvbW1lbnRBY3Rpb24iLCJlZGl0QnRuIiwiY2xvc2VzdCIsImRlbGV0ZUJ0biIsIm9wZW5FZGl0TW9kYWwiLCJjb25maXJtIiwicnBjIiwiY29tbWVudF9pZCIsImRlbGV0ZUNvbW1lbnQiLCJjbG9zZU1vZGFsIiwic2F2ZUNvbW1lbnRFZGl0IiwiaGFuZGxlTG9nb3V0IiwiYXV0aCIsInNpZ25PdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNob3dFcnJvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1c2VyIiwiZ2V0VXNlciIsImRvY3VtZW50SWQiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZWFyY2giLCJnZXQiLCJkb2N1bWVudERhdGEiLCJjaXR5TmFtZSIsInN0ciIsImxldHRlciIsInRvVXBwZXJDYXNlIiwiem9uZU5hbWUiLCJzb3VyY2VQbHVEYXRlIiwic291cmNlX3BsdV9kYXRlIiwiY2l0eUJyZWFkY3J1bWIiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ1cGRhdGVEb2N1bWVudEluZm8iLCJodG1sX2NvbnRlbnQiLCJzb3VyY2VfcGx1X3VybCIsImxvYWREb2N1bWVudCIsImhhbmRsZVN0YXJIb3ZlciIsImFkZCIsInF1ZXJ5U2VsZWN0b3IiLCJsb2dvdXRCdG4iLCJzZXR1cEV2ZW50TGlzdGVuZXJzIiwiYmFja1RvVG9wQnRuIiwic2Nyb2xsWSIsInNjcm9sbFRvIiwidG9wIiwiYmVoYXZpb3IiLCJpbml0QmFja1RvVG9wIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwibSIsIk8iLCJyZXN1bHQiLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImZ1bGZpbGxlZCIsImoiLCJPYmplY3QiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJnZXRQcm90b3R5cGVPZiIsIm9iaiIsInQiLCJtb2RlIiwidGhpcyIsIl9fZXNNb2R1bGUiLCJ0aGVuIiwibnMiLCJjcmVhdGUiLCJkZWYiLCJjdXJyZW50IiwiaW5kZXhPZiIsImdldE93blByb3BlcnR5TmFtZXMiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJmIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwibCIsInVybCIsImRvbmUiLCJwdXNoIiwic2NyaXB0IiwibmVlZEF0dGFjaCIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInMiLCJnZXRBdHRyaWJ1dGUiLCJjaGFyc2V0IiwidGltZW91dCIsIm5jIiwic3JjIiwib25TY3JpcHRDb21wbGV0ZSIsInByZXYiLCJldmVudCIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicGFyZW50Tm9kZSIsInNldFRpbWVvdXQiLCJiaW5kIiwidHlwZSIsImhlYWQiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInAiLCJpbnN0YWxsZWRDaHVua3MiLCJpbnN0YWxsZWRDaHVua0RhdGEiLCJwcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIkVycm9yIiwiZXJyb3JUeXBlIiwicmVhbFNyYyIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==