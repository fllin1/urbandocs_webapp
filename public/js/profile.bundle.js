(()=>{"use strict";var e,t,o,n,r,a={331:(e,t,o)=>{const n=(0,o(303).UU)("https://ofeyssipibktmbfebibo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mZXlzc2lwaWJrdG1iZmViaWJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM5MjUwOTQsImV4cCI6MjA1OTUwMTA5NH0.w71CAKfolktzRl-TmLVhHYaEbhCfVk4A7YraEUCglrU");let r=null,a=!1;function i(e){r=e,e?localStorage.setItem("currentUser",JSON.stringify(e)):localStorage.removeItem("currentUser")}async function s(){try{const{data:{session:e},error:t}=await n.auth.getSession();if(t||!e)return console.log("No valid session found"),i(null),a=!1,!1;const{error:o}=await n.auth.refreshSession();return o?(console.warn("Session validation failed:",o),await n.auth.signOut(),i(null),a=!1,!1):(i(e.user),a=!0,!0)}catch(e){return console.error("Session validation error:",e),i(null),a=!1,!1}}function l(e,t){const o=document.getElementById(e),n=document.getElementById(t);o&&(o.disabled=!0),n&&n.classList.remove("hidden")}function c(e,t){const o=document.getElementById(e),n=document.getElementById(t);o&&(o.disabled=!1),n&&n.classList.add("hidden")}function d(e,t,o){const n=document.getElementById(o);n&&(n.textContent=e,n.className="status-message margin-top-sm",n.classList.add(t),n.classList.remove("hidden"))}async function u(){if(!await async function(e="/login"){return!!await s()||(window.location.href=e,!1)}())return;const e=document.getElementById("userEmail"),t=document.getElementById("logoutBtn"),o=document.getElementById("profileForm"),r=document.getElementById("deleteAccountBtn"),a=document.getElementById("memberSince");try{const{data:{session:i}}=await n.auth.getSession();if(!i||!i.user)return console.log("No active session or user. Redirecting to login."),void(window.location.href="/login.html");const s=i.user;e&&(e.textContent=s.email),a&&s.created_at&&(a.textContent=new Date(s.created_at).toLocaleDateString("fr-FR")),l("saveProfileBtn");const u=await async function(e){const{data:t,error:o}=await n.from("profiles").select("first_name, last_name, address, city, postal_code, occupation, phone, date_of_birth, updated_at").eq("id",e).single();if(o&&"PGRST116"!==o.code)throw console.error("Error fetching profile:",o),o;return t}(s.id);u?function(e){if(!e)return;document.getElementById("nom").value=e.last_name||"",document.getElementById("prenom").value=e.first_name||"",document.getElementById("adresse").value=e.address||"",document.getElementById("ville").value=e.city||"",document.getElementById("codePostal").value=e.postal_code||"",document.getElementById("occupation").value=e.occupation||"",document.getElementById("telephone").value=e.phone||"",e.date_of_birth&&(document.getElementById("dateNaissance").value=e.date_of_birth);const t=document.getElementById("memberSince");t&&e.updated_at&&(t.textContent=new Date(e.updated_at).toLocaleDateString("fr-FR"))}(u):console.log("No profile data found for user, form will be empty."),c("saveProfileBtn"),t&&t.addEventListener("click",(async()=>{l("logoutBtn");try{const{error:e}=await n.auth.signOut();if(e)throw e;d("Déconnexion réussie. Redirection...","success","profileFormStatus"),setTimeout((()=>{window.location.href="/"}),200)}catch(e){console.error("Error signing out:",e),d(`Erreur de déconnexion: ${e.message}`,"error","profileFormStatus")}finally{c("logoutBtn")}})),o&&o.addEventListener("submit",(async e=>{e.preventDefault(),l("saveProfileBtn");const t="profileFormStatus";document.getElementById(t).classList.add("hidden");const o={id:s.id,last_name:document.getElementById("nom").value.trim(),first_name:document.getElementById("prenom").value.trim(),address:document.getElementById("adresse").value.trim(),city:document.getElementById("ville").value.trim(),postal_code:document.getElementById("codePostal").value.trim(),occupation:document.getElementById("occupation").value.trim(),phone:document.getElementById("telephone").value.trim(),date_of_birth:document.getElementById("dateNaissance").value||null,updated_at:(new Date).toISOString()};Object.keys(o).forEach((e=>{""===o[e]&&"id"!==e&&"updated_at"!==e&&(o[e]=null)}));try{const{error:e}=await n.from("profiles").upsert(o);if(e)throw e;d("Profil mis à jour avec succès !","success",t)}catch(e){console.error("Error updating profile:",e),d(`Erreur lors de la mise à jour: ${e.message}`,"error",t)}finally{c("saveProfileBtn")}})),r&&r.addEventListener("click",(async()=>{const e="deleteStatusMessage";if(document.getElementById(e).classList.add("hidden"),confirm("Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible et toutes vos données seront perdues.")){l("deleteAccountBtn");try{const{error:t}=await n.from("profiles").delete().eq("id",s.id);t&&console.error("Error deleting profile:",t);const{error:o}=await n.rpc("delete_user_account");o?(console.warn("delete_user_account RPC not available:",o),await n.auth.signOut(),d("Profil supprimé. Veuillez contacter l'administrateur pour supprimer complètement votre compte.","info",e)):(d("Compte supprimé avec succès. Vous allez être déconnecté et redirigé.","success",e),await n.auth.signOut()),setTimeout((()=>{window.location.href="/"}),3e3)}catch(t){console.error("Error deleting account:",t),d(`Erreur lors de la suppression du compte: ${t.message}`,"error",e)}finally{c("deleteAccountBtn")}}else console.log("User cancelled account deletion.")}))}catch(e){console.error("Profile page initialization error:",e);const t=document.getElementById("profileDetails");t&&(t.innerHTML='<p class="error-message">Impossible de charger les informations du profil. Veuillez réessayer plus tard.</p>')}}document.addEventListener("DOMContentLoaded",u);let m=null;function g(e){m=e;const t=document.getElementById("userStatus"),o=document.getElementById("loginLink"),n=document.getElementById("signupLink"),r=document.getElementById("logoutBtn");e?(t&&(t.classList.remove("hidden"),t.textContent="Votre compte"),o&&o.classList.add("hidden"),n&&n.classList.add("hidden"),r&&r.classList.remove("hidden"),console.log("Header updated: User is authenticated")):(t&&t.classList.add("hidden"),o&&o.classList.remove("hidden"),n&&n.classList.remove("hidden"),r&&r.classList.add("hidden"),console.log("Header updated: User is not authenticated"))}function f(){console.log("Initializing header authentication..."),function(){const e=document.getElementById("logoutBtn");e&&(e.replaceWith(e.cloneNode(!0)),document.getElementById("logoutBtn").addEventListener("click",(async e=>{e.preventDefault(),console.log("Logout initiated from header");try{const{error:e}=await n.auth.signOut();e?(console.error("Error logging out:",e.message),alert("Erreur lors de la déconnexion. Veuillez réessayer.")):console.log("Logout successful, redirecting to home")}catch(e){console.error("Exception during logout:",e),alert("Une erreur inattendue s'est produite lors de la déconnexion.")}})))}(),n.auth.onAuthStateChange(((e,t)=>{const o=t?.user||null;i(o),g(o),"SIGNED_OUT"===e?(console.log("Header auth: User signed out, redirecting to home"),setTimeout((()=>{window.location.href="/"}),100)):"SIGNED_IN"===e?console.log("Header auth: User signed in"):"INITIAL_SESSION"===e?console.log("Header auth: Initial session loaded"):"TOKEN_REFRESHED"===e&&console.log("Header auth: Token refreshed")})),g(async function(e=!0){if(e&&!a&&await s(),!e&&!r){const e=localStorage.getItem("currentUser");if(e)try{r=JSON.parse(e)}catch(e){console.error("Error retrieving user:",e),localStorage.removeItem("currentUser")}}return r}()),console.log("Header authentication initialized")}document.addEventListener("DOMContentLoaded",(()=>{f(),u(),console.log("Profile page and header authentication initialized")}))}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={exports:{}};return a[e].call(o.exports,o,o.exports,s),o.exports}s.m=a,e=[],s.O=(t,o,n,r)=>{if(!o){var a=1/0;for(d=0;d<e.length;d++){for(var[o,n,r]=e[d],i=!0,l=0;l<o.length;l++)(!1&r||a>=r)&&Object.keys(s.O).every((e=>s.O[e](o[l])))?o.splice(l--,1):(i=!1,r<a&&(a=r));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,n,r]},o=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var r=Object.create(null);s.r(r);var a={};t=t||[null,o({}),o([]),o(o)];for(var i=2&n&&e;"object"==typeof i&&!~t.indexOf(i);i=o(i))Object.getOwnPropertyNames(i).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,s.d(r,a),r},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"js/"+e+".bundle.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="urbandocs_webapp:",s.l=(e,t,o,a)=>{if(n[e])n[e].push(t);else{var i,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+o){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",r+o),i.src=e),n[e]=[t];var m=(t,o)=>{i.onerror=i.onload=null,clearTimeout(g);var r=n[e];if(delete n[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(o))),t)return t(o)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),l&&document.head.appendChild(i)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var n=o.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=o[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../"})(),(()=>{var e={138:0};s.f.j=(t,o)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var r=new Promise(((o,r)=>n=e[t]=[o,r]));o.push(n[2]=r);var a=s.p+s.u(t),i=new Error;s.l(a,(o=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=o&&("load"===o.type?"missing":o.type),a=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",i.name="ChunkLoadError",i.type=r,i.request=a,n[1](i)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,o)=>{var n,r,[a,i,l]=o,c=0;if(a.some((t=>0!==e[t]))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var d=l(s)}for(t&&t(o);c<a.length;c++)r=a[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},o=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var l=s.O(void 0,[303],(()=>s(331)));l=s.O(l)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQ3JFbUQsRUFBZ0JuRCxHQUFTLEtBRTFCbUQsRUFBZ0JuRCxHQUFXLEVBRTVCLE9BQU8zQyxFQUFvQlMsRUFBRUMsRUFBTyxFQUdqQ2tHLEVBQXFCQyxLQUFtQyw2QkFBSUEsS0FBbUMsOEJBQUssR0FDeEdELEVBQW1CdEksUUFBUWlJLEVBQXFCeEIsS0FBSyxLQUFNLElBQzNENkIsRUFBbUJsRCxLQUFPNkMsRUFBcUJ4QixLQUFLLEtBQU02QixFQUFtQmxELEtBQUtxQixLQUFLNkIsRyxLQ2xGdkYsSUFBSUUsRUFBc0I5RyxFQUFvQlMsT0FBRU4sRUFBVyxDQUFDLE1BQU0sSUFBT0gsRUFBb0IsT0FDN0Y4RyxFQUFzQjlHLEVBQW9CUyxFQUFFcUcsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9jcmVhdGUgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2xvYWQgc2NyaXB0Iiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvc3VwYWJhc2UtY2xpZW50LmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYXV0aC9hdXRoLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYXV0aC9wcm9maWxlLmpzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvLi9zcmMvanMvYXV0aC9oZWFkZXItYXV0aC5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL3Byb2ZpbGUtcGFnZS5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZSIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0dmFyIHIgPSBmbigpO1xuXHRcdFx0aWYgKHIgIT09IHVuZGVmaW5lZCkgcmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwidmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mID8gKG9iaikgPT4gKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopKSA6IChvYmopID0+IChvYmouX19wcm90b19fKTtcbnZhciBsZWFmUHJvdG90eXBlcztcbi8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLy8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4vLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbi8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLy8gbW9kZSAmIDE2OiByZXR1cm4gdmFsdWUgd2hlbiBpdCdzIFByb21pc2UtbGlrZVxuLy8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuX193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcblx0aWYobW9kZSAmIDEpIHZhbHVlID0gdGhpcyh2YWx1ZSk7XG5cdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG5cdGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUpIHtcblx0XHRpZigobW9kZSAmIDQpICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcblx0XHRpZigobW9kZSAmIDE2KSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHZhbHVlO1xuXHR9XG5cdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG5cdHZhciBkZWYgPSB7fTtcblx0bGVhZlByb3RvdHlwZXMgPSBsZWFmUHJvdG90eXBlcyB8fCBbbnVsbCwgZ2V0UHJvdG8oe30pLCBnZXRQcm90byhbXSksIGdldFByb3RvKGdldFByb3RvKV07XG5cdGZvcih2YXIgY3VycmVudCA9IG1vZGUgJiAyICYmIHZhbHVlOyB0eXBlb2YgY3VycmVudCA9PSAnb2JqZWN0JyAmJiAhfmxlYWZQcm90b3R5cGVzLmluZGV4T2YoY3VycmVudCk7IGN1cnJlbnQgPSBnZXRQcm90byhjdXJyZW50KSkge1xuXHRcdE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGN1cnJlbnQpLmZvckVhY2goKGtleSkgPT4gKGRlZltrZXldID0gKCkgPT4gKHZhbHVlW2tleV0pKSk7XG5cdH1cblx0ZGVmWydkZWZhdWx0J10gPSAoKSA9PiAodmFsdWUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGRlZik7XG5cdHJldHVybiBucztcbn07IiwidmFyIGluUHJvZ3Jlc3MgPSB7fTtcbnZhciBkYXRhV2VicGFja1ByZWZpeCA9IFwidXJiYW5kb2NzX3dlYmFwcDpcIjtcbi8vIGxvYWRTY3JpcHQgZnVuY3Rpb24gdG8gbG9hZCBhIHNjcmlwdCB2aWEgc2NyaXB0IHRhZ1xuX193ZWJwYWNrX3JlcXVpcmVfXy5sID0gKHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSA9PiB7XG5cdGlmKGluUHJvZ3Jlc3NbdXJsXSkgeyBpblByb2dyZXNzW3VybF0ucHVzaChkb25lKTsgcmV0dXJuOyB9XG5cdHZhciBzY3JpcHQsIG5lZWRBdHRhY2g7XG5cdGlmKGtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHMgPSBzY3JpcHRzW2ldO1xuXHRcdFx0aWYocy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgPT0gdXJsIHx8IHMuZ2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIpID09IGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KSB7IHNjcmlwdCA9IHM7IGJyZWFrOyB9XG5cdFx0fVxuXHR9XG5cdGlmKCFzY3JpcHQpIHtcblx0XHRuZWVkQXR0YWNoID0gdHJ1ZTtcblx0XHRzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblxuXHRcdHNjcmlwdC5jaGFyc2V0ID0gJ3V0Zi04Jztcblx0XHRzY3JpcHQudGltZW91dCA9IDEyMDtcblx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5uYykge1xuXHRcdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcIm5vbmNlXCIsIF9fd2VicGFja19yZXF1aXJlX18ubmMpO1xuXHRcdH1cblx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwiZGF0YS13ZWJwYWNrXCIsIGRhdGFXZWJwYWNrUHJlZml4ICsga2V5KTtcblxuXHRcdHNjcmlwdC5zcmMgPSB1cmw7XG5cdH1cblx0aW5Qcm9ncmVzc1t1cmxdID0gW2RvbmVdO1xuXHR2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCkgPT4ge1xuXHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cblx0XHRzY3JpcHQub25lcnJvciA9IHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR2YXIgZG9uZUZucyA9IGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRkZWxldGUgaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdHNjcmlwdC5wYXJlbnROb2RlICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdFx0ZG9uZUZucyAmJiBkb25lRm5zLmZvckVhY2goKGZuKSA9PiAoZm4oZXZlbnQpKSk7XG5cdFx0aWYocHJldikgcmV0dXJuIHByZXYoZXZlbnQpO1xuXHR9XG5cdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgdW5kZWZpbmVkLCB7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSksIDEyMDAwMCk7XG5cdHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcblx0c2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcblx0bmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG59OyIsIi8vIHNyYy9qcy9zdXBhYmFzZS1jbGllbnQuanNcbi8qKlxuICogU3VwYWJhc2UgQ2xpZW50XG4gKiBAbW9kdWxlIHN1cGFiYXNlLWNsaWVudFxuICogQGRlc2NyaXB0aW9uIFRoaXMgbW9kdWxlIGhhbmRsZXMgdGhlIFN1cGFiYXNlIGNsaWVudCBpbml0aWFsaXphdGlvbiBhbmQgY29uZmlndXJhdGlvbi5cbiAqIEB2ZXJzaW9uIDAuMC4yXG4gKiBAYXV0aG9yIEdyZXlQYW5kYVxuICpcbiAqIEBjaGFuZ2Vsb2dcbiAqIC0gMC4wLjIgKDIwMjUtMDUtMjcpOiBBZGRlZCBlbnZpcm9uZW1lbnQgdmFyaWFibGVzIGVycm9yIGhhbmRsaW5nIGZvciBtaXNzaW5nLlxuICogLSAwLjAuMSAoMjAyNS0wNS0wOSk6IEluaXRpYWwgdmVyc2lvbiB3aXRoIGJhc2ljIFN1cGFiYXNlIGNsaWVudCBpbml0aWFsaXphdGlvbi5cbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gXCJodHRwczovL29mZXlzc2lwaWJrdG1iZmViaWJvLnN1cGFiYXNlLmNvXCI7XG5jb25zdCBzdXBhYmFzZUFub25LZXkgPVxuICBcImV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUpwYzNNaU9pSnpkWEJoWW1GelpTSXNJbkpsWmlJNkltOW1aWGx6YzJsd2FXSnJkRzFpWm1WaWFXSnZJaXdpY205c1pTSTZJbUZ1YjI0aUxDSnBZWFFpT2pFM05ETTVNalV3T1RRc0ltVjRjQ0k2TWpBMU9UVXdNVEE1TkgwLnc3MUNBS2ZvbGt0elJsLVRtTFZoSFlhRWJoQ2ZWazRBN1lyYUVVQ2dsclVcIjtcblxuaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XG4gIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzXCIpO1xufVxuXG5jb25zdCBjbGllbnQgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNsaWVudDtcbiIsIi8vIHNyYy9hdXRoL2F1dGguanNcbi8qKlxuICogQXV0aGVudGljYXRpb24gTW9kdWxlIC0gQmFzZVxuICogQG1vZHVsZSBhdXRoXG4gKiBAZGVzY3JpcHRpb24gQmFzZSBtb2R1bGUgZm9yIGF1dGhlbnRpY2F0aW9uIHdpdGggY29tbW9uIGZ1bmN0aW9ucyBhbmQgY29uZmlndXJhdGlvblxuICogQHZlcnNpb24gMC4wLjVcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMC41ICgyMDI1LTA1LTE1KTogQWRkZWQgc2Vzc2lvbiB2YWxpZGF0aW9uIGFuZCBwcm90ZWN0aW9uIGFnYWluc3Qgc3RhbGUgc2Vzc2lvbnMuXG4gKiAtIDAuMC40ICgyMDI1LTA1LTE1KTogUmVtb3ZhbCBvZiBGaXJlYmFzZSBDbG91ZCBGdW5jdGlvbnMgY29uc3RhbnRzLlxuICogLSAwLjAuMyAoMjAyNS0wNS0xMyk6IE1vZGlmaWVkIHRoZSBhdXRoZW50aWNhdGlvbiBzdGF0ZSBtYW5hZ2VtZW50IHRvIHVzZSBTdXBhYmFzZSBBdXRoIHN5c3RlbS5cbiAqIC0gMC4wLjIgKDIwMjUtMDUtMTMpOiBSZW9yZ2FuaXphdGlvbiBpbnRvIHNlcGFyYXRlIG1vZHVsZXNcbiAqIC0gMC4wLjEgKDIwMjUtMDUtMDMpOiBJbml0aWFsIGNyZWF0aW9uXG4gKi9cblxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5cbi8vIEdsb2JhbCBhdXRoZW50aWNhdGlvbiBzdGF0ZVxubGV0IGN1cnJlbnRVc2VyID0gbnVsbDtcbmxldCBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG5cbi8qKlxuICogU2V0cyB0aGUgY3VycmVudCB1c2VyXG4gKiBAcGFyYW0ge09iamVjdH0gdXNlciAtIFVzZXIgZGF0YVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3VycmVudFVzZXIodXNlcikge1xuICBjdXJyZW50VXNlciA9IHVzZXI7XG4gIC8vIFBvc3NpYmxlIHN0b3JhZ2UgaW4gbG9jYWxTdG9yYWdlL3Nlc3Npb25TdG9yYWdlXG4gIGlmICh1c2VyKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50VXNlclwiLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gIH0gZWxzZSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBpZiB0aGUgY3VycmVudCBzZXNzaW9uIGlzIGFjdGl2ZSB3aXRoIFN1cGFiYXNlXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gVHJ1ZSBpZiBzZXNzaW9uIGlzIHZhbGlkLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlU2Vzc2lvbigpIHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgY3VycmVudCBzZXNzaW9uIGZyb20gU3VwYWJhc2VcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHNlc3Npb24gfSxcbiAgICAgIGVycm9yOiBzZXNzaW9uRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuXG4gICAgLy8gTm8gc2Vzc2lvbiBvciBlcnJvciByZXRyaWV2aW5nIHNlc3Npb25cbiAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk5vIHZhbGlkIHNlc3Npb24gZm91bmRcIik7XG4gICAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBUcnkgdG8gcmVmcmVzaCB0aGUgdG9rZW4gdG8gdmFsaWRhdGUgaXQgd2l0aCB0aGUgc2VydmVyXG4gICAgY29uc3QgeyBlcnJvcjogcmVmcmVzaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnJlZnJlc2hTZXNzaW9uKCk7XG5cbiAgICBpZiAocmVmcmVzaEVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJTZXNzaW9uIHZhbGlkYXRpb24gZmFpbGVkOlwiLCByZWZyZXNoRXJyb3IpO1xuICAgICAgLy8gRm9yY2UgY2xlYXIgdGhlIGludmFsaWQgc2Vzc2lvblxuICAgICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG4gICAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBTZXNzaW9uIGlzIHZhbGlkLCB1cGRhdGUgdGhlIGN1cnJlbnQgdXNlclxuICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgc2Vzc2lvblZhbGlkYXRlZCA9IHRydWU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2Vzc2lvbiB2YWxpZGF0aW9uIGVycm9yOlwiLCBlKTtcbiAgICBzZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogUmV0cmlldmVzIHRoZSBjdXJyZW50IHVzZXJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsaWRhdGUgLSBXaGV0aGVyIHRvIHZhbGlkYXRlIHRoZSBzZXNzaW9uIHdpdGggU3VwYWJhc2VcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdHxudWxsPn0gVGhlIGN1cnJlbnQgdXNlciBvciBudWxsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcih2YWxpZGF0ZSA9IHRydWUpIHtcbiAgLy8gSWYgd2UgbmVlZCB0byB2YWxpZGF0ZSBhbmQgaGF2ZW4ndCBkb25lIHNvIHlldFxuICBpZiAodmFsaWRhdGUgJiYgIXNlc3Npb25WYWxpZGF0ZWQpIHtcbiAgICBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcbiAgfVxuXG4gIC8vIElmIG5vIHZhbGlkYXRpb24gbmVlZGVkIG9yIGFscmVhZHkgdmFsaWRhdGVkXG4gIGlmICghdmFsaWRhdGUgJiYgIWN1cnJlbnRVc2VyKSB7XG4gICAgLy8gVHJ5IHRvIHJldHJpZXZlIGZyb20gc3RvcmFnZSBpZiBub3QgaW4gbWVtb3J5XG4gICAgY29uc3Qgc3RvcmVkVXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgaWYgKHN0b3JlZFVzZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJldHJpZXZpbmcgdXNlcjpcIiwgZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRVc2VyO1xufVxuXG4vKipcbiAqIFN5bmNocm9ub3VzIHZlcnNpb24gb2YgZ2V0Q3VycmVudFVzZXIgZm9yIG5vbi1hc3luYyBjb250ZXh0c1xuICogV0FSTklORzogVGhpcyBtYXkgcmV0dXJuIHN0YWxlIGRhdGEgaWYgc2Vzc2lvbiBpcyBpbnZhbGlkXG4gKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9IFRoZSBjdXJyZW50IHVzZXIgb3IgbnVsbFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXJTeW5jKCkge1xuICBpZiAoIWN1cnJlbnRVc2VyKSB7XG4gICAgY29uc3Qgc3RvcmVkVXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgaWYgKHN0b3JlZFVzZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJldHJpZXZpbmcgdXNlcjpcIiwgZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRVc2VyO1xufVxuXG4vKipcbiAqIExvZ3Mgb3V0IHRoZSB1c2VyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgdHJ5IHtcbiAgICAvLyBTaWduIG91dCBmcm9tIFN1cGFiYXNlXG4gICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG5cbiAgICAvLyBDbGVhciBsb2NhbCBzdGF0ZVxuICAgIGN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcblxuICAgIC8vIFJlZGlyZWN0IHRvIHRoZSBob21lIHBhZ2UgYWZ0ZXIgbG9nb3V0XG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZHVyaW5nIGxvZ291dDpcIiwgZXJyb3IpO1xuICAgIC8vIFN0aWxsIGNsZWFyIGxvY2FsIHN0YXRlIGV2ZW4gaWYgU3VwYWJhc2Ugc2lnbk91dCBmYWlsc1xuICAgIGN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJjdXJyZW50VXNlclwiKTtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiB3aXRoIHZhbGlkIHNlc3Npb25cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsaWRhdGUgLSBXaGV0aGVyIHRvIHZhbGlkYXRlIHdpdGggU3VwYWJhc2UgZmlyc3RcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBUcnVlIGlmIHRoZSB1c2VyIGlzIGxvZ2dlZCBpbiB3aXRoIHZhbGlkIHNlc3Npb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzTG9nZ2VkSW4odmFsaWRhdGUgPSB0cnVlKSB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcih2YWxpZGF0ZSk7XG4gIHJldHVybiB1c2VyICE9PSBudWxsO1xufVxuXG4vKipcbiAqIFN5bmNocm9ub3VzIHZlcnNpb24gb2YgaXNMb2dnZWRJblxuICogV0FSTklORzogVGhpcyBtYXkgcmV0dXJuIGluY29ycmVjdCByZXN1bHRzIGlmIHNlc3Npb24gaXMgaW52YWxpZFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdXNlciBhcHBlYXJzIHRvIGJlIGxvZ2dlZCBpbiBsb2NhbGx5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvZ2dlZEluU3luYygpIHtcbiAgcmV0dXJuIGdldEN1cnJlbnRVc2VyU3luYygpICE9PSBudWxsO1xufVxuXG4vKipcbiAqIFByb3RlY3RzIGEgcGFnZSB0aGF0IHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVkaXJlY3RVcmwgLSBVUkwgdG8gcmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWRcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBUcnVlIGlmIGF1dGhlbnRpY2F0ZWQsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvdGVjdFBhZ2UocmVkaXJlY3RVcmwgPSBcIi9sb2dpblwiKSB7XG4gIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcblxuICBpZiAoIWlzVmFsaWQpIHtcbiAgICAvLyBSZWRpcmVjdCB0byBsb2dpbiBwYWdlXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSByZWRpcmVjdFVybDtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhdXRoIG9uIHBhZ2UgbG9hZFxuICogQ2FsbCB0aGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgeW91ciBhcHAgaW5pdGlhbGl6YXRpb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRBdXRoKCkge1xuICAvLyBWYWxpZGF0ZSBzZXNzaW9uIG9uIHBhZ2UgbG9hZFxuICBhd2FpdCB2YWxpZGF0ZVNlc3Npb24oKTtcblxuICAvLyBTZXQgdXAgYXV0aCBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXJcbiAgc3VwYWJhc2UuYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZShhc3luYyAoZXZlbnQsIHNlc3Npb24pID0+IHtcbiAgICBjb25zb2xlLmxvZyhcIkF1dGggc3RhdGUgY2hhbmdlZDpcIiwgZXZlbnQpO1xuXG4gICAgaWYgKGV2ZW50ID09PSBcIlNJR05FRF9JTlwiICYmIHNlc3Npb24pIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBcIlNJR05FRF9PVVRcIikge1xuICAgICAgc2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJUT0tFTl9SRUZSRVNIRURcIikge1xuICAgICAgc2V0Q3VycmVudFVzZXIoc2Vzc2lvbi51c2VyKTtcbiAgICAgIHNlc3Npb25WYWxpZGF0ZWQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiVVNFUl9VUERBVEVEXCIpIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIERpc3BsYXlzIGFuIGVycm9yIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gRXJyb3IgbWVzc2FnZSB0byBkaXNwbGF5XG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgd2hlcmUgdG8gZGlzcGxheSB0aGUgZXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dFcnJvcihtZXNzYWdlLCBlbGVtZW50SWQgPSBcImVycm9yTWVzc2FnZVwiKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChlcnJvckVsZW1lbnQpIHtcbiAgICBlcnJvckVsZW1lbnQuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZWxlbWVudCBub3QgZm91bmQ6XCIsIGVsZW1lbnRJZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNwbGF5cyBhIHN0YXR1cyBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIE1lc3NhZ2UgdG8gZGlzcGxheVxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBNZXNzYWdlIHR5cGUgKHN1Y2Nlc3MsIGluZm8sIHdhcm5pbmcsIGRhbmdlcilcbiAqIEBwYXJhbSB7c3RyaW5nfSBlbGVtZW50SWQgLSBJRCBvZiB0aGUgZWxlbWVudCB3aGVyZSB0byBkaXNwbGF5IHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93U3RhdHVzKFxuICBtZXNzYWdlLFxuICB0eXBlID0gXCJpbmZvXCIsXG4gIGVsZW1lbnRJZCA9IFwic3RhdHVzTWVzc2FnZVwiXG4pIHtcbiAgY29uc3Qgc3RhdHVzRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChzdGF0dXNFbGVtZW50KSB7XG4gICAgc3RhdHVzRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAvLyBSZW1vdmUgYWxsIGFsZXJ0LSogY2xhc3Nlc1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LmZvckVhY2goKGNsYXNzTmFtZSkgPT4ge1xuICAgICAgaWYgKGNsYXNzTmFtZS5zdGFydHNXaXRoKFwiYWxlcnQtXCIpKSB7XG4gICAgICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIHRoZSBjbGFzcyBjb3JyZXNwb25kaW5nIHRvIHRoZSB0eXBlXG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QuYWRkKGBhbGVydC0ke3R5cGV9YCk7XG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTdGF0dXMgZWxlbWVudCBub3QgZm91bmQ6XCIsIGVsZW1lbnRJZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBIaWRlcyBhbiBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgdG8gaGlkZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGlkZUVsZW1lbnQoZWxlbWVudElkKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFNob3dzIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBlbGVtZW50SWQgLSBJRCBvZiB0aGUgZWxlbWVudCB0byBzaG93XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93RWxlbWVudChlbGVtZW50SWQpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICB9XG59XG5cbi8qKlxuICogU2hvd3MgdGhlIGxvYWRpbmcgaW5kaWNhdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gYnV0dG9uSWQgLSBJRCBvZiB0aGUgYnV0dG9uXG4gKiBAcGFyYW0ge3N0cmluZ30gc3Bpbm5lcklkIC0gSUQgb2YgdGhlIHNwaW5uZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dMb2FkaW5nKGJ1dHRvbklkLCBzcGlubmVySWQpIHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYnV0dG9uSWQpO1xuICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc3Bpbm5lcklkKTtcblxuICBpZiAoYnV0dG9uKSBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICBpZiAoc3Bpbm5lcikgc3Bpbm5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xufVxuXG4vKipcbiAqIEhpZGVzIHRoZSBsb2FkaW5nIGluZGljYXRvclxuICogQHBhcmFtIHtzdHJpbmd9IGJ1dHRvbklkIC0gSUQgb2YgdGhlIGJ1dHRvblxuICogQHBhcmFtIHtzdHJpbmd9IHNwaW5uZXJJZCAtIElEIG9mIHRoZSBzcGlubmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoaWRlTG9hZGluZyhidXR0b25JZCwgc3Bpbm5lcklkKSB7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJ1dHRvbklkKTtcbiAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNwaW5uZXJJZCk7XG5cbiAgaWYgKGJ1dHRvbikgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIGlmIChzcGlubmVyKSBzcGlubmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG59XG5cbi8vIEV4cG9ydCB0aGUgbmVjZXNzYXJ5IGZ1bmN0aW9ucyBhbmQgdmFyaWFibGVzXG5leHBvcnQgZGVmYXVsdCB7XG4gIGdldEN1cnJlbnRVc2VyLFxuICBnZXRDdXJyZW50VXNlclN5bmMsXG4gIHNldEN1cnJlbnRVc2VyLFxuICBsb2dvdXQsXG4gIGlzTG9nZ2VkSW4sXG4gIGlzTG9nZ2VkSW5TeW5jLFxuICB2YWxpZGF0ZVNlc3Npb24sXG4gIHByb3RlY3RQYWdlLFxuICBpbml0QXV0aCxcbiAgc2hvd0Vycm9yLFxuICBzaG93U3RhdHVzLFxuICBoaWRlRWxlbWVudCxcbiAgc2hvd0VsZW1lbnQsXG4gIHNob3dMb2FkaW5nLFxuICBoaWRlTG9hZGluZyxcbn07XG4iLCIvLyBzcmMvYXV0aC9wcm9maWxlLmpzXG4vKipcbiAqIFByb2ZpbGUgTW9kdWxlXG4gKiBAbW9kdWxlIHByb2ZpbGVcbiAqIEBkZXNjcmlwdGlvbiBIYW5kbGVzIHVzZXIgcHJvZmlsZSBtYW5hZ2VtZW50LCBpbmNsdWRpbmcgZGF0YSBmZXRjaGluZywgdXBkYXRlcywgYW5kIGFjY291bnQgZGVsZXRpb24uXG4gKiBAdmVyc2lvbiAwLjIuMVxuICpcbiAqIEBjaGFuZ2Vsb2dcbiAqIC0gMC4yLjEgKDIwMjUtMDEtMjcpOiBVcGRhdGVkIHRvIHVzZSBFbmdsaXNoIGNvbHVtbiBuYW1lcyBhbmQgYWRkZWQgZGF0ZV9vZl9iaXJ0aCBzdXBwb3J0XG4gKiAtIDAuMi4wICgyMDI1LTAxLTI3KTogRml4ZWQgZGF0YWJhc2UgdGFibGUgcmVmZXJlbmNlcyBhbmQgZmllbGQgbWFwcGluZ3MgdG8gbWF0Y2ggYWN0dWFsIFN1cGFiYXNlIHN0cnVjdHVyZVxuICogLSAwLjEuMCAoMjAyNS0wNS0xNik6IEFkZGVkIHByb2ZpbGUgZGF0YSBmZXRjaGluZywgdXBkYXRpbmcsIGFuZCBhY2NvdW50IGRlbGV0aW9uIGZ1bmN0aW9uYWxpdHkuXG4gKiAtIDAuMC4yICgyMDI1LTA1LTE1KTogSW1wcm92ZWQgZXJyb3IgaGFuZGxpbmcgYW5kIGFkZGVkIGxvYWRpbmcgc3RhdGVzIChwcmV2aW91cyB2ZXJzaW9uaW5nIHdhcyBmdXR1cmUtZGF0ZWQpXG4gKiAtIDAuMC4xICgyMDI1LTA1LTE0KTogSW5pdGlhbCB2ZXJzaW9uIHdpdGggYmFzaWMgcHJvZmlsZSBkaXNwbGF5IGFuZCBsb2dvdXQuXG4gKi9cblxuaW1wb3J0IHtcbiAgcHJvdGVjdFBhZ2UsXG4gIHNob3dTdGF0dXMsIC8vIEFzc3VtaW5nIHRoaXMgY2FuIHRhcmdldCBzcGVjaWZpYyBlbGVtZW50c1xuICAvLyBzaG93RXJyb3IsIC8vIFdlIGNhbiB1c2Ugc2hvd1N0YXR1cyB3aXRoIHR5cGUgJ2Vycm9yJ1xuICBzaG93TG9hZGluZyxcbiAgaGlkZUxvYWRpbmcsXG59IGZyb20gXCIuL2F1dGguanNcIjsgLy8gQXNzdW1pbmcgYXV0aC5qcyBleHBvcnRzIHNob3dTdGF0dXMgdGhhdCBjYW4gdGFrZSBhbiBlbGVtZW50IElEXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gXCIuLi9zdXBhYmFzZS1jbGllbnQuanNcIjtcblxuLy8gSGVscGVyIHRvIHNob3cgc3RhdHVzIG1lc3NhZ2VzIGZvciBwcm9maWxlIGZvcm0gYW5kIGRlbGV0ZSBzZWN0aW9uXG5mdW5jdGlvbiBzaG93UHJvZmlsZVN0YXR1cyhtZXNzYWdlLCB0eXBlLCBlbGVtZW50SWQpIHtcbiAgY29uc3Qgc3RhdHVzRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XG4gIGlmIChzdGF0dXNFbGVtZW50KSB7XG4gICAgc3RhdHVzRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc05hbWUgPSBcInN0YXR1cy1tZXNzYWdlIG1hcmdpbi10b3Atc21cIjsgLy8gUmVzZXQgY2xhc3Nlc1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LmFkZCh0eXBlKTsgLy8gJ3N1Y2Nlc3MnLCAnZXJyb3InLCAnaW5mbydcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hVc2VyUHJvZmlsZSh1c2VySWQpIHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcInByb2ZpbGVzXCIpXG4gICAgLnNlbGVjdChcbiAgICAgIFwiZmlyc3RfbmFtZSwgbGFzdF9uYW1lLCBhZGRyZXNzLCBjaXR5LCBwb3N0YWxfY29kZSwgb2NjdXBhdGlvbiwgcGhvbmUsIGRhdGVfb2ZfYmlydGgsIHVwZGF0ZWRfYXRcIlxuICAgIClcbiAgICAuZXEoXCJpZFwiLCB1c2VySWQpXG4gICAgLnNpbmdsZSgpO1xuXG4gIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSBcIlBHUlNUMTE2XCIpIHtcbiAgICAvLyBQR1JTVDExNjogXCJyb3cgbm90IGZvdW5kXCJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcHJvZmlsZTpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBwb3B1bGF0ZVByb2ZpbGVGb3JtKHByb2ZpbGUpIHtcbiAgaWYgKCFwcm9maWxlKSByZXR1cm47XG5cbiAgLy8gTWFwIGRhdGFiYXNlIGZpZWxkcyB0byBIVE1MIGZvcm0gZmllbGRzIChIVE1MIHN0aWxsIHVzZXMgRnJlbmNoIGZpZWxkIG5hbWVzKVxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vbVwiKS52YWx1ZSA9IHByb2ZpbGUubGFzdF9uYW1lIHx8IFwiXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJlbm9tXCIpLnZhbHVlID0gcHJvZmlsZS5maXJzdF9uYW1lIHx8IFwiXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRyZXNzZVwiKS52YWx1ZSA9IHByb2ZpbGUuYWRkcmVzcyB8fCBcIlwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpbGxlXCIpLnZhbHVlID0gcHJvZmlsZS5jaXR5IHx8IFwiXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29kZVBvc3RhbFwiKS52YWx1ZSA9IHByb2ZpbGUucG9zdGFsX2NvZGUgfHwgXCJcIjtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvY2N1cGF0aW9uXCIpLnZhbHVlID0gcHJvZmlsZS5vY2N1cGF0aW9uIHx8IFwiXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGVsZXBob25lXCIpLnZhbHVlID0gcHJvZmlsZS5waG9uZSB8fCBcIlwiO1xuXG4gIC8vIEhhbmRsZSBkYXRlIG9mIGJpcnRoXG4gIGlmIChwcm9maWxlLmRhdGVfb2ZfYmlydGgpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRhdGVOYWlzc2FuY2VcIikudmFsdWUgPSBwcm9maWxlLmRhdGVfb2ZfYmlydGg7XG4gIH1cblxuICBjb25zdCBtZW1iZXJTaW5jZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZW1iZXJTaW5jZVwiKTtcbiAgaWYgKG1lbWJlclNpbmNlRWwgJiYgcHJvZmlsZS51cGRhdGVkX2F0KSB7XG4gICAgbWVtYmVyU2luY2VFbC50ZXh0Q29udGVudCA9IG5ldyBEYXRlKHByb2ZpbGUudXBkYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKFxuICAgICAgXCJmci1GUlwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdFByb2ZpbGVQYWdlKCkge1xuICBpZiAoIShhd2FpdCBwcm90ZWN0UGFnZSgpKSkgcmV0dXJuO1xuXG4gIGNvbnN0IHVzZXJFbWFpbEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1c2VyRW1haWxcIik7XG4gIGNvbnN0IGxvZ291dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9nb3V0QnRuXCIpO1xuICBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZUZvcm1cIik7XG4gIGNvbnN0IGRlbGV0ZUFjY291bnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0ZUFjY291bnRCdG5cIik7XG4gIGNvbnN0IG1lbWJlclNpbmNlRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lbWJlclNpbmNlXCIpO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyBzZXNzaW9uIH0sXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuICAgIGlmICghc2Vzc2lvbiB8fCAhc2Vzc2lvbi51c2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk5vIGFjdGl2ZSBzZXNzaW9uIG9yIHVzZXIuIFJlZGlyZWN0aW5nIHRvIGxvZ2luLlwiKTtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9naW4uaHRtbFwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gc2Vzc2lvbi51c2VyO1xuXG4gICAgaWYgKHVzZXJFbWFpbEVsKSB7XG4gICAgICB1c2VyRW1haWxFbC50ZXh0Q29udGVudCA9IHVzZXIuZW1haWw7XG4gICAgfVxuICAgIGlmIChtZW1iZXJTaW5jZUVsICYmIHVzZXIuY3JlYXRlZF9hdCkge1xuICAgICAgbWVtYmVyU2luY2VFbC50ZXh0Q29udGVudCA9IG5ldyBEYXRlKHVzZXIuY3JlYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKFxuICAgICAgICBcImZyLUZSXCJcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggYW5kIHBvcHVsYXRlIHByb2ZpbGVcbiAgICBzaG93TG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgIGNvbnN0IHByb2ZpbGUgPSBhd2FpdCBmZXRjaFVzZXJQcm9maWxlKHVzZXIuaWQpO1xuICAgIGlmIChwcm9maWxlKSB7XG4gICAgICBwb3B1bGF0ZVByb2ZpbGVGb3JtKHByb2ZpbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk5vIHByb2ZpbGUgZGF0YSBmb3VuZCBmb3IgdXNlciwgZm9ybSB3aWxsIGJlIGVtcHR5LlwiKTtcbiAgICB9XG4gICAgaGlkZUxvYWRpbmcoXCJzYXZlUHJvZmlsZUJ0blwiKTtcblxuICAgIGlmIChsb2dvdXRCdG4pIHtcbiAgICAgIGxvZ291dEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBzaG93TG9hZGluZyhcImxvZ291dEJ0blwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKTtcbiAgICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgICAgICAgIHNob3dQcm9maWxlU3RhdHVzKFxuICAgICAgICAgICAgXCJEw6ljb25uZXhpb24gcsOpdXNzaWUuIFJlZGlyZWN0aW9uLi4uXCIsXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIFwicHJvZmlsZUZvcm1TdGF0dXNcIlxuICAgICAgICAgICk7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNpZ25pbmcgb3V0OlwiLCBlcnJvcik7XG4gICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICBgRXJyZXVyIGRlIGTDqWNvbm5leGlvbjogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgICAgICBcImVycm9yXCIsXG4gICAgICAgICAgICBcInByb2ZpbGVGb3JtU3RhdHVzXCJcbiAgICAgICAgICApO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGhpZGVMb2FkaW5nKFwibG9nb3V0QnRuXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocHJvZmlsZUZvcm0pIHtcbiAgICAgIHByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgYXN5bmMgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzaG93TG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgICAgICBjb25zdCBwcm9maWxlU3RhdHVzRWwgPSBcInByb2ZpbGVGb3JtU3RhdHVzXCI7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb2ZpbGVTdGF0dXNFbCkuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcblxuICAgICAgICAvLyBHZXQgZm9ybSB2YWx1ZXMgYW5kIG1hcCB0byBkYXRhYmFzZSBmaWVsZHMgKHVzaW5nIEVuZ2xpc2ggY29sdW1uIG5hbWVzKVxuICAgICAgICBjb25zdCB1cGRhdGVzID0ge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGxhc3RfbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub21cIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIGZpcnN0X25hbWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJlbm9tXCIpLnZhbHVlLnRyaW0oKSxcbiAgICAgICAgICBhZGRyZXNzOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkcmVzc2VcIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIGNpdHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlsbGVcIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIHBvc3RhbF9jb2RlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvZGVQb3N0YWxcIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIG9jY3VwYXRpb246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib2NjdXBhdGlvblwiKS52YWx1ZS50cmltKCksXG4gICAgICAgICAgcGhvbmU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGVsZXBob25lXCIpLnZhbHVlLnRyaW0oKSxcbiAgICAgICAgICBkYXRlX29mX2JpcnRoOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRhdGVOYWlzc2FuY2VcIikudmFsdWUgfHwgbnVsbCxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmVtb3ZlIGVtcHR5IGZpZWxkcyB0byBhdm9pZCBjb25zdHJhaW50IHZpb2xhdGlvbnNcbiAgICAgICAgT2JqZWN0LmtleXModXBkYXRlcykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgaWYgKHVwZGF0ZXNba2V5XSA9PT0gXCJcIiAmJiBrZXkgIT09IFwiaWRcIiAmJiBrZXkgIT09IFwidXBkYXRlZF9hdFwiKSB7XG4gICAgICAgICAgICB1cGRhdGVzW2tleV0gPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKFwicHJvZmlsZXNcIikudXBzZXJ0KHVwZGF0ZXMpO1xuICAgICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICBcIlByb2ZpbCBtaXMgw6Agam91ciBhdmVjIHN1Y2PDqHMgIVwiLFxuICAgICAgICAgICAgXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICBwcm9maWxlU3RhdHVzRWxcbiAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBwcm9maWxlOlwiLCBlcnJvcik7XG4gICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICBgRXJyZXVyIGxvcnMgZGUgbGEgbWlzZSDDoCBqb3VyOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgIFwiZXJyb3JcIixcbiAgICAgICAgICAgIHByb2ZpbGVTdGF0dXNFbFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaGlkZUxvYWRpbmcoXCJzYXZlUHJvZmlsZUJ0blwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGRlbGV0ZUFjY291bnRCdG4pIHtcbiAgICAgIGRlbGV0ZUFjY291bnRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZGVsZXRlU3RhdHVzRWwgPSBcImRlbGV0ZVN0YXR1c01lc3NhZ2VcIjtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVsZXRlU3RhdHVzRWwpLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIGNvbmZpcm0oXG4gICAgICAgICAgICBcIsOKdGVzLXZvdXMgc8O7ciBkZSB2b3Vsb2lyIHN1cHByaW1lciB2b3RyZSBjb21wdGUgPyBDZXR0ZSBhY3Rpb24gZXN0IGlycsOpdmVyc2libGUgZXQgdG91dGVzIHZvcyBkb25uw6llcyBzZXJvbnQgcGVyZHVlcy5cIlxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgc2hvd0xvYWRpbmcoXCJkZWxldGVBY2NvdW50QnRuXCIpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGaXJzdCBkZWxldGUgdGhlIHByb2ZpbGVcbiAgICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IHByb2ZpbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgLmZyb20oXCJwcm9maWxlc1wiKVxuICAgICAgICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgICAgICAgLmVxKFwiaWRcIiwgdXNlci5pZCk7XG5cbiAgICAgICAgICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIHByb2ZpbGU6XCIsIHByb2ZpbGVFcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRoZW4gdHJ5IHRvIGRlbGV0ZSB0aGUgdXNlciBhY2NvdW50ICh0aGlzIG1pZ2h0IHJlcXVpcmUgYWRtaW4gcHJpdmlsZWdlcylcbiAgICAgICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcImRlbGV0ZV91c2VyX2FjY291bnRcIik7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgLy8gSWYgUlBDIGRvZXNuJ3QgZXhpc3QsIGp1c3Qgc2lnbiBvdXQgdGhlIHVzZXJcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiZGVsZXRlX3VzZXJfYWNjb3VudCBSUEMgbm90IGF2YWlsYWJsZTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKTtcbiAgICAgICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICAgICAgXCJQcm9maWwgc3VwcHJpbcOpLiBWZXVpbGxleiBjb250YWN0ZXIgbCdhZG1pbmlzdHJhdGV1ciBwb3VyIHN1cHByaW1lciBjb21wbMOodGVtZW50IHZvdHJlIGNvbXB0ZS5cIixcbiAgICAgICAgICAgICAgICBcImluZm9cIixcbiAgICAgICAgICAgICAgICBkZWxldGVTdGF0dXNFbFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICAgICAgXCJDb21wdGUgc3VwcHJpbcOpIGF2ZWMgc3VjY8Oocy4gVm91cyBhbGxleiDDqnRyZSBkw6ljb25uZWN0w6kgZXQgcmVkaXJpZ8OpLlwiLFxuICAgICAgICAgICAgICAgIFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVN0YXR1c0VsXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgICAgICAgICAgIH0sIDMwMDApO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgYWNjb3VudDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICAgIGBFcnJldXIgbG9ycyBkZSBsYSBzdXBwcmVzc2lvbiBkdSBjb21wdGU6ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgICAgICBcImVycm9yXCIsXG4gICAgICAgICAgICAgIGRlbGV0ZVN0YXR1c0VsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBoaWRlTG9hZGluZyhcImRlbGV0ZUFjY291bnRCdG5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXNlciBjYW5jZWxsZWQgYWNjb3VudCBkZWxldGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiUHJvZmlsZSBwYWdlIGluaXRpYWxpemF0aW9uIGVycm9yOlwiLCBlcnJvcik7XG4gICAgY29uc3QgbWFpbkVycm9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlRGV0YWlsc1wiKTtcbiAgICBpZiAobWFpbkVycm9yQ29udGFpbmVyKSB7XG4gICAgICBtYWluRXJyb3JDb250YWluZXIuaW5uZXJIVE1MID1cbiAgICAgICAgJzxwIGNsYXNzPVwiZXJyb3ItbWVzc2FnZVwiPkltcG9zc2libGUgZGUgY2hhcmdlciBsZXMgaW5mb3JtYXRpb25zIGR1IHByb2ZpbC4gVmV1aWxsZXogcsOpZXNzYXllciBwbHVzIHRhcmQuPC9wPic7XG4gICAgfVxuICB9XG59XG5cbi8vIEluaXRpYWxpemUgdGhlIHBhZ2Ugd2hlbiBET00gaXMgcmVhZHlcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGluaXRQcm9maWxlUGFnZSk7XG4iLCIvKipcbiAqIEhlYWRlciBBdXRoZW50aWNhdGlvbiBNb2R1bGVcbiAqIEBtb2R1bGUgaGVhZGVyLWF1dGhcbiAqIEBkZXNjcmlwdGlvbiBIYW5kbGVzIGR5bmFtaWMgaGVhZGVyIHVwZGF0ZXMgYmFzZWQgb24gYXV0aGVudGljYXRpb24gc3RhdGUgYWNyb3NzIGFsbCBwYWdlc1xuICogQHZlcnNpb24gMS4wLjBcbiAqIEBhdXRob3IgR3JleVBhbmRhXG4gKlxuICogQGNoYW5nZWxvZ1xuICogLSAxLjAuMCAoMjAyNS0wMS1YWCk6IEluaXRpYWwgdmVyc2lvbiAtIHVuaWZpZWQgaGVhZGVyIGF1dGggbWFuYWdlbWVudCBmb3IgYWxsIHBhZ2VzXG4gKi9cblxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5pbXBvcnQgKiBhcyBhdXRoTW9kdWxlIGZyb20gXCIuL2F1dGguanNcIjtcblxubGV0IGN1cnJlbnRVc2VyID0gbnVsbDtcblxuLyoqXG4gKiBVcGRhdGUgaGVhZGVyIFVJIGJhc2VkIG9uIGF1dGhlbnRpY2F0aW9uIHN0YXRlXG4gKiBAcGFyYW0ge09iamVjdHxudWxsfSB1c2VyIC0gVGhlIGF1dGhlbnRpY2F0ZWQgdXNlciBvYmplY3Qgb3IgbnVsbFxuICovXG5mdW5jdGlvbiB1cGRhdGVIZWFkZXJGb3JBdXRoU3RhdGUodXNlcikge1xuICBjdXJyZW50VXNlciA9IHVzZXI7XG5cbiAgLy8gR2V0IGhlYWRlciBlbGVtZW50cyAodGhleSBtaWdodCBub3QgZXhpc3Qgb24gYWxsIHBhZ2VzKVxuICBjb25zdCB1c2VyU3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1c2VyU3RhdHVzXCIpO1xuICBjb25zdCBsb2dpbkxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luTGlua1wiKTtcbiAgY29uc3Qgc2lnbnVwTGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2lnbnVwTGlua1wiKTtcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXRCdG5cIik7XG5cbiAgaWYgKHVzZXIpIHtcbiAgICAvLyBVc2VyIGlzIHNpZ25lZCBpbiAtIHNob3cgYXV0aGVudGljYXRlZCBzdGF0ZVxuICAgIGlmICh1c2VyU3RhdHVzKSB7XG4gICAgICB1c2VyU3RhdHVzLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgICB1c2VyU3RhdHVzLnRleHRDb250ZW50ID0gXCJWb3RyZSBjb21wdGVcIjtcbiAgICB9XG4gICAgaWYgKGxvZ2luTGluaykgbG9naW5MaW5rLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgaWYgKHNpZ251cExpbmspIHNpZ251cExpbmsuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBpZiAobG9nb3V0QnRuKSBsb2dvdXRCdG4uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcblxuICAgIGNvbnNvbGUubG9nKFwiSGVhZGVyIHVwZGF0ZWQ6IFVzZXIgaXMgYXV0aGVudGljYXRlZFwiKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBVc2VyIGlzIHNpZ25lZCBvdXQgLSBzaG93IGd1ZXN0IHN0YXRlXG4gICAgaWYgKHVzZXJTdGF0dXMpIHVzZXJTdGF0dXMuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBpZiAobG9naW5MaW5rKSBsb2dpbkxpbmsuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICBpZiAoc2lnbnVwTGluaykgc2lnbnVwTGluay5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgIGlmIChsb2dvdXRCdG4pIGxvZ291dEJ0bi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuXG4gICAgY29uc29sZS5sb2coXCJIZWFkZXIgdXBkYXRlZDogVXNlciBpcyBub3QgYXV0aGVudGljYXRlZFwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFNldHVwIGxvZ291dCBmdW5jdGlvbmFsaXR5IGZvciB0aGUgY3VycmVudCBwYWdlXG4gKi9cbmZ1bmN0aW9uIHNldHVwTG9nb3V0SGFuZGxlcigpIHtcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXRCdG5cIik7XG4gIGlmIChsb2dvdXRCdG4pIHtcbiAgICAvLyBSZW1vdmUgYW55IGV4aXN0aW5nIGxpc3RlbmVycyB0byBhdm9pZCBkdXBsaWNhdGVzXG4gICAgbG9nb3V0QnRuLnJlcGxhY2VXaXRoKGxvZ291dEJ0bi5jbG9uZU5vZGUodHJ1ZSkpO1xuXG4gICAgLy8gR2V0IHRoZSBuZXcgZWxlbWVudCBhbmQgYWRkIGV2ZW50IGxpc3RlbmVyXG4gICAgY29uc3QgbmV3TG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXRCdG5cIik7XG4gICAgbmV3TG9nb3V0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBjb25zb2xlLmxvZyhcIkxvZ291dCBpbml0aWF0ZWQgZnJvbSBoZWFkZXJcIik7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgbG9nZ2luZyBvdXQ6XCIsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgIGFsZXJ0KFwiRXJyZXVyIGxvcnMgZGUgbGEgZMOpY29ubmV4aW9uLiBWZXVpbGxleiByw6llc3NheWVyLlwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvZ291dCBzdWNjZXNzZnVsLCByZWRpcmVjdGluZyB0byBob21lXCIpO1xuICAgICAgICAgIC8vIFRoZSBvbkF1dGhTdGF0ZUNoYW5nZSB3aWxsIGhhbmRsZSB0aGUgcmVkaXJlY3QgYW5kIFVJIHVwZGF0ZXNcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkV4Y2VwdGlvbiBkdXJpbmcgbG9nb3V0OlwiLCBlcnJvcik7XG4gICAgICAgIGFsZXJ0KFwiVW5lIGVycmV1ciBpbmF0dGVuZHVlIHMnZXN0IHByb2R1aXRlIGxvcnMgZGUgbGEgZMOpY29ubmV4aW9uLlwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemUgaGVhZGVyIGF1dGhlbnRpY2F0aW9uIGZvciB0aGUgY3VycmVudCBwYWdlXG4gKiBDYWxsIHRoaXMgZnVuY3Rpb24gb24gZXZlcnkgcGFnZSB0aGF0IGhhcyBhIGhlYWRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEhlYWRlckF1dGgoKSB7XG4gIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIGhlYWRlciBhdXRoZW50aWNhdGlvbi4uLlwiKTtcblxuICAvLyBTZXR1cCBsb2dvdXQgaGFuZGxlclxuICBzZXR1cExvZ291dEhhbmRsZXIoKTtcblxuICAvLyBMaXN0ZW4gZm9yIGF1dGggc3RhdGUgY2hhbmdlc1xuICBzdXBhYmFzZS5hdXRoLm9uQXV0aFN0YXRlQ2hhbmdlKChldmVudCwgc2Vzc2lvbikgPT4ge1xuICAgIGNvbnN0IHVzZXIgPSBzZXNzaW9uPy51c2VyIHx8IG51bGw7XG5cbiAgICAvLyBVcGRhdGUgYXV0aCBtb2R1bGVcbiAgICBhdXRoTW9kdWxlLnNldEN1cnJlbnRVc2VyKHVzZXIpO1xuXG4gICAgLy8gVXBkYXRlIGhlYWRlciBVSVxuICAgIHVwZGF0ZUhlYWRlckZvckF1dGhTdGF0ZSh1c2VyKTtcblxuICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBldmVudHNcbiAgICBpZiAoZXZlbnQgPT09IFwiU0lHTkVEX09VVFwiKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkhlYWRlciBhdXRoOiBVc2VyIHNpZ25lZCBvdXQsIHJlZGlyZWN0aW5nIHRvIGhvbWVcIik7XG4gICAgICAvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgbG9nb3V0IGNvbXBsZXRlcyBwcm9wZXJseVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XG4gICAgICB9LCAxMDApO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiU0lHTkVEX0lOXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSGVhZGVyIGF1dGg6IFVzZXIgc2lnbmVkIGluXCIpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiSU5JVElBTF9TRVNTSU9OXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSGVhZGVyIGF1dGg6IEluaXRpYWwgc2Vzc2lvbiBsb2FkZWRcIik7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJUT0tFTl9SRUZSRVNIRURcIikge1xuICAgICAgY29uc29sZS5sb2coXCJIZWFkZXIgYXV0aDogVG9rZW4gcmVmcmVzaGVkXCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gU2V0IGluaXRpYWwgc3RhdGUgYmFzZWQgb24gc3RvcmVkIHVzZXIgZGF0YVxuICBjb25zdCBpbml0aWFsVXNlciA9IGF1dGhNb2R1bGUuZ2V0Q3VycmVudFVzZXIoKTtcbiAgdXBkYXRlSGVhZGVyRm9yQXV0aFN0YXRlKGluaXRpYWxVc2VyKTtcblxuICBjb25zb2xlLmxvZyhcIkhlYWRlciBhdXRoZW50aWNhdGlvbiBpbml0aWFsaXplZFwiKTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyXG4gKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9IEN1cnJlbnQgdXNlciBvYmplY3Qgb3IgbnVsbFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIoKSB7XG4gIHJldHVybiBjdXJyZW50VXNlcjtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICByZXR1cm4gY3VycmVudFVzZXIgIT09IG51bGw7XG59XG5cbi8qKlxuICogTWFudWFsbHkgdXBkYXRlIGhlYWRlciBzdGF0ZSAodXNlZnVsIGZvciB0ZXN0aW5nIG9yIHNwZWNpYWwgY2FzZXMpXG4gKiBAcGFyYW0ge09iamVjdHxudWxsfSB1c2VyIC0gVXNlciBvYmplY3Qgb3IgbnVsbFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSGVhZGVyKHVzZXIpIHtcbiAgdXBkYXRlSGVhZGVyRm9yQXV0aFN0YXRlKHVzZXIpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGluaXRIZWFkZXJBdXRoLFxuICBnZXRDdXJyZW50VXNlcixcbiAgaXNBdXRoZW50aWNhdGVkLFxuICB1cGRhdGVIZWFkZXIsXG59O1xuIiwiLy8gc3JjL2pzL3Byb2ZpbGUtcGFnZS5qcyAtIFByb2ZpbGUgcGFnZSBmdW5jdGlvbmFsaXR5XG5pbXBvcnQgeyBpbml0UHJvZmlsZVBhZ2UgfSBmcm9tIFwiLi9hdXRoL3Byb2ZpbGUuanNcIjtcbmltcG9ydCB7IGluaXRIZWFkZXJBdXRoIH0gZnJvbSBcIi4vYXV0aC9oZWFkZXItYXV0aC5qc1wiO1xuXG4vLyBJbml0aWFsaXplIGJvdGggcHJvZmlsZSBmdW5jdGlvbmFsaXR5IGFuZCBoZWFkZXIgYXV0aGVudGljYXRpb25cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgaW5pdEhlYWRlckF1dGgoKTtcbiAgaW5pdFByb2ZpbGVQYWdlKCk7XG4gIGNvbnNvbGUubG9nKFwiUHJvZmlsZSBwYWdlIGFuZCBoZWFkZXIgYXV0aGVudGljYXRpb24gaW5pdGlhbGl6ZWRcIik7XG59KTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gKGNodW5rSWQpID0+IHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcImpzL1wiICsgY2h1bmtJZCArIFwiLmJ1bmRsZS5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJ2YXIgc2NyaXB0VXJsO1xuaWYgKF9fd2VicGFja19yZXF1aXJlX18uZy5pbXBvcnRTY3JpcHRzKSBzY3JpcHRVcmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcubG9jYXRpb24gKyBcIlwiO1xudmFyIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmRvY3VtZW50O1xuaWYgKCFzY3JpcHRVcmwgJiYgZG9jdW1lbnQpIHtcblx0aWYgKGRvY3VtZW50LmN1cnJlbnRTY3JpcHQgJiYgZG9jdW1lbnQuY3VycmVudFNjcmlwdC50YWdOYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdTQ1JJUFQnKVxuXHRcdHNjcmlwdFVybCA9IGRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjO1xuXHRpZiAoIXNjcmlwdFVybCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0aWYoc2NyaXB0cy5sZW5ndGgpIHtcblx0XHRcdHZhciBpID0gc2NyaXB0cy5sZW5ndGggLSAxO1xuXHRcdFx0d2hpbGUgKGkgPiAtMSAmJiAoIXNjcmlwdFVybCB8fCAhL15odHRwKHM/KTovLnRlc3Qoc2NyaXB0VXJsKSkpIHNjcmlwdFVybCA9IHNjcmlwdHNbaS0tXS5zcmM7XG5cdFx0fVxuXHR9XG59XG4vLyBXaGVuIHN1cHBvcnRpbmcgYnJvd3NlcnMgd2hlcmUgYW4gYXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCB5b3UgbXVzdCBzcGVjaWZ5IGFuIG91dHB1dC5wdWJsaWNQYXRoIG1hbnVhbGx5IHZpYSBjb25maWd1cmF0aW9uXG4vLyBvciBwYXNzIGFuIGVtcHR5IHN0cmluZyAoXCJcIikgYW5kIHNldCB0aGUgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gdmFyaWFibGUgZnJvbSB5b3VyIGNvZGUgdG8gdXNlIHlvdXIgb3duIGxvZ2ljLlxuaWYgKCFzY3JpcHRVcmwpIHRocm93IG5ldyBFcnJvcihcIkF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyXCIpO1xuc2NyaXB0VXJsID0gc2NyaXB0VXJsLnJlcGxhY2UoL15ibG9iOi8sIFwiXCIpLnJlcGxhY2UoLyMuKiQvLCBcIlwiKS5yZXBsYWNlKC9cXD8uKiQvLCBcIlwiKS5yZXBsYWNlKC9cXC9bXlxcL10rJC8sIFwiL1wiKTtcbl9fd2VicGFja19yZXF1aXJlX18ucCA9IHNjcmlwdFVybCArIFwiLi4vXCI7IiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDEzODogMFxufTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSAoY2h1bmtJZCwgcHJvbWlzZXMpID0+IHtcblx0XHQvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG5cdFx0dmFyIGluc3RhbGxlZENodW5rRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpID8gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdIDogdW5kZWZpbmVkO1xuXHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgeyAvLyAwIG1lYW5zIFwiYWxyZWFkeSBpbnN0YWxsZWRcIi5cblxuXHRcdFx0Ly8gYSBQcm9taXNlIG1lYW5zIFwiY3VycmVudGx5IGxvYWRpbmdcIi5cblx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZih0cnVlKSB7IC8vIGFsbCBjaHVua3MgaGF2ZSBKU1xuXHRcdFx0XHRcdC8vIHNldHVwIFByb21pc2UgaW4gY2h1bmsgY2FjaGVcblx0XHRcdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IChpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XSkpO1xuXHRcdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSk7XG5cblx0XHRcdFx0XHQvLyBzdGFydCBjaHVuayBsb2FkaW5nXG5cdFx0XHRcdFx0dmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18ucCArIF9fd2VicGFja19yZXF1aXJlX18udShjaHVua0lkKTtcblx0XHRcdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cdFx0XHRcdFx0dmFyIGxvYWRpbmdFbmRlZCA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkpIHtcblx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9IGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmVhbFNyYyA9IGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuc3JjO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPSAnTG9hZGluZyBjaHVuayAnICsgY2h1bmtJZCArICcgZmFpbGVkLlxcbignICsgZXJyb3JUeXBlICsgJzogJyArIHJlYWxTcmMgKyAnKSc7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IudHlwZSA9IGVycm9yVHlwZTtcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmwodXJsLCBsb2FkaW5nRW5kZWQsIFwiY2h1bmstXCIgKyBjaHVua0lkLCBjaHVua0lkKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cbn07XG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbl9fd2VicGFja19yZXF1aXJlX18uTy5qID0gKGNodW5rSWQpID0+IChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPT09IDApO1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDA7XG5cdGlmKGNodW5rSWRzLnNvbWUoKGlkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMCkpKSB7XG5cdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0fVxuXHRpZihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uTyhyZXN1bHQpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzMwM10sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDMzMSkpKVxuX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiJdLCJuYW1lcyI6WyJkZWZlcnJlZCIsImxlYWZQcm90b3R5cGVzIiwiZ2V0UHJvdG8iLCJpblByb2dyZXNzIiwiZGF0YVdlYnBhY2tQcmVmaXgiLCJzdXBhYmFzZSIsImN1cnJlbnRVc2VyIiwic2Vzc2lvblZhbGlkYXRlZCIsInNldEN1cnJlbnRVc2VyIiwidXNlciIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwicmVtb3ZlSXRlbSIsImFzeW5jIiwidmFsaWRhdGVTZXNzaW9uIiwiZGF0YSIsInNlc3Npb24iLCJlcnJvciIsInNlc3Npb25FcnJvciIsImF1dGgiLCJnZXRTZXNzaW9uIiwiY29uc29sZSIsImxvZyIsInJlZnJlc2hFcnJvciIsInJlZnJlc2hTZXNzaW9uIiwid2FybiIsInNpZ25PdXQiLCJlIiwic2hvd0xvYWRpbmciLCJidXR0b25JZCIsInNwaW5uZXJJZCIsImJ1dHRvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcGlubmVyIiwiZGlzYWJsZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJoaWRlTG9hZGluZyIsImFkZCIsInNob3dQcm9maWxlU3RhdHVzIiwibWVzc2FnZSIsInR5cGUiLCJlbGVtZW50SWQiLCJzdGF0dXNFbGVtZW50IiwidGV4dENvbnRlbnQiLCJjbGFzc05hbWUiLCJpbml0UHJvZmlsZVBhZ2UiLCJyZWRpcmVjdFVybCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsInByb3RlY3RQYWdlIiwidXNlckVtYWlsRWwiLCJsb2dvdXRCdG4iLCJwcm9maWxlRm9ybSIsImRlbGV0ZUFjY291bnRCdG4iLCJtZW1iZXJTaW5jZUVsIiwiZW1haWwiLCJjcmVhdGVkX2F0IiwiRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInByb2ZpbGUiLCJ1c2VySWQiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjb2RlIiwiZmV0Y2hVc2VyUHJvZmlsZSIsImlkIiwidmFsdWUiLCJsYXN0X25hbWUiLCJmaXJzdF9uYW1lIiwiYWRkcmVzcyIsImNpdHkiLCJwb3N0YWxfY29kZSIsIm9jY3VwYXRpb24iLCJwaG9uZSIsImRhdGVfb2ZfYmlydGgiLCJ1cGRhdGVkX2F0IiwicG9wdWxhdGVQcm9maWxlRm9ybSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRUaW1lb3V0IiwicHJldmVudERlZmF1bHQiLCJwcm9maWxlU3RhdHVzRWwiLCJ1cGRhdGVzIiwidHJpbSIsInRvSVNPU3RyaW5nIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJ1cHNlcnQiLCJkZWxldGVTdGF0dXNFbCIsImNvbmZpcm0iLCJwcm9maWxlRXJyb3IiLCJkZWxldGUiLCJycGMiLCJtYWluRXJyb3JDb250YWluZXIiLCJpbm5lckhUTUwiLCJ1cGRhdGVIZWFkZXJGb3JBdXRoU3RhdGUiLCJ1c2VyU3RhdHVzIiwibG9naW5MaW5rIiwic2lnbnVwTGluayIsImluaXRIZWFkZXJBdXRoIiwicmVwbGFjZVdpdGgiLCJjbG9uZU5vZGUiLCJhbGVydCIsInNldHVwTG9nb3V0SGFuZGxlciIsIm9uQXV0aFN0YXRlQ2hhbmdlIiwiZXZlbnQiLCJ2YWxpZGF0ZSIsInN0b3JlZFVzZXIiLCJnZXRJdGVtIiwicGFyc2UiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJtIiwiTyIsInJlc3VsdCIsImNodW5rSWRzIiwiZm4iLCJwcmlvcml0eSIsIm5vdEZ1bGZpbGxlZCIsIkluZmluaXR5IiwiaSIsImxlbmd0aCIsImZ1bGZpbGxlZCIsImoiLCJldmVyeSIsInNwbGljZSIsInIiLCJnZXRQcm90b3R5cGVPZiIsIm9iaiIsInQiLCJtb2RlIiwidGhpcyIsIl9fZXNNb2R1bGUiLCJ0aGVuIiwibnMiLCJjcmVhdGUiLCJkZWYiLCJjdXJyZW50IiwiaW5kZXhPZiIsImdldE93blByb3BlcnR5TmFtZXMiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJmIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwibCIsInVybCIsImRvbmUiLCJwdXNoIiwic2NyaXB0IiwibmVlZEF0dGFjaCIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInMiLCJnZXRBdHRyaWJ1dGUiLCJjcmVhdGVFbGVtZW50IiwiY2hhcnNldCIsInRpbWVvdXQiLCJuYyIsInNldEF0dHJpYnV0ZSIsInNyYyIsIm9uU2NyaXB0Q29tcGxldGUiLCJwcmV2Iiwib25lcnJvciIsIm9ubG9hZCIsImNsZWFyVGltZW91dCIsImRvbmVGbnMiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJiaW5kIiwidGFyZ2V0IiwiaGVhZCIsImFwcGVuZENoaWxkIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJzY3JpcHRVcmwiLCJpbXBvcnRTY3JpcHRzIiwiY3VycmVudFNjcmlwdCIsInRhZ05hbWUiLCJ0b1VwcGVyQ2FzZSIsInRlc3QiLCJFcnJvciIsInJlcGxhY2UiLCJwIiwiaW5zdGFsbGVkQ2h1bmtzIiwiaW5zdGFsbGVkQ2h1bmtEYXRhIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnJvclR5cGUiLCJyZWFsU3JjIiwibmFtZSIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==