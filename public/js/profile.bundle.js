(()=>{"use strict";var e,t,o,r,n,i={331:(e,t,o)=>{const r=(0,o(303).UU)("https://ofeyssipibktmbfebibo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mZXlzc2lwaWJrdG1iZmViaWJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM5MjUwOTQsImV4cCI6MjA1OTUwMTA5NH0.w71CAKfolktzRl-TmLVhHYaEbhCfVk4A7YraEUCglrU");let n=null,i=!1;function a(e){n=e,e?localStorage.setItem("currentUser",JSON.stringify(e)):localStorage.removeItem("currentUser")}async function s(){try{const{data:{session:e},error:t}=await r.auth.getSession();if(t||!e)return console.log("No valid session found"),a(null),i=!1,!1;const{error:o}=await r.auth.refreshSession();return o?(console.warn("Session validation failed:",o),await r.auth.signOut(),a(null),i=!1,!1):(a(e.user),i=!0,!0)}catch(e){return console.error("Session validation error:",e),a(null),i=!1,!1}}function l(e,t){const o=document.getElementById(e),r=document.getElementById(t);o&&(o.disabled=!0),r&&r.classList.remove("hidden")}function c(e,t){const o=document.getElementById(e),r=document.getElementById(t);o&&(o.disabled=!1),r&&r.classList.add("hidden")}function d(e,t,o){const r=document.getElementById(o);r&&(r.textContent=e,r.className="status-message margin-top-sm",r.classList.add(t),r.classList.remove("hidden"))}async function u(){if(!await async function(e="/login"){return!!await s()||(window.location.href=e,!1)}())return;const e=document.getElementById("userEmail"),t=document.getElementById("logoutBtn"),o=document.getElementById("profileForm"),n=document.getElementById("deleteAccountBtn"),i=document.getElementById("memberSince");try{const{data:{session:a}}=await r.auth.getSession();if(!a||!a.user)return console.log("No active session or user. Redirecting to login."),void(window.location.href="/");const s=a.user;e&&(e.textContent=s.email),i&&s.created_at&&(i.textContent=new Date(s.created_at).toLocaleDateString("fr-FR")),l("saveProfileBtn");const u=await async function(e){const{data:t,error:o}=await r.from("profiles").select("first_name, last_name, phone, updated_at").eq("id",e).single();if(o&&"PGRST116"!==o.code)throw console.error("Error fetching profile:",o),o;return t}(s.id);u?function(e){if(!e)return;document.getElementById("nom").value=e.last_name||"",document.getElementById("prenom").value=e.first_name||"",document.getElementById("telephone").value=e.phone||"",e.date_of_birth&&(document.getElementById("dateNaissance").value=e.date_of_birth);const t=document.getElementById("memberSince");t&&e.updated_at&&(t.textContent=new Date(e.updated_at).toLocaleDateString("fr-FR"))}(u):console.log("No profile data found for user, form will be empty."),c("saveProfileBtn"),t&&t.addEventListener("click",(async()=>{l("logoutBtn");try{const{error:e}=await r.auth.signOut();if(e)throw e;d("Déconnexion réussie. Redirection...","success","profileFormStatus"),setTimeout((()=>{window.location.href="/"}),200)}catch(e){console.error("Error signing out:",e),d(`Erreur de déconnexion: ${e.message}`,"error","profileFormStatus")}finally{c("logoutBtn")}})),o&&o.addEventListener("submit",(async e=>{e.preventDefault(),l("saveProfileBtn");const t="profileFormStatus";document.getElementById(t).classList.add("hidden");const o={id:s.id,last_name:document.getElementById("nom").value.trim(),first_name:document.getElementById("prenom").value.trim(),phone:document.getElementById("telephone").value.trim(),updated_at:(new Date).toISOString()};Object.keys(o).forEach((e=>{""===o[e]&&"id"!==e&&"updated_at"!==e&&(o[e]=null)}));try{const{error:e}=await r.from("profiles").upsert(o);if(e)throw e;d("Profil mis à jour avec succès !","success",t)}catch(e){console.error("Error updating profile:",e),d(`Erreur lors de la mise à jour: ${e.message}`,"error",t)}finally{c("saveProfileBtn")}})),n&&n.addEventListener("click",(async()=>{const e="deleteStatusMessage";if(document.getElementById(e).classList.add("hidden"),confirm("Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible et toutes vos données seront perdues.")){l("deleteAccountBtn");try{const{error:t}=await r.from("profiles").delete().eq("id",s.id);t&&console.error("Error deleting profile:",t);const{error:o}=await r.rpc("delete_user_account");o?(console.warn("delete_user_account RPC not available:",o),await r.auth.signOut(),d("Profil supprimé. Veuillez contacter l'administrateur pour supprimer complètement votre compte.","info",e)):(d("Compte supprimé avec succès. Vous allez être déconnecté et redirigé.","success",e),await r.auth.signOut()),setTimeout((()=>{window.location.href="/"}),3e3)}catch(t){console.error("Error deleting account:",t),d(`Erreur lors de la suppression du compte: ${t.message}`,"error",e)}finally{c("deleteAccountBtn")}}else console.log("User cancelled account deletion.")}))}catch(e){console.error("Profile page initialization error:",e);const t=document.getElementById("profileDetails");t&&(t.innerHTML='<p class="error-message">Impossible de charger les informations du profil. Veuillez réessayer plus tard.</p>')}}document.addEventListener("DOMContentLoaded",u);let m=null;function f(e){m=e;const t=document.getElementById("userStatus"),o=document.getElementById("loginLink"),r=document.getElementById("signupLink"),n=document.getElementById("logoutBtn");e?(t&&(t.classList.remove("hidden"),t.textContent="Votre compte"),o&&o.classList.add("hidden"),r&&r.classList.add("hidden"),n&&n.classList.remove("hidden"),console.log("Header updated: User is authenticated")):(t&&t.classList.add("hidden"),o&&o.classList.remove("hidden"),r&&r.classList.remove("hidden"),n&&n.classList.add("hidden"),console.log("Header updated: User is not authenticated"))}function g(){console.log("Initializing header authentication..."),function(){const e=document.getElementById("logoutBtn");e&&(e.replaceWith(e.cloneNode(!0)),document.getElementById("logoutBtn").addEventListener("click",(async e=>{e.preventDefault(),console.log("Logout initiated from header");try{const{error:e}=await r.auth.signOut();e?(console.error("Error logging out:",e.message),alert("Erreur lors de la déconnexion. Veuillez réessayer.")):console.log("Logout successful, redirecting to home")}catch(e){console.error("Exception during logout:",e),alert("Une erreur inattendue s'est produite lors de la déconnexion.")}})))}(),r.auth.onAuthStateChange(((e,t)=>{const o=t?.user||null;a(o),f(o),"SIGNED_OUT"===e?(console.log("Header auth: User signed out, redirecting to home"),setTimeout((()=>{window.location.href="/"}),100)):"SIGNED_IN"===e?console.log("Header auth: User signed in"):"INITIAL_SESSION"===e?console.log("Header auth: Initial session loaded"):"TOKEN_REFRESHED"===e&&console.log("Header auth: Token refreshed")})),f(async function(e=!0){if(e&&!i&&await s(),!e&&!n){const e=localStorage.getItem("currentUser");if(e)try{n=JSON.parse(e)}catch(e){console.error("Error retrieving user:",e),localStorage.removeItem("currentUser")}}return n}()),console.log("Header authentication initialized")}document.addEventListener("DOMContentLoaded",(()=>{g(),u(),console.log("Profile page and header authentication initialized")}))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return i[e].call(o.exports,o,o.exports,s),o.exports}s.m=i,e=[],s.O=(t,o,r,n)=>{if(!o){var i=1/0;for(d=0;d<e.length;d++){for(var[o,r,n]=e[d],a=!0,l=0;l<o.length;l++)(!1&n||i>=n)&&Object.keys(s.O).every((e=>s.O[e](o[l])))?o.splice(l--,1):(a=!1,n<i&&(i=n));if(a){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,r,n]},o=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var n=Object.create(null);s.r(n);var i={};t=t||[null,o({}),o([]),o(o)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=o(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(n,i),n},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"js/"+e+".bundle.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},n="urbandocs_webapp:",s.l=(e,t,o,i)=>{if(r[e])r[e].push(t);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+o){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",n+o),a.src=e),r[e]=[t];var m=(t,o)=>{a.onerror=a.onload=null,clearTimeout(f);var n=r[e];if(delete r[e],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((e=>e(o))),t)return t(o)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=m.bind(null,a.onerror),a.onload=m.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../"})(),(()=>{var e={138:0};s.f.j=(t,o)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var n=new Promise(((o,n)=>r=e[t]=[o,n]));o.push(r[2]=n);var i=s.p+s.u(t),a=new Error;s.l(i,(o=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",a.name="ChunkLoadError",a.type=n,a.request=i,r[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,o)=>{var r,n,[i,a,l]=o,c=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var d=l(s)}for(t&&t(o);c<i.length;c++)n=i[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(d)},o=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var l=s.O(void 0,[303],(()=>s(331)));l=s.O(l)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZWQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY3JlYXRlIGZha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9sb2FkIHNjcmlwdCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL3N1cGFiYXNlLWNsaWVudC5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2F1dGgvYXV0aC5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2F1dGgvcHJvZmlsZS5qcyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwLy4vc3JjL2pzL2F1dGgvaGVhZGVyLWF1dGguanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9wcm9maWxlLXBhZ2UuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWZlcnJlZCA9IFtdO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5PID0gKHJlc3VsdCwgY2h1bmtJZHMsIGZuLCBwcmlvcml0eSkgPT4ge1xuXHRpZihjaHVua0lkcykge1xuXHRcdHByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcblx0XHRmb3IodmFyIGkgPSBkZWZlcnJlZC5sZW5ndGg7IGkgPiAwICYmIGRlZmVycmVkW2kgLSAxXVsyXSA+IHByaW9yaXR5OyBpLS0pIGRlZmVycmVkW2ldID0gZGVmZXJyZWRbaSAtIDFdO1xuXHRcdGRlZmVycmVkW2ldID0gW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldO1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgbm90RnVsZmlsbGVkID0gSW5maW5pdHk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWQubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgW2NodW5rSWRzLCBmbiwgcHJpb3JpdHldID0gZGVmZXJyZWRbaV07XG5cdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBjaHVua0lkcy5sZW5ndGg7IGorKykge1xuXHRcdFx0aWYgKChwcmlvcml0eSAmIDEgPT09IDAgfHwgbm90RnVsZmlsbGVkID49IHByaW9yaXR5KSAmJiBPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLk8pLmV2ZXJ5KChrZXkpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fLk9ba2V5XShjaHVua0lkc1tqXSkpKSkge1xuXHRcdFx0XHRjaHVua0lkcy5zcGxpY2Uoai0tLCAxKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZ1bGZpbGxlZCA9IGZhbHNlO1xuXHRcdFx0XHRpZihwcmlvcml0eSA8IG5vdEZ1bGZpbGxlZCkgbm90RnVsZmlsbGVkID0gcHJpb3JpdHk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWQuc3BsaWNlKGktLSwgMSlcblx0XHRcdHZhciByID0gZm4oKTtcblx0XHRcdGlmIChyICE9PSB1bmRlZmluZWQpIHJlc3VsdCA9IHI7XG5cdFx0fVxuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59OyIsInZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiA/IChvYmopID0+IChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkgOiAob2JqKSA9PiAob2JqLl9fcHJvdG9fXyk7XG52YXIgbGVhZlByb3RvdHlwZXM7XG4vLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3Rcbi8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuLy8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3Rcbi8vIG1vZGUgJiAxNjogcmV0dXJuIHZhbHVlIHdoZW4gaXQncyBQcm9taXNlLWxpa2Vcbi8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbl9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG5cdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IHRoaXModmFsdWUpO1xuXHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuXHRpZih0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlKSB7XG5cdFx0aWYoKG1vZGUgJiA0KSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG5cdFx0aWYoKG1vZGUgJiAxNikgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicpIHJldHVybiB2YWx1ZTtcblx0fVxuXHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuXHR2YXIgZGVmID0ge307XG5cdGxlYWZQcm90b3R5cGVzID0gbGVhZlByb3RvdHlwZXMgfHwgW251bGwsIGdldFByb3RvKHt9KSwgZ2V0UHJvdG8oW10pLCBnZXRQcm90byhnZXRQcm90byldO1xuXHRmb3IodmFyIGN1cnJlbnQgPSBtb2RlICYgMiAmJiB2YWx1ZTsgdHlwZW9mIGN1cnJlbnQgPT0gJ29iamVjdCcgJiYgIX5sZWFmUHJvdG90eXBlcy5pbmRleE9mKGN1cnJlbnQpOyBjdXJyZW50ID0gZ2V0UHJvdG8oY3VycmVudCkpIHtcblx0XHRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IChkZWZba2V5XSA9ICgpID0+ICh2YWx1ZVtrZXldKSkpO1xuXHR9XG5cdGRlZlsnZGVmYXVsdCddID0gKCkgPT4gKHZhbHVlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBkZWYpO1xuXHRyZXR1cm4gbnM7XG59OyIsInZhciBpblByb2dyZXNzID0ge307XG52YXIgZGF0YVdlYnBhY2tQcmVmaXggPSBcInVyYmFuZG9jc193ZWJhcHA6XCI7XG4vLyBsb2FkU2NyaXB0IGZ1bmN0aW9uIHRvIGxvYWQgYSBzY3JpcHQgdmlhIHNjcmlwdCB0YWdcbl9fd2VicGFja19yZXF1aXJlX18ubCA9ICh1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkgPT4ge1xuXHRpZihpblByb2dyZXNzW3VybF0pIHsgaW5Qcm9ncmVzc1t1cmxdLnB1c2goZG9uZSk7IHJldHVybjsgfVxuXHR2YXIgc2NyaXB0LCBuZWVkQXR0YWNoO1xuXHRpZihrZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBzID0gc2NyaXB0c1tpXTtcblx0XHRcdGlmKHMuZ2V0QXR0cmlidXRlKFwic3JjXCIpID09IHVybCB8fCBzLmdldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiKSA9PSBkYXRhV2VicGFja1ByZWZpeCArIGtleSkgeyBzY3JpcHQgPSBzOyBicmVhazsgfVxuXHRcdH1cblx0fVxuXHRpZighc2NyaXB0KSB7XG5cdFx0bmVlZEF0dGFjaCA9IHRydWU7XG5cdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cblx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG5cdFx0c2NyaXB0LnRpbWVvdXQgPSAxMjA7XG5cdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubmMpIHtcblx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcblx0XHR9XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiLCBkYXRhV2VicGFja1ByZWZpeCArIGtleSk7XG5cblx0XHRzY3JpcHQuc3JjID0gdXJsO1xuXHR9XG5cdGluUHJvZ3Jlc3NbdXJsXSA9IFtkb25lXTtcblx0dmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpID0+IHtcblx0XHQvLyBhdm9pZCBtZW0gbGVha3MgaW4gSUUuXG5cdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcblx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0dmFyIGRvbmVGbnMgPSBpblByb2dyZXNzW3VybF07XG5cdFx0ZGVsZXRlIGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRzY3JpcHQucGFyZW50Tm9kZSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdGRvbmVGbnMgJiYgZG9uZUZucy5mb3JFYWNoKChmbikgPT4gKGZuKGV2ZW50KSkpO1xuXHRcdGlmKHByZXYpIHJldHVybiBwcmV2KGV2ZW50KTtcblx0fVxuXHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQob25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHVuZGVmaW5lZCwgeyB0eXBlOiAndGltZW91dCcsIHRhcmdldDogc2NyaXB0IH0pLCAxMjAwMDApO1xuXHRzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG5cdHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG5cdG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xufTsiLCIvLyBzcmMvanMvc3VwYWJhc2UtY2xpZW50LmpzXG4vKipcbiAqIFN1cGFiYXNlIENsaWVudFxuICogQG1vZHVsZSBzdXBhYmFzZS1jbGllbnRcbiAqIEBkZXNjcmlwdGlvbiBUaGlzIG1vZHVsZSBoYW5kbGVzIHRoZSBTdXBhYmFzZSBjbGllbnQgaW5pdGlhbGl6YXRpb24gYW5kIGNvbmZpZ3VyYXRpb24uXG4gKiBAdmVyc2lvbiAwLjAuMlxuICogQGF1dGhvciBHcmV5UGFuZGFcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMC4yICgyMDI1LTA1LTI3KTogQWRkZWQgZW52aXJvbmVtZW50IHZhcmlhYmxlcyBlcnJvciBoYW5kbGluZyBmb3IgbWlzc2luZy5cbiAqIC0gMC4wLjEgKDIwMjUtMDUtMDkpOiBJbml0aWFsIHZlcnNpb24gd2l0aCBiYXNpYyBTdXBhYmFzZSBjbGllbnQgaW5pdGlhbGl6YXRpb24uXG4gKi9cblxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IFwiaHR0cHM6Ly9vZmV5c3NpcGlia3RtYmZlYmliby5zdXBhYmFzZS5jb1wiO1xuY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID1cbiAgXCJleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKcGMzTWlPaUp6ZFhCaFltRnpaU0lzSW5KbFppSTZJbTltWlhsemMybHdhV0pyZEcxaVptVmlhV0p2SWl3aWNtOXNaU0k2SW1GdWIyNGlMQ0pwWVhRaU9qRTNORE01TWpVd09UUXNJbVY0Y0NJNk1qQTFPVFV3TVRBNU5IMC53NzFDQUtmb2xrdHpSbC1UbUxWaEhZYUViaENmVms0QTdZcmFFVUNnbHJVXCI7XG5cbmlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlQW5vbktleSkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIFN1cGFiYXNlIGVudmlyb25tZW50IHZhcmlhYmxlc1wiKTtcbn1cblxuY29uc3QgY2xpZW50ID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xuXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjbGllbnQ7XG4iLCIvLyBzcmMvYXV0aC9hdXRoLmpzXG4vKipcbiAqIEF1dGhlbnRpY2F0aW9uIE1vZHVsZSAtIEJhc2VcbiAqIEBtb2R1bGUgYXV0aFxuICogQGRlc2NyaXB0aW9uIEJhc2UgbW9kdWxlIGZvciBhdXRoZW50aWNhdGlvbiB3aXRoIGNvbW1vbiBmdW5jdGlvbnMgYW5kIGNvbmZpZ3VyYXRpb25cbiAqIEB2ZXJzaW9uIDAuMC41XG4gKlxuICogQGNoYW5nZWxvZ1xuICogLSAwLjAuNSAoMjAyNS0wNS0xNSk6IEFkZGVkIHNlc3Npb24gdmFsaWRhdGlvbiBhbmQgcHJvdGVjdGlvbiBhZ2FpbnN0IHN0YWxlIHNlc3Npb25zLlxuICogLSAwLjAuNCAoMjAyNS0wNS0xNSk6IFJlbW92YWwgb2YgRmlyZWJhc2UgQ2xvdWQgRnVuY3Rpb25zIGNvbnN0YW50cy5cbiAqIC0gMC4wLjMgKDIwMjUtMDUtMTMpOiBNb2RpZmllZCB0aGUgYXV0aGVudGljYXRpb24gc3RhdGUgbWFuYWdlbWVudCB0byB1c2UgU3VwYWJhc2UgQXV0aCBzeXN0ZW0uXG4gKiAtIDAuMC4yICgyMDI1LTA1LTEzKTogUmVvcmdhbml6YXRpb24gaW50byBzZXBhcmF0ZSBtb2R1bGVzXG4gKiAtIDAuMC4xICgyMDI1LTA1LTAzKTogSW5pdGlhbCBjcmVhdGlvblxuICovXG5cbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4uL3N1cGFiYXNlLWNsaWVudC5qc1wiO1xuXG4vLyBHbG9iYWwgYXV0aGVudGljYXRpb24gc3RhdGVcbmxldCBjdXJyZW50VXNlciA9IG51bGw7XG5sZXQgc2Vzc2lvblZhbGlkYXRlZCA9IGZhbHNlO1xuXG4vKipcbiAqIFNldHMgdGhlIGN1cnJlbnQgdXNlclxuICogQHBhcmFtIHtPYmplY3R9IHVzZXIgLSBVc2VyIGRhdGFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEN1cnJlbnRVc2VyKHVzZXIpIHtcbiAgY3VycmVudFVzZXIgPSB1c2VyO1xuICAvLyBQb3NzaWJsZSBzdG9yYWdlIGluIGxvY2FsU3RvcmFnZS9zZXNzaW9uU3RvcmFnZVxuICBpZiAodXNlcikge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudFVzZXJcIiwgSlNPTi5zdHJpbmdpZnkodXNlcikpO1xuICB9IGVsc2Uge1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gIH1cbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgaWYgdGhlIGN1cnJlbnQgc2Vzc2lvbiBpcyBhY3RpdmUgd2l0aCBTdXBhYmFzZVxuICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IFRydWUgaWYgc2Vzc2lvbiBpcyB2YWxpZCwgZmFsc2Ugb3RoZXJ3aXNlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVNlc3Npb24oKSB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IGN1cnJlbnQgc2Vzc2lvbiBmcm9tIFN1cGFiYXNlXG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyBzZXNzaW9uIH0sXG4gICAgICBlcnJvcjogc2Vzc2lvbkVycm9yLFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcblxuICAgIC8vIE5vIHNlc3Npb24gb3IgZXJyb3IgcmV0cmlldmluZyBzZXNzaW9uXG4gICAgaWYgKHNlc3Npb25FcnJvciB8fCAhc2Vzc2lvbikge1xuICAgICAgY29uc29sZS5sb2coXCJObyB2YWxpZCBzZXNzaW9uIGZvdW5kXCIpO1xuICAgICAgc2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gVHJ5IHRvIHJlZnJlc2ggdGhlIHRva2VuIHRvIHZhbGlkYXRlIGl0IHdpdGggdGhlIHNlcnZlclxuICAgIGNvbnN0IHsgZXJyb3I6IHJlZnJlc2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5yZWZyZXNoU2Vzc2lvbigpO1xuXG4gICAgaWYgKHJlZnJlc2hFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwiU2Vzc2lvbiB2YWxpZGF0aW9uIGZhaWxlZDpcIiwgcmVmcmVzaEVycm9yKTtcbiAgICAgIC8vIEZvcmNlIGNsZWFyIHRoZSBpbnZhbGlkIHNlc3Npb25cbiAgICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuICAgICAgc2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gU2Vzc2lvbiBpcyB2YWxpZCwgdXBkYXRlIHRoZSBjdXJyZW50IHVzZXJcbiAgICBzZXRDdXJyZW50VXNlcihzZXNzaW9uLnVzZXIpO1xuICAgIHNlc3Npb25WYWxpZGF0ZWQgPSB0cnVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNlc3Npb24gdmFsaWRhdGlvbiBlcnJvcjpcIiwgZSk7XG4gICAgc2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgc2Vzc2lvblZhbGlkYXRlZCA9IGZhbHNlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCB1c2VyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHZhbGlkYXRlIC0gV2hldGhlciB0byB2YWxpZGF0ZSB0aGUgc2Vzc2lvbiB3aXRoIFN1cGFiYXNlXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3R8bnVsbD59IFRoZSBjdXJyZW50IHVzZXIgb3IgbnVsbFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIodmFsaWRhdGUgPSB0cnVlKSB7XG4gIC8vIElmIHdlIG5lZWQgdG8gdmFsaWRhdGUgYW5kIGhhdmVuJ3QgZG9uZSBzbyB5ZXRcbiAgaWYgKHZhbGlkYXRlICYmICFzZXNzaW9uVmFsaWRhdGVkKSB7XG4gICAgYXdhaXQgdmFsaWRhdGVTZXNzaW9uKCk7XG4gIH1cblxuICAvLyBJZiBubyB2YWxpZGF0aW9uIG5lZWRlZCBvciBhbHJlYWR5IHZhbGlkYXRlZFxuICBpZiAoIXZhbGlkYXRlICYmICFjdXJyZW50VXNlcikge1xuICAgIC8vIFRyeSB0byByZXRyaWV2ZSBmcm9tIHN0b3JhZ2UgaWYgbm90IGluIG1lbW9yeVxuICAgIGNvbnN0IHN0b3JlZFVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRVc2VyXCIpO1xuICAgIGlmIChzdG9yZWRVc2VyKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjdXJyZW50VXNlciA9IEpTT04ucGFyc2Uoc3RvcmVkVXNlcik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZXRyaWV2aW5nIHVzZXI6XCIsIGUpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcImN1cnJlbnRVc2VyXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50VXNlcjtcbn1cblxuLyoqXG4gKiBTeW5jaHJvbm91cyB2ZXJzaW9uIG9mIGdldEN1cnJlbnRVc2VyIGZvciBub24tYXN5bmMgY29udGV4dHNcbiAqIFdBUk5JTkc6IFRoaXMgbWF5IHJldHVybiBzdGFsZSBkYXRhIGlmIHNlc3Npb24gaXMgaW52YWxpZFxuICogQHJldHVybnMge09iamVjdHxudWxsfSBUaGUgY3VycmVudCB1c2VyIG9yIG51bGxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyU3luYygpIHtcbiAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgIGNvbnN0IHN0b3JlZFVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRVc2VyXCIpO1xuICAgIGlmIChzdG9yZWRVc2VyKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjdXJyZW50VXNlciA9IEpTT04ucGFyc2Uoc3RvcmVkVXNlcik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZXRyaWV2aW5nIHVzZXI6XCIsIGUpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcImN1cnJlbnRVc2VyXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50VXNlcjtcbn1cblxuLyoqXG4gKiBMb2dzIG91dCB0aGUgdXNlclxuICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gIHRyeSB7XG4gICAgLy8gU2lnbiBvdXQgZnJvbSBTdXBhYmFzZVxuICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuXG4gICAgLy8gQ2xlYXIgbG9jYWwgc3RhdGVcbiAgICBjdXJyZW50VXNlciA9IG51bGw7XG4gICAgc2Vzc2lvblZhbGlkYXRlZCA9IGZhbHNlO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG5cbiAgICAvLyBSZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlIGFmdGVyIGxvZ291dFxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBsb2dvdXQ6XCIsIGVycm9yKTtcbiAgICAvLyBTdGlsbCBjbGVhciBsb2NhbCBzdGF0ZSBldmVuIGlmIFN1cGFiYXNlIHNpZ25PdXQgZmFpbHNcbiAgICBjdXJyZW50VXNlciA9IG51bGw7XG4gICAgc2Vzc2lvblZhbGlkYXRlZCA9IGZhbHNlO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiY3VycmVudFVzZXJcIik7XG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgdXNlciBpcyBsb2dnZWQgaW4gd2l0aCB2YWxpZCBzZXNzaW9uXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHZhbGlkYXRlIC0gV2hldGhlciB0byB2YWxpZGF0ZSB3aXRoIFN1cGFiYXNlIGZpcnN0XG4gKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gVHJ1ZSBpZiB0aGUgdXNlciBpcyBsb2dnZWQgaW4gd2l0aCB2YWxpZCBzZXNzaW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0xvZ2dlZEluKHZhbGlkYXRlID0gdHJ1ZSkge1xuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIodmFsaWRhdGUpO1xuICByZXR1cm4gdXNlciAhPT0gbnVsbDtcbn1cblxuLyoqXG4gKiBTeW5jaHJvbm91cyB2ZXJzaW9uIG9mIGlzTG9nZ2VkSW5cbiAqIFdBUk5JTkc6IFRoaXMgbWF5IHJldHVybiBpbmNvcnJlY3QgcmVzdWx0cyBpZiBzZXNzaW9uIGlzIGludmFsaWRcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHVzZXIgYXBwZWFycyB0byBiZSBsb2dnZWQgaW4gbG9jYWxseVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2dnZWRJblN5bmMoKSB7XG4gIHJldHVybiBnZXRDdXJyZW50VXNlclN5bmMoKSAhPT0gbnVsbDtcbn1cblxuLyoqXG4gKiBQcm90ZWN0cyBhIHBhZ2UgdGhhdCByZXF1aXJlcyBhdXRoZW50aWNhdGlvblxuICogQHBhcmFtIHtzdHJpbmd9IHJlZGlyZWN0VXJsIC0gVVJMIHRvIHJlZGlyZWN0IGlmIG5vdCBhdXRoZW50aWNhdGVkXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gVHJ1ZSBpZiBhdXRoZW50aWNhdGVkLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb3RlY3RQYWdlKHJlZGlyZWN0VXJsID0gXCIvbG9naW5cIikge1xuICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgdmFsaWRhdGVTZXNzaW9uKCk7XG5cbiAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgLy8gUmVkaXJlY3QgdG8gbG9naW4gcGFnZVxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmVkaXJlY3RVcmw7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYXV0aCBvbiBwYWdlIGxvYWRcbiAqIENhbGwgdGhpcyBhdCB0aGUgYmVnaW5uaW5nIG9mIHlvdXIgYXBwIGluaXRpYWxpemF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0QXV0aCgpIHtcbiAgLy8gVmFsaWRhdGUgc2Vzc2lvbiBvbiBwYWdlIGxvYWRcbiAgYXdhaXQgdmFsaWRhdGVTZXNzaW9uKCk7XG5cbiAgLy8gU2V0IHVwIGF1dGggc3RhdGUgY2hhbmdlIGxpc3RlbmVyXG4gIHN1cGFiYXNlLmF1dGgub25BdXRoU3RhdGVDaGFuZ2UoYXN5bmMgKGV2ZW50LCBzZXNzaW9uKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJBdXRoIHN0YXRlIGNoYW5nZWQ6XCIsIGV2ZW50KTtcblxuICAgIGlmIChldmVudCA9PT0gXCJTSUdORURfSU5cIiAmJiBzZXNzaW9uKSB7XG4gICAgICBzZXRDdXJyZW50VXNlcihzZXNzaW9uLnVzZXIpO1xuICAgICAgc2Vzc2lvblZhbGlkYXRlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJTSUdORURfT1VUXCIpIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKG51bGwpO1xuICAgICAgc2Vzc2lvblZhbGlkYXRlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IFwiVE9LRU5fUkVGUkVTSEVEXCIpIHtcbiAgICAgIHNldEN1cnJlbnRVc2VyKHNlc3Npb24udXNlcik7XG4gICAgICBzZXNzaW9uVmFsaWRhdGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBcIlVTRVJfVVBEQVRFRFwiKSB7XG4gICAgICBzZXRDdXJyZW50VXNlcihzZXNzaW9uLnVzZXIpO1xuICAgICAgc2Vzc2lvblZhbGlkYXRlZCA9IHRydWU7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBEaXNwbGF5cyBhbiBlcnJvciBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIEVycm9yIG1lc3NhZ2UgdG8gZGlzcGxheVxuICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnRJZCAtIElEIG9mIHRoZSBlbGVtZW50IHdoZXJlIHRvIGRpc3BsYXkgdGhlIGVycm9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93RXJyb3IobWVzc2FnZSwgZWxlbWVudElkID0gXCJlcnJvck1lc3NhZ2VcIikge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoZXJyb3JFbGVtZW50KSB7XG4gICAgZXJyb3JFbGVtZW50LmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGVsZW1lbnQgbm90IGZvdW5kOlwiLCBlbGVtZW50SWQpO1xuICB9XG59XG5cbi8qKlxuICogRGlzcGxheXMgYSBzdGF0dXMgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSBNZXNzYWdlIHRvIGRpc3BsYXlcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gTWVzc2FnZSB0eXBlIChzdWNjZXNzLCBpbmZvLCB3YXJuaW5nLCBkYW5nZXIpXG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgd2hlcmUgdG8gZGlzcGxheSB0aGUgbWVzc2FnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2hvd1N0YXR1cyhcbiAgbWVzc2FnZSxcbiAgdHlwZSA9IFwiaW5mb1wiLFxuICBlbGVtZW50SWQgPSBcInN0YXR1c01lc3NhZ2VcIlxuKSB7XG4gIGNvbnN0IHN0YXR1c0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoc3RhdHVzRWxlbWVudCkge1xuICAgIHN0YXR1c0VsZW1lbnQudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuXG4gICAgLy8gUmVtb3ZlIGFsbCBhbGVydC0qIGNsYXNzZXNcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTGlzdC5mb3JFYWNoKChjbGFzc05hbWUpID0+IHtcbiAgICAgIGlmIChjbGFzc05hbWUuc3RhcnRzV2l0aChcImFsZXJ0LVwiKSkge1xuICAgICAgICBzdGF0dXNFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEFkZCB0aGUgY2xhc3MgY29ycmVzcG9uZGluZyB0byB0aGUgdHlwZVxuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LmFkZChgYWxlcnQtJHt0eXBlfWApO1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU3RhdHVzIGVsZW1lbnQgbm90IGZvdW5kOlwiLCBlbGVtZW50SWQpO1xuICB9XG59XG5cbi8qKlxuICogSGlkZXMgYW4gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnRJZCAtIElEIG9mIHRoZSBlbGVtZW50IHRvIGhpZGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhpZGVFbGVtZW50KGVsZW1lbnRJZCkge1xuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudElkKTtcbiAgaWYgKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIH1cbn1cblxuLyoqXG4gKiBTaG93cyBhbiBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudElkIC0gSUQgb2YgdGhlIGVsZW1lbnQgdG8gc2hvd1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2hvd0VsZW1lbnQoZWxlbWVudElkKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfVxufVxuXG4vKipcbiAqIFNob3dzIHRoZSBsb2FkaW5nIGluZGljYXRvclxuICogQHBhcmFtIHtzdHJpbmd9IGJ1dHRvbklkIC0gSUQgb2YgdGhlIGJ1dHRvblxuICogQHBhcmFtIHtzdHJpbmd9IHNwaW5uZXJJZCAtIElEIG9mIHRoZSBzcGlubmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93TG9hZGluZyhidXR0b25JZCwgc3Bpbm5lcklkKSB7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJ1dHRvbklkKTtcbiAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNwaW5uZXJJZCk7XG5cbiAgaWYgKGJ1dHRvbikgYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgaWYgKHNwaW5uZXIpIHNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbn1cblxuLyoqXG4gKiBIaWRlcyB0aGUgbG9hZGluZyBpbmRpY2F0b3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBidXR0b25JZCAtIElEIG9mIHRoZSBidXR0b25cbiAqIEBwYXJhbSB7c3RyaW5nfSBzcGlubmVySWQgLSBJRCBvZiB0aGUgc3Bpbm5lclxuICovXG5leHBvcnQgZnVuY3Rpb24gaGlkZUxvYWRpbmcoYnV0dG9uSWQsIHNwaW5uZXJJZCkge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChidXR0b25JZCk7XG4gIGNvbnN0IHNwaW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzcGlubmVySWQpO1xuXG4gIGlmIChidXR0b24pIGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICBpZiAoc3Bpbm5lcikgc3Bpbm5lci5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xufVxuXG4vLyBFeHBvcnQgdGhlIG5lY2Vzc2FyeSBmdW5jdGlvbnMgYW5kIHZhcmlhYmxlc1xuZXhwb3J0IGRlZmF1bHQge1xuICBnZXRDdXJyZW50VXNlcixcbiAgZ2V0Q3VycmVudFVzZXJTeW5jLFxuICBzZXRDdXJyZW50VXNlcixcbiAgbG9nb3V0LFxuICBpc0xvZ2dlZEluLFxuICBpc0xvZ2dlZEluU3luYyxcbiAgdmFsaWRhdGVTZXNzaW9uLFxuICBwcm90ZWN0UGFnZSxcbiAgaW5pdEF1dGgsXG4gIHNob3dFcnJvcixcbiAgc2hvd1N0YXR1cyxcbiAgaGlkZUVsZW1lbnQsXG4gIHNob3dFbGVtZW50LFxuICBzaG93TG9hZGluZyxcbiAgaGlkZUxvYWRpbmcsXG59O1xuIiwiLy8gc3JjL2F1dGgvcHJvZmlsZS5qc1xuLyoqXG4gKiBQcm9maWxlIE1vZHVsZVxuICogQG1vZHVsZSBwcm9maWxlXG4gKiBAZGVzY3JpcHRpb24gSGFuZGxlcyB1c2VyIHByb2ZpbGUgbWFuYWdlbWVudCwgaW5jbHVkaW5nIGRhdGEgZmV0Y2hpbmcsIHVwZGF0ZXMsIGFuZCBhY2NvdW50IGRlbGV0aW9uLlxuICogQHZlcnNpb24gMC4yLjFcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMi4xICgyMDI1LTAxLTI3KTogVXBkYXRlZCB0byB1c2UgRW5nbGlzaCBjb2x1bW4gbmFtZXMgYW5kIGFkZGVkIGRhdGVfb2ZfYmlydGggc3VwcG9ydFxuICogLSAwLjIuMCAoMjAyNS0wMS0yNyk6IEZpeGVkIGRhdGFiYXNlIHRhYmxlIHJlZmVyZW5jZXMgYW5kIGZpZWxkIG1hcHBpbmdzIHRvIG1hdGNoIGFjdHVhbCBTdXBhYmFzZSBzdHJ1Y3R1cmVcbiAqIC0gMC4xLjAgKDIwMjUtMDUtMTYpOiBBZGRlZCBwcm9maWxlIGRhdGEgZmV0Y2hpbmcsIHVwZGF0aW5nLCBhbmQgYWNjb3VudCBkZWxldGlvbiBmdW5jdGlvbmFsaXR5LlxuICogLSAwLjAuMiAoMjAyNS0wNS0xNSk6IEltcHJvdmVkIGVycm9yIGhhbmRsaW5nIGFuZCBhZGRlZCBsb2FkaW5nIHN0YXRlcyAocHJldmlvdXMgdmVyc2lvbmluZyB3YXMgZnV0dXJlLWRhdGVkKVxuICogLSAwLjAuMSAoMjAyNS0wNS0xNCk6IEluaXRpYWwgdmVyc2lvbiB3aXRoIGJhc2ljIHByb2ZpbGUgZGlzcGxheSBhbmQgbG9nb3V0LlxuICovXG5cbmltcG9ydCB7XG4gIHByb3RlY3RQYWdlLFxuICBzaG93U3RhdHVzLCAvLyBBc3N1bWluZyB0aGlzIGNhbiB0YXJnZXQgc3BlY2lmaWMgZWxlbWVudHNcbiAgLy8gc2hvd0Vycm9yLCAvLyBXZSBjYW4gdXNlIHNob3dTdGF0dXMgd2l0aCB0eXBlICdlcnJvcidcbiAgc2hvd0xvYWRpbmcsXG4gIGhpZGVMb2FkaW5nLFxufSBmcm9tIFwiLi9hdXRoLmpzXCI7IC8vIEFzc3VtaW5nIGF1dGguanMgZXhwb3J0cyBzaG93U3RhdHVzIHRoYXQgY2FuIHRha2UgYW4gZWxlbWVudCBJRFxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vc3VwYWJhc2UtY2xpZW50LmpzXCI7XG5cbi8vIEhlbHBlciB0byBzaG93IHN0YXR1cyBtZXNzYWdlcyBmb3IgcHJvZmlsZSBmb3JtIGFuZCBkZWxldGUgc2VjdGlvblxuZnVuY3Rpb24gc2hvd1Byb2ZpbGVTdGF0dXMobWVzc2FnZSwgdHlwZSwgZWxlbWVudElkKSB7XG4gIGNvbnN0IHN0YXR1c0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBpZiAoc3RhdHVzRWxlbWVudCkge1xuICAgIHN0YXR1c0VsZW1lbnQudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NOYW1lID0gXCJzdGF0dXMtbWVzc2FnZSBtYXJnaW4tdG9wLXNtXCI7IC8vIFJlc2V0IGNsYXNzZXNcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTGlzdC5hZGQodHlwZSk7IC8vICdzdWNjZXNzJywgJ2Vycm9yJywgJ2luZm8nXG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoVXNlclByb2ZpbGUodXNlcklkKSB7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oXCJwcm9maWxlc1wiKVxuICAgIC5zZWxlY3QoXCJmaXJzdF9uYW1lLCBsYXN0X25hbWUsIHBob25lLCB1cGRhdGVkX2F0XCIpXG4gICAgLmVxKFwiaWRcIiwgdXNlcklkKVxuICAgIC5zaW5nbGUoKTtcblxuICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gXCJQR1JTVDExNlwiKSB7XG4gICAgLy8gUEdSU1QxMTY6IFwicm93IG5vdCBmb3VuZFwiXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gcG9wdWxhdGVQcm9maWxlRm9ybShwcm9maWxlKSB7XG4gIGlmICghcHJvZmlsZSkgcmV0dXJuO1xuXG4gIC8vIE1hcCBkYXRhYmFzZSBmaWVsZHMgdG8gSFRNTCBmb3JtIGZpZWxkcyAoSFRNTCBzdGlsbCB1c2VzIEZyZW5jaCBmaWVsZCBuYW1lcylcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub21cIikudmFsdWUgPSBwcm9maWxlLmxhc3RfbmFtZSB8fCBcIlwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByZW5vbVwiKS52YWx1ZSA9IHByb2ZpbGUuZmlyc3RfbmFtZSB8fCBcIlwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlbGVwaG9uZVwiKS52YWx1ZSA9IHByb2ZpbGUucGhvbmUgfHwgXCJcIjtcblxuICAvLyBIYW5kbGUgZGF0ZSBvZiBiaXJ0aFxuICBpZiAocHJvZmlsZS5kYXRlX29mX2JpcnRoKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYXRlTmFpc3NhbmNlXCIpLnZhbHVlID0gcHJvZmlsZS5kYXRlX29mX2JpcnRoO1xuICB9XG5cbiAgY29uc3QgbWVtYmVyU2luY2VFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVtYmVyU2luY2VcIik7XG4gIGlmIChtZW1iZXJTaW5jZUVsICYmIHByb2ZpbGUudXBkYXRlZF9hdCkge1xuICAgIG1lbWJlclNpbmNlRWwudGV4dENvbnRlbnQgPSBuZXcgRGF0ZShwcm9maWxlLnVwZGF0ZWRfYXQpLnRvTG9jYWxlRGF0ZVN0cmluZyhcbiAgICAgIFwiZnItRlJcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRQcm9maWxlUGFnZSgpIHtcbiAgaWYgKCEoYXdhaXQgcHJvdGVjdFBhZ2UoKSkpIHJldHVybjtcblxuICBjb25zdCB1c2VyRW1haWxFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXNlckVtYWlsXCIpO1xuICBjb25zdCBsb2dvdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ291dEJ0blwiKTtcbiAgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVGb3JtXCIpO1xuICBjb25zdCBkZWxldGVBY2NvdW50QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWxldGVBY2NvdW50QnRuXCIpO1xuICBjb25zdCBtZW1iZXJTaW5jZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZW1iZXJTaW5jZVwiKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgc2Vzc2lvbiB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcbiAgICBpZiAoIXNlc3Npb24gfHwgIXNlc3Npb24udXNlcikge1xuICAgICAgY29uc29sZS5sb2coXCJObyBhY3RpdmUgc2Vzc2lvbiBvciB1c2VyLiBSZWRpcmVjdGluZyB0byBsb2dpbi5cIik7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gc2Vzc2lvbi51c2VyO1xuXG4gICAgaWYgKHVzZXJFbWFpbEVsKSB7XG4gICAgICB1c2VyRW1haWxFbC50ZXh0Q29udGVudCA9IHVzZXIuZW1haWw7XG4gICAgfVxuICAgIGlmIChtZW1iZXJTaW5jZUVsICYmIHVzZXIuY3JlYXRlZF9hdCkge1xuICAgICAgbWVtYmVyU2luY2VFbC50ZXh0Q29udGVudCA9IG5ldyBEYXRlKHVzZXIuY3JlYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKFxuICAgICAgICBcImZyLUZSXCJcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggYW5kIHBvcHVsYXRlIHByb2ZpbGVcbiAgICBzaG93TG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgIGNvbnN0IHByb2ZpbGUgPSBhd2FpdCBmZXRjaFVzZXJQcm9maWxlKHVzZXIuaWQpO1xuICAgIGlmIChwcm9maWxlKSB7XG4gICAgICBwb3B1bGF0ZVByb2ZpbGVGb3JtKHByb2ZpbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk5vIHByb2ZpbGUgZGF0YSBmb3VuZCBmb3IgdXNlciwgZm9ybSB3aWxsIGJlIGVtcHR5LlwiKTtcbiAgICB9XG4gICAgaGlkZUxvYWRpbmcoXCJzYXZlUHJvZmlsZUJ0blwiKTtcblxuICAgIGlmIChsb2dvdXRCdG4pIHtcbiAgICAgIGxvZ291dEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBzaG93TG9hZGluZyhcImxvZ291dEJ0blwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25PdXQoKTtcbiAgICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgICAgICAgIHNob3dQcm9maWxlU3RhdHVzKFxuICAgICAgICAgICAgXCJEw6ljb25uZXhpb24gcsOpdXNzaWUuIFJlZGlyZWN0aW9uLi4uXCIsXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIFwicHJvZmlsZUZvcm1TdGF0dXNcIlxuICAgICAgICAgICk7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNpZ25pbmcgb3V0OlwiLCBlcnJvcik7XG4gICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICBgRXJyZXVyIGRlIGTDqWNvbm5leGlvbjogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgICAgICBcImVycm9yXCIsXG4gICAgICAgICAgICBcInByb2ZpbGVGb3JtU3RhdHVzXCJcbiAgICAgICAgICApO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGhpZGVMb2FkaW5nKFwibG9nb3V0QnRuXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocHJvZmlsZUZvcm0pIHtcbiAgICAgIHByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgYXN5bmMgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzaG93TG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgICAgICBjb25zdCBwcm9maWxlU3RhdHVzRWwgPSBcInByb2ZpbGVGb3JtU3RhdHVzXCI7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb2ZpbGVTdGF0dXNFbCkuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcblxuICAgICAgICAvLyBHZXQgZm9ybSB2YWx1ZXMgYW5kIG1hcCB0byBkYXRhYmFzZSBmaWVsZHMgKHVzaW5nIEVuZ2xpc2ggY29sdW1uIG5hbWVzKVxuICAgICAgICBjb25zdCB1cGRhdGVzID0ge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGxhc3RfbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub21cIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIGZpcnN0X25hbWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJlbm9tXCIpLnZhbHVlLnRyaW0oKSxcbiAgICAgICAgICBwaG9uZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZWxlcGhvbmVcIikudmFsdWUudHJpbSgpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBSZW1vdmUgZW1wdHkgZmllbGRzIHRvIGF2b2lkIGNvbnN0cmFpbnQgdmlvbGF0aW9uc1xuICAgICAgICBPYmplY3Qua2V5cyh1cGRhdGVzKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICBpZiAodXBkYXRlc1trZXldID09PSBcIlwiICYmIGtleSAhPT0gXCJpZFwiICYmIGtleSAhPT0gXCJ1cGRhdGVkX2F0XCIpIHtcbiAgICAgICAgICAgIHVwZGF0ZXNba2V5XSA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oXCJwcm9maWxlc1wiKS51cHNlcnQodXBkYXRlcyk7XG4gICAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgIFwiUHJvZmlsIG1pcyDDoCBqb3VyIGF2ZWMgc3VjY8OocyAhXCIsXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIHByb2ZpbGVTdGF0dXNFbFxuICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcbiAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgIGBFcnJldXIgbG9ycyBkZSBsYSBtaXNlIMOgIGpvdXI6ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgICAgXCJlcnJvclwiLFxuICAgICAgICAgICAgcHJvZmlsZVN0YXR1c0VsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBoaWRlTG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZGVsZXRlQWNjb3VudEJ0bikge1xuICAgICAgZGVsZXRlQWNjb3VudEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBkZWxldGVTdGF0dXNFbCA9IFwiZGVsZXRlU3RhdHVzTWVzc2FnZVwiO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkZWxldGVTdGF0dXNFbCkuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgY29uZmlybShcbiAgICAgICAgICAgIFwiw4p0ZXMtdm91cyBzw7tyIGRlIHZvdWxvaXIgc3VwcHJpbWVyIHZvdHJlIGNvbXB0ZSA/IENldHRlIGFjdGlvbiBlc3QgaXJyw6l2ZXJzaWJsZSBldCB0b3V0ZXMgdm9zIGRvbm7DqWVzIHNlcm9udCBwZXJkdWVzLlwiXG4gICAgICAgICAgKVxuICAgICAgICApIHtcbiAgICAgICAgICBzaG93TG9hZGluZyhcImRlbGV0ZUFjY291bnRCdG5cIik7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpcnN0IGRlbGV0ZSB0aGUgcHJvZmlsZVxuICAgICAgICAgICAgY29uc3QgeyBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbShcInByb2ZpbGVzXCIpXG4gICAgICAgICAgICAgIC5kZWxldGUoKVxuICAgICAgICAgICAgICAuZXEoXCJpZFwiLCB1c2VyLmlkKTtcblxuICAgICAgICAgICAgaWYgKHByb2ZpbGVFcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgcHJvZmlsZTpcIiwgcHJvZmlsZUVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVGhlbiB0cnkgdG8gZGVsZXRlIHRoZSB1c2VyIGFjY291bnQgKHRoaXMgbWlnaHQgcmVxdWlyZSBhZG1pbiBwcml2aWxlZ2VzKVxuICAgICAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFwiZGVsZXRlX3VzZXJfYWNjb3VudFwiKTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAvLyBJZiBSUEMgZG9lc24ndCBleGlzdCwganVzdCBzaWduIG91dCB0aGUgdXNlclxuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJkZWxldGVfdXNlcl9hY2NvdW50IFJQQyBub3QgYXZhaWxhYmxlOlwiLCBlcnJvcik7XG4gICAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuICAgICAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgICAgICBcIlByb2ZpbCBzdXBwcmltw6kuIFZldWlsbGV6IGNvbnRhY3RlciBsJ2FkbWluaXN0cmF0ZXVyIHBvdXIgc3VwcHJpbWVyIGNvbXBsw6h0ZW1lbnQgdm90cmUgY29tcHRlLlwiLFxuICAgICAgICAgICAgICAgIFwiaW5mb1wiLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVN0YXR1c0VsXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgICAgICBcIkNvbXB0ZSBzdXBwcmltw6kgYXZlYyBzdWNjw6hzLiBWb3VzIGFsbGV6IMOqdHJlIGTDqWNvbm5lY3TDqSBldCByZWRpcmlnw6kuXCIsXG4gICAgICAgICAgICAgICAgXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgZGVsZXRlU3RhdHVzRWxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL1wiO1xuICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBhY2NvdW50OlwiLCBlcnJvcik7XG4gICAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgICAgYEVycmV1ciBsb3JzIGRlIGxhIHN1cHByZXNzaW9uIGR1IGNvbXB0ZTogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgIFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgZGVsZXRlU3RhdHVzRWxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGhpZGVMb2FkaW5nKFwiZGVsZXRlQWNjb3VudEJ0blwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIGNhbmNlbGxlZCBhY2NvdW50IGRlbGV0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJQcm9maWxlIHBhZ2UgaW5pdGlhbGl6YXRpb24gZXJyb3I6XCIsIGVycm9yKTtcbiAgICBjb25zdCBtYWluRXJyb3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVEZXRhaWxzXCIpO1xuICAgIGlmIChtYWluRXJyb3JDb250YWluZXIpIHtcbiAgICAgIG1haW5FcnJvckNvbnRhaW5lci5pbm5lckhUTUwgPVxuICAgICAgICAnPHAgY2xhc3M9XCJlcnJvci1tZXNzYWdlXCI+SW1wb3NzaWJsZSBkZSBjaGFyZ2VyIGxlcyBpbmZvcm1hdGlvbnMgZHUgcHJvZmlsLiBWZXVpbGxleiByw6llc3NheWVyIHBsdXMgdGFyZC48L3A+JztcbiAgICB9XG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZSB0aGUgcGFnZSB3aGVuIERPTSBpcyByZWFkeVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgaW5pdFByb2ZpbGVQYWdlKTtcbiIsIi8qKlxuICogSGVhZGVyIEF1dGhlbnRpY2F0aW9uIE1vZHVsZVxuICogQG1vZHVsZSBoZWFkZXItYXV0aFxuICogQGRlc2NyaXB0aW9uIEhhbmRsZXMgZHluYW1pYyBoZWFkZXIgdXBkYXRlcyBiYXNlZCBvbiBhdXRoZW50aWNhdGlvbiBzdGF0ZSBhY3Jvc3MgYWxsIHBhZ2VzXG4gKiBAdmVyc2lvbiAxLjAuMFxuICogQGF1dGhvciBHcmV5UGFuZGFcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDEuMC4wICgyMDI1LTAxLVhYKTogSW5pdGlhbCB2ZXJzaW9uIC0gdW5pZmllZCBoZWFkZXIgYXV0aCBtYW5hZ2VtZW50IGZvciBhbGwgcGFnZXNcbiAqL1xuXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gXCIuLi9zdXBhYmFzZS1jbGllbnQuanNcIjtcbmltcG9ydCAqIGFzIGF1dGhNb2R1bGUgZnJvbSBcIi4vYXV0aC5qc1wiO1xuXG5sZXQgY3VycmVudFVzZXIgPSBudWxsO1xuXG4vKipcbiAqIFVwZGF0ZSBoZWFkZXIgVUkgYmFzZWQgb24gYXV0aGVudGljYXRpb24gc3RhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fG51bGx9IHVzZXIgLSBUaGUgYXV0aGVudGljYXRlZCB1c2VyIG9iamVjdCBvciBudWxsXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZUhlYWRlckZvckF1dGhTdGF0ZSh1c2VyKSB7XG4gIGN1cnJlbnRVc2VyID0gdXNlcjtcblxuICAvLyBHZXQgaGVhZGVyIGVsZW1lbnRzICh0aGV5IG1pZ2h0IG5vdCBleGlzdCBvbiBhbGwgcGFnZXMpXG4gIGNvbnN0IHVzZXJTdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXJTdGF0dXNcIik7XG4gIGNvbnN0IGxvZ2luTGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5MaW5rXCIpO1xuICBjb25zdCBzaWdudXBMaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzaWdudXBMaW5rXCIpO1xuICBjb25zdCBsb2dvdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ291dEJ0blwiKTtcblxuICBpZiAodXNlcikge1xuICAgIC8vIFVzZXIgaXMgc2lnbmVkIGluIC0gc2hvdyBhdXRoZW50aWNhdGVkIHN0YXRlXG4gICAgaWYgKHVzZXJTdGF0dXMpIHtcbiAgICAgIHVzZXJTdGF0dXMuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgIHVzZXJTdGF0dXMudGV4dENvbnRlbnQgPSBcIlZvdHJlIGNvbXB0ZVwiO1xuICAgIH1cbiAgICBpZiAobG9naW5MaW5rKSBsb2dpbkxpbmsuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBpZiAoc2lnbnVwTGluaykgc2lnbnVwTGluay5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgIGlmIChsb2dvdXRCdG4pIGxvZ291dEJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuXG4gICAgY29uc29sZS5sb2coXCJIZWFkZXIgdXBkYXRlZDogVXNlciBpcyBhdXRoZW50aWNhdGVkXCIpO1xuICB9IGVsc2Uge1xuICAgIC8vIFVzZXIgaXMgc2lnbmVkIG91dCAtIHNob3cgZ3Vlc3Qgc3RhdGVcbiAgICBpZiAodXNlclN0YXR1cykgdXNlclN0YXR1cy5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgIGlmIChsb2dpbkxpbmspIGxvZ2luTGluay5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgIGlmIChzaWdudXBMaW5rKSBzaWdudXBMaW5rLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgaWYgKGxvZ291dEJ0bikgbG9nb3V0QnRuLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG5cbiAgICBjb25zb2xlLmxvZyhcIkhlYWRlciB1cGRhdGVkOiBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXCIpO1xuICB9XG59XG5cbi8qKlxuICogU2V0dXAgbG9nb3V0IGZ1bmN0aW9uYWxpdHkgZm9yIHRoZSBjdXJyZW50IHBhZ2VcbiAqL1xuZnVuY3Rpb24gc2V0dXBMb2dvdXRIYW5kbGVyKCkge1xuICBjb25zdCBsb2dvdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ291dEJ0blwiKTtcbiAgaWYgKGxvZ291dEJ0bikge1xuICAgIC8vIFJlbW92ZSBhbnkgZXhpc3RpbmcgbGlzdGVuZXJzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcbiAgICBsb2dvdXRCdG4ucmVwbGFjZVdpdGgobG9nb3V0QnRuLmNsb25lTm9kZSh0cnVlKSk7XG5cbiAgICAvLyBHZXQgdGhlIG5ldyBlbGVtZW50IGFuZCBhZGQgZXZlbnQgbGlzdGVuZXJcbiAgICBjb25zdCBuZXdMb2dvdXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ291dEJ0blwiKTtcbiAgICBuZXdMb2dvdXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFwiTG9nb3V0IGluaXRpYXRlZCBmcm9tIGhlYWRlclwiKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduT3V0KCk7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2dnaW5nIG91dDpcIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgYWxlcnQoXCJFcnJldXIgbG9ycyBkZSBsYSBkw6ljb25uZXhpb24uIFZldWlsbGV6IHLDqWVzc2F5ZXIuXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9nb3V0IHN1Y2Nlc3NmdWwsIHJlZGlyZWN0aW5nIHRvIGhvbWVcIik7XG4gICAgICAgICAgLy8gVGhlIG9uQXV0aFN0YXRlQ2hhbmdlIHdpbGwgaGFuZGxlIHRoZSByZWRpcmVjdCBhbmQgVUkgdXBkYXRlc1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXhjZXB0aW9uIGR1cmluZyBsb2dvdXQ6XCIsIGVycm9yKTtcbiAgICAgICAgYWxlcnQoXCJVbmUgZXJyZXVyIGluYXR0ZW5kdWUgcydlc3QgcHJvZHVpdGUgbG9ycyBkZSBsYSBkw6ljb25uZXhpb24uXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBoZWFkZXIgYXV0aGVudGljYXRpb24gZm9yIHRoZSBjdXJyZW50IHBhZ2VcbiAqIENhbGwgdGhpcyBmdW5jdGlvbiBvbiBldmVyeSBwYWdlIHRoYXQgaGFzIGEgaGVhZGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0SGVhZGVyQXV0aCgpIHtcbiAgY29uc29sZS5sb2coXCJJbml0aWFsaXppbmcgaGVhZGVyIGF1dGhlbnRpY2F0aW9uLi4uXCIpO1xuXG4gIC8vIFNldHVwIGxvZ291dCBoYW5kbGVyXG4gIHNldHVwTG9nb3V0SGFuZGxlcigpO1xuXG4gIC8vIExpc3RlbiBmb3IgYXV0aCBzdGF0ZSBjaGFuZ2VzXG4gIHN1cGFiYXNlLmF1dGgub25BdXRoU3RhdGVDaGFuZ2UoKGV2ZW50LCBzZXNzaW9uKSA9PiB7XG4gICAgY29uc3QgdXNlciA9IHNlc3Npb24/LnVzZXIgfHwgbnVsbDtcblxuICAgIC8vIFVwZGF0ZSBhdXRoIG1vZHVsZVxuICAgIGF1dGhNb2R1bGUuc2V0Q3VycmVudFVzZXIodXNlcik7XG5cbiAgICAvLyBVcGRhdGUgaGVhZGVyIFVJXG4gICAgdXBkYXRlSGVhZGVyRm9yQXV0aFN0YXRlKHVzZXIpO1xuXG4gICAgLy8gSGFuZGxlIHNwZWNpZmljIGV2ZW50c1xuICAgIGlmIChldmVudCA9PT0gXCJTSUdORURfT1VUXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSGVhZGVyIGF1dGg6IFVzZXIgc2lnbmVkIG91dCwgcmVkaXJlY3RpbmcgdG8gaG9tZVwiKTtcbiAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBsb2dvdXQgY29tcGxldGVzIHByb3Blcmx5XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgICAgIH0sIDEwMCk7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJTSUdORURfSU5cIikge1xuICAgICAgY29uc29sZS5sb2coXCJIZWFkZXIgYXV0aDogVXNlciBzaWduZWQgaW5cIik7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gXCJJTklUSUFMX1NFU1NJT05cIikge1xuICAgICAgY29uc29sZS5sb2coXCJIZWFkZXIgYXV0aDogSW5pdGlhbCBzZXNzaW9uIGxvYWRlZFwiKTtcbiAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBcIlRPS0VOX1JFRlJFU0hFRFwiKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkhlYWRlciBhdXRoOiBUb2tlbiByZWZyZXNoZWRcIik7XG4gICAgfVxuICB9KTtcblxuICAvLyBTZXQgaW5pdGlhbCBzdGF0ZSBiYXNlZCBvbiBzdG9yZWQgdXNlciBkYXRhXG4gIGNvbnN0IGluaXRpYWxVc2VyID0gYXV0aE1vZHVsZS5nZXRDdXJyZW50VXNlcigpO1xuICB1cGRhdGVIZWFkZXJGb3JBdXRoU3RhdGUoaW5pdGlhbFVzZXIpO1xuXG4gIGNvbnNvbGUubG9nKFwiSGVhZGVyIGF1dGhlbnRpY2F0aW9uIGluaXRpYWxpemVkXCIpO1xufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBhdXRoZW50aWNhdGVkIHVzZXJcbiAqIEByZXR1cm5zIHtPYmplY3R8bnVsbH0gQ3VycmVudCB1c2VyIG9iamVjdCBvciBudWxsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgcmV0dXJuIGN1cnJlbnRVc2VyO1xufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gIHJldHVybiBjdXJyZW50VXNlciAhPT0gbnVsbDtcbn1cblxuLyoqXG4gKiBNYW51YWxseSB1cGRhdGUgaGVhZGVyIHN0YXRlICh1c2VmdWwgZm9yIHRlc3Rpbmcgb3Igc3BlY2lhbCBjYXNlcylcbiAqIEBwYXJhbSB7T2JqZWN0fG51bGx9IHVzZXIgLSBVc2VyIG9iamVjdCBvciBudWxsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIZWFkZXIodXNlcikge1xuICB1cGRhdGVIZWFkZXJGb3JBdXRoU3RhdGUodXNlcik7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgaW5pdEhlYWRlckF1dGgsXG4gIGdldEN1cnJlbnRVc2VyLFxuICBpc0F1dGhlbnRpY2F0ZWQsXG4gIHVwZGF0ZUhlYWRlcixcbn07XG4iLCIvLyBzcmMvanMvcHJvZmlsZS1wYWdlLmpzIC0gUHJvZmlsZSBwYWdlIGZ1bmN0aW9uYWxpdHlcbmltcG9ydCB7IGluaXRQcm9maWxlUGFnZSB9IGZyb20gXCIuL2F1dGgvcHJvZmlsZS5qc1wiO1xuaW1wb3J0IHsgaW5pdEhlYWRlckF1dGggfSBmcm9tIFwiLi9hdXRoL2hlYWRlci1hdXRoLmpzXCI7XG5cbi8vIEluaXRpYWxpemUgYm90aCBwcm9maWxlIGZ1bmN0aW9uYWxpdHkgYW5kIGhlYWRlciBhdXRoZW50aWNhdGlvblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICBpbml0SGVhZGVyQXV0aCgpO1xuICBpbml0UHJvZmlsZVBhZ2UoKTtcbiAgY29uc29sZS5sb2coXCJQcm9maWxlIHBhZ2UgYW5kIGhlYWRlciBhdXRoZW50aWNhdGlvbiBpbml0aWFsaXplZFwiKTtcbn0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwianMvXCIgKyBjaHVua0lkICsgXCIuYnVuZGxlLmpzXCI7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdCAmJiBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gJ1NDUklQVCcpXG5cdFx0c2NyaXB0VXJsID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM7XG5cdGlmICghc2NyaXB0VXJsKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRpZihzY3JpcHRzLmxlbmd0aCkge1xuXHRcdFx0dmFyIGkgPSBzY3JpcHRzLmxlbmd0aCAtIDE7XG5cdFx0XHR3aGlsZSAoaSA+IC0xICYmICghc2NyaXB0VXJsIHx8ICEvXmh0dHAocz8pOi8udGVzdChzY3JpcHRVcmwpKSkgc2NyaXB0VXJsID0gc2NyaXB0c1tpLS1dLnNyYztcblx0XHR9XG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvXmJsb2I6LywgXCJcIikucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsICsgXCIuLi9cIjsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0MTM4OiAwXG59O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuaiA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHRcdC8vIEpTT05QIGNodW5rIGxvYWRpbmcgZm9yIGphdmFzY3JpcHRcblx0XHR2YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgPyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gOiB1bmRlZmluZWQ7XG5cdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7IC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdFx0XHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0XHRcdHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gKGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IFtyZXNvbHZlLCByZWplY3RdKSk7XG5cdFx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKTtcblxuXHRcdFx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdFx0XHR2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgX193ZWJwYWNrX3JlcXVpcmVfXy51KGNodW5rSWQpO1xuXHRcdFx0XHRcdC8vIGNyZWF0ZSBlcnJvciBiZWZvcmUgc3RhY2sgdW53b3VuZCB0byBnZXQgdXNlZnVsIHN0YWNrdHJhY2UgbGF0ZXJcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdFx0XHR2YXIgbG9hZGluZ0VuZGVkID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSkge1xuXHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF07XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID0gZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubWVzc2FnZSA9ICdMb2FkaW5nIGNodW5rICcgKyBjaHVua0lkICsgJyBmYWlsZWQuXFxuKCcgKyBlcnJvclR5cGUgKyAnOiAnICsgcmVhbFNyYyArICcpJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci50eXBlID0gZXJyb3JUeXBlO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnJlcXVlc3QgPSByZWFsU3JjO1xuXHRcdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubCh1cmwsIGxvYWRpbmdFbmRlZCwgXCJjaHVuay1cIiArIGNodW5rSWQsIGNodW5rSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxufTtcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5PLmogPSAoY2h1bmtJZCkgPT4gKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9PT0gMCk7XG5cbi8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uLCBkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYoY2h1bmtJZHMuc29tZSgoaWQpID0+IChpbnN0YWxsZWRDaHVua3NbaWRdICE9PSAwKSkpIHtcblx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcblx0fVxuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHJlc3VsdCk7XG59XG5cbnZhciBjaHVua0xvYWRpbmdHbG9iYWwgPSBzZWxmW1wid2VicGFja0NodW5rdXJiYW5kb2NzX3dlYmFwcFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8odW5kZWZpbmVkLCBbMzAzXSwgKCkgPT4gKF9fd2VicGFja19yZXF1aXJlX18oMzMxKSkpXG5fX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKF9fd2VicGFja19leHBvcnRzX18pO1xuIl0sIm5hbWVzIjpbImRlZmVycmVkIiwibGVhZlByb3RvdHlwZXMiLCJnZXRQcm90byIsImluUHJvZ3Jlc3MiLCJkYXRhV2VicGFja1ByZWZpeCIsInN1cGFiYXNlIiwiY3VycmVudFVzZXIiLCJzZXNzaW9uVmFsaWRhdGVkIiwic2V0Q3VycmVudFVzZXIiLCJ1c2VyIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVJdGVtIiwiYXN5bmMiLCJ2YWxpZGF0ZVNlc3Npb24iLCJkYXRhIiwic2Vzc2lvbiIsImVycm9yIiwic2Vzc2lvbkVycm9yIiwiYXV0aCIsImdldFNlc3Npb24iLCJjb25zb2xlIiwibG9nIiwicmVmcmVzaEVycm9yIiwicmVmcmVzaFNlc3Npb24iLCJ3YXJuIiwic2lnbk91dCIsImUiLCJzaG93TG9hZGluZyIsImJ1dHRvbklkIiwic3Bpbm5lcklkIiwiYnV0dG9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNwaW5uZXIiLCJkaXNhYmxlZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImhpZGVMb2FkaW5nIiwiYWRkIiwic2hvd1Byb2ZpbGVTdGF0dXMiLCJtZXNzYWdlIiwidHlwZSIsImVsZW1lbnRJZCIsInN0YXR1c0VsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTmFtZSIsImluaXRQcm9maWxlUGFnZSIsInJlZGlyZWN0VXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwicHJvdGVjdFBhZ2UiLCJ1c2VyRW1haWxFbCIsImxvZ291dEJ0biIsInByb2ZpbGVGb3JtIiwiZGVsZXRlQWNjb3VudEJ0biIsIm1lbWJlclNpbmNlRWwiLCJlbWFpbCIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicHJvZmlsZSIsInVzZXJJZCIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImNvZGUiLCJmZXRjaFVzZXJQcm9maWxlIiwiaWQiLCJ2YWx1ZSIsImxhc3RfbmFtZSIsImZpcnN0X25hbWUiLCJwaG9uZSIsImRhdGVfb2ZfYmlydGgiLCJ1cGRhdGVkX2F0IiwicG9wdWxhdGVQcm9maWxlRm9ybSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRUaW1lb3V0IiwicHJldmVudERlZmF1bHQiLCJwcm9maWxlU3RhdHVzRWwiLCJ1cGRhdGVzIiwidHJpbSIsInRvSVNPU3RyaW5nIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJ1cHNlcnQiLCJkZWxldGVTdGF0dXNFbCIsImNvbmZpcm0iLCJwcm9maWxlRXJyb3IiLCJkZWxldGUiLCJycGMiLCJtYWluRXJyb3JDb250YWluZXIiLCJpbm5lckhUTUwiLCJ1cGRhdGVIZWFkZXJGb3JBdXRoU3RhdGUiLCJ1c2VyU3RhdHVzIiwibG9naW5MaW5rIiwic2lnbnVwTGluayIsImluaXRIZWFkZXJBdXRoIiwicmVwbGFjZVdpdGgiLCJjbG9uZU5vZGUiLCJhbGVydCIsInNldHVwTG9nb3V0SGFuZGxlciIsIm9uQXV0aFN0YXRlQ2hhbmdlIiwiZXZlbnQiLCJ2YWxpZGF0ZSIsInN0b3JlZFVzZXIiLCJnZXRJdGVtIiwicGFyc2UiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJtIiwiTyIsInJlc3VsdCIsImNodW5rSWRzIiwiZm4iLCJwcmlvcml0eSIsIm5vdEZ1bGZpbGxlZCIsIkluZmluaXR5IiwiaSIsImxlbmd0aCIsImZ1bGZpbGxlZCIsImoiLCJldmVyeSIsInNwbGljZSIsInIiLCJnZXRQcm90b3R5cGVPZiIsIm9iaiIsInQiLCJtb2RlIiwidGhpcyIsIl9fZXNNb2R1bGUiLCJ0aGVuIiwibnMiLCJjcmVhdGUiLCJkZWYiLCJjdXJyZW50IiwiaW5kZXhPZiIsImdldE93blByb3BlcnR5TmFtZXMiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJmIiwiY2h1bmtJZCIsIlByb21pc2UiLCJhbGwiLCJyZWR1Y2UiLCJwcm9taXNlcyIsInUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwibCIsInVybCIsImRvbmUiLCJwdXNoIiwic2NyaXB0IiwibmVlZEF0dGFjaCIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInMiLCJnZXRBdHRyaWJ1dGUiLCJjcmVhdGVFbGVtZW50IiwiY2hhcnNldCIsInRpbWVvdXQiLCJuYyIsInNldEF0dHJpYnV0ZSIsInNyYyIsIm9uU2NyaXB0Q29tcGxldGUiLCJwcmV2Iiwib25lcnJvciIsIm9ubG9hZCIsImNsZWFyVGltZW91dCIsImRvbmVGbnMiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJiaW5kIiwidGFyZ2V0IiwiaGVhZCIsImFwcGVuZENoaWxkIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJzY3JpcHRVcmwiLCJpbXBvcnRTY3JpcHRzIiwiY3VycmVudFNjcmlwdCIsInRhZ05hbWUiLCJ0b1VwcGVyQ2FzZSIsInRlc3QiLCJFcnJvciIsInJlcGxhY2UiLCJwIiwiaW5zdGFsbGVkQ2h1bmtzIiwiaW5zdGFsbGVkQ2h1bmtEYXRhIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnJvclR5cGUiLCJyZWFsU3JjIiwibmFtZSIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sInNvdXJjZVJvb3QiOiIifQ==