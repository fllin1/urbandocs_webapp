(()=>{"use strict";var e,t,n,o,r,s={7647:(e,t,n)=>{var o=n(3715),r=n(9660),s=n(2387);function a(e,t,n){const o=document.getElementById(n);o&&(o.textContent=e,o.className="status-message margin-top-sm",o.classList.add(t),o.classList.remove("hidden"))}async function i(e){const{data:t,error:n}=await r.N.from("profiles").select("first_name, last_name, phone, updated_at, deletion_requested_at, deletion_scheduled_for").eq("id",e).single();if(n&&"PGRST116"!==n.code)throw console.error("Error fetching profile:",n),n;return t}async function c(){if(!await(0,s.Kv)(!1))return;if(!await(0,o.z6)())return;const e=document.getElementById("userEmail"),t=document.getElementById("logoutBtn"),n=document.getElementById("profileForm"),c=document.getElementById("deleteAccountBtn"),d=document.getElementById("memberSince");try{const{data:{session:s}}=await r.N.auth.getSession();if(!s||!s.user)return console.log("No active session or user. Redirecting to login."),void(window.location.href="/");const u=s.user;e&&(e.textContent=u.email),d&&u.created_at&&(d.textContent=new Date(u.created_at).toLocaleDateString("fr-FR")),(0,o.Cs)("saveProfileBtn");const m=await i(u.id);m?(function(e){const t=document.getElementById("firstName"),n=document.getElementById("lastName"),o=document.getElementById("phone");t&&e.first_name&&(t.value=e.first_name),n&&e.last_name&&(n.value=e.last_name),o&&e.phone&&(o.value=e.phone)}(m),m.deletion_scheduled_for&&l(m)):console.log("No profile data found for user, form will be empty."),(0,o.RZ)("saveProfileBtn"),t&&t.addEventListener("click",(async()=>{(0,o.Cs)("logoutBtn");try{const{error:e}=await r.N.auth.signOut();if(e)throw e;a("Déconnexion réussie. Redirection...","success","profileFormStatus"),setTimeout((()=>{window.location.href="/"}),200)}catch(e){console.error("Error signing out:",e),a(`Erreur de déconnexion: ${e.message}`,"error","profileFormStatus")}finally{(0,o.RZ)("logoutBtn")}})),n&&n.addEventListener("submit",(async e=>{e.preventDefault();const t="profileFormStatus";document.getElementById(t).classList.add("hidden"),(0,o.Cs)("saveProfileBtn");try{const e=new FormData(n),o={first_name:e.get("firstName")||null,last_name:e.get("lastName")||null,phone:e.get("phone")||null,updated_at:(new Date).toISOString()};await async function(e,t){const{data:n,error:o}=await r.N.from("profiles").update(t).eq("id",e).select().single();if(o)throw console.error("Error updating profile:",o),o;return n}(u.id,o),a("Profil mis à jour avec succès !","success",t)}catch(e){console.error("Error updating profile:",e),a(`Erreur lors de la mise à jour: ${e.message}`,"error",t)}finally{(0,o.RZ)("saveProfileBtn")}})),c&&c.addEventListener("click",(async()=>{const e="deleteStatusMessage";if(document.getElementById(e).classList.add("hidden"),confirm("Êtes-vous sûr de vouloir programmer la suppression de votre compte ? Votre compte sera supprimé dans 30 secondes pour le test, mais vous pourrez annuler cette action à tout moment avant la suppression définitive.")){(0,o.Cs)("deleteAccountBtn");try{const{data:t}=await r.N.auth.getSession();if(!t?.session?.access_token)throw new Error("No valid session");const n=await fetch(`${r.N.supabaseUrl}/functions/v1/account-management`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.session.access_token}`},body:JSON.stringify({action:"schedule",reason:"User requested account deletion from profile page"})}),o=await n.json();if(!o.success)throw new Error(o.error||"Failed to schedule deletion");a("Suppression de compte programmée pour dans 30 secondes. Vous pouvez annuler cette action à tout moment.","info",e),setTimeout((async()=>{const e=await i(u.id);e&&l(e)}),1e3)}catch(t){console.error("Error scheduling account deletion:",t),a(`Erreur lors de la programmation de suppression: ${t.message}`,"error",e)}finally{(0,o.RZ)("deleteAccountBtn")}}else console.log("User cancelled account deletion.")}))}catch(e){console.error("Profile page initialization error:",e);const t=document.getElementById("profileDetails");t&&(t.innerHTML='<p class="error-message">Impossible de charger les informations du profil. Veuillez réessayer plus tard.</p>')}}function l(e){const t=document.getElementById("deleteAccountSection"),n=document.getElementById("deleteAccountBtn");if(t&&n&&e.deletion_scheduled_for){const n=new Date(e.deletion_scheduled_for),o=new Date,r=Math.ceil((n.getTime()-o.getTime())/1e3);t.innerHTML=`\n      <h3 class="margin-bottom-sm">Suppression de compte programmée</h3>\n      <div class="deletion-warning">\n        <p class="margin-bottom-sm">\n          ⚠️ Votre compte sera supprimé dans <strong>${r} seconde(s)</strong> \n          (le ${n.toLocaleDateString("fr-FR")} à ${n.toLocaleTimeString("fr-FR")}).\n        </p>\n        <p class="margin-bottom-sm">\n          Vous pouvez annuler cette suppression à tout moment avant la date prévue.\n        </p>\n      </div>\n      <div class="deletion-actions">\n        <button id="cancelDeletionBtn" class="btn btn-primary">\n          Annuler la suppression\n        </button>\n        <button id="viewDeletionStatusBtn" class="btn btn-secondary">\n          Voir le statut détaillé\n        </button>\n      </div>\n      <div id="deleteStatusMessage" class="status-message hidden margin-top-sm"></div>\n    `;const s=document.getElementById("cancelDeletionBtn"),a=document.getElementById("viewDeletionStatusBtn");s&&s.addEventListener("click",d),a&&a.addEventListener("click",(()=>{window.location.href="/user/account-deletion-status"}))}}async function d(){if(confirm("Êtes-vous sûr de vouloir annuler la suppression de votre compte ?"))try{const e=document.getElementById("cancelDeletionBtn");e.textContent,e.textContent="Annulation...",e.disabled=!0;const{data:t}=await r.N.auth.getSession();if(!t?.session?.access_token)throw new Error("No valid session");const n=await fetch(`${r.N.supabaseUrl}/functions/v1/account-management`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.session.access_token}`},body:JSON.stringify({action:"cancel"})}),o=await n.json();if(!o.success)throw new Error(o.error||"Failed to cancel deletion");a("Suppression de compte annulée avec succès !","success","deleteStatusMessage"),setTimeout((()=>{const e=document.getElementById("deleteAccountSection");if(e){e.innerHTML='\n          <h3 class="margin-bottom-sm">Supprimer le compte</h3>\n          <p class="margin-bottom-sm">\n            Attention : Cette action programmera la suppression de votre compte dans 30 secondes pour le test. \n            Vous pourrez annuler cette action à tout moment avant la suppression définitive.\n          </p>\n          <button id="deleteAccountBtn" class="btn btn-danger">\n            Programmer la suppression de mon compte\n          </button>\n          <div id="deleteStatusMessage" class="status-message hidden margin-top-sm"></div>\n        ';const t=document.getElementById("deleteAccountBtn");t&&t.addEventListener("click",(async()=>{location.reload()}))}}),2e3)}catch(e){console.error("Error canceling deletion:",e),a("Erreur lors de l'annulation de la suppression","error","deleteStatusMessage");const t=document.getElementById("cancelDeletionBtn");t&&(t.textContent="Annuler la suppression",t.disabled=!1)}}document.addEventListener("DOMContentLoaded",c);var u=n(9251);document.addEventListener("DOMContentLoaded",(()=>{(0,u.Mt)(),c(),console.log("Profile page and header authentication initialized")}))}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return s[e].call(n.exports,n,n.exports,i),n.exports}i.m=s,e=[],i.O=(t,n,o,r)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){for(var[n,o,r]=e[d],a=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(a=!1,r<s&&(s=r));if(a){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);i.r(r);var s={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,i.d(r,s),r},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>"js/"+e+".bundle.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},r="urbandocs_webapp:",i.l=(e,t,n,s)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==r+n){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",r+n),a.src=e),o[e]=[t];var m=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var r=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=m.bind(null,a.onerror),a.onload=m.bind(null,a.onload),c&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=138,(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../"})(),(()=>{var e={138:0};i.f.j=(t,n)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var s=i.p+i.u(t),a=new Error;i.l(s,(n=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,o[1](a)}}),"chunk-"+t,t)}},i.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[s,a,c]=n,l=0;if(s.some((t=>0!==e[t]))){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(c)var d=c(i)}for(t&&t(n);l<s.length;l++)r=s[l],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(d)},n=self.webpackChunkurbandocs_webapp=self.webpackChunkurbandocs_webapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=i.O(void 0,[76],(()=>i(7647)));c=i.O(c)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3ZELElBR0l5RixFQUFVNEMsR0FIVG5DLEVBQVVpRyxFQUFhQyxHQUFXcE0sRUFHaEJ1RyxFQUFJLEVBQzNCLEdBQUdMLEVBQVNtRyxNQUFNMUssR0FBZ0MsSUFBeEI2SixFQUFnQjdKLEtBQWEsQ0FDdEQsSUFBSThELEtBQVkwRyxFQUNaM0csRUFBb0J5QyxFQUFFa0UsRUFBYTFHLEtBQ3JDRCxFQUFvQlEsRUFBRVAsR0FBWTBHLEVBQVkxRyxJQUdoRCxHQUFHMkcsRUFBUyxJQUFJbEksRUFBU2tJLEVBQVE1RyxFQUNsQyxDQUVBLElBREcwRyxHQUE0QkEsRUFBMkJsTSxHQUNyRHVHLEVBQUlMLEVBQVNNLE9BQVFELElBQ3pCOEIsRUFBVW5DLEVBQVNLLEdBQ2hCZixFQUFvQnlDLEVBQUV1RCxFQUFpQm5ELElBQVltRCxFQUFnQm5ELElBQ3JFbUQsRUFBZ0JuRCxHQUFTLEtBRTFCbUQsRUFBZ0JuRCxHQUFXLEVBRTVCLE9BQU83QyxFQUFvQlMsRUFBRS9CLElBRzFCb0ksRUFBcUJDLEtBQW1DLDZCQUFJQSxLQUFtQyw4QkFBSyxHQUN4R0QsRUFBbUJ4RSxRQUFRbUUsRUFBcUJ2QixLQUFLLEtBQU0sSUFDM0Q0QixFQUFtQmxELEtBQU82QyxFQUFxQnZCLEtBQUssS0FBTTRCLEVBQW1CbEQsS0FBS3NCLEtBQUs0QixHLEtDbEZ2RixJQUFJRSxFQUFzQmhILEVBQW9CUyxPQUFFTixFQUFXLENBQUMsS0FBSyxJQUFPSCxFQUFvQixRQUM1RmdILEVBQXNCaEgsRUFBb0JTLEVBQUV1RyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2NyZWF0ZSBmYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9hdXRoL3Byb2ZpbGUuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC8uL3NyYy9qcy9wcm9maWxlLXBhZ2UuanMiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvcnVudGltZUlkIiwid2VicGFjazovL3VyYmFuZG9jc193ZWJhcHAvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vdXJiYW5kb2NzX3dlYmFwcC93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly91cmJhbmRvY3Nfd2ViYXBwL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJ2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgPyAob2JqKSA9PiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikpIDogKG9iaikgPT4gKG9iai5fX3Byb3RvX18pO1xudmFyIGxlYWZQcm90b3R5cGVzO1xuLy8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4vLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbi8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuLy8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4vLyBtb2RlICYgMTY6IHJldHVybiB2YWx1ZSB3aGVuIGl0J3MgUHJvbWlzZS1saWtlXG4vLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuXHRpZihtb2RlICYgMSkgdmFsdWUgPSB0aGlzKHZhbHVlKTtcblx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcblx0aWYodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSkge1xuXHRcdGlmKChtb2RlICYgNCkgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuXHRcdGlmKChtb2RlICYgMTYpICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdmFsdWU7XG5cdH1cblx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcblx0dmFyIGRlZiA9IHt9O1xuXHRsZWFmUHJvdG90eXBlcyA9IGxlYWZQcm90b3R5cGVzIHx8IFtudWxsLCBnZXRQcm90byh7fSksIGdldFByb3RvKFtdKSwgZ2V0UHJvdG8oZ2V0UHJvdG8pXTtcblx0Zm9yKHZhciBjdXJyZW50ID0gbW9kZSAmIDIgJiYgdmFsdWU7IHR5cGVvZiBjdXJyZW50ID09ICdvYmplY3QnICYmICF+bGVhZlByb3RvdHlwZXMuaW5kZXhPZihjdXJyZW50KTsgY3VycmVudCA9IGdldFByb3RvKGN1cnJlbnQpKSB7XG5cdFx0T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoY3VycmVudCkuZm9yRWFjaCgoa2V5KSA9PiAoZGVmW2tleV0gPSAoKSA9PiAodmFsdWVba2V5XSkpKTtcblx0fVxuXHRkZWZbJ2RlZmF1bHQnXSA9ICgpID0+ICh2YWx1ZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChucywgZGVmKTtcblx0cmV0dXJuIG5zO1xufTsiLCJ2YXIgaW5Qcm9ncmVzcyA9IHt9O1xudmFyIGRhdGFXZWJwYWNrUHJlZml4ID0gXCJ1cmJhbmRvY3Nfd2ViYXBwOlwiO1xuLy8gbG9hZFNjcmlwdCBmdW5jdGlvbiB0byBsb2FkIGEgc2NyaXB0IHZpYSBzY3JpcHQgdGFnXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSAodXJsLCBkb25lLCBrZXksIGNodW5rSWQpID0+IHtcblx0aWYoaW5Qcm9ncmVzc1t1cmxdKSB7IGluUHJvZ3Jlc3NbdXJsXS5wdXNoKGRvbmUpOyByZXR1cm47IH1cblx0dmFyIHNjcmlwdCwgbmVlZEF0dGFjaDtcblx0aWYoa2V5ICE9PSB1bmRlZmluZWQpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgcyA9IHNjcmlwdHNbaV07XG5cdFx0XHRpZihzLmdldEF0dHJpYnV0ZShcInNyY1wiKSA9PSB1cmwgfHwgcy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIikgPT0gZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpIHsgc2NyaXB0ID0gczsgYnJlYWs7IH1cblx0XHR9XG5cdH1cblx0aWYoIXNjcmlwdCkge1xuXHRcdG5lZWRBdHRhY2ggPSB0cnVlO1xuXHRcdHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG5cdFx0c2NyaXB0LmNoYXJzZXQgPSAndXRmLTgnO1xuXHRcdHNjcmlwdC50aW1lb3V0ID0gMTIwO1xuXHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKSB7XG5cdFx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgX193ZWJwYWNrX3JlcXVpcmVfXy5uYyk7XG5cdFx0fVxuXHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIiwgZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpO1xuXG5cdFx0c2NyaXB0LnNyYyA9IHVybDtcblx0fVxuXHRpblByb2dyZXNzW3VybF0gPSBbZG9uZV07XG5cdHZhciBvblNjcmlwdENvbXBsZXRlID0gKHByZXYsIGV2ZW50KSA9PiB7XG5cdFx0Ly8gYXZvaWQgbWVtIGxlYWtzIGluIElFLlxuXHRcdHNjcmlwdC5vbmVycm9yID0gc2NyaXB0Lm9ubG9hZCA9IG51bGw7XG5cdFx0Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXHRcdHZhciBkb25lRm5zID0gaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdGRlbGV0ZSBpblByb2dyZXNzW3VybF07XG5cdFx0c2NyaXB0LnBhcmVudE5vZGUgJiYgc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcblx0XHRkb25lRm5zICYmIGRvbmVGbnMuZm9yRWFjaCgoZm4pID0+IChmbihldmVudCkpKTtcblx0XHRpZihwcmV2KSByZXR1cm4gcHJldihldmVudCk7XG5cdH1cblx0dmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCB1bmRlZmluZWQsIHsgdHlwZTogJ3RpbWVvdXQnLCB0YXJnZXQ6IHNjcmlwdCB9KSwgMTIwMDAwKTtcblx0c2NyaXB0Lm9uZXJyb3IgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9uZXJyb3IpO1xuXHRzY3JpcHQub25sb2FkID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmxvYWQpO1xuXHRuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbn07IiwiLy8gc3JjL2F1dGgvcHJvZmlsZS5qc1xuLyoqXG4gKiBQcm9maWxlIE1vZHVsZVxuICogQG1vZHVsZSBwcm9maWxlXG4gKiBAZGVzY3JpcHRpb24gSGFuZGxlcyB1c2VyIHByb2ZpbGUgbWFuYWdlbWVudCwgaW5jbHVkaW5nIGRhdGEgZmV0Y2hpbmcsIHVwZGF0ZXMsIGFuZCBhY2NvdW50IGRlbGV0aW9uLlxuICogQHZlcnNpb24gMC4zLjBcbiAqXG4gKiBAY2hhbmdlbG9nXG4gKiAtIDAuMy4wICgyMDI1LTAxLTI3KTogVXBkYXRlZCBhY2NvdW50IGRlbGV0aW9uIHRvIHVzZSAzMC1kYXkgZ3JhY2UgcGVyaW9kIHN5c3RlbVxuICogLSAwLjIuMSAoMjAyNS0wMS0yNyk6IFVwZGF0ZWQgdG8gdXNlIEVuZ2xpc2ggY29sdW1uIG5hbWVzIGFuZCBhZGRlZCBkYXRlX29mX2JpcnRoIHN1cHBvcnRcbiAqIC0gMC4yLjAgKDIwMjUtMDEtMjcpOiBGaXhlZCBkYXRhYmFzZSB0YWJsZSByZWZlcmVuY2VzIGFuZCBmaWVsZCBtYXBwaW5ncyB0byBtYXRjaCBhY3R1YWwgU3VwYWJhc2Ugc3RydWN0dXJlXG4gKiAtIDAuMS4wICgyMDI1LTA1LTE2KTogQWRkZWQgcHJvZmlsZSBkYXRhIGZldGNoaW5nLCB1cGRhdGluZywgYW5kIGFjY291bnQgZGVsZXRpb24gZnVuY3Rpb25hbGl0eS5cbiAqIC0gMC4wLjIgKDIwMjUtMDUtMTUpOiBJbXByb3ZlZCBlcnJvciBoYW5kbGluZyBhbmQgYWRkZWQgbG9hZGluZyBzdGF0ZXMgKHByZXZpb3VzIHZlcnNpb25pbmcgd2FzIGZ1dHVyZS1kYXRlZClcbiAqIC0gMC4wLjEgKDIwMjUtMDUtMTQpOiBJbml0aWFsIHZlcnNpb24gd2l0aCBiYXNpYyBwcm9maWxlIGRpc3BsYXkgYW5kIGxvZ291dC5cbiAqL1xuXG5pbXBvcnQge1xuICBwcm90ZWN0UGFnZSxcbiAgc2hvd1N0YXR1cywgLy8gQXNzdW1pbmcgdGhpcyBjYW4gdGFyZ2V0IHNwZWNpZmljIGVsZW1lbnRzXG4gIC8vIHNob3dFcnJvciwgLy8gV2UgY2FuIHVzZSBzaG93U3RhdHVzIHdpdGggdHlwZSAnZXJyb3InXG4gIHNob3dMb2FkaW5nLFxuICBoaWRlTG9hZGluZyxcbn0gZnJvbSBcIi4vYXV0aC5qc1wiOyAvLyBBc3N1bWluZyBhdXRoLmpzIGV4cG9ydHMgc2hvd1N0YXR1cyB0aGF0IGNhbiB0YWtlIGFuIGVsZW1lbnQgSURcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSBcIi4uL3N1cGFiYXNlLWNsaWVudC5qc1wiO1xuaW1wb3J0IHsgaW5pdERlbGV0aW9uR3VhcmQgfSBmcm9tIFwiLi9kZWxldGlvbi1ndWFyZC5qc1wiO1xuXG4vLyBIZWxwZXIgdG8gc2hvdyBzdGF0dXMgbWVzc2FnZXMgZm9yIHByb2ZpbGUgZm9ybSBhbmQgZGVsZXRlIHNlY3Rpb25cbmZ1bmN0aW9uIHNob3dQcm9maWxlU3RhdHVzKG1lc3NhZ2UsIHR5cGUsIGVsZW1lbnRJZCkge1xuICBjb25zdCBzdGF0dXNFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudElkKTtcbiAgaWYgKHN0YXR1c0VsZW1lbnQpIHtcbiAgICBzdGF0dXNFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICBzdGF0dXNFbGVtZW50LmNsYXNzTmFtZSA9IFwic3RhdHVzLW1lc3NhZ2UgbWFyZ2luLXRvcC1zbVwiOyAvLyBSZXNldCBjbGFzc2VzXG4gICAgc3RhdHVzRWxlbWVudC5jbGFzc0xpc3QuYWRkKHR5cGUpOyAvLyAnc3VjY2VzcycsICdlcnJvcicsICdpbmZvJ1xuICAgIHN0YXR1c0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBmZXRjaFVzZXJQcm9maWxlKHVzZXJJZCkge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwicHJvZmlsZXNcIilcbiAgICAuc2VsZWN0KFxuICAgICAgXCJmaXJzdF9uYW1lLCBsYXN0X25hbWUsIHBob25lLCB1cGRhdGVkX2F0LCBkZWxldGlvbl9yZXF1ZXN0ZWRfYXQsIGRlbGV0aW9uX3NjaGVkdWxlZF9mb3JcIlxuICAgIClcbiAgICAuZXEoXCJpZFwiLCB1c2VySWQpXG4gICAgLnNpbmdsZSgpO1xuXG4gIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSBcIlBHUlNUMTE2XCIpIHtcbiAgICAvLyBQR1JTVDExNjogXCJyb3cgbm90IGZvdW5kXCJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcHJvZmlsZTpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBwb3B1bGF0ZVByb2ZpbGVGb3JtKHByb2ZpbGUpIHtcbiAgY29uc3QgZmlyc3ROYW1lRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcnN0TmFtZVwiKTtcbiAgY29uc3QgbGFzdE5hbWVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGFzdE5hbWVcIik7XG4gIGNvbnN0IHBob25lRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBob25lXCIpO1xuXG4gIGlmIChmaXJzdE5hbWVFbCAmJiBwcm9maWxlLmZpcnN0X25hbWUpIHtcbiAgICBmaXJzdE5hbWVFbC52YWx1ZSA9IHByb2ZpbGUuZmlyc3RfbmFtZTtcbiAgfVxuICBpZiAobGFzdE5hbWVFbCAmJiBwcm9maWxlLmxhc3RfbmFtZSkge1xuICAgIGxhc3ROYW1lRWwudmFsdWUgPSBwcm9maWxlLmxhc3RfbmFtZTtcbiAgfVxuICBpZiAocGhvbmVFbCAmJiBwcm9maWxlLnBob25lKSB7XG4gICAgcGhvbmVFbC52YWx1ZSA9IHByb2ZpbGUucGhvbmU7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlclByb2ZpbGUodXNlcklkLCBwcm9maWxlRGF0YSkge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwicHJvZmlsZXNcIilcbiAgICAudXBkYXRlKHByb2ZpbGVEYXRhKVxuICAgIC5lcShcImlkXCIsIHVzZXJJZClcbiAgICAuc2VsZWN0KClcbiAgICAuc2luZ2xlKCk7XG5cbiAgaWYgKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICByZXR1cm4gZGF0YTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRQcm9maWxlUGFnZSgpIHtcbiAgLy8gSW5pdGlhbGl6ZSBkZWxldGlvbiBndWFyZCBmaXJzdFxuICBjb25zdCBjYW5BY2Nlc3MgPSBhd2FpdCBpbml0RGVsZXRpb25HdWFyZChmYWxzZSk7XG4gIGlmICghY2FuQWNjZXNzKSB7XG4gICAgcmV0dXJuOyAvLyBBY2Nlc3Mgd2FzIGJsb2NrZWRcbiAgfVxuXG4gIGlmICghKGF3YWl0IHByb3RlY3RQYWdlKCkpKSByZXR1cm47XG5cbiAgY29uc3QgdXNlckVtYWlsRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXJFbWFpbFwiKTtcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvdXRCdG5cIik7XG4gIGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlRm9ybVwiKTtcbiAgY29uc3QgZGVsZXRlQWNjb3VudEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlQWNjb3VudEJ0blwiKTtcbiAgY29uc3QgbWVtYmVyU2luY2VFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVtYmVyU2luY2VcIik7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHNlc3Npb24gfSxcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKCk7XG4gICAgaWYgKCFzZXNzaW9uIHx8ICFzZXNzaW9uLnVzZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTm8gYWN0aXZlIHNlc3Npb24gb3IgdXNlci4gUmVkaXJlY3RpbmcgdG8gbG9naW4uXCIpO1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgdXNlciA9IHNlc3Npb24udXNlcjtcblxuICAgIGlmICh1c2VyRW1haWxFbCkge1xuICAgICAgdXNlckVtYWlsRWwudGV4dENvbnRlbnQgPSB1c2VyLmVtYWlsO1xuICAgIH1cbiAgICBpZiAobWVtYmVyU2luY2VFbCAmJiB1c2VyLmNyZWF0ZWRfYXQpIHtcbiAgICAgIG1lbWJlclNpbmNlRWwudGV4dENvbnRlbnQgPSBuZXcgRGF0ZSh1c2VyLmNyZWF0ZWRfYXQpLnRvTG9jYWxlRGF0ZVN0cmluZyhcbiAgICAgICAgXCJmci1GUlwiXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEZldGNoIGFuZCBwb3B1bGF0ZSBwcm9maWxlXG4gICAgc2hvd0xvYWRpbmcoXCJzYXZlUHJvZmlsZUJ0blwiKTtcbiAgICBjb25zdCBwcm9maWxlID0gYXdhaXQgZmV0Y2hVc2VyUHJvZmlsZSh1c2VyLmlkKTtcbiAgICBpZiAocHJvZmlsZSkge1xuICAgICAgcG9wdWxhdGVQcm9maWxlRm9ybShwcm9maWxlKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgYWNjb3VudCBkZWxldGlvbiBpcyBzY2hlZHVsZWRcbiAgICAgIGlmIChwcm9maWxlLmRlbGV0aW9uX3NjaGVkdWxlZF9mb3IpIHtcbiAgICAgICAgdXBkYXRlRGVsZXRlQWNjb3VudFNlY3Rpb24ocHJvZmlsZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTm8gcHJvZmlsZSBkYXRhIGZvdW5kIGZvciB1c2VyLCBmb3JtIHdpbGwgYmUgZW1wdHkuXCIpO1xuICAgIH1cbiAgICBoaWRlTG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuXG4gICAgaWYgKGxvZ291dEJ0bikge1xuICAgICAgbG9nb3V0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHNob3dMb2FkaW5nKFwibG9nb3V0QnRuXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuICAgICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICBcIkTDqWNvbm5leGlvbiByw6l1c3NpZS4gUmVkaXJlY3Rpb24uLi5cIixcbiAgICAgICAgICAgIFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgXCJwcm9maWxlRm9ybVN0YXR1c1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XG4gICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2lnbmluZyBvdXQ6XCIsIGVycm9yKTtcbiAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgIGBFcnJldXIgZGUgZMOpY29ubmV4aW9uOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgIFwiZXJyb3JcIixcbiAgICAgICAgICAgIFwicHJvZmlsZUZvcm1TdGF0dXNcIlxuICAgICAgICAgICk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaGlkZUxvYWRpbmcoXCJsb2dvdXRCdG5cIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwcm9maWxlRm9ybSkge1xuICAgICAgcHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBhc3luYyAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGRlbGV0ZVN0YXR1c0VsID0gXCJwcm9maWxlRm9ybVN0YXR1c1wiO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkZWxldGVTdGF0dXNFbCkuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcblxuICAgICAgICBzaG93TG9hZGluZyhcInNhdmVQcm9maWxlQnRuXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKHByb2ZpbGVGb3JtKTtcbiAgICAgICAgICBjb25zdCBwcm9maWxlRGF0YSA9IHtcbiAgICAgICAgICAgIGZpcnN0X25hbWU6IGZvcm1EYXRhLmdldChcImZpcnN0TmFtZVwiKSB8fCBudWxsLFxuICAgICAgICAgICAgbGFzdF9uYW1lOiBmb3JtRGF0YS5nZXQoXCJsYXN0TmFtZVwiKSB8fCBudWxsLFxuICAgICAgICAgICAgcGhvbmU6IGZvcm1EYXRhLmdldChcInBob25lXCIpIHx8IG51bGwsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJQcm9maWxlKHVzZXIuaWQsIHByb2ZpbGVEYXRhKTtcbiAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgIFwiUHJvZmlsIG1pcyDDoCBqb3VyIGF2ZWMgc3VjY8OocyAhXCIsXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGRlbGV0ZVN0YXR1c0VsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZTpcIiwgZXJyb3IpO1xuICAgICAgICAgIHNob3dQcm9maWxlU3RhdHVzKFxuICAgICAgICAgICAgYEVycmV1ciBsb3JzIGRlIGxhIG1pc2Ugw6Agam91cjogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgICAgICBcImVycm9yXCIsXG4gICAgICAgICAgICBkZWxldGVTdGF0dXNFbFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaGlkZUxvYWRpbmcoXCJzYXZlUHJvZmlsZUJ0blwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGRlbGV0ZUFjY291bnRCdG4pIHtcbiAgICAgIGRlbGV0ZUFjY291bnRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZGVsZXRlU3RhdHVzRWwgPSBcImRlbGV0ZVN0YXR1c01lc3NhZ2VcIjtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVsZXRlU3RhdHVzRWwpLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIGNvbmZpcm0oXG4gICAgICAgICAgICBcIsOKdGVzLXZvdXMgc8O7ciBkZSB2b3Vsb2lyIHByb2dyYW1tZXIgbGEgc3VwcHJlc3Npb24gZGUgdm90cmUgY29tcHRlID8gVm90cmUgY29tcHRlIHNlcmEgc3VwcHJpbcOpIGRhbnMgMzAgc2Vjb25kZXMgcG91ciBsZSB0ZXN0LCBtYWlzIHZvdXMgcG91cnJleiBhbm51bGVyIGNldHRlIGFjdGlvbiDDoCB0b3V0IG1vbWVudCBhdmFudCBsYSBzdXBwcmVzc2lvbiBkw6lmaW5pdGl2ZS5cIlxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgc2hvd0xvYWRpbmcoXCJkZWxldGVBY2NvdW50QnRuXCIpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDYWxsIHRoZSBhY2NvdW50IG1hbmFnZW1lbnQgZWRnZSBmdW5jdGlvbiB0byBzY2hlZHVsZSBkZWxldGlvblxuICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBzZXNzaW9uIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbj8uc2Vzc2lvbj8uYWNjZXNzX3Rva2VuKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHZhbGlkIHNlc3Npb25cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgICAgIGAke3N1cGFiYXNlLnN1cGFiYXNlVXJsfS9mdW5jdGlvbnMvdjEvYWNjb3VudC1tYW5hZ2VtZW50YCxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7c2Vzc2lvbi5zZXNzaW9uLmFjY2Vzc190b2tlbn1gLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcInNjaGVkdWxlXCIsXG4gICAgICAgICAgICAgICAgICByZWFzb246IFwiVXNlciByZXF1ZXN0ZWQgYWNjb3VudCBkZWxldGlvbiBmcm9tIHByb2ZpbGUgcGFnZVwiLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5lcnJvciB8fCBcIkZhaWxlZCB0byBzY2hlZHVsZSBkZWxldGlvblwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2hvd1Byb2ZpbGVTdGF0dXMoXG4gICAgICAgICAgICAgIFwiU3VwcHJlc3Npb24gZGUgY29tcHRlIHByb2dyYW1tw6llIHBvdXIgZGFucyAzMCBzZWNvbmRlcy4gVm91cyBwb3V2ZXogYW5udWxlciBjZXR0ZSBhY3Rpb24gw6AgdG91dCBtb21lbnQuXCIsXG4gICAgICAgICAgICAgIFwiaW5mb1wiLFxuICAgICAgICAgICAgICBkZWxldGVTdGF0dXNFbFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBkZWxldGUgYWNjb3VudCBzZWN0aW9uXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZFByb2ZpbGUgPSBhd2FpdCBmZXRjaFVzZXJQcm9maWxlKHVzZXIuaWQpO1xuICAgICAgICAgICAgICBpZiAodXBkYXRlZFByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVEZWxldGVBY2NvdW50U2VjdGlvbih1cGRhdGVkUHJvZmlsZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2NoZWR1bGluZyBhY2NvdW50IGRlbGV0aW9uOlwiLCBlcnJvcik7XG4gICAgICAgICAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgICAgICAgICAgYEVycmV1ciBsb3JzIGRlIGxhIHByb2dyYW1tYXRpb24gZGUgc3VwcHJlc3Npb246ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgICAgICBcImVycm9yXCIsXG4gICAgICAgICAgICAgIGRlbGV0ZVN0YXR1c0VsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBoaWRlTG9hZGluZyhcImRlbGV0ZUFjY291bnRCdG5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXNlciBjYW5jZWxsZWQgYWNjb3VudCBkZWxldGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiUHJvZmlsZSBwYWdlIGluaXRpYWxpemF0aW9uIGVycm9yOlwiLCBlcnJvcik7XG4gICAgY29uc3QgbWFpbkVycm9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlRGV0YWlsc1wiKTtcbiAgICBpZiAobWFpbkVycm9yQ29udGFpbmVyKSB7XG4gICAgICBtYWluRXJyb3JDb250YWluZXIuaW5uZXJIVE1MID1cbiAgICAgICAgJzxwIGNsYXNzPVwiZXJyb3ItbWVzc2FnZVwiPkltcG9zc2libGUgZGUgY2hhcmdlciBsZXMgaW5mb3JtYXRpb25zIGR1IHByb2ZpbC4gVmV1aWxsZXogcsOpZXNzYXllciBwbHVzIHRhcmQuPC9wPic7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogVXBkYXRlIHRoZSBkZWxldGUgYWNjb3VudCBzZWN0aW9uIGJhc2VkIG9uIGRlbGV0aW9uIHN0YXR1c1xuICovXG5mdW5jdGlvbiB1cGRhdGVEZWxldGVBY2NvdW50U2VjdGlvbihwcm9maWxlKSB7XG4gIGNvbnN0IGRlbGV0ZVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0ZUFjY291bnRTZWN0aW9uXCIpO1xuICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0ZUFjY291bnRCdG5cIik7XG5cbiAgaWYgKCFkZWxldGVTZWN0aW9uIHx8ICFkZWxldGVCdG4pIHJldHVybjtcblxuICBpZiAocHJvZmlsZS5kZWxldGlvbl9zY2hlZHVsZWRfZm9yKSB7XG4gICAgY29uc3QgZGVsZXRpb25EYXRlID0gbmV3IERhdGUocHJvZmlsZS5kZWxldGlvbl9zY2hlZHVsZWRfZm9yKTtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHNlY29uZHNSZW1haW5pbmcgPSBNYXRoLmNlaWwoXG4gICAgICAoZGVsZXRpb25EYXRlLmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCkpIC8gMTAwMFxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgc2VjdGlvbiBjb250ZW50XG4gICAgZGVsZXRlU2VjdGlvbi5pbm5lckhUTUwgPSBgXG4gICAgICA8aDMgY2xhc3M9XCJtYXJnaW4tYm90dG9tLXNtXCI+U3VwcHJlc3Npb24gZGUgY29tcHRlIHByb2dyYW1tw6llPC9oMz5cbiAgICAgIDxkaXYgY2xhc3M9XCJkZWxldGlvbi13YXJuaW5nXCI+XG4gICAgICAgIDxwIGNsYXNzPVwibWFyZ2luLWJvdHRvbS1zbVwiPlxuICAgICAgICAgIOKaoO+4jyBWb3RyZSBjb21wdGUgc2VyYSBzdXBwcmltw6kgZGFucyA8c3Ryb25nPiR7c2Vjb25kc1JlbWFpbmluZ30gc2Vjb25kZShzKTwvc3Ryb25nPiBcbiAgICAgICAgICAobGUgJHtkZWxldGlvbkRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKFxuICAgICAgICAgICAgXCJmci1GUlwiXG4gICAgICAgICAgKX0gw6AgJHtkZWxldGlvbkRhdGUudG9Mb2NhbGVUaW1lU3RyaW5nKFwiZnItRlJcIil9KS5cbiAgICAgICAgPC9wPlxuICAgICAgICA8cCBjbGFzcz1cIm1hcmdpbi1ib3R0b20tc21cIj5cbiAgICAgICAgICBWb3VzIHBvdXZleiBhbm51bGVyIGNldHRlIHN1cHByZXNzaW9uIMOgIHRvdXQgbW9tZW50IGF2YW50IGxhIGRhdGUgcHLDqXZ1ZS5cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiZGVsZXRpb24tYWN0aW9uc1wiPlxuICAgICAgICA8YnV0dG9uIGlkPVwiY2FuY2VsRGVsZXRpb25CdG5cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiPlxuICAgICAgICAgIEFubnVsZXIgbGEgc3VwcHJlc3Npb25cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDxidXR0b24gaWQ9XCJ2aWV3RGVsZXRpb25TdGF0dXNCdG5cIiBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5XCI+XG4gICAgICAgICAgVm9pciBsZSBzdGF0dXQgZMOpdGFpbGzDqVxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBpZD1cImRlbGV0ZVN0YXR1c01lc3NhZ2VcIiBjbGFzcz1cInN0YXR1cy1tZXNzYWdlIGhpZGRlbiBtYXJnaW4tdG9wLXNtXCI+PC9kaXY+XG4gICAgYDtcblxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnMgZm9yIG5ldyBidXR0b25zXG4gICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxEZWxldGlvbkJ0blwiKTtcbiAgICBjb25zdCB2aWV3U3RhdHVzQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWV3RGVsZXRpb25TdGF0dXNCdG5cIik7XG5cbiAgICBpZiAoY2FuY2VsQnRuKSB7XG4gICAgICBjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNhbmNlbERlbGV0aW9uKTtcbiAgICB9XG5cbiAgICBpZiAodmlld1N0YXR1c0J0bikge1xuICAgICAgdmlld1N0YXR1c0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3VzZXIvYWNjb3VudC1kZWxldGlvbi1zdGF0dXNcIjtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEhhbmRsZSBjYW5jZWxpbmcgYWNjb3VudCBkZWxldGlvblxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDYW5jZWxEZWxldGlvbigpIHtcbiAgaWYgKFxuICAgICFjb25maXJtKFxuICAgICAgXCLDinRlcy12b3VzIHPDu3IgZGUgdm91bG9pciBhbm51bGVyIGxhIHN1cHByZXNzaW9uIGRlIHZvdHJlIGNvbXB0ZSA/XCJcbiAgICApXG4gICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxEZWxldGlvbkJ0blwiKTtcbiAgICBjb25zdCBvcmlnaW5hbFRleHQgPSBjYW5jZWxCdG4udGV4dENvbnRlbnQ7XG4gICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gXCJBbm51bGF0aW9uLi4uXCI7XG4gICAgY2FuY2VsQnRuLmRpc2FibGVkID0gdHJ1ZTtcblxuICAgIC8vIENhbGwgdGhlIGFjY291bnQgbWFuYWdlbWVudCBlZGdlIGZ1bmN0aW9uIHRvIGNhbmNlbCBkZWxldGlvblxuICAgIGNvbnN0IHsgZGF0YTogc2Vzc2lvbiB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKCk7XG4gICAgaWYgKCFzZXNzaW9uPy5zZXNzaW9uPy5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHZhbGlkIHNlc3Npb25cIik7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgIGAke3N1cGFiYXNlLnN1cGFiYXNlVXJsfS9mdW5jdGlvbnMvdjEvYWNjb3VudC1tYW5hZ2VtZW50YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtzZXNzaW9uLnNlc3Npb24uYWNjZXNzX3Rva2VufWAsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBhY3Rpb246IFwiY2FuY2VsXCIsXG4gICAgICAgIH0pLFxuICAgICAgfVxuICAgICk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0LmVycm9yIHx8IFwiRmFpbGVkIHRvIGNhbmNlbCBkZWxldGlvblwiKTtcbiAgICB9XG5cbiAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgIFwiU3VwcHJlc3Npb24gZGUgY29tcHRlIGFubnVsw6llIGF2ZWMgc3VjY8OocyAhXCIsXG4gICAgICBcInN1Y2Nlc3NcIixcbiAgICAgIFwiZGVsZXRlU3RhdHVzTWVzc2FnZVwiXG4gICAgKTtcblxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgZGVsZXRlIGFjY291bnQgc2VjdGlvblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY29uc3QgZGVsZXRlU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlQWNjb3VudFNlY3Rpb25cIik7XG4gICAgICBpZiAoZGVsZXRlU2VjdGlvbikge1xuICAgICAgICBkZWxldGVTZWN0aW9uLmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8aDMgY2xhc3M9XCJtYXJnaW4tYm90dG9tLXNtXCI+U3VwcHJpbWVyIGxlIGNvbXB0ZTwvaDM+XG4gICAgICAgICAgPHAgY2xhc3M9XCJtYXJnaW4tYm90dG9tLXNtXCI+XG4gICAgICAgICAgICBBdHRlbnRpb24gOiBDZXR0ZSBhY3Rpb24gcHJvZ3JhbW1lcmEgbGEgc3VwcHJlc3Npb24gZGUgdm90cmUgY29tcHRlIGRhbnMgMzAgc2Vjb25kZXMgcG91ciBsZSB0ZXN0LiBcbiAgICAgICAgICAgIFZvdXMgcG91cnJleiBhbm51bGVyIGNldHRlIGFjdGlvbiDDoCB0b3V0IG1vbWVudCBhdmFudCBsYSBzdXBwcmVzc2lvbiBkw6lmaW5pdGl2ZS5cbiAgICAgICAgICA8L3A+XG4gICAgICAgICAgPGJ1dHRvbiBpZD1cImRlbGV0ZUFjY291bnRCdG5cIiBjbGFzcz1cImJ0biBidG4tZGFuZ2VyXCI+XG4gICAgICAgICAgICBQcm9ncmFtbWVyIGxhIHN1cHByZXNzaW9uIGRlIG1vbiBjb21wdGVcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8ZGl2IGlkPVwiZGVsZXRlU3RhdHVzTWVzc2FnZVwiIGNsYXNzPVwic3RhdHVzLW1lc3NhZ2UgaGlkZGVuIG1hcmdpbi10b3Atc21cIj48L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICAvLyBSZS1hZGQgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgY29uc3QgbmV3RGVsZXRlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWxldGVBY2NvdW50QnRuXCIpO1xuICAgICAgICBpZiAobmV3RGVsZXRlQnRuKSB7XG4gICAgICAgICAgbmV3RGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBSZS1ydW4gdGhlIGRlbGV0ZSBhY2NvdW50IGxvZ2ljXG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsgLy8gU2ltcGxlIHNvbHV0aW9uOiByZWxvYWQgdGhlIHBhZ2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDIwMDApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjYW5jZWxpbmcgZGVsZXRpb246XCIsIGVycm9yKTtcbiAgICBzaG93UHJvZmlsZVN0YXR1cyhcbiAgICAgIFwiRXJyZXVyIGxvcnMgZGUgbCdhbm51bGF0aW9uIGRlIGxhIHN1cHByZXNzaW9uXCIsXG4gICAgICBcImVycm9yXCIsXG4gICAgICBcImRlbGV0ZVN0YXR1c01lc3NhZ2VcIlxuICAgICk7XG5cbiAgICAvLyBSZS1lbmFibGUgYnV0dG9uXG4gICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxEZWxldGlvbkJ0blwiKTtcbiAgICBpZiAoY2FuY2VsQnRuKSB7XG4gICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSBcIkFubnVsZXIgbGEgc3VwcHJlc3Npb25cIjtcbiAgICAgIGNhbmNlbEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG4vLyBJbml0aWFsaXplIHRoZSBwYWdlIHdoZW4gRE9NIGlzIHJlYWR5XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBpbml0UHJvZmlsZVBhZ2UpO1xuIiwiLy8gc3JjL2pzL3Byb2ZpbGUtcGFnZS5qcyAtIFByb2ZpbGUgcGFnZSBmdW5jdGlvbmFsaXR5XG5pbXBvcnQgeyBpbml0UHJvZmlsZVBhZ2UgfSBmcm9tIFwiLi9hdXRoL3Byb2ZpbGUuanNcIjtcbmltcG9ydCB7IGluaXRIZWFkZXJBdXRoIH0gZnJvbSBcIi4vYXV0aC9oZWFkZXItYXV0aC5qc1wiO1xuXG4vLyBJbml0aWFsaXplIGJvdGggcHJvZmlsZSBmdW5jdGlvbmFsaXR5IGFuZCBoZWFkZXIgYXV0aGVudGljYXRpb25cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgaW5pdEhlYWRlckF1dGgoKTtcbiAgaW5pdFByb2ZpbGVQYWdlKCk7XG4gIGNvbnNvbGUubG9nKFwiUHJvZmlsZSBwYWdlIGFuZCBoZWFkZXIgYXV0aGVudGljYXRpb24gaW5pdGlhbGl6ZWRcIik7XG59KTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gKGNodW5rSWQpID0+IHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcImpzL1wiICsgY2h1bmtJZCArIFwiLmJ1bmRsZS5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmogPSAxMzg7IiwidmFyIHNjcmlwdFVybDtcbmlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmcuaW1wb3J0U2NyaXB0cykgc2NyaXB0VXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmxvY2F0aW9uICsgXCJcIjtcbnZhciBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5kb2N1bWVudDtcbmlmICghc2NyaXB0VXJsICYmIGRvY3VtZW50KSB7XG5cdGlmIChkb2N1bWVudC5jdXJyZW50U2NyaXB0ICYmIGRvY3VtZW50LmN1cnJlbnRTY3JpcHQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnU0NSSVBUJylcblx0XHRzY3JpcHRVcmwgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYztcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSB7XG5cdFx0XHR2YXIgaSA9IHNjcmlwdHMubGVuZ3RoIC0gMTtcblx0XHRcdHdoaWxlIChpID4gLTEgJiYgKCFzY3JpcHRVcmwgfHwgIS9eaHR0cChzPyk6Ly50ZXN0KHNjcmlwdFVybCkpKSBzY3JpcHRVcmwgPSBzY3JpcHRzW2ktLV0uc3JjO1xuXHRcdH1cblx0fVxufVxuLy8gV2hlbiBzdXBwb3J0aW5nIGJyb3dzZXJzIHdoZXJlIGFuIGF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgeW91IG11c3Qgc3BlY2lmeSBhbiBvdXRwdXQucHVibGljUGF0aCBtYW51YWxseSB2aWEgY29uZmlndXJhdGlvblxuLy8gb3IgcGFzcyBhbiBlbXB0eSBzdHJpbmcgKFwiXCIpIGFuZCBzZXQgdGhlIF9fd2VicGFja19wdWJsaWNfcGF0aF9fIHZhcmlhYmxlIGZyb20geW91ciBjb2RlIHRvIHVzZSB5b3VyIG93biBsb2dpYy5cbmlmICghc2NyaXB0VXJsKSB0aHJvdyBuZXcgRXJyb3IoXCJBdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlclwiKTtcbnNjcmlwdFVybCA9IHNjcmlwdFVybC5yZXBsYWNlKC9eYmxvYjovLCBcIlwiKS5yZXBsYWNlKC8jLiokLywgXCJcIikucmVwbGFjZSgvXFw/LiokLywgXCJcIikucmVwbGFjZSgvXFwvW15cXC9dKyQvLCBcIi9cIik7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBzY3JpcHRVcmwgKyBcIi4uL1wiOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQxMzg6IDBcbn07XG5cbl9fd2VicGFja19yZXF1aXJlX18uZi5qID0gKGNodW5rSWQsIHByb21pc2VzKSA9PiB7XG5cdFx0Ly8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxuXHRcdHZhciBpbnN0YWxsZWRDaHVua0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSA/IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA6IHVuZGVmaW5lZDtcblx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIHsgLy8gMCBtZWFucyBcImFscmVhZHkgaW5zdGFsbGVkXCIuXG5cblx0XHRcdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRcdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYodHJ1ZSkgeyAvLyBhbGwgY2h1bmtzIGhhdmUgSlNcblx0XHRcdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiAoaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF0pKTtcblx0XHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSA9IHByb21pc2UpO1xuXG5cdFx0XHRcdFx0Ly8gc3RhcnQgY2h1bmsgbG9hZGluZ1xuXHRcdFx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuXHRcdFx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID0gJ0xvYWRpbmcgY2h1bmsgJyArIGNodW5rSWQgKyAnIGZhaWxlZC5cXG4oJyArIGVycm9yVHlwZSArICc6ICcgKyByZWFsU3JjICsgJyknO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm5hbWUgPSAnQ2h1bmtMb2FkRXJyb3InO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhWzFdKGVycm9yKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG59O1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZihjaHVua0lkcy5zb21lKChpZCkgPT4gKGluc3RhbGxlZENodW5rc1tpZF0gIT09IDApKSkge1xuXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdH1cblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLk8ocmVzdWx0KTtcbn1cblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmt1cmJhbmRvY3Nfd2ViYXBwXCJdID0gc2VsZltcIndlYnBhY2tDaHVua3VyYmFuZG9jc193ZWJhcHBcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3Nl0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDc2NDcpKSlcbl9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4iXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJsZWFmUHJvdG90eXBlcyIsImdldFByb3RvIiwiaW5Qcm9ncmVzcyIsImRhdGFXZWJwYWNrUHJlZml4Iiwic2hvd1Byb2ZpbGVTdGF0dXMiLCJtZXNzYWdlIiwidHlwZSIsImVsZW1lbnRJZCIsInN0YXR1c0VsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJhc3luYyIsImZldGNoVXNlclByb2ZpbGUiLCJ1c2VySWQiLCJkYXRhIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjb2RlIiwiY29uc29sZSIsImluaXRQcm9maWxlUGFnZSIsInVzZXJFbWFpbEVsIiwibG9nb3V0QnRuIiwicHJvZmlsZUZvcm0iLCJkZWxldGVBY2NvdW50QnRuIiwibWVtYmVyU2luY2VFbCIsInNlc3Npb24iLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsInVzZXIiLCJsb2ciLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlbWFpbCIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicHJvZmlsZSIsImlkIiwiZmlyc3ROYW1lRWwiLCJsYXN0TmFtZUVsIiwicGhvbmVFbCIsImZpcnN0X25hbWUiLCJ2YWx1ZSIsImxhc3RfbmFtZSIsInBob25lIiwicG9wdWxhdGVQcm9maWxlRm9ybSIsImRlbGV0aW9uX3NjaGVkdWxlZF9mb3IiLCJ1cGRhdGVEZWxldGVBY2NvdW50U2VjdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJzaWduT3V0Iiwic2V0VGltZW91dCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImRlbGV0ZVN0YXR1c0VsIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInByb2ZpbGVEYXRhIiwiZ2V0IiwidXBkYXRlZF9hdCIsInRvSVNPU3RyaW5nIiwidXBkYXRlIiwidXBkYXRlVXNlclByb2ZpbGUiLCJjb25maXJtIiwiYWNjZXNzX3Rva2VuIiwiRXJyb3IiLCJyZXNwb25zZSIsImZldGNoIiwic3VwYWJhc2VVcmwiLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWN0aW9uIiwicmVhc29uIiwicmVzdWx0IiwianNvbiIsInN1Y2Nlc3MiLCJ1cGRhdGVkUHJvZmlsZSIsIm1haW5FcnJvckNvbnRhaW5lciIsImlubmVySFRNTCIsImRlbGV0ZVNlY3Rpb24iLCJkZWxldGVCdG4iLCJkZWxldGlvbkRhdGUiLCJub3ciLCJzZWNvbmRzUmVtYWluaW5nIiwiTWF0aCIsImNlaWwiLCJnZXRUaW1lIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwiY2FuY2VsQnRuIiwidmlld1N0YXR1c0J0biIsImhhbmRsZUNhbmNlbERlbGV0aW9uIiwiZGlzYWJsZWQiLCJuZXdEZWxldGVCdG4iLCJyZWxvYWQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJtIiwiTyIsImNodW5rSWRzIiwiZm4iLCJwcmlvcml0eSIsIm5vdEZ1bGZpbGxlZCIsIkluZmluaXR5IiwiaSIsImxlbmd0aCIsImZ1bGZpbGxlZCIsImoiLCJPYmplY3QiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJyIiwiZ2V0UHJvdG90eXBlT2YiLCJvYmoiLCJ0IiwibW9kZSIsInRoaXMiLCJfX2VzTW9kdWxlIiwidGhlbiIsIm5zIiwiY3JlYXRlIiwiZGVmIiwiY3VycmVudCIsImluZGV4T2YiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZm9yRWFjaCIsImQiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJjaHVua0lkIiwiUHJvbWlzZSIsImFsbCIsInJlZHVjZSIsInByb21pc2VzIiwidSIsImciLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJsIiwidXJsIiwiZG9uZSIsInB1c2giLCJzY3JpcHQiLCJuZWVkQXR0YWNoIiwic2NyaXB0cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicyIsImdldEF0dHJpYnV0ZSIsImNyZWF0ZUVsZW1lbnQiLCJjaGFyc2V0IiwidGltZW91dCIsIm5jIiwic2V0QXR0cmlidXRlIiwic3JjIiwib25TY3JpcHRDb21wbGV0ZSIsInByZXYiLCJldmVudCIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiYmluZCIsInRhcmdldCIsImhlYWQiLCJhcHBlbmRDaGlsZCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwic2NyaXB0VXJsIiwiaW1wb3J0U2NyaXB0cyIsImN1cnJlbnRTY3JpcHQiLCJ0YWdOYW1lIiwidG9VcHBlckNhc2UiLCJ0ZXN0IiwicmVwbGFjZSIsInAiLCJpbnN0YWxsZWRDaHVua3MiLCJpbnN0YWxsZWRDaHVua0RhdGEiLCJwcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImVycm9yVHlwZSIsInJlYWxTcmMiLCJuYW1lIiwicmVxdWVzdCIsIndlYnBhY2tKc29ucENhbGxiYWNrIiwicGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24iLCJtb3JlTW9kdWxlcyIsInJ1bnRpbWUiLCJzb21lIiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwic2VsZiIsIl9fd2VicGFja19leHBvcnRzX18iXSwic291cmNlUm9vdCI6IiJ9